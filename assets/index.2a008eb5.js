function xM(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}const PM=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};PM();var MM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function IM(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Te={exports:{}},Ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wl=Symbol.for("react.element"),BM=Symbol.for("react.portal"),LM=Symbol.for("react.fragment"),RM=Symbol.for("react.strict_mode"),OM=Symbol.for("react.profiler"),FM=Symbol.for("react.provider"),DM=Symbol.for("react.context"),kM=Symbol.for("react.forward_ref"),NM=Symbol.for("react.suspense"),UM=Symbol.for("react.memo"),GM=Symbol.for("react.lazy"),H_=Symbol.iterator;function zM(t){return t===null||typeof t!="object"?null:(t=H_&&t[H_]||t["@@iterator"],typeof t=="function"?t:null)}var tT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nT=Object.assign,iT={};function Ua(t,e,n){this.props=t,this.context=e,this.refs=iT,this.updater=n||tT}Ua.prototype.isReactComponent={};Ua.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ua.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function rT(){}rT.prototype=Ua.prototype;function Xp(t,e,n){this.props=t,this.context=e,this.refs=iT,this.updater=n||tT}var Jp=Xp.prototype=new rT;Jp.constructor=Xp;nT(Jp,Ua.prototype);Jp.isPureReactComponent=!0;var j_=Array.isArray,sT=Object.prototype.hasOwnProperty,Yp={current:null},oT={key:!0,ref:!0,__self:!0,__source:!0};function aT(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)sT.call(e,i)&&!oT.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var c=Array(a),f=0;f<a;f++)c[f]=arguments[f+2];r.children=c}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Wl,type:t,key:s,ref:o,props:r,_owner:Yp.current}}function VM(t,e){return{$$typeof:Wl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Kp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wl}function HM(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var W_=/\/+/g;function gd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?HM(""+t.key):e.toString(36)}function ku(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Wl:case BM:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+gd(o,0):i,j_(r)?(n="",t!=null&&(n=t.replace(W_,"$&/")+"/"),ku(r,e,n,"",function(f){return f})):r!=null&&(Kp(r)&&(r=VM(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(W_,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",j_(t))for(var a=0;a<t.length;a++){s=t[a];var c=i+gd(s,a);o+=ku(s,e,n,c,r)}else if(c=zM(t),typeof c=="function")for(t=c.call(t),a=0;!(s=t.next()).done;)s=s.value,c=i+gd(s,a++),o+=ku(s,e,n,c,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function kc(t,e,n){if(t==null)return t;var i=[],r=0;return ku(t,i,"","",function(s){return e.call(n,s,r++)}),i}function jM(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Sn={current:null},Nu={transition:null},WM={ReactCurrentDispatcher:Sn,ReactCurrentBatchConfig:Nu,ReactCurrentOwner:Yp};Ke.Children={map:kc,forEach:function(t,e,n){kc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return kc(t,function(){e++}),e},toArray:function(t){return kc(t,function(e){return e})||[]},only:function(t){if(!Kp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ke.Component=Ua;Ke.Fragment=LM;Ke.Profiler=OM;Ke.PureComponent=Xp;Ke.StrictMode=RM;Ke.Suspense=NM;Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WM;Ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=nT({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Yp.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)sT.call(e,c)&&!oT.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=n;else if(1<c){a=Array(c);for(var f=0;f<c;f++)a[f]=arguments[f+2];i.children=a}return{$$typeof:Wl,type:t.type,key:r,ref:s,props:i,_owner:o}};Ke.createContext=function(t){return t={$$typeof:DM,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:FM,_context:t},t.Consumer=t};Ke.createElement=aT;Ke.createFactory=function(t){var e=aT.bind(null,t);return e.type=t,e};Ke.createRef=function(){return{current:null}};Ke.forwardRef=function(t){return{$$typeof:kM,render:t}};Ke.isValidElement=Kp;Ke.lazy=function(t){return{$$typeof:GM,_payload:{_status:-1,_result:t},_init:jM}};Ke.memo=function(t,e){return{$$typeof:UM,type:t,compare:e===void 0?null:e}};Ke.startTransition=function(t){var e=Nu.transition;Nu.transition={};try{t()}finally{Nu.transition=e}};Ke.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ke.useCallback=function(t,e){return Sn.current.useCallback(t,e)};Ke.useContext=function(t){return Sn.current.useContext(t)};Ke.useDebugValue=function(){};Ke.useDeferredValue=function(t){return Sn.current.useDeferredValue(t)};Ke.useEffect=function(t,e){return Sn.current.useEffect(t,e)};Ke.useId=function(){return Sn.current.useId()};Ke.useImperativeHandle=function(t,e,n){return Sn.current.useImperativeHandle(t,e,n)};Ke.useInsertionEffect=function(t,e){return Sn.current.useInsertionEffect(t,e)};Ke.useLayoutEffect=function(t,e){return Sn.current.useLayoutEffect(t,e)};Ke.useMemo=function(t,e){return Sn.current.useMemo(t,e)};Ke.useReducer=function(t,e,n){return Sn.current.useReducer(t,e,n)};Ke.useRef=function(t){return Sn.current.useRef(t)};Ke.useState=function(t){return Sn.current.useState(t)};Ke.useSyncExternalStore=function(t,e,n){return Sn.current.useSyncExternalStore(t,e,n)};Ke.useTransition=function(){return Sn.current.useTransition()};Ke.version="18.2.0";(function(t){t.exports=Ke})(Te);const QM=IM(Te.exports);var sg={},Af={exports:{}},ni={},AT={exports:{}},lT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(oe,ve){var xe=oe.length;oe.push(ve);e:for(;0<xe;){var Le=xe-1>>>1,ke=oe[Le];if(0<r(ke,ve))oe[Le]=ve,oe[xe]=ke,xe=Le;else break e}}function n(oe){return oe.length===0?null:oe[0]}function i(oe){if(oe.length===0)return null;var ve=oe[0],xe=oe.pop();if(xe!==ve){oe[0]=xe;e:for(var Le=0,ke=oe.length,Wt=ke>>>1;Le<Wt;){var Gn=2*(Le+1)-1,Ts=oe[Gn],ri=Gn+1,Bt=oe[ri];if(0>r(Ts,xe))ri<ke&&0>r(Bt,Ts)?(oe[Le]=Bt,oe[ri]=xe,Le=ri):(oe[Le]=Ts,oe[Gn]=xe,Le=Gn);else if(ri<ke&&0>r(Bt,xe))oe[Le]=Bt,oe[ri]=xe,Le=ri;else break e}}return ve}function r(oe,ve){var xe=oe.sortIndex-ve.sortIndex;return xe!==0?xe:oe.id-ve.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],f=[],p=1,m=null,v=3,w=!1,C=!1,S=!1,R=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(oe){for(var ve=n(f);ve!==null;){if(ve.callback===null)i(f);else if(ve.startTime<=oe)i(f),ve.sortIndex=ve.expirationTime,e(c,ve);else break;ve=n(f)}}function F(oe){if(S=!1,I(oe),!C)if(n(c)!==null)C=!0,Ye(H);else{var ve=n(f);ve!==null&&Qe(F,ve.startTime-oe)}}function H(oe,ve){C=!1,S&&(S=!1,x(ee),ee=-1),w=!0;var xe=v;try{for(I(ve),m=n(c);m!==null&&(!(m.expirationTime>ve)||oe&&!D());){var Le=m.callback;if(typeof Le=="function"){m.callback=null,v=m.priorityLevel;var ke=Le(m.expirationTime<=ve);ve=t.unstable_now(),typeof ke=="function"?m.callback=ke:m===n(c)&&i(c),I(ve)}else i(c);m=n(c)}if(m!==null)var Wt=!0;else{var Gn=n(f);Gn!==null&&Qe(F,Gn.startTime-ve),Wt=!1}return Wt}finally{m=null,v=xe,w=!1}}var Q=!1,q=null,ee=-1,X=5,V=-1;function D(){return!(t.unstable_now()-V<X)}function re(){if(q!==null){var oe=t.unstable_now();V=oe;var ve=!0;try{ve=q(!0,oe)}finally{ve?Ae():(Q=!1,q=null)}}else Q=!1}var Ae;if(typeof P=="function")Ae=function(){P(re)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,Be=ge.port2;ge.port1.onmessage=re,Ae=function(){Be.postMessage(null)}}else Ae=function(){R(re,0)};function Ye(oe){q=oe,Q||(Q=!0,Ae())}function Qe(oe,ve){ee=R(function(){oe(t.unstable_now())},ve)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(oe){oe.callback=null},t.unstable_continueExecution=function(){C||w||(C=!0,Ye(H))},t.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):X=0<oe?Math.floor(1e3/oe):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(oe){switch(v){case 1:case 2:case 3:var ve=3;break;default:ve=v}var xe=v;v=ve;try{return oe()}finally{v=xe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(oe,ve){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var xe=v;v=oe;try{return ve()}finally{v=xe}},t.unstable_scheduleCallback=function(oe,ve,xe){var Le=t.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?Le+xe:Le):xe=Le,oe){case 1:var ke=-1;break;case 2:ke=250;break;case 5:ke=1073741823;break;case 4:ke=1e4;break;default:ke=5e3}return ke=xe+ke,oe={id:p++,callback:ve,priorityLevel:oe,startTime:xe,expirationTime:ke,sortIndex:-1},xe>Le?(oe.sortIndex=xe,e(f,oe),n(c)===null&&oe===n(f)&&(S?(x(ee),ee=-1):S=!0,Qe(F,xe-Le))):(oe.sortIndex=ke,e(c,oe),C||w||(C=!0,Ye(H))),oe},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(oe){var ve=v;return function(){var xe=v;v=ve;try{return oe.apply(this,arguments)}finally{v=xe}}}})(lT);(function(t){t.exports=lT})(AT);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cT=Te.exports,ti=AT.exports;function le(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uT=new Set,cl={};function lo(t,e){wa(t,e),wa(t+"Capture",e)}function wa(t,e){for(cl[t]=e,t=0;t<e.length;t++)uT.add(e[t])}var wr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),og=Object.prototype.hasOwnProperty,XM=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Q_={},X_={};function JM(t){return og.call(X_,t)?!0:og.call(Q_,t)?!1:XM.test(t)?X_[t]=!0:(Q_[t]=!0,!1)}function YM(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function KM(t,e,n,i){if(e===null||typeof e>"u"||YM(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xn(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){An[t]=new xn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];An[e]=new xn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){An[t]=new xn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){An[t]=new xn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){An[t]=new xn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){An[t]=new xn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){An[t]=new xn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){An[t]=new xn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){An[t]=new xn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Zp=/[\-:]([a-z])/g;function qp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Zp,qp);An[e]=new xn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Zp,qp);An[e]=new xn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Zp,qp);An[e]=new xn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){An[t]=new xn(t,1,!1,t.toLowerCase(),null,!1,!1)});An.xlinkHref=new xn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){An[t]=new xn(t,1,!1,t.toLowerCase(),null,!0,!0)});function $p(t,e,n,i){var r=An.hasOwnProperty(e)?An[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(KM(e,n,r,i)&&(n=null),i||r===null?JM(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Ir=cT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Nc=Symbol.for("react.element"),Ho=Symbol.for("react.portal"),jo=Symbol.for("react.fragment"),em=Symbol.for("react.strict_mode"),ag=Symbol.for("react.profiler"),hT=Symbol.for("react.provider"),fT=Symbol.for("react.context"),tm=Symbol.for("react.forward_ref"),Ag=Symbol.for("react.suspense"),lg=Symbol.for("react.suspense_list"),nm=Symbol.for("react.memo"),Yr=Symbol.for("react.lazy"),dT=Symbol.for("react.offscreen"),J_=Symbol.iterator;function dA(t){return t===null||typeof t!="object"?null:(t=J_&&t[J_]||t["@@iterator"],typeof t=="function"?t:null)}var It=Object.assign,pd;function kA(t){if(pd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);pd=e&&e[1]||""}return`
`+pd+t}var md=!1;function _d(t,e){if(!t||md)return"";md=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var i=f}Reflect.construct(t,[],e)}else{try{e.call()}catch(f){i=f}t.call(e.prototype)}else{try{throw Error()}catch(f){i=f}t()}}catch(f){if(f&&i&&typeof f.stack=="string"){for(var r=f.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var c=`
`+r[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{md=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?kA(t):""}function ZM(t){switch(t.tag){case 5:return kA(t.type);case 16:return kA("Lazy");case 13:return kA("Suspense");case 19:return kA("SuspenseList");case 0:case 2:case 15:return t=_d(t.type,!1),t;case 11:return t=_d(t.type.render,!1),t;case 1:return t=_d(t.type,!0),t;default:return""}}function cg(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jo:return"Fragment";case Ho:return"Portal";case ag:return"Profiler";case em:return"StrictMode";case Ag:return"Suspense";case lg:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fT:return(t.displayName||"Context")+".Consumer";case hT:return(t._context.displayName||"Context")+".Provider";case tm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case nm:return e=t.displayName||null,e!==null?e:cg(t.type)||"Memo";case Yr:e=t._payload,t=t._init;try{return cg(t(e))}catch{}}return null}function qM(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cg(e);case 8:return e===em?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function fs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function gT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function $M(t){var e=gT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Uc(t){t._valueTracker||(t._valueTracker=$M(t))}function pT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=gT(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function uh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ug(t,e){var n=e.checked;return It({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:t._wrapperState.initialChecked})}function Y_(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=fs(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function mT(t,e){e=e.checked,e!=null&&$p(t,"checked",e,!1)}function hg(t,e){mT(t,e);var n=fs(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?fg(t,e.type,n):e.hasOwnProperty("defaultValue")&&fg(t,e.type,fs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function K_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function fg(t,e,n){(e!=="number"||uh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var NA=Array.isArray;function ua(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+fs(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function dg(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(le(91));return It({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Z_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(le(92));if(NA(n)){if(1<n.length)throw Error(le(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:fs(n)}}function _T(t,e){var n=fs(e.value),i=fs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function q_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function yT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gg(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?yT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Gc,vT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Gc=Gc||document.createElement("div"),Gc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ul(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var XA={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eI=["Webkit","ms","Moz","O"];Object.keys(XA).forEach(function(t){eI.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),XA[e]=XA[t]})});function ET(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||XA.hasOwnProperty(t)&&XA[t]?(""+e).trim():e+"px"}function wT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=ET(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var tI=It({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pg(t,e){if(e){if(tI[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(le(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(le(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(le(61))}if(e.style!=null&&typeof e.style!="object")throw Error(le(62))}}function mg(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _g=null;function im(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var yg=null,ha=null,fa=null;function $_(t){if(t=Jl(t)){if(typeof yg!="function")throw Error(le(280));var e=t.stateNode;e&&(e=ff(e),yg(t.stateNode,t.type,e))}}function TT(t){ha?fa?fa.push(t):fa=[t]:ha=t}function CT(){if(ha){var t=ha,e=fa;if(fa=ha=null,$_(t),e)for(t=0;t<e.length;t++)$_(e[t])}}function bT(t,e){return t(e)}function ST(){}var yd=!1;function xT(t,e,n){if(yd)return t(e,n);yd=!0;try{return bT(t,e,n)}finally{yd=!1,(ha!==null||fa!==null)&&(ST(),CT())}}function hl(t,e){var n=t.stateNode;if(n===null)return null;var i=ff(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(le(231,e,typeof n));return n}var vg=!1;if(wr)try{var gA={};Object.defineProperty(gA,"passive",{get:function(){vg=!0}}),window.addEventListener("test",gA,gA),window.removeEventListener("test",gA,gA)}catch{vg=!1}function nI(t,e,n,i,r,s,o,a,c){var f=Array.prototype.slice.call(arguments,3);try{e.apply(n,f)}catch(p){this.onError(p)}}var JA=!1,hh=null,fh=!1,Eg=null,iI={onError:function(t){JA=!0,hh=t}};function rI(t,e,n,i,r,s,o,a,c){JA=!1,hh=null,nI.apply(iI,arguments)}function sI(t,e,n,i,r,s,o,a,c){if(rI.apply(this,arguments),JA){if(JA){var f=hh;JA=!1,hh=null}else throw Error(le(198));fh||(fh=!0,Eg=f)}}function co(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,(e.flags&4098)!==0&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function PT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ey(t){if(co(t)!==t)throw Error(le(188))}function oI(t){var e=t.alternate;if(!e){if(e=co(t),e===null)throw Error(le(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return ey(r),t;if(s===i)return ey(r),e;s=s.sibling}throw Error(le(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(le(189))}}if(n.alternate!==i)throw Error(le(190))}if(n.tag!==3)throw Error(le(188));return n.stateNode.current===n?t:e}function MT(t){return t=oI(t),t!==null?IT(t):null}function IT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=IT(t);if(e!==null)return e;t=t.sibling}return null}var BT=ti.unstable_scheduleCallback,ty=ti.unstable_cancelCallback,aI=ti.unstable_shouldYield,AI=ti.unstable_requestPaint,Nt=ti.unstable_now,lI=ti.unstable_getCurrentPriorityLevel,rm=ti.unstable_ImmediatePriority,LT=ti.unstable_UserBlockingPriority,dh=ti.unstable_NormalPriority,cI=ti.unstable_LowPriority,RT=ti.unstable_IdlePriority,lf=null,tr=null;function uI(t){if(tr&&typeof tr.onCommitFiberRoot=="function")try{tr.onCommitFiberRoot(lf,t,void 0,(t.current.flags&128)===128)}catch{}}var Fi=Math.clz32?Math.clz32:dI,hI=Math.log,fI=Math.LN2;function dI(t){return t>>>=0,t===0?32:31-(hI(t)/fI|0)|0}var zc=64,Vc=4194304;function UA(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gh(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=UA(a):(s&=o,s!==0&&(i=UA(s)))}else o=n&~r,o!==0?i=UA(o):s!==0&&(i=UA(s));if(i===0)return 0;if(e!==0&&e!==i&&(e&r)===0&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if((i&4)!==0&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Fi(e),r=1<<n,i|=t[n],e&=~r;return i}function gI(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pI(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Fi(s),a=1<<o,c=r[o];c===-1?((a&n)===0||(a&i)!==0)&&(r[o]=gI(a,e)):c<=e&&(t.expiredLanes|=a),s&=~a}}function wg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function OT(){var t=zc;return zc<<=1,(zc&4194240)===0&&(zc=64),t}function vd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ql(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Fi(e),t[e]=n}function mI(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Fi(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function sm(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Fi(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var ut=0;function FT(t){return t&=-t,1<t?4<t?(t&268435455)!==0?16:536870912:4:1}var DT,om,kT,NT,UT,Tg=!1,Hc=[],rs=null,ss=null,os=null,fl=new Map,dl=new Map,Zr=[],_I="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ny(t,e){switch(t){case"focusin":case"focusout":rs=null;break;case"dragenter":case"dragleave":ss=null;break;case"mouseover":case"mouseout":os=null;break;case"pointerover":case"pointerout":fl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":dl.delete(e.pointerId)}}function pA(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Jl(e),e!==null&&om(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function yI(t,e,n,i,r){switch(e){case"focusin":return rs=pA(rs,t,e,n,i,r),!0;case"dragenter":return ss=pA(ss,t,e,n,i,r),!0;case"mouseover":return os=pA(os,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return fl.set(s,pA(fl.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,dl.set(s,pA(dl.get(s)||null,t,e,n,i,r)),!0}return!1}function GT(t){var e=Hs(t.target);if(e!==null){var n=co(e);if(n!==null){if(e=n.tag,e===13){if(e=PT(n),e!==null){t.blockedOn=e,UT(t.priority,function(){kT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Uu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);_g=i,n.target.dispatchEvent(i),_g=null}else return e=Jl(n),e!==null&&om(e),t.blockedOn=n,!1;e.shift()}return!0}function iy(t,e,n){Uu(t)&&n.delete(e)}function vI(){Tg=!1,rs!==null&&Uu(rs)&&(rs=null),ss!==null&&Uu(ss)&&(ss=null),os!==null&&Uu(os)&&(os=null),fl.forEach(iy),dl.forEach(iy)}function mA(t,e){t.blockedOn===e&&(t.blockedOn=null,Tg||(Tg=!0,ti.unstable_scheduleCallback(ti.unstable_NormalPriority,vI)))}function gl(t){function e(r){return mA(r,t)}if(0<Hc.length){mA(Hc[0],t);for(var n=1;n<Hc.length;n++){var i=Hc[n];i.blockedOn===t&&(i.blockedOn=null)}}for(rs!==null&&mA(rs,t),ss!==null&&mA(ss,t),os!==null&&mA(os,t),fl.forEach(e),dl.forEach(e),n=0;n<Zr.length;n++)i=Zr[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Zr.length&&(n=Zr[0],n.blockedOn===null);)GT(n),n.blockedOn===null&&Zr.shift()}var da=Ir.ReactCurrentBatchConfig,ph=!0;function EI(t,e,n,i){var r=ut,s=da.transition;da.transition=null;try{ut=1,am(t,e,n,i)}finally{ut=r,da.transition=s}}function wI(t,e,n,i){var r=ut,s=da.transition;da.transition=null;try{ut=4,am(t,e,n,i)}finally{ut=r,da.transition=s}}function am(t,e,n,i){if(ph){var r=Cg(t,e,n,i);if(r===null)Id(t,e,i,mh,n),ny(t,i);else if(yI(r,t,e,n,i))i.stopPropagation();else if(ny(t,i),e&4&&-1<_I.indexOf(t)){for(;r!==null;){var s=Jl(r);if(s!==null&&DT(s),s=Cg(t,e,n,i),s===null&&Id(t,e,i,mh,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Id(t,e,i,null,n)}}var mh=null;function Cg(t,e,n,i){if(mh=null,t=im(i),t=Hs(t),t!==null)if(e=co(t),e===null)t=null;else if(n=e.tag,n===13){if(t=PT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return mh=t,null}function zT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lI()){case rm:return 1;case LT:return 4;case dh:case cI:return 16;case RT:return 536870912;default:return 16}default:return 16}}var es=null,Am=null,Gu=null;function VT(){if(Gu)return Gu;var t,e=Am,n=e.length,i,r="value"in es?es.value:es.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return Gu=r.slice(t,1<i?1-i:void 0)}function zu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function jc(){return!0}function ry(){return!1}function ii(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?jc:ry,this.isPropagationStopped=ry,this}return It(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jc)},persist:function(){},isPersistent:jc}),e}var Ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lm=ii(Ga),Xl=It({},Ga,{view:0,detail:0}),TI=ii(Xl),Ed,wd,_A,cf=It({},Xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cm,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==_A&&(_A&&t.type==="mousemove"?(Ed=t.screenX-_A.screenX,wd=t.screenY-_A.screenY):wd=Ed=0,_A=t),Ed)},movementY:function(t){return"movementY"in t?t.movementY:wd}}),sy=ii(cf),CI=It({},cf,{dataTransfer:0}),bI=ii(CI),SI=It({},Xl,{relatedTarget:0}),Td=ii(SI),xI=It({},Ga,{animationName:0,elapsedTime:0,pseudoElement:0}),PI=ii(xI),MI=It({},Ga,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),II=ii(MI),BI=It({},Ga,{data:0}),oy=ii(BI),LI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=OI[t])?!!e[t]:!1}function cm(){return FI}var DI=It({},Xl,{key:function(t){if(t.key){var e=LI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=zu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?RI[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cm,charCode:function(t){return t.type==="keypress"?zu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kI=ii(DI),NI=It({},cf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ay=ii(NI),UI=It({},Xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cm}),GI=ii(UI),zI=It({},Ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),VI=ii(zI),HI=It({},cf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),jI=ii(HI),WI=[9,13,27,32],um=wr&&"CompositionEvent"in window,YA=null;wr&&"documentMode"in document&&(YA=document.documentMode);var QI=wr&&"TextEvent"in window&&!YA,HT=wr&&(!um||YA&&8<YA&&11>=YA),Ay=String.fromCharCode(32),ly=!1;function jT(t,e){switch(t){case"keyup":return WI.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wo=!1;function XI(t,e){switch(t){case"compositionend":return WT(e);case"keypress":return e.which!==32?null:(ly=!0,Ay);case"textInput":return t=e.data,t===Ay&&ly?null:t;default:return null}}function JI(t,e){if(Wo)return t==="compositionend"||!um&&jT(t,e)?(t=VT(),Gu=Am=es=null,Wo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return HT&&e.locale!=="ko"?null:e.data;default:return null}}var YI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!YI[t.type]:e==="textarea"}function QT(t,e,n,i){TT(i),e=_h(e,"onChange"),0<e.length&&(n=new lm("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var KA=null,pl=null;function KI(t){iC(t,0)}function uf(t){var e=Jo(t);if(pT(e))return t}function ZI(t,e){if(t==="change")return e}var XT=!1;if(wr){var Cd;if(wr){var bd="oninput"in document;if(!bd){var uy=document.createElement("div");uy.setAttribute("oninput","return;"),bd=typeof uy.oninput=="function"}Cd=bd}else Cd=!1;XT=Cd&&(!document.documentMode||9<document.documentMode)}function hy(){KA&&(KA.detachEvent("onpropertychange",JT),pl=KA=null)}function JT(t){if(t.propertyName==="value"&&uf(pl)){var e=[];QT(e,pl,t,im(t)),xT(KI,e)}}function qI(t,e,n){t==="focusin"?(hy(),KA=e,pl=n,KA.attachEvent("onpropertychange",JT)):t==="focusout"&&hy()}function $I(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return uf(pl)}function eB(t,e){if(t==="click")return uf(e)}function tB(t,e){if(t==="input"||t==="change")return uf(e)}function nB(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ni=typeof Object.is=="function"?Object.is:nB;function ml(t,e){if(Ni(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!og.call(e,r)||!Ni(t[r],e[r]))return!1}return!0}function fy(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dy(t,e){var n=fy(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fy(n)}}function YT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?YT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function KT(){for(var t=window,e=uh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=uh(t.document)}return e}function hm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function iB(t){var e=KT(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&YT(n.ownerDocument.documentElement,n)){if(i!==null&&hm(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=dy(n,s);var o=dy(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var rB=wr&&"documentMode"in document&&11>=document.documentMode,Qo=null,bg=null,ZA=null,Sg=!1;function gy(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Sg||Qo==null||Qo!==uh(i)||(i=Qo,"selectionStart"in i&&hm(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),ZA&&ml(ZA,i)||(ZA=i,i=_h(bg,"onSelect"),0<i.length&&(e=new lm("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Qo)))}function Wc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xo={animationend:Wc("Animation","AnimationEnd"),animationiteration:Wc("Animation","AnimationIteration"),animationstart:Wc("Animation","AnimationStart"),transitionend:Wc("Transition","TransitionEnd")},Sd={},ZT={};wr&&(ZT=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function hf(t){if(Sd[t])return Sd[t];if(!Xo[t])return t;var e=Xo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in ZT)return Sd[t]=e[n];return t}var qT=hf("animationend"),$T=hf("animationiteration"),eC=hf("animationstart"),tC=hf("transitionend"),nC=new Map,py="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ys(t,e){nC.set(t,e),lo(e,[t])}for(var xd=0;xd<py.length;xd++){var Pd=py[xd],sB=Pd.toLowerCase(),oB=Pd[0].toUpperCase()+Pd.slice(1);ys(sB,"on"+oB)}ys(qT,"onAnimationEnd");ys($T,"onAnimationIteration");ys(eC,"onAnimationStart");ys("dblclick","onDoubleClick");ys("focusin","onFocus");ys("focusout","onBlur");ys(tC,"onTransitionEnd");wa("onMouseEnter",["mouseout","mouseover"]);wa("onMouseLeave",["mouseout","mouseover"]);wa("onPointerEnter",["pointerout","pointerover"]);wa("onPointerLeave",["pointerout","pointerover"]);lo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));lo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));lo("onBeforeInput",["compositionend","keypress","textInput","paste"]);lo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));lo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));lo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var GA="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aB=new Set("cancel close invalid load scroll toggle".split(" ").concat(GA));function my(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,sI(i,e,void 0,t),t.currentTarget=null}function iC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,f=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break e;my(r,a,f),s=c}else for(o=0;o<i.length;o++){if(a=i[o],c=a.instance,f=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break e;my(r,a,f),s=c}}}if(fh)throw t=Eg,fh=!1,Eg=null,t}function Et(t,e){var n=e[Bg];n===void 0&&(n=e[Bg]=new Set);var i=t+"__bubble";n.has(i)||(rC(e,t,2,!1),n.add(i))}function Md(t,e,n){var i=0;e&&(i|=4),rC(n,t,i,e)}var Qc="_reactListening"+Math.random().toString(36).slice(2);function _l(t){if(!t[Qc]){t[Qc]=!0,uT.forEach(function(n){n!=="selectionchange"&&(aB.has(n)||Md(n,!1,t),Md(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Qc]||(e[Qc]=!0,Md("selectionchange",!1,e))}}function rC(t,e,n,i){switch(zT(e)){case 1:var r=EI;break;case 4:r=wI;break;default:r=am}n=r.bind(null,e,n,t),r=void 0,!vg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Id(t,e,n,i,r){var s=i;if((e&1)===0&&(e&2)===0&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Hs(a),o===null)return;if(c=o.tag,c===5||c===6){i=s=o;continue e}a=a.parentNode}}i=i.return}xT(function(){var f=s,p=im(n),m=[];e:{var v=nC.get(t);if(v!==void 0){var w=lm,C=t;switch(t){case"keypress":if(zu(n)===0)break e;case"keydown":case"keyup":w=kI;break;case"focusin":C="focus",w=Td;break;case"focusout":C="blur",w=Td;break;case"beforeblur":case"afterblur":w=Td;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=sy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=bI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=GI;break;case qT:case $T:case eC:w=PI;break;case tC:w=VI;break;case"scroll":w=TI;break;case"wheel":w=jI;break;case"copy":case"cut":case"paste":w=II;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=ay}var S=(e&4)!==0,R=!S&&t==="scroll",x=S?v!==null?v+"Capture":null:v;S=[];for(var P=f,I;P!==null;){I=P;var F=I.stateNode;if(I.tag===5&&F!==null&&(I=F,x!==null&&(F=hl(P,x),F!=null&&S.push(yl(P,F,I)))),R)break;P=P.return}0<S.length&&(v=new w(v,C,null,n,p),m.push({event:v,listeners:S}))}}if((e&7)===0){e:{if(v=t==="mouseover"||t==="pointerover",w=t==="mouseout"||t==="pointerout",v&&n!==_g&&(C=n.relatedTarget||n.fromElement)&&(Hs(C)||C[Tr]))break e;if((w||v)&&(v=p.window===p?p:(v=p.ownerDocument)?v.defaultView||v.parentWindow:window,w?(C=n.relatedTarget||n.toElement,w=f,C=C?Hs(C):null,C!==null&&(R=co(C),C!==R||C.tag!==5&&C.tag!==6)&&(C=null)):(w=null,C=f),w!==C)){if(S=sy,F="onMouseLeave",x="onMouseEnter",P="mouse",(t==="pointerout"||t==="pointerover")&&(S=ay,F="onPointerLeave",x="onPointerEnter",P="pointer"),R=w==null?v:Jo(w),I=C==null?v:Jo(C),v=new S(F,P+"leave",w,n,p),v.target=R,v.relatedTarget=I,F=null,Hs(p)===f&&(S=new S(x,P+"enter",C,n,p),S.target=I,S.relatedTarget=R,F=S),R=F,w&&C)t:{for(S=w,x=C,P=0,I=S;I;I=Mo(I))P++;for(I=0,F=x;F;F=Mo(F))I++;for(;0<P-I;)S=Mo(S),P--;for(;0<I-P;)x=Mo(x),I--;for(;P--;){if(S===x||x!==null&&S===x.alternate)break t;S=Mo(S),x=Mo(x)}S=null}else S=null;w!==null&&_y(m,v,w,S,!1),C!==null&&R!==null&&_y(m,R,C,S,!0)}}e:{if(v=f?Jo(f):window,w=v.nodeName&&v.nodeName.toLowerCase(),w==="select"||w==="input"&&v.type==="file")var H=ZI;else if(cy(v))if(XT)H=tB;else{H=$I;var Q=qI}else(w=v.nodeName)&&w.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(H=eB);if(H&&(H=H(t,f))){QT(m,H,n,p);break e}Q&&Q(t,v,f),t==="focusout"&&(Q=v._wrapperState)&&Q.controlled&&v.type==="number"&&fg(v,"number",v.value)}switch(Q=f?Jo(f):window,t){case"focusin":(cy(Q)||Q.contentEditable==="true")&&(Qo=Q,bg=f,ZA=null);break;case"focusout":ZA=bg=Qo=null;break;case"mousedown":Sg=!0;break;case"contextmenu":case"mouseup":case"dragend":Sg=!1,gy(m,n,p);break;case"selectionchange":if(rB)break;case"keydown":case"keyup":gy(m,n,p)}var q;if(um)e:{switch(t){case"compositionstart":var ee="onCompositionStart";break e;case"compositionend":ee="onCompositionEnd";break e;case"compositionupdate":ee="onCompositionUpdate";break e}ee=void 0}else Wo?jT(t,n)&&(ee="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ee="onCompositionStart");ee&&(HT&&n.locale!=="ko"&&(Wo||ee!=="onCompositionStart"?ee==="onCompositionEnd"&&Wo&&(q=VT()):(es=p,Am="value"in es?es.value:es.textContent,Wo=!0)),Q=_h(f,ee),0<Q.length&&(ee=new oy(ee,t,null,n,p),m.push({event:ee,listeners:Q}),q?ee.data=q:(q=WT(n),q!==null&&(ee.data=q)))),(q=QI?XI(t,n):JI(t,n))&&(f=_h(f,"onBeforeInput"),0<f.length&&(p=new oy("onBeforeInput","beforeinput",null,n,p),m.push({event:p,listeners:f}),p.data=q))}iC(m,e)})}function yl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function _h(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=hl(t,n),s!=null&&i.unshift(yl(t,s,r)),s=hl(t,e),s!=null&&i.push(yl(t,s,r))),t=t.return}return i}function Mo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function _y(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,c=a.alternate,f=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&f!==null&&(a=f,r?(c=hl(n,s),c!=null&&o.unshift(yl(n,c,a))):r||(c=hl(n,s),c!=null&&o.push(yl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var AB=/\r\n?/g,lB=/\u0000|\uFFFD/g;function yy(t){return(typeof t=="string"?t:""+t).replace(AB,`
`).replace(lB,"")}function Xc(t,e,n){if(e=yy(e),yy(t)!==e&&n)throw Error(le(425))}function yh(){}var xg=null,Pg=null;function Mg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ig=typeof setTimeout=="function"?setTimeout:void 0,cB=typeof clearTimeout=="function"?clearTimeout:void 0,vy=typeof Promise=="function"?Promise:void 0,uB=typeof queueMicrotask=="function"?queueMicrotask:typeof vy<"u"?function(t){return vy.resolve(null).then(t).catch(hB)}:Ig;function hB(t){setTimeout(function(){throw t})}function Bd(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),gl(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);gl(e)}function as(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ey(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var za=Math.random().toString(36).slice(2),Zi="__reactFiber$"+za,vl="__reactProps$"+za,Tr="__reactContainer$"+za,Bg="__reactEvents$"+za,fB="__reactListeners$"+za,dB="__reactHandles$"+za;function Hs(t){var e=t[Zi];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Tr]||n[Zi]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ey(t);t!==null;){if(n=t[Zi])return n;t=Ey(t)}return e}t=n,n=t.parentNode}return null}function Jl(t){return t=t[Zi]||t[Tr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Jo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(le(33))}function ff(t){return t[vl]||null}var Lg=[],Yo=-1;function vs(t){return{current:t}}function wt(t){0>Yo||(t.current=Lg[Yo],Lg[Yo]=null,Yo--)}function mt(t,e){Yo++,Lg[Yo]=t.current,t.current=e}var ds={},yn=vs(ds),Fn=vs(!1),$s=ds;function Ta(t,e){var n=t.type.contextTypes;if(!n)return ds;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Dn(t){return t=t.childContextTypes,t!=null}function vh(){wt(Fn),wt(yn)}function wy(t,e,n){if(yn.current!==ds)throw Error(le(168));mt(yn,e),mt(Fn,n)}function sC(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(le(108,qM(t)||"Unknown",r));return It({},n,i)}function Eh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ds,$s=yn.current,mt(yn,t),mt(Fn,Fn.current),!0}function Ty(t,e,n){var i=t.stateNode;if(!i)throw Error(le(169));n?(t=sC(t,e,$s),i.__reactInternalMemoizedMergedChildContext=t,wt(Fn),wt(yn),mt(yn,t)):wt(Fn),mt(Fn,n)}var pr=null,df=!1,Ld=!1;function oC(t){pr===null?pr=[t]:pr.push(t)}function gB(t){df=!0,oC(t)}function Es(){if(!Ld&&pr!==null){Ld=!0;var t=0,e=ut;try{var n=pr;for(ut=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}pr=null,df=!1}catch(r){throw pr!==null&&(pr=pr.slice(t+1)),BT(rm,Es),r}finally{ut=e,Ld=!1}}return null}var Ko=[],Zo=0,wh=null,Th=0,ci=[],ui=0,eo=null,_r=1,yr="";function Gs(t,e){Ko[Zo++]=Th,Ko[Zo++]=wh,wh=t,Th=e}function aC(t,e,n){ci[ui++]=_r,ci[ui++]=yr,ci[ui++]=eo,eo=t;var i=_r;t=yr;var r=32-Fi(i)-1;i&=~(1<<r),n+=1;var s=32-Fi(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,_r=1<<32-Fi(e)+r|n<<r|i,yr=s+t}else _r=1<<s|n<<r|i,yr=t}function fm(t){t.return!==null&&(Gs(t,1),aC(t,1,0))}function dm(t){for(;t===wh;)wh=Ko[--Zo],Ko[Zo]=null,Th=Ko[--Zo],Ko[Zo]=null;for(;t===eo;)eo=ci[--ui],ci[ui]=null,yr=ci[--ui],ci[ui]=null,_r=ci[--ui],ci[ui]=null}var $n=null,Kn=null,Ct=!1,Mi=null;function AC(t,e){var n=fi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Cy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,$n=t,Kn=as(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,$n=t,Kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=eo!==null?{id:_r,overflow:yr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=fi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,$n=t,Kn=null,!0):!1;default:return!1}}function Rg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Og(t){if(Ct){var e=Kn;if(e){var n=e;if(!Cy(t,e)){if(Rg(t))throw Error(le(418));e=as(n.nextSibling);var i=$n;e&&Cy(t,e)?AC(i,n):(t.flags=t.flags&-4097|2,Ct=!1,$n=t)}}else{if(Rg(t))throw Error(le(418));t.flags=t.flags&-4097|2,Ct=!1,$n=t}}}function by(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;$n=t}function Jc(t){if(t!==$n)return!1;if(!Ct)return by(t),Ct=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Mg(t.type,t.memoizedProps)),e&&(e=Kn)){if(Rg(t))throw lC(),Error(le(418));for(;e;)AC(t,e),e=as(e.nextSibling)}if(by(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(le(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Kn=as(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Kn=null}}else Kn=$n?as(t.stateNode.nextSibling):null;return!0}function lC(){for(var t=Kn;t;)t=as(t.nextSibling)}function Ca(){Kn=$n=null,Ct=!1}function gm(t){Mi===null?Mi=[t]:Mi.push(t)}var pB=Ir.ReactCurrentBatchConfig;function xi(t,e){if(t&&t.defaultProps){e=It({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Ch=vs(null),bh=null,qo=null,pm=null;function mm(){pm=qo=bh=null}function _m(t){var e=Ch.current;wt(Ch),t._currentValue=e}function Fg(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function ga(t,e){bh=t,pm=qo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&((t.lanes&e)!==0&&(On=!0),t.firstContext=null)}function mi(t){var e=t._currentValue;if(pm!==t)if(t={context:t,memoizedValue:e,next:null},qo===null){if(bh===null)throw Error(le(308));qo=t,bh.dependencies={lanes:0,firstContext:t}}else qo=qo.next=t;return e}var js=null;function ym(t){js===null?js=[t]:js.push(t)}function cC(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,ym(e)):(n.next=r.next,r.next=n),e.interleaved=n,Cr(t,i)}function Cr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Kr=!1;function vm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function vr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function As(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,(rt&2)!==0){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Cr(t,n)}return r=i.interleaved,r===null?(e.next=e,ym(i)):(e.next=r.next,r.next=e),i.interleaved=e,Cr(t,n)}function Vu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,sm(t,n)}}function Sy(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Sh(t,e,n,i){var r=t.updateQueue;Kr=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,f=c.next;c.next=null,o===null?s=f:o.next=f,o=c;var p=t.alternate;p!==null&&(p=p.updateQueue,a=p.lastBaseUpdate,a!==o&&(a===null?p.firstBaseUpdate=f:a.next=f,p.lastBaseUpdate=c))}if(s!==null){var m=r.baseState;o=0,p=f=c=null,a=s;do{var v=a.lane,w=a.eventTime;if((i&v)===v){p!==null&&(p=p.next={eventTime:w,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var C=t,S=a;switch(v=e,w=n,S.tag){case 1:if(C=S.payload,typeof C=="function"){m=C.call(w,m,v);break e}m=C;break e;case 3:C.flags=C.flags&-65537|128;case 0:if(C=S.payload,v=typeof C=="function"?C.call(w,m,v):C,v==null)break e;m=It({},m,v);break e;case 2:Kr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,v=r.effects,v===null?r.effects=[a]:v.push(a))}else w={eventTime:w,lane:v,tag:a.tag,payload:a.payload,callback:a.callback,next:null},p===null?(f=p=w,c=m):p=p.next=w,o|=v;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;v=a,a=v.next,v.next=null,r.lastBaseUpdate=v,r.shared.pending=null}}while(1);if(p===null&&(c=m),r.baseState=c,r.firstBaseUpdate=f,r.lastBaseUpdate=p,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);no|=o,t.lanes=o,t.memoizedState=m}}function xy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(le(191,r));r.call(i)}}}var hC=new cT.Component().refs;function Dg(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:It({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var gf={isMounted:function(t){return(t=t._reactInternals)?co(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=bn(),r=cs(t),s=vr(i,r);s.payload=e,n!=null&&(s.callback=n),e=As(t,s,r),e!==null&&(Di(e,t,r,i),Vu(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=bn(),r=cs(t),s=vr(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=As(t,s,r),e!==null&&(Di(e,t,r,i),Vu(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=bn(),i=cs(t),r=vr(n,i);r.tag=2,e!=null&&(r.callback=e),e=As(t,r,i),e!==null&&(Di(e,t,i,n),Vu(e,t,i))}};function Py(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!ml(n,i)||!ml(r,s):!0}function fC(t,e,n){var i=!1,r=ds,s=e.contextType;return typeof s=="object"&&s!==null?s=mi(s):(r=Dn(e)?$s:yn.current,i=e.contextTypes,s=(i=i!=null)?Ta(t,r):ds),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=gf,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function My(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&gf.enqueueReplaceState(e,e.state,null)}function kg(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=hC,vm(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=mi(s):(s=Dn(e)?$s:yn.current,r.context=Ta(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Dg(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&gf.enqueueReplaceState(r,r.state,null),Sh(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function yA(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(le(309));var i=n.stateNode}if(!i)throw Error(le(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===hC&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(le(284));if(!n._owner)throw Error(le(290,t))}return t}function Yc(t,e){throw t=Object.prototype.toString.call(e),Error(le(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Iy(t){var e=t._init;return e(t._payload)}function dC(t){function e(x,P){if(t){var I=x.deletions;I===null?(x.deletions=[P],x.flags|=16):I.push(P)}}function n(x,P){if(!t)return null;for(;P!==null;)e(x,P),P=P.sibling;return null}function i(x,P){for(x=new Map;P!==null;)P.key!==null?x.set(P.key,P):x.set(P.index,P),P=P.sibling;return x}function r(x,P){return x=us(x,P),x.index=0,x.sibling=null,x}function s(x,P,I){return x.index=I,t?(I=x.alternate,I!==null?(I=I.index,I<P?(x.flags|=2,P):I):(x.flags|=2,P)):(x.flags|=1048576,P)}function o(x){return t&&x.alternate===null&&(x.flags|=2),x}function a(x,P,I,F){return P===null||P.tag!==6?(P=Ud(I,x.mode,F),P.return=x,P):(P=r(P,I),P.return=x,P)}function c(x,P,I,F){var H=I.type;return H===jo?p(x,P,I.props.children,F,I.key):P!==null&&(P.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Yr&&Iy(H)===P.type)?(F=r(P,I.props),F.ref=yA(x,P,I),F.return=x,F):(F=Ju(I.type,I.key,I.props,null,x.mode,F),F.ref=yA(x,P,I),F.return=x,F)}function f(x,P,I,F){return P===null||P.tag!==4||P.stateNode.containerInfo!==I.containerInfo||P.stateNode.implementation!==I.implementation?(P=Gd(I,x.mode,F),P.return=x,P):(P=r(P,I.children||[]),P.return=x,P)}function p(x,P,I,F,H){return P===null||P.tag!==7?(P=Ys(I,x.mode,F,H),P.return=x,P):(P=r(P,I),P.return=x,P)}function m(x,P,I){if(typeof P=="string"&&P!==""||typeof P=="number")return P=Ud(""+P,x.mode,I),P.return=x,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Nc:return I=Ju(P.type,P.key,P.props,null,x.mode,I),I.ref=yA(x,null,P),I.return=x,I;case Ho:return P=Gd(P,x.mode,I),P.return=x,P;case Yr:var F=P._init;return m(x,F(P._payload),I)}if(NA(P)||dA(P))return P=Ys(P,x.mode,I,null),P.return=x,P;Yc(x,P)}return null}function v(x,P,I,F){var H=P!==null?P.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return H!==null?null:a(x,P,""+I,F);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Nc:return I.key===H?c(x,P,I,F):null;case Ho:return I.key===H?f(x,P,I,F):null;case Yr:return H=I._init,v(x,P,H(I._payload),F)}if(NA(I)||dA(I))return H!==null?null:p(x,P,I,F,null);Yc(x,I)}return null}function w(x,P,I,F,H){if(typeof F=="string"&&F!==""||typeof F=="number")return x=x.get(I)||null,a(P,x,""+F,H);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case Nc:return x=x.get(F.key===null?I:F.key)||null,c(P,x,F,H);case Ho:return x=x.get(F.key===null?I:F.key)||null,f(P,x,F,H);case Yr:var Q=F._init;return w(x,P,I,Q(F._payload),H)}if(NA(F)||dA(F))return x=x.get(I)||null,p(P,x,F,H,null);Yc(P,F)}return null}function C(x,P,I,F){for(var H=null,Q=null,q=P,ee=P=0,X=null;q!==null&&ee<I.length;ee++){q.index>ee?(X=q,q=null):X=q.sibling;var V=v(x,q,I[ee],F);if(V===null){q===null&&(q=X);break}t&&q&&V.alternate===null&&e(x,q),P=s(V,P,ee),Q===null?H=V:Q.sibling=V,Q=V,q=X}if(ee===I.length)return n(x,q),Ct&&Gs(x,ee),H;if(q===null){for(;ee<I.length;ee++)q=m(x,I[ee],F),q!==null&&(P=s(q,P,ee),Q===null?H=q:Q.sibling=q,Q=q);return Ct&&Gs(x,ee),H}for(q=i(x,q);ee<I.length;ee++)X=w(q,x,ee,I[ee],F),X!==null&&(t&&X.alternate!==null&&q.delete(X.key===null?ee:X.key),P=s(X,P,ee),Q===null?H=X:Q.sibling=X,Q=X);return t&&q.forEach(function(D){return e(x,D)}),Ct&&Gs(x,ee),H}function S(x,P,I,F){var H=dA(I);if(typeof H!="function")throw Error(le(150));if(I=H.call(I),I==null)throw Error(le(151));for(var Q=H=null,q=P,ee=P=0,X=null,V=I.next();q!==null&&!V.done;ee++,V=I.next()){q.index>ee?(X=q,q=null):X=q.sibling;var D=v(x,q,V.value,F);if(D===null){q===null&&(q=X);break}t&&q&&D.alternate===null&&e(x,q),P=s(D,P,ee),Q===null?H=D:Q.sibling=D,Q=D,q=X}if(V.done)return n(x,q),Ct&&Gs(x,ee),H;if(q===null){for(;!V.done;ee++,V=I.next())V=m(x,V.value,F),V!==null&&(P=s(V,P,ee),Q===null?H=V:Q.sibling=V,Q=V);return Ct&&Gs(x,ee),H}for(q=i(x,q);!V.done;ee++,V=I.next())V=w(q,x,ee,V.value,F),V!==null&&(t&&V.alternate!==null&&q.delete(V.key===null?ee:V.key),P=s(V,P,ee),Q===null?H=V:Q.sibling=V,Q=V);return t&&q.forEach(function(re){return e(x,re)}),Ct&&Gs(x,ee),H}function R(x,P,I,F){if(typeof I=="object"&&I!==null&&I.type===jo&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case Nc:e:{for(var H=I.key,Q=P;Q!==null;){if(Q.key===H){if(H=I.type,H===jo){if(Q.tag===7){n(x,Q.sibling),P=r(Q,I.props.children),P.return=x,x=P;break e}}else if(Q.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Yr&&Iy(H)===Q.type){n(x,Q.sibling),P=r(Q,I.props),P.ref=yA(x,Q,I),P.return=x,x=P;break e}n(x,Q);break}else e(x,Q);Q=Q.sibling}I.type===jo?(P=Ys(I.props.children,x.mode,F,I.key),P.return=x,x=P):(F=Ju(I.type,I.key,I.props,null,x.mode,F),F.ref=yA(x,P,I),F.return=x,x=F)}return o(x);case Ho:e:{for(Q=I.key;P!==null;){if(P.key===Q)if(P.tag===4&&P.stateNode.containerInfo===I.containerInfo&&P.stateNode.implementation===I.implementation){n(x,P.sibling),P=r(P,I.children||[]),P.return=x,x=P;break e}else{n(x,P);break}else e(x,P);P=P.sibling}P=Gd(I,x.mode,F),P.return=x,x=P}return o(x);case Yr:return Q=I._init,R(x,P,Q(I._payload),F)}if(NA(I))return C(x,P,I,F);if(dA(I))return S(x,P,I,F);Yc(x,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,P!==null&&P.tag===6?(n(x,P.sibling),P=r(P,I),P.return=x,x=P):(n(x,P),P=Ud(I,x.mode,F),P.return=x,x=P),o(x)):n(x,P)}return R}var ba=dC(!0),gC=dC(!1),Yl={},nr=vs(Yl),El=vs(Yl),wl=vs(Yl);function Ws(t){if(t===Yl)throw Error(le(174));return t}function Em(t,e){switch(mt(wl,e),mt(El,t),mt(nr,Yl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:gg(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=gg(e,t)}wt(nr),mt(nr,e)}function Sa(){wt(nr),wt(El),wt(wl)}function pC(t){Ws(wl.current);var e=Ws(nr.current),n=gg(e,t.type);e!==n&&(mt(El,t),mt(nr,n))}function wm(t){El.current===t&&(wt(nr),wt(El))}var St=vs(0);function xh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if((e.flags&128)!==0)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rd=[];function Tm(){for(var t=0;t<Rd.length;t++)Rd[t]._workInProgressVersionPrimary=null;Rd.length=0}var Hu=Ir.ReactCurrentDispatcher,Od=Ir.ReactCurrentBatchConfig,to=0,Mt=null,Yt=null,en=null,Ph=!1,qA=!1,Tl=0,mB=0;function un(){throw Error(le(321))}function Cm(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ni(t[n],e[n]))return!1;return!0}function bm(t,e,n,i,r,s){if(to=s,Mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Hu.current=t===null||t.memoizedState===null?EB:wB,t=n(i,r),qA){s=0;do{if(qA=!1,Tl=0,25<=s)throw Error(le(301));s+=1,en=Yt=null,e.updateQueue=null,Hu.current=TB,t=n(i,r)}while(qA)}if(Hu.current=Mh,e=Yt!==null&&Yt.next!==null,to=0,en=Yt=Mt=null,Ph=!1,e)throw Error(le(300));return t}function Sm(){var t=Tl!==0;return Tl=0,t}function Yi(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?Mt.memoizedState=en=t:en=en.next=t,en}function _i(){if(Yt===null){var t=Mt.alternate;t=t!==null?t.memoizedState:null}else t=Yt.next;var e=en===null?Mt.memoizedState:en.next;if(e!==null)en=e,Yt=t;else{if(t===null)throw Error(le(310));Yt=t,t={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},en===null?Mt.memoizedState=en=t:en=en.next=t}return en}function Cl(t,e){return typeof e=="function"?e(t):e}function Fd(t){var e=_i(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var i=Yt,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,c=null,f=s;do{var p=f.lane;if((to&p)===p)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),i=f.hasEagerState?f.eagerState:t(i,f.action);else{var m={lane:p,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(a=c=m,o=i):c=c.next=m,Mt.lanes|=p,no|=p}f=f.next}while(f!==null&&f!==s);c===null?o=i:c.next=a,Ni(i,e.memoizedState)||(On=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=c,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,Mt.lanes|=s,no|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Dd(t){var e=_i(),n=e.queue;if(n===null)throw Error(le(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Ni(s,e.memoizedState)||(On=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function mC(){}function _C(t,e){var n=Mt,i=_i(),r=e(),s=!Ni(i.memoizedState,r);if(s&&(i.memoizedState=r,On=!0),i=i.queue,xm(EC.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||en!==null&&en.memoizedState.tag&1){if(n.flags|=2048,bl(9,vC.bind(null,n,i,r,e),void 0,null),nn===null)throw Error(le(349));(to&30)!==0||yC(n,e,r)}return r}function yC(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Mt.updateQueue,e===null?(e={lastEffect:null,stores:null},Mt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function vC(t,e,n,i){e.value=n,e.getSnapshot=i,wC(e)&&TC(t)}function EC(t,e,n){return n(function(){wC(e)&&TC(t)})}function wC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ni(t,n)}catch{return!0}}function TC(t){var e=Cr(t,1);e!==null&&Di(e,t,1,-1)}function By(t){var e=Yi();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Cl,lastRenderedState:t},e.queue=t,t=t.dispatch=vB.bind(null,Mt,t),[e.memoizedState,t]}function bl(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Mt.updateQueue,e===null?(e={lastEffect:null,stores:null},Mt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function CC(){return _i().memoizedState}function ju(t,e,n,i){var r=Yi();Mt.flags|=t,r.memoizedState=bl(1|e,n,void 0,i===void 0?null:i)}function pf(t,e,n,i){var r=_i();i=i===void 0?null:i;var s=void 0;if(Yt!==null){var o=Yt.memoizedState;if(s=o.destroy,i!==null&&Cm(i,o.deps)){r.memoizedState=bl(e,n,s,i);return}}Mt.flags|=t,r.memoizedState=bl(1|e,n,s,i)}function Ly(t,e){return ju(8390656,8,t,e)}function xm(t,e){return pf(2048,8,t,e)}function bC(t,e){return pf(4,2,t,e)}function SC(t,e){return pf(4,4,t,e)}function xC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function PC(t,e,n){return n=n!=null?n.concat([t]):null,pf(4,4,xC.bind(null,e,t),n)}function Pm(){}function MC(t,e){var n=_i();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&Cm(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function IC(t,e){var n=_i();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&Cm(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function BC(t,e,n){return(to&21)===0?(t.baseState&&(t.baseState=!1,On=!0),t.memoizedState=n):(Ni(n,e)||(n=OT(),Mt.lanes|=n,no|=n,t.baseState=!0),e)}function _B(t,e){var n=ut;ut=n!==0&&4>n?n:4,t(!0);var i=Od.transition;Od.transition={};try{t(!1),e()}finally{ut=n,Od.transition=i}}function LC(){return _i().memoizedState}function yB(t,e,n){var i=cs(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},RC(t))OC(e,n);else if(n=cC(t,e,n,i),n!==null){var r=bn();Di(n,t,i,r),FC(n,e,i)}}function vB(t,e,n){var i=cs(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(RC(t))OC(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Ni(a,o)){var c=e.interleaved;c===null?(r.next=r,ym(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}n=cC(t,e,r,i),n!==null&&(r=bn(),Di(n,t,i,r),FC(n,e,i))}}function RC(t){var e=t.alternate;return t===Mt||e!==null&&e===Mt}function OC(t,e){qA=Ph=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function FC(t,e,n){if((n&4194240)!==0){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,sm(t,n)}}var Mh={readContext:mi,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},EB={readContext:mi,useCallback:function(t,e){return Yi().memoizedState=[t,e===void 0?null:e],t},useContext:mi,useEffect:Ly,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ju(4194308,4,xC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ju(4194308,4,t,e)},useInsertionEffect:function(t,e){return ju(4,2,t,e)},useMemo:function(t,e){var n=Yi();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Yi();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=yB.bind(null,Mt,t),[i.memoizedState,t]},useRef:function(t){var e=Yi();return t={current:t},e.memoizedState=t},useState:By,useDebugValue:Pm,useDeferredValue:function(t){return Yi().memoizedState=t},useTransition:function(){var t=By(!1),e=t[0];return t=_B.bind(null,t[1]),Yi().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Mt,r=Yi();if(Ct){if(n===void 0)throw Error(le(407));n=n()}else{if(n=e(),nn===null)throw Error(le(349));(to&30)!==0||yC(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,Ly(EC.bind(null,i,s,t),[t]),i.flags|=2048,bl(9,vC.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=Yi(),e=nn.identifierPrefix;if(Ct){var n=yr,i=_r;n=(i&~(1<<32-Fi(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=Tl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=mB++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},wB={readContext:mi,useCallback:MC,useContext:mi,useEffect:xm,useImperativeHandle:PC,useInsertionEffect:bC,useLayoutEffect:SC,useMemo:IC,useReducer:Fd,useRef:CC,useState:function(){return Fd(Cl)},useDebugValue:Pm,useDeferredValue:function(t){var e=_i();return BC(e,Yt.memoizedState,t)},useTransition:function(){var t=Fd(Cl)[0],e=_i().memoizedState;return[t,e]},useMutableSource:mC,useSyncExternalStore:_C,useId:LC,unstable_isNewReconciler:!1},TB={readContext:mi,useCallback:MC,useContext:mi,useEffect:xm,useImperativeHandle:PC,useInsertionEffect:bC,useLayoutEffect:SC,useMemo:IC,useReducer:Dd,useRef:CC,useState:function(){return Dd(Cl)},useDebugValue:Pm,useDeferredValue:function(t){var e=_i();return Yt===null?e.memoizedState=t:BC(e,Yt.memoizedState,t)},useTransition:function(){var t=Dd(Cl)[0],e=_i().memoizedState;return[t,e]},useMutableSource:mC,useSyncExternalStore:_C,useId:LC,unstable_isNewReconciler:!1};function xa(t,e){try{var n="",i=e;do n+=ZM(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function kd(t,e,n){return{value:t,source:null,stack:n!=null?n:null,digest:e!=null?e:null}}function Ng(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var CB=typeof WeakMap=="function"?WeakMap:Map;function DC(t,e,n){n=vr(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Bh||(Bh=!0,Jg=i),Ng(t,e)},n}function kC(t,e,n){n=vr(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){Ng(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Ng(t,e),typeof i!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Ry(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new CB;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=NB.bind(null,t,e,n),e.then(t,t))}function Oy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Fy(t,e,n,i,r){return(t.mode&1)===0?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=vr(-1,1),e.tag=2,As(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}var bB=Ir.ReactCurrentOwner,On=!1;function Tn(t,e,n,i){e.child=t===null?gC(e,null,n,i):ba(e,t.child,n,i)}function Dy(t,e,n,i,r){n=n.render;var s=e.ref;return ga(e,r),i=bm(t,e,n,i,s,r),n=Sm(),t!==null&&!On?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,br(t,e,r)):(Ct&&n&&fm(e),e.flags|=1,Tn(t,e,i,r),e.child)}function ky(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!Dm(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,NC(t,e,s,i,r)):(t=Ju(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,(t.lanes&r)===0){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:ml,n(o,i)&&t.ref===e.ref)return br(t,e,r)}return e.flags|=1,t=us(s,i),t.ref=e.ref,t.return=e,e.child=t}function NC(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(ml(s,i)&&t.ref===e.ref)if(On=!1,e.pendingProps=i=s,(t.lanes&r)!==0)(t.flags&131072)!==0&&(On=!0);else return e.lanes=t.lanes,br(t,e,r)}return Ug(t,e,n,i,r)}function UC(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if((e.mode&1)===0)e.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(ea,Yn),Yn|=n;else{if((n&1073741824)===0)return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,mt(ea,Yn),Yn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,mt(ea,Yn),Yn|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,mt(ea,Yn),Yn|=i;return Tn(t,e,r,n),e.child}function GC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ug(t,e,n,i,r){var s=Dn(n)?$s:yn.current;return s=Ta(e,s),ga(e,r),n=bm(t,e,n,i,s,r),i=Sm(),t!==null&&!On?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,br(t,e,r)):(Ct&&i&&fm(e),e.flags|=1,Tn(t,e,n,r),e.child)}function Ny(t,e,n,i,r){if(Dn(n)){var s=!0;Eh(e)}else s=!1;if(ga(e,r),e.stateNode===null)Wu(t,e),fC(e,n,i),kg(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,f=n.contextType;typeof f=="object"&&f!==null?f=mi(f):(f=Dn(n)?$s:yn.current,f=Ta(e,f));var p=n.getDerivedStateFromProps,m=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||c!==f)&&My(e,o,i,f),Kr=!1;var v=e.memoizedState;o.state=v,Sh(e,i,o,r),c=e.memoizedState,a!==i||v!==c||Fn.current||Kr?(typeof p=="function"&&(Dg(e,n,p,i),c=e.memoizedState),(a=Kr||Py(e,n,a,i,v,c,f))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),o.props=i,o.state=c,o.context=f,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,uC(t,e),a=e.memoizedProps,f=e.type===e.elementType?a:xi(e.type,a),o.props=f,m=e.pendingProps,v=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=mi(c):(c=Dn(n)?$s:yn.current,c=Ta(e,c));var w=n.getDerivedStateFromProps;(p=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||v!==c)&&My(e,o,i,c),Kr=!1,v=e.memoizedState,o.state=v,Sh(e,i,o,r);var C=e.memoizedState;a!==m||v!==C||Fn.current||Kr?(typeof w=="function"&&(Dg(e,n,w,i),C=e.memoizedState),(f=Kr||Py(e,n,f,i,v,C,c)||!1)?(p||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,C,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,C,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=C),o.props=i,o.state=C,o.context=c,i=f):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),i=!1)}return Gg(t,e,n,i,s,r)}function Gg(t,e,n,i,r,s){GC(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&Ty(e,n,!1),br(t,e,s);i=e.stateNode,bB.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=ba(e,t.child,null,s),e.child=ba(e,null,a,s)):Tn(t,e,a,s),e.memoizedState=i.state,r&&Ty(e,n,!0),e.child}function zC(t){var e=t.stateNode;e.pendingContext?wy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&wy(t,e.context,!1),Em(t,e.containerInfo)}function Uy(t,e,n,i,r){return Ca(),gm(r),e.flags|=256,Tn(t,e,n,i),e.child}var zg={dehydrated:null,treeContext:null,retryLane:0};function Vg(t){return{baseLanes:t,cachePool:null,transitions:null}}function VC(t,e,n){var i=e.pendingProps,r=St.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),mt(St,r&1),t===null)return Og(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?((e.mode&1)===0?e.lanes=1:t.data==="$!"?e.lanes=8:e.lanes=1073741824,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},(i&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=o):s=yf(o,i,0,null),t=Ys(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Vg(n),e.memoizedState=zg,t):Mm(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return SB(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var c={mode:"hidden",children:i.children};return(o&1)===0&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=us(r,c),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=us(a,s):(s=Ys(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?Vg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=zg,i}return s=t.child,t=s.sibling,i=us(s,{mode:"visible",children:i.children}),(e.mode&1)===0&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function Mm(t,e){return e=yf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Kc(t,e,n,i){return i!==null&&gm(i),ba(e,t.child,null,n),t=Mm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function SB(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=kd(Error(le(422))),Kc(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=yf({mode:"visible",children:i.children},r,0,null),s=Ys(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,(e.mode&1)!==0&&ba(e,t.child,null,o),e.child.memoizedState=Vg(o),e.memoizedState=zg,s);if((e.mode&1)===0)return Kc(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(le(419)),i=kd(s,i,void 0),Kc(t,e,o,i)}if(a=(o&t.childLanes)!==0,On||a){if(i=nn,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=(r&(i.suspendedLanes|o))!==0?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Cr(t,r),Di(i,t,r,-1))}return Fm(),i=kd(Error(le(421))),Kc(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=UB.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,Kn=as(r.nextSibling),$n=e,Ct=!0,Mi=null,t!==null&&(ci[ui++]=_r,ci[ui++]=yr,ci[ui++]=eo,_r=t.id,yr=t.overflow,eo=e),e=Mm(e,i.children),e.flags|=4096,e)}function Gy(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),Fg(t.return,e,n)}function Nd(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function HC(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Tn(t,e,i.children,n),i=St.current,(i&2)!==0)i=i&1|2,e.flags|=128;else{if(t!==null&&(t.flags&128)!==0)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Gy(t,n,e);else if(t.tag===19)Gy(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(mt(St,i),(e.mode&1)===0)e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&xh(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Nd(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&xh(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Nd(e,!0,n,null,s);break;case"together":Nd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Wu(t,e){(e.mode&1)===0&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function br(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),no|=e.lanes,(n&e.childLanes)===0)return null;if(t!==null&&e.child!==t.child)throw Error(le(153));if(e.child!==null){for(t=e.child,n=us(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=us(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xB(t,e,n){switch(e.tag){case 3:zC(e),Ca();break;case 5:pC(e);break;case 1:Dn(e.type)&&Eh(e);break;case 4:Em(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;mt(Ch,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(mt(St,St.current&1),e.flags|=128,null):(n&e.child.childLanes)!==0?VC(t,e,n):(mt(St,St.current&1),t=br(t,e,n),t!==null?t.sibling:null);mt(St,St.current&1);break;case 19:if(i=(n&e.childLanes)!==0,(t.flags&128)!==0){if(i)return HC(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),mt(St,St.current),i)break;return null;case 22:case 23:return e.lanes=0,UC(t,e,n)}return br(t,e,n)}var jC,Hg,WC,QC;jC=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Hg=function(){};WC=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Ws(nr.current);var s=null;switch(n){case"input":r=ug(t,r),i=ug(t,i),s=[];break;case"select":r=It({},r,{value:void 0}),i=It({},i,{value:void 0}),s=[];break;case"textarea":r=dg(t,r),i=dg(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=yh)}pg(n,i);var o;n=null;for(f in r)if(!i.hasOwnProperty(f)&&r.hasOwnProperty(f)&&r[f]!=null)if(f==="style"){var a=r[f];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(cl.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in i){var c=i[f];if(a=r!=null?r[f]:void 0,i.hasOwnProperty(f)&&c!==a&&(c!=null||a!=null))if(f==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(s||(s=[]),s.push(f,n)),n=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(cl.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&Et("scroll",t),s||a===c||(s=[])):(s=s||[]).push(f,c))}n&&(s=s||[]).push("style",n);var f=s;(e.updateQueue=f)&&(e.flags|=4)}};QC=function(t,e,n,i){n!==i&&(e.flags|=4)};function vA(t,e){if(!Ct)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function hn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function PB(t,e,n){var i=e.pendingProps;switch(dm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hn(e),null;case 1:return Dn(e.type)&&vh(),hn(e),null;case 3:return i=e.stateNode,Sa(),wt(Fn),wt(yn),Tm(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Jc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&(e.flags&256)===0||(e.flags|=1024,Mi!==null&&(Zg(Mi),Mi=null))),Hg(t,e),hn(e),null;case 5:wm(e);var r=Ws(wl.current);if(n=e.type,t!==null&&e.stateNode!=null)WC(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(le(166));return hn(e),null}if(t=Ws(nr.current),Jc(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[Zi]=e,i[vl]=s,t=(e.mode&1)!==0,n){case"dialog":Et("cancel",i),Et("close",i);break;case"iframe":case"object":case"embed":Et("load",i);break;case"video":case"audio":for(r=0;r<GA.length;r++)Et(GA[r],i);break;case"source":Et("error",i);break;case"img":case"image":case"link":Et("error",i),Et("load",i);break;case"details":Et("toggle",i);break;case"input":Y_(i,s),Et("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Et("invalid",i);break;case"textarea":Z_(i,s),Et("invalid",i)}pg(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Xc(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Xc(i.textContent,a,t),r=["children",""+a]):cl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Et("scroll",i)}switch(n){case"input":Uc(i),K_(i,s,!0);break;case"textarea":Uc(i),q_(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=yh)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=yT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[Zi]=e,t[vl]=i,jC(t,e,!1,!1),e.stateNode=t;e:{switch(o=mg(n,i),n){case"dialog":Et("cancel",t),Et("close",t),r=i;break;case"iframe":case"object":case"embed":Et("load",t),r=i;break;case"video":case"audio":for(r=0;r<GA.length;r++)Et(GA[r],t);r=i;break;case"source":Et("error",t),r=i;break;case"img":case"image":case"link":Et("error",t),Et("load",t),r=i;break;case"details":Et("toggle",t),r=i;break;case"input":Y_(t,i),r=ug(t,i),Et("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=It({},i,{value:void 0}),Et("invalid",t);break;case"textarea":Z_(t,i),r=dg(t,i),Et("invalid",t);break;default:r=i}pg(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?wT(t,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&vT(t,c)):s==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&ul(t,c):typeof c=="number"&&ul(t,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(cl.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Et("scroll",t):c!=null&&$p(t,s,c,o))}switch(n){case"input":Uc(t),K_(t,i,!1);break;case"textarea":Uc(t),q_(t);break;case"option":i.value!=null&&t.setAttribute("value",""+fs(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?ua(t,!!i.multiple,s,!1):i.defaultValue!=null&&ua(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=yh)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hn(e),null;case 6:if(t&&e.stateNode!=null)QC(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(le(166));if(n=Ws(wl.current),Ws(nr.current),Jc(e)){if(i=e.stateNode,n=e.memoizedProps,i[Zi]=e,(s=i.nodeValue!==n)&&(t=$n,t!==null))switch(t.tag){case 3:Xc(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Xc(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Zi]=e,e.stateNode=i}return hn(e),null;case 13:if(wt(St),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ct&&Kn!==null&&(e.mode&1)!==0&&(e.flags&128)===0)lC(),Ca(),e.flags|=98560,s=!1;else if(s=Jc(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(le(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(le(317));s[Zi]=e}else Ca(),(e.flags&128)===0&&(e.memoizedState=null),e.flags|=4;hn(e),s=!1}else Mi!==null&&(Zg(Mi),Mi=null),s=!0;if(!s)return e.flags&65536?e:null}return(e.flags&128)!==0?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,(e.mode&1)!==0&&(t===null||(St.current&1)!==0?Kt===0&&(Kt=3):Fm())),e.updateQueue!==null&&(e.flags|=4),hn(e),null);case 4:return Sa(),Hg(t,e),t===null&&_l(e.stateNode.containerInfo),hn(e),null;case 10:return _m(e.type._context),hn(e),null;case 17:return Dn(e.type)&&vh(),hn(e),null;case 19:if(wt(St),s=e.memoizedState,s===null)return hn(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)vA(s,!1);else{if(Kt!==0||t!==null&&(t.flags&128)!==0)for(t=e.child;t!==null;){if(o=xh(t),o!==null){for(e.flags|=128,vA(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return mt(St,St.current&1|2),e.child}t=t.sibling}s.tail!==null&&Nt()>Pa&&(e.flags|=128,i=!0,vA(s,!1),e.lanes=4194304)}else{if(!i)if(t=xh(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),vA(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ct)return hn(e),null}else 2*Nt()-s.renderingStartTime>Pa&&n!==1073741824&&(e.flags|=128,i=!0,vA(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Nt(),e.sibling=null,n=St.current,mt(St,i?n&1|2:n&1),e):(hn(e),null);case 22:case 23:return Om(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&(e.mode&1)!==0?(Yn&1073741824)!==0&&(hn(e),e.subtreeFlags&6&&(e.flags|=8192)):hn(e),null;case 24:return null;case 25:return null}throw Error(le(156,e.tag))}function MB(t,e){switch(dm(e),e.tag){case 1:return Dn(e.type)&&vh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Sa(),wt(Fn),wt(yn),Tm(),t=e.flags,(t&65536)!==0&&(t&128)===0?(e.flags=t&-65537|128,e):null;case 5:return wm(e),null;case 13:if(wt(St),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(le(340));Ca()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return wt(St),null;case 4:return Sa(),null;case 10:return _m(e.type._context),null;case 22:case 23:return Om(),null;case 24:return null;default:return null}}var Zc=!1,pn=!1,IB=typeof WeakSet=="function"?WeakSet:Set,be=null;function $o(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){Dt(t,e,i)}else n.current=null}function jg(t,e,n){try{n()}catch(i){Dt(t,e,i)}}var zy=!1;function BB(t,e){if(xg=ph,t=KT(),hm(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,f=0,p=0,m=t,v=null;t:for(;;){for(var w;m!==n||r!==0&&m.nodeType!==3||(a=o+r),m!==s||i!==0&&m.nodeType!==3||(c=o+i),m.nodeType===3&&(o+=m.nodeValue.length),(w=m.firstChild)!==null;)v=m,m=w;for(;;){if(m===t)break t;if(v===n&&++f===r&&(a=o),v===s&&++p===i&&(c=o),(w=m.nextSibling)!==null)break;m=v,v=m.parentNode}m=w}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Pg={focusedElem:t,selectionRange:n},ph=!1,be=e;be!==null;)if(e=be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,be=t;else for(;be!==null;){e=be;try{var C=e.alternate;if((e.flags&1024)!==0)switch(e.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var S=C.memoizedProps,R=C.memoizedState,x=e.stateNode,P=x.getSnapshotBeforeUpdate(e.elementType===e.type?S:xi(e.type,S),R);x.__reactInternalSnapshotBeforeUpdate=P}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(le(163))}}catch(F){Dt(e,e.return,F)}if(t=e.sibling,t!==null){t.return=e.return,be=t;break}be=e.return}return C=zy,zy=!1,C}function $A(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&jg(e,n,s)}r=r.next}while(r!==i)}}function mf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function Wg(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function XC(t){var e=t.alternate;e!==null&&(t.alternate=null,XC(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Zi],delete e[vl],delete e[Bg],delete e[fB],delete e[dB])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function JC(t){return t.tag===5||t.tag===3||t.tag===4}function Vy(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||JC(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Qg(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=yh));else if(i!==4&&(t=t.child,t!==null))for(Qg(t,e,n),t=t.sibling;t!==null;)Qg(t,e,n),t=t.sibling}function Xg(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(Xg(t,e,n),t=t.sibling;t!==null;)Xg(t,e,n),t=t.sibling}var on=null,Pi=!1;function zr(t,e,n){for(n=n.child;n!==null;)YC(t,e,n),n=n.sibling}function YC(t,e,n){if(tr&&typeof tr.onCommitFiberUnmount=="function")try{tr.onCommitFiberUnmount(lf,n)}catch{}switch(n.tag){case 5:pn||$o(n,e);case 6:var i=on,r=Pi;on=null,zr(t,e,n),on=i,Pi=r,on!==null&&(Pi?(t=on,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):on.removeChild(n.stateNode));break;case 18:on!==null&&(Pi?(t=on,n=n.stateNode,t.nodeType===8?Bd(t.parentNode,n):t.nodeType===1&&Bd(t,n),gl(t)):Bd(on,n.stateNode));break;case 4:i=on,r=Pi,on=n.stateNode.containerInfo,Pi=!0,zr(t,e,n),on=i,Pi=r;break;case 0:case 11:case 14:case 15:if(!pn&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&((s&2)!==0||(s&4)!==0)&&jg(n,e,o),r=r.next}while(r!==i)}zr(t,e,n);break;case 1:if(!pn&&($o(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){Dt(n,e,a)}zr(t,e,n);break;case 21:zr(t,e,n);break;case 22:n.mode&1?(pn=(i=pn)||n.memoizedState!==null,zr(t,e,n),pn=i):zr(t,e,n);break;default:zr(t,e,n)}}function Hy(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new IB),e.forEach(function(i){var r=GB.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function bi(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:on=a.stateNode,Pi=!1;break e;case 3:on=a.stateNode.containerInfo,Pi=!0;break e;case 4:on=a.stateNode.containerInfo,Pi=!0;break e}a=a.return}if(on===null)throw Error(le(160));YC(s,o,r),on=null,Pi=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(f){Dt(r,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)KC(e,t),e=e.sibling}function KC(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(bi(e,t),ji(t),i&4){try{$A(3,t,t.return),mf(3,t)}catch(S){Dt(t,t.return,S)}try{$A(5,t,t.return)}catch(S){Dt(t,t.return,S)}}break;case 1:bi(e,t),ji(t),i&512&&n!==null&&$o(n,n.return);break;case 5:if(bi(e,t),ji(t),i&512&&n!==null&&$o(n,n.return),t.flags&32){var r=t.stateNode;try{ul(r,"")}catch(S){Dt(t,t.return,S)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&mT(r,s),mg(a,o);var f=mg(a,s);for(o=0;o<c.length;o+=2){var p=c[o],m=c[o+1];p==="style"?wT(r,m):p==="dangerouslySetInnerHTML"?vT(r,m):p==="children"?ul(r,m):$p(r,p,m,f)}switch(a){case"input":hg(r,s);break;case"textarea":_T(r,s);break;case"select":var v=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?ua(r,!!s.multiple,w,!1):v!==!!s.multiple&&(s.defaultValue!=null?ua(r,!!s.multiple,s.defaultValue,!0):ua(r,!!s.multiple,s.multiple?[]:"",!1))}r[vl]=s}catch(S){Dt(t,t.return,S)}}break;case 6:if(bi(e,t),ji(t),i&4){if(t.stateNode===null)throw Error(le(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(S){Dt(t,t.return,S)}}break;case 3:if(bi(e,t),ji(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{gl(e.containerInfo)}catch(S){Dt(t,t.return,S)}break;case 4:bi(e,t),ji(t);break;case 13:bi(e,t),ji(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(Lm=Nt())),i&4&&Hy(t);break;case 22:if(p=n!==null&&n.memoizedState!==null,t.mode&1?(pn=(f=pn)||p,bi(e,t),pn=f):bi(e,t),ji(t),i&8192){if(f=t.memoizedState!==null,(t.stateNode.isHidden=f)&&!p&&(t.mode&1)!==0)for(be=t,p=t.child;p!==null;){for(m=be=p;be!==null;){switch(v=be,w=v.child,v.tag){case 0:case 11:case 14:case 15:$A(4,v,v.return);break;case 1:$o(v,v.return);var C=v.stateNode;if(typeof C.componentWillUnmount=="function"){i=v,n=v.return;try{e=i,C.props=e.memoizedProps,C.state=e.memoizedState,C.componentWillUnmount()}catch(S){Dt(i,n,S)}}break;case 5:$o(v,v.return);break;case 22:if(v.memoizedState!==null){Wy(m);continue}}w!==null?(w.return=v,be=w):Wy(m)}p=p.sibling}e:for(p=null,m=t;;){if(m.tag===5){if(p===null){p=m;try{r=m.stateNode,f?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=ET("display",o))}catch(S){Dt(t,t.return,S)}}}else if(m.tag===6){if(p===null)try{m.stateNode.nodeValue=f?"":m.memoizedProps}catch(S){Dt(t,t.return,S)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;p===m&&(p=null),m=m.return}p===m&&(p=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:bi(e,t),ji(t),i&4&&Hy(t);break;case 21:break;default:bi(e,t),ji(t)}}function ji(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(JC(n)){var i=n;break e}n=n.return}throw Error(le(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(ul(r,""),i.flags&=-33);var s=Vy(t);Xg(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=Vy(t);Qg(t,a,o);break;default:throw Error(le(161))}}catch(c){Dt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function LB(t,e,n){be=t,ZC(t)}function ZC(t,e,n){for(var i=(t.mode&1)!==0;be!==null;){var r=be,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Zc;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||pn;a=Zc;var f=pn;if(Zc=o,(pn=c)&&!f)for(be=r;be!==null;)o=be,c=o.child,o.tag===22&&o.memoizedState!==null?Qy(r):c!==null?(c.return=o,be=c):Qy(r);for(;s!==null;)be=s,ZC(s),s=s.sibling;be=r,Zc=a,pn=f}jy(t)}else(r.subtreeFlags&8772)!==0&&s!==null?(s.return=r,be=s):jy(t)}}function jy(t){for(;be!==null;){var e=be;if((e.flags&8772)!==0){var n=e.alternate;try{if((e.flags&8772)!==0)switch(e.tag){case 0:case 11:case 15:pn||mf(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!pn)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:xi(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&xy(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}xy(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var p=f.memoizedState;if(p!==null){var m=p.dehydrated;m!==null&&gl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(le(163))}pn||e.flags&512&&Wg(e)}catch(v){Dt(e,e.return,v)}}if(e===t){be=null;break}if(n=e.sibling,n!==null){n.return=e.return,be=n;break}be=e.return}}function Wy(t){for(;be!==null;){var e=be;if(e===t){be=null;break}var n=e.sibling;if(n!==null){n.return=e.return,be=n;break}be=e.return}}function Qy(t){for(;be!==null;){var e=be;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{mf(4,e)}catch(c){Dt(e,n,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(c){Dt(e,r,c)}}var s=e.return;try{Wg(e)}catch(c){Dt(e,s,c)}break;case 5:var o=e.return;try{Wg(e)}catch(c){Dt(e,o,c)}}}catch(c){Dt(e,e.return,c)}if(e===t){be=null;break}var a=e.sibling;if(a!==null){a.return=e.return,be=a;break}be=e.return}}var RB=Math.ceil,Ih=Ir.ReactCurrentDispatcher,Im=Ir.ReactCurrentOwner,di=Ir.ReactCurrentBatchConfig,rt=0,nn=null,Vt=null,an=0,Yn=0,ea=vs(0),Kt=0,Sl=null,no=0,_f=0,Bm=0,el=null,Ln=null,Lm=0,Pa=1/0,gr=null,Bh=!1,Jg=null,ls=null,qc=!1,ts=null,Lh=0,tl=0,Yg=null,Qu=-1,Xu=0;function bn(){return(rt&6)!==0?Nt():Qu!==-1?Qu:Qu=Nt()}function cs(t){return(t.mode&1)===0?1:(rt&2)!==0&&an!==0?an&-an:pB.transition!==null?(Xu===0&&(Xu=OT()),Xu):(t=ut,t!==0||(t=window.event,t=t===void 0?16:zT(t.type)),t)}function Di(t,e,n,i){if(50<tl)throw tl=0,Yg=null,Error(le(185));Ql(t,n,i),((rt&2)===0||t!==nn)&&(t===nn&&((rt&2)===0&&(_f|=n),Kt===4&&qr(t,an)),kn(t,i),n===1&&rt===0&&(e.mode&1)===0&&(Pa=Nt()+500,df&&Es()))}function kn(t,e){var n=t.callbackNode;pI(t,e);var i=gh(t,t===nn?an:0);if(i===0)n!==null&&ty(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&ty(n),e===1)t.tag===0?gB(Xy.bind(null,t)):oC(Xy.bind(null,t)),uB(function(){(rt&6)===0&&Es()}),n=null;else{switch(FT(i)){case 1:n=rm;break;case 4:n=LT;break;case 16:n=dh;break;case 536870912:n=RT;break;default:n=dh}n=sb(n,qC.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function qC(t,e){if(Qu=-1,Xu=0,(rt&6)!==0)throw Error(le(327));var n=t.callbackNode;if(pa()&&t.callbackNode!==n)return null;var i=gh(t,t===nn?an:0);if(i===0)return null;if((i&30)!==0||(i&t.expiredLanes)!==0||e)e=Rh(t,i);else{e=i;var r=rt;rt|=2;var s=eb();(nn!==t||an!==e)&&(gr=null,Pa=Nt()+500,Js(t,e));do try{DB();break}catch(a){$C(t,a)}while(1);mm(),Ih.current=s,rt=r,Vt!==null?e=0:(nn=null,an=0,e=Kt)}if(e!==0){if(e===2&&(r=wg(t),r!==0&&(i=r,e=Kg(t,r))),e===1)throw n=Sl,Js(t,0),qr(t,i),kn(t,Nt()),n;if(e===6)qr(t,i);else{if(r=t.current.alternate,(i&30)===0&&!OB(r)&&(e=Rh(t,i),e===2&&(s=wg(t),s!==0&&(i=s,e=Kg(t,s))),e===1))throw n=Sl,Js(t,0),qr(t,i),kn(t,Nt()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(le(345));case 2:zs(t,Ln,gr);break;case 3:if(qr(t,i),(i&130023424)===i&&(e=Lm+500-Nt(),10<e)){if(gh(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){bn(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=Ig(zs.bind(null,t,Ln,gr),e);break}zs(t,Ln,gr);break;case 4:if(qr(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Fi(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Nt()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*RB(i/1960))-i,10<i){t.timeoutHandle=Ig(zs.bind(null,t,Ln,gr),i);break}zs(t,Ln,gr);break;case 5:zs(t,Ln,gr);break;default:throw Error(le(329))}}}return kn(t,Nt()),t.callbackNode===n?qC.bind(null,t):null}function Kg(t,e){var n=el;return t.current.memoizedState.isDehydrated&&(Js(t,e).flags|=256),t=Rh(t,e),t!==2&&(e=Ln,Ln=n,e!==null&&Zg(e)),t}function Zg(t){Ln===null?Ln=t:Ln.push.apply(Ln,t)}function OB(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Ni(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function qr(t,e){for(e&=~Bm,e&=~_f,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Fi(e),i=1<<n;t[n]=-1,e&=~i}}function Xy(t){if((rt&6)!==0)throw Error(le(327));pa();var e=gh(t,0);if((e&1)===0)return kn(t,Nt()),null;var n=Rh(t,e);if(t.tag!==0&&n===2){var i=wg(t);i!==0&&(e=i,n=Kg(t,i))}if(n===1)throw n=Sl,Js(t,0),qr(t,e),kn(t,Nt()),n;if(n===6)throw Error(le(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,zs(t,Ln,gr),kn(t,Nt()),null}function Rm(t,e){var n=rt;rt|=1;try{return t(e)}finally{rt=n,rt===0&&(Pa=Nt()+500,df&&Es())}}function io(t){ts!==null&&ts.tag===0&&(rt&6)===0&&pa();var e=rt;rt|=1;var n=di.transition,i=ut;try{if(di.transition=null,ut=1,t)return t()}finally{ut=i,di.transition=n,rt=e,(rt&6)===0&&Es()}}function Om(){Yn=ea.current,wt(ea)}function Js(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,cB(n)),Vt!==null)for(n=Vt.return;n!==null;){var i=n;switch(dm(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&vh();break;case 3:Sa(),wt(Fn),wt(yn),Tm();break;case 5:wm(i);break;case 4:Sa();break;case 13:wt(St);break;case 19:wt(St);break;case 10:_m(i.type._context);break;case 22:case 23:Om()}n=n.return}if(nn=t,Vt=t=us(t.current,null),an=Yn=e,Kt=0,Sl=null,Bm=_f=no=0,Ln=el=null,js!==null){for(e=0;e<js.length;e++)if(n=js[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}js=null}return t}function $C(t,e){do{var n=Vt;try{if(mm(),Hu.current=Mh,Ph){for(var i=Mt.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Ph=!1}if(to=0,en=Yt=Mt=null,qA=!1,Tl=0,Im.current=null,n===null||n.return===null){Kt=1,Sl=e,Vt=null;break}e:{var s=t,o=n.return,a=n,c=e;if(e=an,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,p=a,m=p.tag;if((p.mode&1)===0&&(m===0||m===11||m===15)){var v=p.alternate;v?(p.updateQueue=v.updateQueue,p.memoizedState=v.memoizedState,p.lanes=v.lanes):(p.updateQueue=null,p.memoizedState=null)}var w=Oy(o);if(w!==null){w.flags&=-257,Fy(w,o,a,s,e),w.mode&1&&Ry(s,f,e),e=w,c=f;var C=e.updateQueue;if(C===null){var S=new Set;S.add(c),e.updateQueue=S}else C.add(c);break e}else{if((e&1)===0){Ry(s,f,e),Fm();break e}c=Error(le(426))}}else if(Ct&&a.mode&1){var R=Oy(o);if(R!==null){(R.flags&65536)===0&&(R.flags|=256),Fy(R,o,a,s,e),gm(xa(c,a));break e}}s=c=xa(c,a),Kt!==4&&(Kt=2),el===null?el=[s]:el.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var x=DC(s,c,e);Sy(s,x);break e;case 1:a=c;var P=s.type,I=s.stateNode;if((s.flags&128)===0&&(typeof P.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(ls===null||!ls.has(I)))){s.flags|=65536,e&=-e,s.lanes|=e;var F=kC(s,a,e);Sy(s,F);break e}}s=s.return}while(s!==null)}nb(n)}catch(H){e=H,Vt===n&&n!==null&&(Vt=n=n.return);continue}break}while(1)}function eb(){var t=Ih.current;return Ih.current=Mh,t===null?Mh:t}function Fm(){(Kt===0||Kt===3||Kt===2)&&(Kt=4),nn===null||(no&268435455)===0&&(_f&268435455)===0||qr(nn,an)}function Rh(t,e){var n=rt;rt|=2;var i=eb();(nn!==t||an!==e)&&(gr=null,Js(t,e));do try{FB();break}catch(r){$C(t,r)}while(1);if(mm(),rt=n,Ih.current=i,Vt!==null)throw Error(le(261));return nn=null,an=0,Kt}function FB(){for(;Vt!==null;)tb(Vt)}function DB(){for(;Vt!==null&&!aI();)tb(Vt)}function tb(t){var e=rb(t.alternate,t,Yn);t.memoizedProps=t.pendingProps,e===null?nb(t):Vt=e,Im.current=null}function nb(t){var e=t;do{var n=e.alternate;if(t=e.return,(e.flags&32768)===0){if(n=PB(n,e,Yn),n!==null){Vt=n;return}}else{if(n=MB(n,e),n!==null){n.flags&=32767,Vt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kt=6,Vt=null;return}}if(e=e.sibling,e!==null){Vt=e;return}Vt=e=t}while(e!==null);Kt===0&&(Kt=5)}function zs(t,e,n){var i=ut,r=di.transition;try{di.transition=null,ut=1,kB(t,e,n,i)}finally{di.transition=r,ut=i}return null}function kB(t,e,n,i){do pa();while(ts!==null);if((rt&6)!==0)throw Error(le(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(le(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(mI(t,s),t===nn&&(Vt=nn=null,an=0),(n.subtreeFlags&2064)===0&&(n.flags&2064)===0||qc||(qc=!0,sb(dh,function(){return pa(),null})),s=(n.flags&15990)!==0,(n.subtreeFlags&15990)!==0||s){s=di.transition,di.transition=null;var o=ut;ut=1;var a=rt;rt|=4,Im.current=null,BB(t,n),KC(n,t),iB(Pg),ph=!!xg,Pg=xg=null,t.current=n,LB(n),AI(),rt=a,ut=o,di.transition=s}else t.current=n;if(qc&&(qc=!1,ts=t,Lh=r),s=t.pendingLanes,s===0&&(ls=null),uI(n.stateNode),kn(t,Nt()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(Bh)throw Bh=!1,t=Jg,Jg=null,t;return(Lh&1)!==0&&t.tag!==0&&pa(),s=t.pendingLanes,(s&1)!==0?t===Yg?tl++:(tl=0,Yg=t):tl=0,Es(),null}function pa(){if(ts!==null){var t=FT(Lh),e=di.transition,n=ut;try{if(di.transition=null,ut=16>t?16:t,ts===null)var i=!1;else{if(t=ts,ts=null,Lh=0,(rt&6)!==0)throw Error(le(331));var r=rt;for(rt|=4,be=t.current;be!==null;){var s=be,o=s.child;if((be.flags&16)!==0){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var f=a[c];for(be=f;be!==null;){var p=be;switch(p.tag){case 0:case 11:case 15:$A(8,p,s)}var m=p.child;if(m!==null)m.return=p,be=m;else for(;be!==null;){p=be;var v=p.sibling,w=p.return;if(XC(p),p===f){be=null;break}if(v!==null){v.return=w,be=v;break}be=w}}}var C=s.alternate;if(C!==null){var S=C.child;if(S!==null){C.child=null;do{var R=S.sibling;S.sibling=null,S=R}while(S!==null)}}be=s}}if((s.subtreeFlags&2064)!==0&&o!==null)o.return=s,be=o;else e:for(;be!==null;){if(s=be,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:$A(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,be=x;break e}be=s.return}}var P=t.current;for(be=P;be!==null;){o=be;var I=o.child;if((o.subtreeFlags&2064)!==0&&I!==null)I.return=o,be=I;else e:for(o=P;be!==null;){if(a=be,(a.flags&2048)!==0)try{switch(a.tag){case 0:case 11:case 15:mf(9,a)}}catch(H){Dt(a,a.return,H)}if(a===o){be=null;break e}var F=a.sibling;if(F!==null){F.return=a.return,be=F;break e}be=a.return}}if(rt=r,Es(),tr&&typeof tr.onPostCommitFiberRoot=="function")try{tr.onPostCommitFiberRoot(lf,t)}catch{}i=!0}return i}finally{ut=n,di.transition=e}}return!1}function Jy(t,e,n){e=xa(n,e),e=DC(t,e,1),t=As(t,e,1),e=bn(),t!==null&&(Ql(t,1,e),kn(t,e))}function Dt(t,e,n){if(t.tag===3)Jy(t,t,n);else for(;e!==null;){if(e.tag===3){Jy(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ls===null||!ls.has(i))){t=xa(n,t),t=kC(e,t,1),e=As(e,t,1),t=bn(),e!==null&&(Ql(e,1,t),kn(e,t));break}}e=e.return}}function NB(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=bn(),t.pingedLanes|=t.suspendedLanes&n,nn===t&&(an&n)===n&&(Kt===4||Kt===3&&(an&130023424)===an&&500>Nt()-Lm?Js(t,0):Bm|=n),kn(t,e)}function ib(t,e){e===0&&((t.mode&1)===0?e=1:(e=Vc,Vc<<=1,(Vc&130023424)===0&&(Vc=4194304)));var n=bn();t=Cr(t,e),t!==null&&(Ql(t,e,n),kn(t,n))}function UB(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),ib(t,n)}function GB(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(le(314))}i!==null&&i.delete(e),ib(t,n)}var rb;rb=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Fn.current)On=!0;else{if((t.lanes&n)===0&&(e.flags&128)===0)return On=!1,xB(t,e,n);On=(t.flags&131072)!==0}else On=!1,Ct&&(e.flags&1048576)!==0&&aC(e,Th,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Wu(t,e),t=e.pendingProps;var r=Ta(e,yn.current);ga(e,n),r=bm(null,e,i,t,r,n);var s=Sm();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Dn(i)?(s=!0,Eh(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,vm(e),r.updater=gf,e.stateNode=r,r._reactInternals=e,kg(e,i,t,n),e=Gg(null,e,i,!0,s,n)):(e.tag=0,Ct&&s&&fm(e),Tn(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Wu(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=VB(i),t=xi(i,t),r){case 0:e=Ug(null,e,i,t,n);break e;case 1:e=Ny(null,e,i,t,n);break e;case 11:e=Dy(null,e,i,t,n);break e;case 14:e=ky(null,e,i,xi(i.type,t),n);break e}throw Error(le(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xi(i,r),Ug(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xi(i,r),Ny(t,e,i,r,n);case 3:e:{if(zC(e),t===null)throw Error(le(387));i=e.pendingProps,s=e.memoizedState,r=s.element,uC(t,e),Sh(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=xa(Error(le(423)),e),e=Uy(t,e,i,n,r);break e}else if(i!==r){r=xa(Error(le(424)),e),e=Uy(t,e,i,n,r);break e}else for(Kn=as(e.stateNode.containerInfo.firstChild),$n=e,Ct=!0,Mi=null,n=gC(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ca(),i===r){e=br(t,e,n);break e}Tn(t,e,i,n)}e=e.child}return e;case 5:return pC(e),t===null&&Og(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,Mg(i,r)?o=null:s!==null&&Mg(i,s)&&(e.flags|=32),GC(t,e),Tn(t,e,o,n),e.child;case 6:return t===null&&Og(e),null;case 13:return VC(t,e,n);case 4:return Em(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=ba(e,null,i,n):Tn(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xi(i,r),Dy(t,e,i,r,n);case 7:return Tn(t,e,e.pendingProps,n),e.child;case 8:return Tn(t,e,e.pendingProps.children,n),e.child;case 12:return Tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,mt(Ch,i._currentValue),i._currentValue=o,s!==null)if(Ni(s.value,o)){if(s.children===r.children&&!Fn.current){e=br(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(s.tag===1){c=vr(-1,n&-n),c.tag=2;var f=s.updateQueue;if(f!==null){f=f.shared;var p=f.pending;p===null?c.next=c:(c.next=p.next,p.next=c),f.pending=c}}s.lanes|=n,c=s.alternate,c!==null&&(c.lanes|=n),Fg(s.return,n,e),a.lanes|=n;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(le(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Fg(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Tn(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,ga(e,n),r=mi(r),i=i(r),e.flags|=1,Tn(t,e,i,n),e.child;case 14:return i=e.type,r=xi(i,e.pendingProps),r=xi(i.type,r),ky(t,e,i,r,n);case 15:return NC(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xi(i,r),Wu(t,e),e.tag=1,Dn(i)?(t=!0,Eh(e)):t=!1,ga(e,n),fC(e,i,r),kg(e,i,r,n),Gg(null,e,i,!0,t,n);case 19:return HC(t,e,n);case 22:return UC(t,e,n)}throw Error(le(156,e.tag))};function sb(t,e){return BT(t,e)}function zB(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(t,e,n,i){return new zB(t,e,n,i)}function Dm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function VB(t){if(typeof t=="function")return Dm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===tm)return 11;if(t===nm)return 14}return 2}function us(t,e){var n=t.alternate;return n===null?(n=fi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ju(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")Dm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case jo:return Ys(n.children,r,s,e);case em:o=8,r|=8;break;case ag:return t=fi(12,n,e,r|2),t.elementType=ag,t.lanes=s,t;case Ag:return t=fi(13,n,e,r),t.elementType=Ag,t.lanes=s,t;case lg:return t=fi(19,n,e,r),t.elementType=lg,t.lanes=s,t;case dT:return yf(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hT:o=10;break e;case fT:o=9;break e;case tm:o=11;break e;case nm:o=14;break e;case Yr:o=16,i=null;break e}throw Error(le(130,t==null?t:typeof t,""))}return e=fi(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function Ys(t,e,n,i){return t=fi(7,t,i,e),t.lanes=n,t}function yf(t,e,n,i){return t=fi(22,t,i,e),t.elementType=dT,t.lanes=n,t.stateNode={isHidden:!1},t}function Ud(t,e,n){return t=fi(6,t,null,e),t.lanes=n,t}function Gd(t,e,n){return e=fi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function HB(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vd(0),this.expirationTimes=vd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vd(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function km(t,e,n,i,r,s,o,a,c){return t=new HB(t,e,n,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=fi(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vm(s),t}function jB(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ho,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function ob(t){if(!t)return ds;t=t._reactInternals;e:{if(co(t)!==t||t.tag!==1)throw Error(le(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Dn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(le(171))}if(t.tag===1){var n=t.type;if(Dn(n))return sC(t,n,e)}return e}function ab(t,e,n,i,r,s,o,a,c){return t=km(n,i,!0,t,r,s,o,a,c),t.context=ob(null),n=t.current,i=bn(),r=cs(n),s=vr(i,r),s.callback=e!=null?e:null,As(n,s,r),t.current.lanes=r,Ql(t,r,i),kn(t,i),t}function vf(t,e,n,i){var r=e.current,s=bn(),o=cs(r);return n=ob(n),e.context===null?e.context=n:e.pendingContext=n,e=vr(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=As(r,e,o),t!==null&&(Di(t,r,o,s),Vu(t,r,o)),o}function Oh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Yy(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Nm(t,e){Yy(t,e),(t=t.alternate)&&Yy(t,e)}function WB(){return null}var Ab=typeof reportError=="function"?reportError:function(t){console.error(t)};function Um(t){this._internalRoot=t}Ef.prototype.render=Um.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(le(409));vf(t,e,null,null)};Ef.prototype.unmount=Um.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;io(function(){vf(null,t,null,null)}),e[Tr]=null}};function Ef(t){this._internalRoot=t}Ef.prototype.unstable_scheduleHydration=function(t){if(t){var e=NT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Zr.length&&e!==0&&e<Zr[n].priority;n++);Zr.splice(n,0,t),n===0&&GT(t)}};function Gm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function wf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Ky(){}function QB(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var f=Oh(o);s.call(f)}}var o=ab(e,i,t,0,null,!1,!1,"",Ky);return t._reactRootContainer=o,t[Tr]=o.current,_l(t.nodeType===8?t.parentNode:t),io(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var f=Oh(c);a.call(f)}}var c=km(t,0,!1,null,null,!1,!1,"",Ky);return t._reactRootContainer=c,t[Tr]=c.current,_l(t.nodeType===8?t.parentNode:t),io(function(){vf(e,c,n,i)}),c}function Tf(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var c=Oh(o);a.call(c)}}vf(e,o,t,r)}else o=QB(n,e,t,r,i);return Oh(o)}DT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=UA(e.pendingLanes);n!==0&&(sm(e,n|1),kn(e,Nt()),(rt&6)===0&&(Pa=Nt()+500,Es()))}break;case 13:io(function(){var i=Cr(t,1);if(i!==null){var r=bn();Di(i,t,1,r)}}),Nm(t,1)}};om=function(t){if(t.tag===13){var e=Cr(t,134217728);if(e!==null){var n=bn();Di(e,t,134217728,n)}Nm(t,134217728)}};kT=function(t){if(t.tag===13){var e=cs(t),n=Cr(t,e);if(n!==null){var i=bn();Di(n,t,e,i)}Nm(t,e)}};NT=function(){return ut};UT=function(t,e){var n=ut;try{return ut=t,e()}finally{ut=n}};yg=function(t,e,n){switch(e){case"input":if(hg(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=ff(i);if(!r)throw Error(le(90));pT(i),hg(i,r)}}}break;case"textarea":_T(t,n);break;case"select":e=n.value,e!=null&&ua(t,!!n.multiple,e,!1)}};bT=Rm;ST=io;var XB={usingClientEntryPoint:!1,Events:[Jl,Jo,ff,TT,CT,Rm]},EA={findFiberByHostInstance:Hs,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},JB={bundleType:EA.bundleType,version:EA.version,rendererPackageName:EA.rendererPackageName,rendererConfig:EA.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ir.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=MT(t),t===null?null:t.stateNode},findFiberByHostInstance:EA.findFiberByHostInstance||WB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $c=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$c.isDisabled&&$c.supportsFiber)try{lf=$c.inject(JB),tr=$c}catch{}}ni.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XB;ni.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Gm(e))throw Error(le(200));return jB(t,e,null,n)};ni.createRoot=function(t,e){if(!Gm(t))throw Error(le(299));var n=!1,i="",r=Ab;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=km(t,1,!1,null,null,n,!1,i,r),t[Tr]=e.current,_l(t.nodeType===8?t.parentNode:t),new Um(e)};ni.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(le(188)):(t=Object.keys(t).join(","),Error(le(268,t)));return t=MT(e),t=t===null?null:t.stateNode,t};ni.flushSync=function(t){return io(t)};ni.hydrate=function(t,e,n){if(!wf(e))throw Error(le(200));return Tf(null,t,e,!0,n)};ni.hydrateRoot=function(t,e,n){if(!Gm(t))throw Error(le(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=Ab;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=ab(e,null,t,1,n!=null?n:null,r,!1,s,o),t[Tr]=e.current,_l(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Ef(e)};ni.render=function(t,e,n){if(!wf(e))throw Error(le(200));return Tf(null,t,e,!1,n)};ni.unmountComponentAtNode=function(t){if(!wf(t))throw Error(le(40));return t._reactRootContainer?(io(function(){Tf(null,null,t,!1,function(){t._reactRootContainer=null,t[Tr]=null})}),!0):!1};ni.unstable_batchedUpdates=Rm;ni.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!wf(n))throw Error(le(200));if(t==null||t._reactInternals===void 0)throw Error(le(38));return Tf(t,e,n,!1,i)};ni.version="18.2.0-next-9e3b772b8-20220608";(function(t){function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(n){console.error(n)}}e(),t.exports=ni})(Af);var Zy=Af.exports;sg.createRoot=Zy.createRoot,sg.hydrateRoot=Zy.hydrateRoot;const YB="modulepreload",KB=function(t,e){return new URL(t,e).href},qy={},ZB=function(e,n,i){return!n||n.length===0?e():Promise.all(n.map(r=>{if(r=KB(r,i),r in qy)return;qy[r]=!0;const s=r.endsWith(".css"),o=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${o}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":YB,s||(a.as="script",a.crossOrigin=""),a.href=r,document.head.appendChild(a),s)return new Promise((c,f)=>{a.addEventListener("load",c),a.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${r}`)))})})).then(()=>e())};var Cf={exports:{}},bf={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qB=Te.exports,$B=Symbol.for("react.element"),eL=Symbol.for("react.fragment"),tL=Object.prototype.hasOwnProperty,nL=qB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iL={key:!0,ref:!0,__self:!0,__source:!0};function lb(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)tL.call(e,i)&&!iL.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:$B,type:t,key:s,ref:o,props:r,_owner:nL.current}}bf.Fragment=eL;bf.jsx=lb;bf.jsxs=lb;(function(t){t.exports=bf})(Cf);const rL=Cf.exports.Fragment,Ks=Cf.exports.jsx,sL=Cf.exports.jsxs,oL=Te.exports.createContext(null);function aL(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function $y(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function ev(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const r=t.center;t.center=new r.constructor(n.longitude,n.latitude),i=i||r!==t.center}if("zoom"in n){const r=t.zoom;t.zoom=n.zoom,i=i||r!==t.zoom}if("bearing"in n){const r=t.bearing;t.bearing=n.bearing,i=i||r!==t.bearing}if("pitch"in n){const r=t.pitch;t.pitch=n.pitch,i=i||r!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const AL=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function tv(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const i of t.layers)e[i.id]=i;const n=t.layers.map(i=>{const r=e[i.ref];let s=null;if("interactive"in i&&(s={...i},delete s.interactive),r){s=s||{...i},delete s.ref;for(const o of AL)o in r&&(s[o]=r[o])}return s||i});return{...t,layers:n}}function lL(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,s=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===s}function $r(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!$r(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const r of n)if(!e.hasOwnProperty(r)||!$r(t[r],e[r]))return!1;return!0}return!1}const nv={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},zd={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},iv={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},cL=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],uL=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Ma{constructor(e,n,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const s=this.props[iv[r.type]];s&&s(r)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const s=this.props[nv[r.type]];if(s){if(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"){const o=this._hoveredFeatures||this._map.queryRenderedFeatures(r.point,{layers:this.props.interactiveLayerIds});r.features=o}s(r),delete r.features}},this._onCameraEvent=r=>{if(!this._internalUpdate){const s=this.props[zd[r.type]];s&&s(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=e,this.props=n,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const i=this._updateSettings(e,n);i&&this._createShadowTransform(this._map);const r=this._updateSize(e),s=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(i||r||s&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const i=Ma.savedMaps.pop();if(!i)return null;const r=i.map,s=r.getContainer();for(n.className=s.className;s.childNodes.length>0;)n.appendChild(s.childNodes[0]);r._container=n,i.setProps({...e,styleDiffing:!1}),r.resize();const{initialViewState:o}=e;return o&&(o.bounds?r.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):i._updateViewState(o,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),i}_initialize(e){const{props:n}=this,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||hL()||null,container:e,style:tv(n.mapStyle)},r=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[r.longitude||0,r.latitude||0],zoom:r.zoom||0,pitch:r.pitch||0,bearing:r.bearing||0}),n.gl){const f=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=f,n.gl)}const s=new this._MapClass(i);r.padding&&s.setPadding(r.padding),n.cursor&&(s.getCanvas().style.cursor=n.cursor),this._createShadowTransform(s);const o=s._render;s._render=f=>{this._inRender=!0,o.call(s,f),this._inRender=!1};const a=s._renderTaskQueue.run;s._renderTaskQueue.run=f=>{a.call(s._renderTaskQueue,f),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const c=s.fire;s.fire=this._fireEvent.bind(this,c),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>this._updateStyleComponents(this.props,{})),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const f in nv)s.on(f,this._onPointerEvent);for(const f in zd)s.on(f,this._onCameraEvent);for(const f in iv)s.on(f,this._onEvent);this._map=s}recycle(){Ma.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=aL(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const i=this._map;if(n.width!==i.transform.width||n.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const i=this._map,r=this._renderTransform,{zoom:s,pitch:o,bearing:a}=r,c=i.isMoving();c&&(r.cameraElevationReference="sea");const f=ev(r,{...$y(i.transform),...e});if(c&&(r.cameraElevationReference="ground"),f&&n){const p=this._deferredEvents;p.move=!0,p.zoom||(p.zoom=s!==r.zoom),p.rotate||(p.rotate=a!==r.bearing),p.pitch||(p.pitch=o!==r.pitch)}return c||ev(i.transform,e),f}_updateSettings(e,n){const i=this._map;let r=!1;for(const s of cL)s in e&&!$r(e[s],n[s])&&(r=!0,i[`set${s[0].toUpperCase()}${s.slice(1)}`](e[s]));return r}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==n.mapStyle){const i={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(i.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(tv(e.mapStyle),i),!0}return!1}_updateStyleComponents(e,n){const i=this._map;let r=!1;return i.style.loaded()&&("light"in e&&!$r(e.light,n.light)&&(r=!0,i.setLight(e.light)),"fog"in e&&!$r(e.fog,n.fog)&&(r=!0,i.setFog(e.fog)),"terrain"in e&&!$r(e.terrain,n.terrain)&&(!e.terrain||i.getSource(e.terrain.source))&&(r=!0,i.setTerrain(e.terrain))),r}_updateHandlers(e,n){const i=this._map;let r=!1;for(const s of uL){const o=e[s];$r(o,n[s])||(r=!0,o?i[s].enable(o):i[s].disable())}return r}_updateHover(e){var n;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const s=e.type,o=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0;let a;if(s==="mousemove")try{a=this._map.queryRenderedFeatures(e.point,{layers:i.interactiveLayerIds})}catch{a=[]}else a=[];const c=a.length>0;!c&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=a,c&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=s}else this._hoveredFeatures=null}_fireEvent(e,n,i){const r=this._map,s=r.transform,o=typeof n=="string"?n:n.type;return o==="move"&&this._updateViewState(this.props,!1),o in zd&&(typeof n=="object"&&(n.viewState=$y(s)),this._map.isMoving())?(r.transform=this._renderTransform,e.call(r,n,i),r.transform=s,r):(e.call(r,n,i),r)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=n}}}Ma.savedMaps=[];function hL(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||process.env.MapboxAccessToken}catch{}try{t=t||process.env.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const fL=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function dL(t,e){if(!t)return null;const n=t.map,i={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>t.transform.locationPoint(e.LngLat.convert(r)),unproject:r=>t.transform.pointLocation(e.Point.convert(r)),queryTerrainElevation:(r,s)=>{const o=n.transform;n.transform=t.transform;const a=n.queryTerrainElevation(r,s);return n.transform=o,a}};for(const r of gL(n))!(r in i)&&!fL.includes(r)&&(i[r]=n[r].bind(n));return i}function gL(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))i[0]!=="_"&&typeof t[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}const pL=typeof document<"u"?Te.exports.useLayoutEffect:Te.exports.useEffect,mL=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function _L(t,e){for(const n of mL)n in e&&(t[n]=e[n]);e.RTLTextPlugin&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(e.RTLTextPlugin,n=>{n&&console.error(n)},!1)}const Sf=Te.exports.createContext(null),yL={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:t=>console.error(t.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},zm=Te.exports.forwardRef((t,e)=>{const n=Te.exports.useContext(oL),[i,r]=Te.exports.useState(null),s=Te.exports.useRef(),{current:o}=Te.exports.useRef({mapLib:null,map:null});Te.exports.useEffect(()=>{const c=t.mapLib;let f=!0,p;return Promise.resolve(c||ZB(()=>import("./mapbox-gl.6c3b61b8.js").then(m=>m.m),[],import.meta.url)).then(m=>{if(!!f){if(m.Map||(m=m.default),!m||!m.Map)throw new Error("Invalid mapLib");if(m.supported(t))_L(m,t),t.reuseMaps&&(p=Ma.reuse(t,s.current)),p||(p=new Ma(m.Map,t,s.current)),o.map=dL(p,m),o.mapLib=m,r(p),n==null||n.onMapMount(o.map,t.id);else throw new Error("Map is not supported by this browser")}}).catch(m=>{t.onError({type:"error",target:null,originalEvent:null,error:m})}),()=>{f=!1,p&&(n==null||n.onMapUnmount(t.id),t.reuseMaps?p.recycle():p.destroy())}},[]),pL(()=>{i&&i.setProps(t)}),Te.exports.useImperativeHandle(e,()=>o.map,[i]);const a=Te.exports.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]);return Ks("div",{id:t.id,ref:s,style:a,children:i&&Ks(Sf.Provider,{value:o,children:t.children})})});zm.displayName="Map";zm.defaultProps=yL;const vL=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function uo(t,e){if(!t||!e)return;const n=t.style;for(const i in e){const r=e[i];Number.isFinite(r)&&!vL.test(i)?n[i]=`${r}px`:n[i]=r}}const EL={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function cb(t){const{map:e,mapLib:n}=Te.exports.useContext(Sf),i=Te.exports.useRef({props:t});i.current.props=t;const r=Te.exports.useMemo(()=>{let s=!1;Te.exports.Children.forEach(t.children,c=>{c&&(s=!0)});const o={...t,element:s?document.createElement("div"):null},a=new n.Marker(o).setLngLat([t.longitude,t.latitude]);return a.getElement().addEventListener("click",c=>{var f,p;(p=(f=i.current.props).onClick)===null||p===void 0||p.call(f,{type:"click",target:a,originalEvent:c})}),a.on("dragstart",c=>{var f,p;const m=c;m.lngLat=r.getLngLat(),(p=(f=i.current.props).onDragStart)===null||p===void 0||p.call(f,m)}),a.on("drag",c=>{var f,p;const m=c;m.lngLat=r.getLngLat(),(p=(f=i.current.props).onDrag)===null||p===void 0||p.call(f,m)}),a.on("dragend",c=>{var f,p;const m=c;m.lngLat=r.getLngLat(),(p=(f=i.current.props).onDragEnd)===null||p===void 0||p.call(f,m)}),a},[]);return Te.exports.useEffect(()=>(r.addTo(e.getMap()),()=>{r.remove()}),[]),Te.exports.useEffect(()=>{uo(r.getElement(),t.style)},[t.style]),(r.getLngLat().lng!==t.longitude||r.getLngLat().lat!==t.latitude)&&r.setLngLat([t.longitude,t.latitude]),t.offset&&!lL(r.getOffset(),t.offset)&&r.setOffset(t.offset),r.isDraggable()!==t.draggable&&r.setDraggable(t.draggable),r.getRotation()!==t.rotation&&r.setRotation(t.rotation),r.getRotationAlignment()!==t.rotationAlignment&&r.setRotationAlignment(t.rotationAlignment),r.getPitchAlignment()!==t.pitchAlignment&&r.setPitchAlignment(t.pitchAlignment),r.getPopup()!==t.popup&&r.setPopup(t.popup),Af.exports.createPortal(t.children,r.getElement())}cb.defaultProps=EL;Te.exports.memo(cb);function rv(t){return new Set(t?t.trim().split(/\s+/):[])}function wL(t){const{map:e,mapLib:n}=Te.exports.useContext(Sf),i=Te.exports.useMemo(()=>document.createElement("div"),[]),r=Te.exports.useRef({props:t});r.current.props=t;const s=Te.exports.useMemo(()=>{const o={...t},a=new n.Popup(o).setLngLat([t.longitude,t.latitude]);return a.once("open",c=>{var f,p;(p=(f=r.current.props).onOpen)===null||p===void 0||p.call(f,c)}),a},[]);if(Te.exports.useEffect(()=>{const o=a=>{var c,f;(f=(c=r.current.props).onClose)===null||f===void 0||f.call(c,a)};return s.on("close",o),s.setDOMContent(i).addTo(e.getMap()),()=>{s.off("close",o),s.isOpen()&&s.remove()}},[]),Te.exports.useEffect(()=>{uo(s.getElement(),t.style)},[t.style]),s.isOpen()&&((s.getLngLat().lng!==t.longitude||s.getLngLat().lat!==t.latitude)&&s.setLngLat([t.longitude,t.latitude]),t.offset&&!$r(s.options.offset,t.offset)&&s.setOffset(t.offset),(s.options.anchor!==t.anchor||s.options.maxWidth!==t.maxWidth)&&(s.options.anchor=t.anchor,s.setMaxWidth(t.maxWidth)),s.options.className!==t.className)){const o=rv(s.options.className),a=rv(t.className);for(const c of o)a.has(c)||s.removeClassName(c);for(const c of a)o.has(c)||s.addClassName(c);s.options.className=t.className}return Af.exports.createPortal(t.children,i)}Te.exports.memo(wL);function Kl(t,e,n){const i=Te.exports.useContext(Sf),r=Te.exports.useMemo(()=>t(i),[]);return Te.exports.useEffect(()=>{var s;const{map:o}=i;return o.hasControl(r)||o.addControl(r,(s=n||e)===null||s===void 0?void 0:s.position),()=>{typeof e=="function"&&e(i),o.hasControl(r)&&o.removeControl(r)}},[]),r}function TL(t){const e=Kl(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Te.exports.useEffect(()=>{uo(e._container,t.style)},[t.style]),null}Te.exports.memo(TL);function CL(t){const e=Kl(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Te.exports.useEffect(()=>{uo(e._controlContainer,t.style)},[t.style]),null}Te.exports.memo(CL);const ub=Te.exports.forwardRef((t,e)=>{const n=Te.exports.useRef({props:t}),i=Kl(({mapLib:r})=>{const s=new r.GeolocateControl(t),o=s._setupUI;return s._setupUI=a=>{s._container.hasChildNodes()||o(a)},s.on("geolocate",a=>{var c,f;(f=(c=n.current.props).onGeolocate)===null||f===void 0||f.call(c,a)}),s.on("error",a=>{var c,f;(f=(c=n.current.props).onError)===null||f===void 0||f.call(c,a)}),s.on("outofmaxbounds",a=>{var c,f;(f=(c=n.current.props).onOutOfMaxBounds)===null||f===void 0||f.call(c,a)}),s.on("trackuserlocationstart",a=>{var c,f;(f=(c=n.current.props).onTrackUserLocationStart)===null||f===void 0||f.call(c,a)}),s.on("trackuserlocationend",a=>{var c,f;(f=(c=n.current.props).onTrackUserLocationEnd)===null||f===void 0||f.call(c,a)}),s},{position:t.position});return n.current.props=t,Te.exports.useImperativeHandle(e,()=>({trigger:()=>i.trigger()}),[]),Te.exports.useEffect(()=>{uo(i._container,t.style)},[t.style]),null});ub.displayName="GeolocateControl";Te.exports.memo(ub);function bL(t){const e=Kl(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Te.exports.useEffect(()=>{uo(e._container,t.style)},[t.style]),null}Te.exports.memo(bL);const SL={unit:"metric",maxWidth:100};function hb(t){const e=Kl(({mapLib:n})=>new n.ScaleControl(t),{position:t.position});return(e.options.unit!==t.unit||e.options.maxWidth!==t.maxWidth)&&(e.options.maxWidth=t.maxWidth,e.setUnit(t.unit)),Te.exports.useEffect(()=>{uo(e._container,t.style)},[t.style]),null}hb.defaultProps=SL;Te.exports.memo(hb);function lt(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const Ia=Boolean(typeof process!="object"||String(process)!=="[object process]"||process.browser),sv=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);sv&&parseFloat(sv[1]);const xL="3.2.6";function ir(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const Vd={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},PL=Vd.global||Vd.self||Vd.window||{},Ba=typeof process!="object"||String(process)!=="[object process]"||process.browser,Vm=typeof importScripts=="function",ML=typeof window<"u"&&typeof window.orientation<"u",ov=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);ov&&parseFloat(ov[1]);function T(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class IL{constructor(e,n){T(this,"name",void 0),T(this,"workerThread",void 0),T(this,"isRunning",!0),T(this,"result",void 0),T(this,"_resolve",()=>{}),T(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((i,r)=>{this._resolve=i,this._reject=r})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){ir(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){ir(this.isRunning),this.isRunning=!1,this._reject(e)}}class Hd{}const jd=new Map;function BL(t){ir(t.source&&!t.url||!t.source&&t.url);let e=jd.get(t.source||t.url);return e||(t.url&&(e=LL(t.url),jd.set(t.url,e)),t.source&&(e=fb(t.source),jd.set(t.source,e))),ir(e),e}function LL(t){if(!t.startsWith("http"))return t;const e=RL(t);return fb(e)}function fb(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function RL(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function db(t,e=!0,n){const i=n||new Set;if(t){if(av(t))i.add(t);else if(av(t.buffer))i.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const r in t)db(t[r],e,i)}}return n===void 0?Array.from(i):[]}function av(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const Wd=()=>{};class qg{static isSupported(){return typeof Worker<"u"&&Ba||typeof Hd!==void 0}constructor(e){T(this,"name",void 0),T(this,"source",void 0),T(this,"url",void 0),T(this,"terminated",!1),T(this,"worker",void 0),T(this,"onMessage",void 0),T(this,"onError",void 0),T(this,"_loadableURL","");const{name:n,source:i,url:r}=e;ir(i||r),this.name=n,this.source=i,this.url=r,this.onMessage=Wd,this.onError=s=>console.log(s),this.worker=Ba?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Wd,this.onError=Wd,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(e,n){n=n||db(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=BL({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new Hd(i,{eval:!1})}else if(this.source)e=new Hd(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class OL{static isSupported(){return qg.isSupported()}constructor(e){T(this,"name","unnamed"),T(this,"source",void 0),T(this,"url",void 0),T(this,"maxConcurrency",1),T(this,"maxMobileConcurrency",1),T(this,"onDebug",()=>{}),T(this,"reuseWorkers",!0),T(this,"props",{}),T(this,"jobQueue",[]),T(this,"idleQueue",[]),T(this,"count",0),T(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,n=(r,s,o)=>r.done(o),i=(r,s)=>r.error(s)){const r=new Promise(s=>(this.jobQueue.push({name:e,onMessage:n,onError:i,onStart:s}),this));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const i=new IL(n.name,e);e.onMessage=r=>n.onMessage(i,r.type,r.payload),e.onError=r=>n.onError(i,r),n.onStart(i);try{await i.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new qg({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return ML?this.maxMobileConcurrency:this.maxConcurrency}}const FL={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class mr{static isSupported(){return qg.isSupported()}static getWorkerFarm(e={}){return mr._workerFarm=mr._workerFarm||new mr({}),mr._workerFarm.setProps(e),mr._workerFarm}constructor(e){T(this,"props",void 0),T(this,"workerPools",new Map),this.props={...FL},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:i,url:r}=e;let s=this.workerPools.get(n);return s||(s=new OL({name:n,source:i,url:r}),s.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,s)),s}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}T(mr,"_workerFarm",void 0);const DL="latest";function kL(t,e={}){const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(!r&&t.id==="compression"&&(r=e.workerUrl),e._workerType==="test"&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let s=t.version;s==="latest"&&(s=DL);const o=s?"@".concat(s):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(o,"/dist/").concat(i)}return ir(r),r}function NL(t,e=xL){ir(t,"no worker provided");const n=t.version;return!(!e||!n)}const UL={},zL=Object.freeze(Object.defineProperty({__proto__:null,default:UL},Symbol.toStringTag,{value:"Module"})),VL="3.2.6",Qd={};async function Zs(t,e=null,n={}){return e&&(t=HL(t,e,n)),Qd[t]=Qd[t]||jL(t),await Qd[t]}function HL(t,e,n){if(t.startsWith("http"))return t;const i=n.modules||{};return i[t]?i[t]:Ba?n.CDN?(ir(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(VL,"/dist/libs/").concat(t)):Vm?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}async function jL(t){if(t.endsWith("wasm"))return await(await fetch(t)).arrayBuffer();if(!Ba)try{return zL&&void 0}catch{return null}if(Vm)return importScripts(t);const n=await(await fetch(t)).text();return WL(n,t)}function WL(t,e){if(!Ba)return;if(Vm)return eval.call(PL,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}function QL(t,e){return!mr.isSupported()||!Ba&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function XL(t,e,n,i,r){const s=t.id,o=kL(t,n),c=mr.getWorkerFarm(n).getWorkerPool({name:s,url:o});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const f=await c.startJob("process-on-worker",JL.bind(null,r));return f.postMessage("process",{input:e,options:n,context:i}),await(await f.result).result}async function JL(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:s,options:o}=i;try{const a=await t(s,o);e.postMessage("done",{id:r,result:a})}catch(a){const c=a instanceof Error?a.message:"unknown error";e.postMessage("error",{id:r,error:c})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function YL(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?Av(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Av(t,0,e):""}function Av(t,e,n){if(t.byteLength<=e+n)return"";const i=new DataView(t);let r="";for(let s=0;s<n;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}function KL(t){try{return JSON.parse(t)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(YL(t),'"'))}}function gb(t){return t&&typeof t=="object"&&t.isBuffer}function ZL(t){return gb(t)?new Uint8Array(t.buffer,t.byteOffset,t.length).slice().buffer:t}function pb(t){if(gb(t))return ZL(t);if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function qL(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}function $L(...t){const e=t.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),n=e.reduce((s,o)=>s+o.byteLength,0),i=new Uint8Array(n);let r=0;for(const s of e)i.set(s,r),r+=s.byteLength;return i.buffer}function Xd(...t){const e=t,n=e&&e.length>1&&e[0].constructor||null;if(!n)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');const i=e.reduce((o,a)=>o+a.length,0),r=new n(i);let s=0;for(const o of e)r.set(o,s),s+=o.length;return r}function Hm(t,e,n){const i=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(i).buffer}function Zl(t,e){return lt(t>=0),lt(e>0),t+(e-1)&~(e-1)}function eR(t,e,n){let i;if(t instanceof ArrayBuffer)i=new Uint8Array(t);else{const r=t.byteOffset,s=t.byteLength;i=new Uint8Array(t.buffer||t.arrayBuffer,r,s)}return e.set(i,n),n+Zl(i.byteLength,4)}async function tR(t){const e=[];for await(const n of t)e.push(n);return $L(...e)}function lv(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class cv{constructor(e,n){T(this,"name",void 0),T(this,"type",void 0),T(this,"sampleSize",1),T(this,"time",void 0),T(this,"count",void 0),T(this,"samples",void 0),T(this,"lastTiming",void 0),T(this,"lastSampleTime",void 0),T(this,"lastSampleCount",void 0),T(this,"_count",0),T(this,"_time",0),T(this,"_samples",0),T(this,"_startTime",0),T(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=lv(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(lv()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class ql{constructor(e){T(this,"id",void 0),T(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:i}=e;return this.stats[n]||(e instanceof cv?this.stats[n]=e:this.stats[n]=new cv(n,i)),this.stats[n]}}const nR="Queued Requests",iR="Active Requests",rR="Cancelled Requests",sR="Queued Requests Ever",oR="Active Requests Ever",aR={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class mb{constructor(e={}){T(this,"props",void 0),T(this,"stats",void 0),T(this,"activeRequestCount",0),T(this,"requestQueue",[]),T(this,"requestMap",new Map),T(this,"deferredUpdate",null),this.props={...aR,...e},this.stats=new ql({id:this.props.id}),this.stats.get(nR),this.stats.get(iR),this.stats.get(rR),this.stats.get(sR),this.stats.get(oR)}scheduleRequest(e,n=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const i={handle:e,priority:0,getPriority:n},r=new Promise(s=>(i.resolve=s,i));return this.requestQueue.push(i),this.requestMap.set(e,r),this._issueNewRequests(),r}_issueRequest(e){const{handle:n,resolve:i}=e;let r=!1;const s=()=>{r||(r=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:s}):Promise.resolve({done:s})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const i=this.requestQueue.shift();i&&this._issueRequest(i)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const i=e[n];this._updateRequest(i)||(e.splice(n,1),this.requestMap.delete(i.handle),n--)}e.sort((n,i)=>n.priority-i.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let AR="";const uv={};function lR(t){for(const e in uv)if(t.startsWith(e)){const n=uv[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(AR).concat(t)),t}function cR(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}function _b(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}const uR=t=>typeof t=="boolean",nl=t=>typeof t=="function",$l=t=>t!==null&&typeof t=="object",hv=t=>$l(t)&&t.constructor==={}.constructor,hR=t=>t&&typeof t[Symbol.iterator]=="function",fR=t=>t&&typeof t[Symbol.asyncIterator]=="function",Va=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,Ha=t=>typeof Blob<"u"&&t instanceof Blob,dR=t=>t&&typeof t=="object"&&t.isBuffer,gR=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||$l(t)&&nl(t.tee)&&nl(t.cancel)&&nl(t.getReader),pR=t=>$l(t)&&nl(t.read)&&nl(t.pipe)&&uR(t.readable),yb=t=>gR(t)||pR(t),mR=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,_R=/^([-\w.]+\/[-\w.+]+)/;function yR(t){const e=_R.exec(t);return e?e[1]:t}function fv(t){const e=mR.exec(t);return e?e[1]:""}const vR=/\?.*/;function xf(t){if(Va(t)){const e=Jd(t.url||""),n=t.headers.get("content-type")||"";return{url:e,type:yR(n)||fv(e)}}return Ha(t)?{url:Jd(t.name||""),type:t.type||""}:typeof t=="string"?{url:Jd(t),type:fv(t)}:{url:"",type:""}}function ER(t){return Va(t)?t.headers["content-length"]||-1:Ha(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function Jd(t){return t.replace(vR,"")}async function vb(t){if(Va(t))return t;const e={},n=ER(t);n>=0&&(e["content-length"]=String(n));const{url:i,type:r}=xf(t);r&&(e["content-type"]=r);const s=await CR(t);s&&(e["x-first-bytes"]=s),typeof t=="string"&&(t=new TextEncoder().encode(t));const o=new Response(t,{headers:e});return Object.defineProperty(o,"url",{value:i}),o}async function wR(t){if(!t.ok){const e=await TR(t);throw new Error(e)}}async function TR(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function CR(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(i=>{const r=new FileReader;r.onload=s=>{var o;return i(s==null||(o=s.target)===null||o===void 0?void 0:o.result)},r.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),i=bR(n);return"data:base64,".concat(i)}return null}function bR(t){let e="";const n=new Uint8Array(t);for(let i=0;i<n.byteLength;i++)e+=String.fromCharCode(n[i]);return btoa(e)}async function $g(t,e){if(typeof t=="string"){t=lR(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await vb(t)}function Eb(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&Boolean(process.versions.electron))return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function Br(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||Eb()}const Yu={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},eu=Yu.window||Yu.self||Yu.global,wA=Yu.process||{},wb=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";Br();const Yd=globalThis;function Tb(t){if(!t&&!Br())return"Node";if(Eb(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r?"IE":Yd.chrome?"Chrome":Yd.safari?"Safari":Yd.mozInnerScreenX?"Firefox":"Unknown"}function SR(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class xR{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";T(this,"storage",void 0),T(this,"id",void 0),T(this,"config",{}),this.storage=SR(i),this.id=e,this.config={},Object.assign(this.config,n),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){return this.config={},this.updateConfiguration(e)}updateConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}return this}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function PR(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function MR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function Kd(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const s=t.width*n,o=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(o/2),"px ").concat(Math.floor(s/2),"px;"),"line-height:".concat(o,"px;"),"background:url(".concat(r,");"),"background-size:".concat(s,"px ").concat(o,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let Fh;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Fh||(Fh={}));function dv(t){return typeof t=="string"?Fh[t.toUpperCase()]||Fh.WHITE:t}function IR(t,e,n){return!Br&&typeof t=="string"&&(e&&(e=dv(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=dv(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function BR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const r of i)typeof t[r]=="function"&&(e.find(s=>r===s)||(t[r]=t[r].bind(t)))}function Dh(t,e){if(!t)throw new Error(e||"Assertion failed")}function Io(){let t;if(Br&&"performance"in eu){var e,n;t=eu==null||(e=eu.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in wA){var i;const r=wA==null||(i=wA.hrtime)===null||i===void 0?void 0:i.call(wA);t=r[0]*1e3+r[1]/1e6}else t=Date.now();return t}const Bo={debug:Br&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},LR={enabled:!0,level:0};function li(){}const gv={},pv={once:!0};class ec{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};T(this,"id",void 0),T(this,"VERSION",wb),T(this,"_startTs",Io()),T(this,"_deltaTs",Io()),T(this,"_storage",void 0),T(this,"userData",{}),T(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this._storage=new xR("__probe-".concat(this.id,"__"),LR),this.userData={},this.timeStamp("".concat(this.id," started")),BR(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Io()-this._startTs).toPrecision(10))}getDelta(){return Number((Io()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.updateConfiguration({enabled:e}),this}setLevel(e){return this._storage.updateConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.updateConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){Dh(e,n)}warn(e){return this._getLogFunction(0,e,Bo.warn,arguments,pv)}error(e){return this._getLogFunction(0,e,Bo.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Bo.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Bo.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return this._getLogFunction(e,n,Bo.debug||Bo.info,arguments,pv)}table(e,n,i){return n?this._getLogFunction(e,n,console.table||li,i&&[i],{tag:DR(n)}):li}image(e){let{logLevel:n,priority:i,image:r,message:s="",scale:o=1}=e;return this._shouldLog(n||i)?Br?FR({image:r,message:s,scale:o}):OR({image:r,message:s,scale:o}):li}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||li)}group(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const r=mv({logLevel:e,message:n,opts:i}),{collapsed:s}=i;return r.method=(s?console.groupCollapsed:console.group)||console.info,this._getLogFunction(r)}groupCollapsed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||li)}withGroup(e,n,i){this.group(e,n)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=Cb(e)}_getLogFunction(e,n,i,r,s){if(this._shouldLog(e)){s=mv({logLevel:e,message:n,args:r,opts:s}),i=i||s.method,Dh(i),s.total=this.getTotal(),s.delta=this.getDelta(),this._deltaTs=Io();const o=s.tag||s.message;if(s.once)if(!gv[o])gv[o]=Io();else return li;return n=RR(this.id,s.message,s),i.bind(console,n,...s.args)}return li}}T(ec,"VERSION",wb);function Cb(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Dh(Number.isFinite(e)&&e>=0),e}function mv(t){const{logLevel:e,message:n}=t;t.logLevel=Cb(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const r=typeof t.message;return Dh(r==="string"||r==="object"),Object.assign(t,{args:i},t.opts)}function RR(t,e,n){if(typeof e=="string"){const i=n.time?MR(PR(n.total)):"";e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),e=IR(e,n.color,n.background)}return e}function OR(t){let{image:e,message:n="",scale:i=1}=t,r=null;try{r=module.require("asciify-image")}catch{}return r?()=>r(e,{fit:"box",width:"".concat(Math.round(80*i),"%")}).then(s=>console.log(s)):li}function FR(t){let{image:e,message:n="",scale:i=1}=t;if(typeof e=="string"){const s=new Image;return s.onload=()=>{const o=Kd(s,n,i);console.log(...o)},s.src=e,li}const r=e.nodeName||"";if(r.toLowerCase()==="img")return console.log(...Kd(e,n,i)),li;if(r.toLowerCase()==="canvas"){const s=new Image;return s.onload=()=>console.log(...Kd(s,n,i)),s.src=e.toDataURL(),li}return li}function DR(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const _v=new ec({id:"loaders.gl"});class kR{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class NR{constructor(){T(this,"console",void 0),this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const bb={fetch:null,mimeType:void 0,nothrow:!1,log:new NR,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Ia,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},UR={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Sb(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const xb=()=>{const t=Sb();return t.globalOptions=t.globalOptions||{...bb},t.globalOptions};function GR(t,e,n,i){return n=n||[],n=Array.isArray(n)?n:[n],zR(t,n),HR(e,t,i)}function Pb(t,e){const n=xb(),i=t||n;return typeof i.fetch=="function"?i.fetch:$l(i.fetch)?r=>$g(r,i):e!=null&&e.fetch?e==null?void 0:e.fetch:$g}function zR(t,e){yv(t,null,bb,UR,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},s=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};yv(i,n.id,r,s,e)}}function yv(t,e,n,i,r){const s=e||"Top level",o=e?"".concat(e,"."):"";for(const a in t){const c=!e&&$l(t[a]),f=a==="baseUri"&&!e,p=a==="workerUrl"&&e;if(!(a in n)&&!f&&!p){if(a in i)_v.warn("".concat(s," loader option '").concat(o).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!c){const m=VR(a,r);_v.warn("".concat(s," loader option '").concat(o).concat(a,"' not recognized. ").concat(m))()}}}}function VR(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const s in r.options){if(t===s)return"Did you mean '".concat(r.id,".").concat(s,"'?");const o=s.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(s,"'?"))}return i}function HR(t,e,n){const r={...t.options||{}};return jR(r,n),r.log===null&&(r.log=new kR),vv(r,xb()),vv(r,e),r}function vv(t,e){for(const n in e)if(n in e){const i=e[n];hv(i)&&hv(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function jR(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function jm(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function Wm(t){var e,n;lt(t,"null loader"),lt(jm(t),"invalid loader");let i;return Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Mb=()=>{const t=Sb();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function WR(t){const e=Mb();t=Array.isArray(t)?t:[t];for(const n of t){const i=Wm(n);e.find(r=>i===r)||e.unshift(i)}}function QR(){return Mb()}const XR=new ec({id:"loaders.gl"}),JR=/\.([^.]+)$/;async function YR(t,e=[],n,i){if(!Ib(t))return null;let r=Ev(t,e,{...n,nothrow:!0},i);if(r)return r;if(Ha(t)&&(t=await t.slice(0,10).arrayBuffer(),r=Ev(t,e,n,i)),!r&&!(n!=null&&n.nothrow))throw new Error(Bb(t));return r}function Ev(t,e=[],n,i){if(!Ib(t))return null;if(e&&!Array.isArray(e))return Wm(e);let r=[];e&&(r=r.concat(e)),n!=null&&n.ignoreRegisteredLoaders||r.push(...QR()),ZR(r);const s=KR(t,r,n,i);if(!s&&!(n!=null&&n.nothrow))throw new Error(Bb(t));return s}function KR(t,e,n,i){const{url:r,type:s}=xf(t),o=r||(i==null?void 0:i.url);let a=null,c="";if(n!=null&&n.mimeType&&(a=Zd(e,n==null?void 0:n.mimeType),c="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),a=a||qR(e,o),c=c||(a?"matched url ".concat(o):""),a=a||Zd(e,s),c=c||(a?"matched MIME type ".concat(s):""),a=a||eO(e,t),c=c||(a?"matched initial data ".concat(Lb(t)):""),a=a||Zd(e,n==null?void 0:n.fallbackMimeType),c=c||(a?"matched fallback MIME type ".concat(s):""),c){var f;XR.log(1,"selectLoader selected ".concat((f=a)===null||f===void 0?void 0:f.name,": ").concat(c,"."))}return a}function Ib(t){return!(t instanceof Response&&t.status===204)}function Bb(t){const{url:e,type:n}=xf(t);let i="No valid loader found (";i+=e?"".concat(cR(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?Lb(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function ZR(t){for(const e of t)Wm(e)}function qR(t,e){const n=e&&JR.exec(e),i=n&&n[1];return i?$R(t,i):null}function $R(t,e){e=e.toLowerCase();for(const n of t)for(const i of n.extensions)if(i.toLowerCase()===e)return n;return null}function Zd(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function eO(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(tO(e,n))return n}else if(ArrayBuffer.isView(e)){if(wv(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&wv(e,0,n))return n;return null}function tO(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>t.startsWith(i))}function wv(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(r=>nO(t,e,n,r))}function nO(t,e,n,i){if(i instanceof ArrayBuffer)return qL(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":const r=ep(t,e,i.length);return i===r;default:return!1}}function Lb(t,e=5){return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?ep(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?ep(t,0,e):""}function ep(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let s=0;s<n;s++)r+=String.fromCharCode(i.getUint8(e+s));return r}const iO=256*1024;function*rO(t,e){const n=(e==null?void 0:e.chunkSize)||iO;let i=0;const r=new TextEncoder;for(;i<t.length;){const s=Math.min(t.length-i,n),o=t.slice(i,i+s);i+=s,yield r.encode(o)}}const sO=256*1024;function*oO(t,e={}){const{chunkSize:n=sO}=e;let i=0;for(;i<t.byteLength;){const r=Math.min(t.byteLength-i,n),s=new ArrayBuffer(r),o=new Uint8Array(t,i,r);new Uint8Array(s).set(o),i+=r,yield s}}const aO=1024*1024;async function*AO(t,e){const n=(e==null?void 0:e.chunkSize)||aO;let i=0;for(;i<t.size;){const r=i+n,s=await t.slice(i,r).arrayBuffer();i=r,yield s}}function Tv(t,e){return Ia?lO(t,e):cO(t)}async function*lO(t,e){const n=t.getReader();let i;try{for(;;){const r=i||n.read();e!=null&&e._streamReadAhead&&(i=n.read());const{done:s,value:o}=await r;if(s)return;yield pb(o)}}catch{n.releaseLock()}}async function*cO(t,e){for await(const n of t)yield pb(n)}function uO(t,e){if(typeof t=="string")return rO(t,e);if(t instanceof ArrayBuffer)return oO(t,e);if(Ha(t))return AO(t,e);if(yb(t))return Tv(t,e);if(Va(t))return Tv(t.body,e);throw new Error("makeIterator")}const Rb="Cannot convert supplied data type";function hO(t,e,n){if(e.text&&typeof t=="string")return t;if(dR(t)&&(t=t.buffer),t instanceof ArrayBuffer){const i=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let i=t.buffer;const r=t.byteLength||t.length;return(t.byteOffset!==0||r!==i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+r)),i}throw new Error(Rb)}async function fO(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||i)return hO(t,e);if(Ha(t)&&(t=await vb(t)),Va(t)){const r=t;return await wR(r),e.binary?await r.arrayBuffer():await r.text()}if(yb(t)&&(t=uO(t,n)),hR(t)||fR(t))return tR(t);throw new Error(Rb)}function dO(t,e,n=null){if(n)return n;const i={fetch:Pb(e,t),...t};return Array.isArray(i.loaders)||(i.loaders=null),i}function gO(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...i]:i}return n&&n.length?n:null}async function Qm(t,e,n,i){ir(!i||typeof i=="object"),e&&!Array.isArray(e)&&!jm(e)&&(i=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:r}=xf(t),o=gO(e,i),a=await YR(t,o,n);return a?(n=GR(n,a,o,r),i=dO({url:r,parse:Qm,loaders:o},n,i),await pO(a,t,n,i)):null}async function pO(t,e,n,i){if(NL(t),Va(e)){const r=e,{ok:s,redirected:o,status:a,statusText:c,type:f,url:p}=r,m=Object.fromEntries(r.headers.entries());i.response={headers:m,ok:s,redirected:o,status:a,statusText:c,type:f,url:p}}if(e=await fO(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,i,t);if(QL(t,n))return await XL(t,e,n,i,Qm);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw ir(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function Sr(t,e,n,i){!Array.isArray(e)&&!jm(e)&&(n=e,e=void 0);const r=Pb(n);let s=t;return typeof t=="string"&&(s=await r(t)),Ha(t)&&(s=await r(t)),await Qm(s,e,n)}const mO="3.2.6",{_parseImageNode:_O}=globalThis,tp=typeof Image<"u",np=typeof ImageBitmap<"u",yO=Boolean(_O),ip=Ia?!0:yO;function vO(t){switch(t){case"auto":return np||tp||ip;case"imagebitmap":return np;case"image":return tp;case"data":return ip;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function EO(){if(np)return"imagebitmap";if(tp)return"image";if(ip)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function wO(t){const e=CO(t);if(!e)throw new Error("Not an image");return e}function TO(t){switch(wO(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function CO(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const bO=/^data:image\/svg\+xml/,SO=/\.svg((\?|#).*)?$/;function Xm(t){return t&&(bO.test(t)||SO.test(t))}function xO(t,e){if(Xm(e)){let i=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(s){throw new Error(s.message)}return"data:image/svg+xml;base64,".concat(btoa(i))}return Ob(t,e)}function Ob(t,e){if(Xm(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Fb(t,e,n){const i=xO(t,n),r=self.URL||self.webkitURL,s=typeof i!="string"&&r.createObjectURL(i);try{return await PO(s||i,e)}finally{s&&r.revokeObjectURL(s)}}async function PO(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((i,r)=>{try{n.onload=()=>i(n),n.onerror=s=>r(new Error("Could not load image ".concat(t,": ").concat(s)))}catch(s){r(s)}})}const MO={};let Cv=!0;async function IO(t,e,n){let i;Xm(n)?i=await Fb(t,e,n):i=Ob(t,n);const r=e&&e.imagebitmap;return await BO(i,r)}async function BO(t,e=null){if((LO(e)||!Cv)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),Cv=!1}return await createImageBitmap(t)}function LO(t){for(const e in t||MO)return!1;return!0}const qi=!1,il=!0;function Jm(t){const e=tc(t);return RO(e)||DO(e)||OO(e)||FO(e)}function RO(t){const e=tc(t);return e.byteLength>=24&&e.getUint32(0,qi)===2303741511?{mimeType:"image/png",width:e.getUint32(16,qi),height:e.getUint32(20,qi)}:null}function OO(t){const e=tc(t);return e.byteLength>=10&&e.getUint32(0,qi)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,il),height:e.getUint16(8,il)}:null}function FO(t){const e=tc(t);return e.byteLength>=14&&e.getUint16(0,qi)===16973&&e.getUint32(2,il)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,il),height:e.getUint32(22,il)}:null}function DO(t){const e=tc(t);if(!(e.byteLength>=3&&e.getUint16(0,qi)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:r}=kO();let s=2;for(;s+9<e.byteLength;){const o=e.getUint16(s,qi);if(r.has(o))return{mimeType:"image/jpeg",height:e.getUint16(s+5,qi),width:e.getUint16(s+7,qi)};if(!i.has(o))return null;s+=2,s+=e.getUint16(s,qi)}return null}function kO(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function tc(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function NO(t,e){const{mimeType:n}=Jm(t)||{},i=globalThis._parseImageNode;return lt(i),await i(t,n)}async function UO(t,e,n){e=e||{};const r=(e.image||{}).type||"auto",{url:s}=n||{},o=GO(r);let a;switch(o){case"imagebitmap":a=await IO(t,e,s);break;case"image":a=await Fb(t,e,s);break;case"data":a=await NO(t);break;default:lt(!1)}return r==="data"&&(a=TO(a)),a}function GO(t){switch(t){case"auto":case"data":return EO();default:return vO(t),t}}const zO=["png","jpg","jpeg","gif","webp","bmp","ico","svg"],VO=["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],HO={image:{type:"auto",decode:!0}},Ym={id:"image",module:"images",name:"Images",version:mO,mimeTypes:VO,extensions:zO,parse:UO,tests:[t=>Boolean(Jm(new DataView(t)))],options:HO},jO=["image/png","image/jpeg","image/gif"],qd={};function WO(t){return qd[t]===void 0&&(qd[t]=QO(t)),qd[t]}function QO(t){switch(t){case"image/webp":return XO();case"image/svg":return Ia;default:if(!Ia){const{_parseImageNode:e}=globalThis;return Boolean(e)&&jO.includes(t)}return!0}}function XO(){if(!Ia)return!1;try{return document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")===0}catch{return!1}}const Re=new ec({id:"deck"});let rp={};function JO(t){rp=t}function dn(t,e,n,i){Re.level>0&&rp[t]&&rp[t].call(null,e,n,i)}function YO(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const KO={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:YO,parseTextSync:JSON.parse},rl="8.8.6",Ku=globalThis.deck&&globalThis.deck.VERSION;if(Ku&&Ku!==rl)throw new Error("deck.gl - multiple versions detected: ".concat(Ku," vs ").concat(rl));Ku||(Re.log(1,"deck.gl ".concat(rl))(),globalThis.deck={...globalThis.deck,VERSION:rl,version:rl,log:Re,_registerLoggers:JO},WR([KO,[Ym,{imagebitmap:{premultiplyAlpha:"none"}}]]));const ZO=globalThis.deck,Se=new ec({id:"luma.gl"});function Cn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const qO="Invalid WebGLRenderingContext",$O="Requires WebGL2";function Pf(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&Number.isFinite(t._version))}function We(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function eF(t){return We(t)?t:null}function Mf(t){return Cn(Pf(t),qO),t}function mn(t){return Cn(We(t),$O),t}const zA={};function tF(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function nF(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function iF(t,e){zA[t]=!0,e!==void 0&&tF(e)}function rF(t){const e=t.getError;t.getError=function(){let i;do i=e.apply(t),i!==0&&(zA[i]=!0);while(i!==0);for(i in zA)if(zA[i])return delete zA[i],parseInt(i,10);return 0}}const nc=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let i=0;i<this.attribs.length;i++){const r=new t.VertexAttrib(n);this.attribs[i]=r}this.maxAttrib=0};nc.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};nc.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const ho=function(e){const n=this;this.gl=e,rF(e);const i=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(s){return s===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:i.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!0,i.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(s){const o=n.currentVertexArrayObject;o.maxAttrib=Math.max(o.maxAttrib,s);const a=o.attribs[s];return a.enabled=!1,i.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(s,o){switch(s){case 34962:n.currentArrayBuffer=o;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=o;break}return i.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(s,o){const c=n.currentVertexArrayObject.attribs[s];switch(o){case 34975:return c.buffer;case 34338:return c.enabled;case 34339:return c.size;case 34340:return c.stride;case 34341:return c.type;case 34922:return c.normalized;default:return i.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(s,o,a,c,f,p){const m=n.currentVertexArrayObject;m.maxAttrib=Math.max(m.maxAttrib,s);const v=m.attribs[s];return v.buffer=n.currentArrayBuffer,v.size=o,v.type=a,v.normalized=c,v.stride=f,v.offset=p,v.recache(),i.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{nF("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};ho.prototype.VERTEX_ARRAY_BINDING_OES=34229;ho.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let i=0;i<this.vertexArrayObjects.length;++i)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new nc(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};ho.prototype.createVertexArrayOES=function(){const e=new nc(this);return this.vertexArrayObjects.push(e),e};ho.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};ho.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof nc&&e.hasBeenBound&&e.ext===this)};ho.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){iF(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const i=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(r===s)return;(!r||s.elementArrayBuffer!==r.elementArrayBuffer)&&i.bindBuffer.call(n,34963,s.elementArrayBuffer);let o=this.currentArrayBuffer;const a=Math.max(r?r.maxAttrib:0,s.maxAttrib);for(let c=0;c<=a;c++){const f=s.attribs[c],p=r?r.attribs[c]:null;if((!r||f.enabled!==p.enabled)&&(f.enabled?i.enableVertexAttribArray.call(n,c):i.disableVertexAttribArray.call(n,c)),f.enabled){let m=!1;(!r||f.buffer!==p.buffer)&&(o!==f.buffer&&(i.bindBuffer.call(n,34962,f.buffer),o=f.buffer),m=!0),(m||f.cached!==p.cached)&&i.vertexAttribPointer.call(n,c,f.size,f.type,f.normalized,f.stride,f.offset)}}this.currentArrayBuffer!==o&&i.bindBuffer.call(n,34962,this.currentArrayBuffer)};function sF(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const r=e.call(this)||[];return r.indexOf("OES_vertex_array_object")<0&&r.push("OES_vertex_array_object"),r};const n=t.getExtension;t.getExtension=function(r){const s=n.call(this,r);return s||(r!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new ho(this)),this.__OESVertexArrayObject))}}const bv="OES_element_index",Sv="WEBGL_draw_buffers",oF="EXT_disjoint_timer_query",aF="EXT_disjoint_timer_query_webgl2",AF="EXT_texture_filter_anisotropic",xv="WEBGL_debug_renderer_info",lF=35723,cF=4352,uF=36795,hF=34047,fF=37445,dF=37446,pt=t=>We(t)?void 0:0,gF={[3074]:t=>We(t)?void 0:36064,[lF]:t=>We(t)?void 0:cF,[35977]:pt,[32937]:pt,[uF]:(t,e)=>{const n=We(t)?t.getExtension(aF):t.getExtension(oF);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[fF]:(t,e)=>{const n=t.getExtension(xv);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[dF]:(t,e)=>{const n=t.getExtension(xv);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[hF]:(t,e)=>{const n=t.luma.extensions[AF];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},[32883]:pt,[35071]:pt,[37447]:pt,[36063]:(t,e)=>{if(!We(t)){const n=t.getExtension(Sv);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},[35379]:pt,[35374]:pt,[35377]:pt,[34852]:t=>{if(!We(t)){const e=t.getExtension(Sv);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},[36203]:t=>t.getExtension(bv)?2147483647:65535,[33001]:t=>t.getExtension(bv)?16777216:65535,[33e3]:t=>16777216,[37157]:pt,[35373]:pt,[35657]:pt,[36183]:pt,[37137]:pt,[34045]:pt,[35978]:pt,[35979]:pt,[35968]:pt,[35376]:pt,[35375]:pt,[35659]:pt,[37154]:pt,[35371]:pt,[35658]:pt,[35076]:pt,[35077]:pt,[35380]:pt};function pF(t,e,n){const i=gF[n],r=typeof i=="function"?i(t,e,n):i;return r!==void 0?r:e(n)}const mF="OES_vertex_array_object",Db="ANGLE_instanced_arrays",_F="WEBGL_draw_buffers",yF="EXT_disjoint_timer_query",vF="EXT_texture_filter_anisotropic",EF="VertexArray requires WebGL2 or OES_vertex_array_object extension";function wF(t,e){return{webgl2:We(t),ext:t.getExtension(e)}}const kb={[mF]:{meta:{suffix:"OES"},createVertexArray:()=>{Cn(!1,EF)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[Db]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Cn(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[_F]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Cn(!1)}},[yF]:{meta:{suffix:"EXT"},createQuery:()=>{Cn(!1)},deleteQuery:()=>{Cn(!1)},beginQuery:()=>{Cn(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},$d={readBuffer:(t,e,n)=>{We(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:s}=wF(t,Db);let o;switch(i){case 35069:o=r?void 0:!1;break;case 35070:o=!r&&!s?0:void 0;break}return o!==void 0?o:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!We(t))switch(i){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>{if(!We(t))switch(r){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,i,r)},getTexParameter(t,e,n,i){switch(i){case 34046:const{extensions:r}=t.luma,s=r[vF];i=s&&s.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,i)},getParameter:pF,hint(t,e,n,i){return e(n,i)}};function TF(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(sF(t),CF(t),SF(t,kb),bF(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=TF;function CF(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function bF(t,e){let{target:n,target2:i}=e;Object.keys($d).forEach(r=>{if(typeof $d[r]=="function"){const s=t[r]?t[r].bind(t):()=>{},o=$d[r].bind(null,t,s);n[r]=o,i[r]=o}})}function SF(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&xF(t,{extension:n,target:t.luma,target2:t})}function xF(t,e){let{extension:n,target:i,target2:r}=e;const s=kb[n];Cn(s);const{meta:o={}}=s,{suffix:a=""}=o,c=t.getExtension(n);for(const f of Object.keys(s)){const p="".concat(f).concat(a);let m=null;f==="meta"||typeof t[f]=="function"||(c&&typeof c[p]=="function"?m=function(){return c[p](...arguments)}:typeof s[f]=="function"&&(m=s[f].bind(i))),m&&(i[f]=m,r[f]=m)}}const Km={[3042]:!1,[32773]:new Float32Array([0,0,0,0]),[32777]:32774,[34877]:32774,[32969]:1,[32968]:0,[32971]:1,[32970]:0,[3106]:new Float32Array([0,0,0,0]),[3107]:[!0,!0,!0,!0],[2884]:!1,[2885]:1029,[2929]:!1,[2931]:1,[2932]:513,[2928]:new Float32Array([0,1]),[2930]:!0,[3024]:!0,[36006]:null,[2886]:2305,[33170]:4352,[2849]:1,[32823]:!1,[32824]:0,[10752]:0,[32938]:1,[32939]:!1,[3089]:!1,[3088]:new Int32Array([0,0,1024,1024]),[2960]:!1,[2961]:0,[2968]:4294967295,[36005]:4294967295,[2962]:519,[2967]:0,[2963]:4294967295,[34816]:519,[36003]:0,[36004]:4294967295,[2964]:7680,[2965]:7680,[2966]:7680,[34817]:7680,[34818]:7680,[34819]:7680,[2978]:[0,0,1024,1024],[3333]:4,[3317]:4,[37440]:!1,[37441]:!1,[37443]:37444,[35723]:4352,[36010]:null,[35977]:!1,[3330]:0,[3332]:0,[3331]:0,[3314]:0,[32878]:0,[3316]:0,[3315]:0,[32877]:0},Vr=(t,e,n)=>e?t.enable(n):t.disable(n),Pv=(t,e,n)=>t.hint(n,e),jn=(t,e,n)=>t.pixelStorei(n,e),PF=(t,e)=>{const n=We(t)?36009:36160;return t.bindFramebuffer(n,e)},MF=(t,e)=>t.bindFramebuffer(36008,e);function TA(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const IF={[3042]:Vr,[32773]:(t,e)=>t.blendColor(...e),[32777]:"blendEquation",[34877]:"blendEquation",[32969]:"blendFunc",[32968]:"blendFunc",[32971]:"blendFunc",[32970]:"blendFunc",[3106]:(t,e)=>t.clearColor(...e),[3107]:(t,e)=>t.colorMask(...e),[2884]:Vr,[2885]:(t,e)=>t.cullFace(e),[2929]:Vr,[2931]:(t,e)=>t.clearDepth(e),[2932]:(t,e)=>t.depthFunc(e),[2928]:(t,e)=>t.depthRange(...e),[2930]:(t,e)=>t.depthMask(e),[3024]:Vr,[35723]:Pv,[36006]:PF,[2886]:(t,e)=>t.frontFace(e),[33170]:Pv,[2849]:(t,e)=>t.lineWidth(e),[32823]:Vr,[32824]:"polygonOffset",[10752]:"polygonOffset",[35977]:Vr,[32938]:"sampleCoverage",[32939]:"sampleCoverage",[3089]:Vr,[3088]:(t,e)=>t.scissor(...e),[2960]:Vr,[2961]:(t,e)=>t.clearStencil(e),[2968]:(t,e)=>t.stencilMaskSeparate(1028,e),[36005]:(t,e)=>t.stencilMaskSeparate(1029,e),[2962]:"stencilFuncFront",[2967]:"stencilFuncFront",[2963]:"stencilFuncFront",[34816]:"stencilFuncBack",[36003]:"stencilFuncBack",[36004]:"stencilFuncBack",[2964]:"stencilOpFront",[2965]:"stencilOpFront",[2966]:"stencilOpFront",[34817]:"stencilOpBack",[34818]:"stencilOpBack",[34819]:"stencilOpBack",[2978]:(t,e)=>t.viewport(...e),[3333]:jn,[3317]:jn,[37440]:jn,[37441]:jn,[37443]:jn,[3330]:jn,[3332]:jn,[3331]:jn,[36010]:MF,[3314]:jn,[32878]:jn,[3316]:jn,[3315]:jn,[32877]:jn,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=TA(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=TA(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=TA(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=TA(e)&&e.length===3?[...e,...e]:e;const[n,i,r,s,o,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,s,o,a)},stencilOp:(t,e)=>{e=TA(e)&&e.length===3?[...e,...e]:e;const[n,i,r,s,o,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,s,o,a)},viewport:(t,e)=>t.viewport(...e)};function Ft(t,e,n){return e[t]!==void 0?e[t]:n[t]}const BF={blendEquation:(t,e,n)=>t.blendEquationSeparate(Ft(32777,e,n),Ft(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Ft(32969,e,n),Ft(32968,e,n),Ft(32971,e,n),Ft(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Ft(32824,e,n),Ft(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Ft(32938,e,n),Ft(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Ft(2962,e,n),Ft(2967,e,n),Ft(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Ft(34816,e,n),Ft(36003,e,n),Ft(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Ft(2964,e,n),Ft(2965,e,n),Ft(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Ft(34817,e,n),Ft(34818,e,n),Ft(34819,e,n))},Mv={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({[36006]:n,[36010]:n});case 36009:return t({[36006]:n});case 36008:return t({[36010]:n});default:return null}},blendColor:(t,e,n,i,r)=>t({[32773]:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({[32777]:e,[34877]:e}),blendEquationSeparate:(t,e,n)=>t({[32777]:e,[34877]:n}),blendFunc:(t,e,n)=>t({[32969]:e,[32968]:n,[32971]:e,[32970]:n}),blendFuncSeparate:(t,e,n,i,r)=>t({[32969]:e,[32968]:n,[32971]:i,[32970]:r}),clearColor:(t,e,n,i,r)=>t({[3106]:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({[2931]:e}),clearStencil:(t,e)=>t({[2961]:e}),colorMask:(t,e,n,i,r)=>t({[3107]:[e,n,i,r]}),cullFace:(t,e)=>t({[2885]:e}),depthFunc:(t,e)=>t({[2932]:e}),depthRange:(t,e,n)=>t({[2928]:new Float32Array([e,n])}),depthMask:(t,e)=>t({[2930]:e}),frontFace:(t,e)=>t({[2886]:e}),lineWidth:(t,e)=>t({[2849]:e}),polygonOffset:(t,e,n)=>t({[32824]:e,[10752]:n}),sampleCoverage:(t,e,n)=>t({[32938]:e,[32939]:n}),scissor:(t,e,n,i,r)=>t({[3088]:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({[2968]:e,[36005]:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({[2962]:e,[2967]:n,[2963]:i,[34816]:e,[36003]:n,[36004]:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:i,[e===1028?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({[2964]:e,[2965]:n,[2966]:i,[34817]:e,[34818]:n,[34819]:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:i,[e===1028?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({[2978]:[e,n,i,r]})},Wi=(t,e)=>t.isEnabled(e),Iv={[3042]:Wi,[2884]:Wi,[2929]:Wi,[3024]:Wi,[32823]:Wi,[32926]:Wi,[32928]:Wi,[3089]:Wi,[2960]:Wi,[35977]:Wi};function Nb(t){for(const e in t)return!1;return!0}function LF(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let r=0;r<t.length;++r)if(t[r]!==e[r])return!1;return!0}return!1}function Bv(t,e){const n=t[e].bind(t);t[e]=function(){const r=arguments.length<=0?void 0:arguments[0];return r in t.state.cache?t.state.enable?t.state.cache[r]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function RF(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const{valueChanged:c,oldValue:f}=n(t.state._updateCache,...o);return c&&i(...o),f},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function OF(t){const e=t.useProgram.bind(t);t.useProgram=function(i){t.state.program!==i&&(e(i),t.state.program=i)}}class FF{constructor(e){let{copyState:n=!1,log:i=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?kF(e):Object.assign({},Km),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Cn(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];xr(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,i;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const s in e){Cn(s!==void 0);const o=e[s],a=this.cache[s];LF(o,a)||(n=!0,i=a,r&&!(s in r)&&(r[s]=a),this.cache[s]=o)}return{valueChanged:n,oldValue:i}}}function Ub(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(Cn(i!==void 0),!t.state){const{polyfillContext:r}=globalThis;r&&r(t),t.state=new FF(t,{copyState:i}),OF(t);for(const s in Mv){const o=Mv[s];RF(t,s,o)}Bv(t,"getParameter"),Bv(t,"isEnabled")}return t.state.enable=n,t}function DF(t){t.state||Ub(t,{copyState:!1}),t.state.push()}function Lv(t){Cn(t.state),t.state.pop()}function xr(t,e){if(Cn(Pf(t),"setParameters requires a WebGL context"),Nb(e))return;const n={};for(const r in e){const s=Number(r),o=IF[r];o&&(typeof o=="string"?n[o]=!0:o(t,e[r],s))}const i=t.state&&t.state.cache;if(i)for(const r in n){const s=BF[r];s(t,e,i)}}function kF(t,e){if(e=e||Km,typeof e=="number"){const r=e,s=Iv[r];return s?s(t,r):t.getParameter(r)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const r of n){const s=Iv[r];i[r]=s?s(t,Number(r)):t.getParameter(Number(r))}return i}function NF(t){xr(t,Km)}function gi(t,e,n){if(Nb(e))return n(t);const{nocatch:i=!0}=e;DF(t),xr(t,e);let r;if(i)r=n(t),Lv(t);else try{r=n(t)}finally{Lv(t)}return r}function La(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function e0(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=La(t),r=t.drawingBufferWidth,s=t.drawingBufferHeight;return GF(e,i,r,s,n)}function UF(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function GF(t,e,n,i,r){const s=Rv(t[0],e,n);let o=Ov(t[1],e,i,r),a=Rv(t[0]+1,e,n);const c=a===n-1?a:a-1;a=Ov(t[1]+1,e,i,r);let f;return r?(a=a===0?a:a+1,f=o,o=a):f=a===i-1?a:a-1,{x:s,y:o,width:Math.max(c-s+1,1),height:Math.max(f-o+1,1)}}function Rv(t,e,n){return Math.min(Math.round(t*e),n-1)}function Ov(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Zm=Br(),zF=Zm&&typeof document<"u",Gb={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function zb(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Cn(Zm,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},Gb,t);const{width:e,height:n}=t;function i(a){if(t.throwOnError)throw new Error(a);return console.error(a),null}t.onError=i;let r;const{canvas:s}=t,o=WF({canvas:s,width:e,height:n,onError:i});return r=jF(o,t),r?(r=qm(r,t),QF(r),r):null}function qm(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||XF(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Gb,e);const{manageState:n,debug:i}=e;return n&&Ub(t,{copyState:!1,log:function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return Se.log(1,...s)()}}),Zm&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Se.level=Math.max(Se.level,1)):Se.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function VF(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info"),r=i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936),s=i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937);return{vendor:r||e,renderer:s||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function HF(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const i=UF(e.useDevicePixels);JF(t,i,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function jF(t,e){const{onError:n}=e;let i=null;const r=c=>i=c.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:s=!0,webgl2:o=!0}=e;let a=null;return o&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),s&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(o&&!s?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}function WF(t){let{canvas:e,width:n=800,height:i=600,onError:r}=t,s;return typeof e=="string"?(zF&&document.readyState==="complete"||r("createGLContext called on canvas '".concat(e,"' before page was loaded")),s=document.getElementById(e)):e?s=e:(s=document.createElement("canvas"),s.id="lumagl-canvas",s.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",s.style.height=Number.isFinite(i)?"".concat(i,"px"):"100%",document.body.insertBefore(s,document.body.firstChild)),s}function QF(t){const e=We(t)?"WebGL2":"WebGL1",n=VF(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";Se.info(1,"".concat(e).concat(r," context ").concat(i))()}function XF(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function JF(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;(!i||!r)&&(Se.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==r||s.devicePixelRatio!==e){let o=e;const a=Math.floor(i*o),c=Math.floor(r*o);t.canvas.width=a,t.canvas.height=c,(t.drawingBufferWidth!==a||t.drawingBufferHeight!==c)&&(Se.warn("Device pixel ratio clamped")(),o=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*o),t.canvas.height=Math.floor(r*o)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}const sl="8.5.16",YF="set luma.log.level=1 (or higher) to trace rendering";class Vb{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new ql({id:e})),this.stats.get(e)}}const Qs=new Vb;if(globalThis.luma&&globalThis.luma.VERSION!==sl)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(sl));globalThis.luma||(Br()&&Se.log(1,"luma.gl ".concat(sl," - ").concat(YF))(),globalThis.luma=globalThis.luma||{VERSION:sl,version:sl,log:Se,stats:Qs,globals:{modules:{},nodeIO:{}}});function KF(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function ZF(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function pe(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function t0(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const i=t[e];return pe(i!==void 0,"Accessing undefined constant GL.".concat(e)),i}function hs(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const n0={};function rr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";n0[t]=n0[t]||1;const e=n0[t]++;return"".concat(t,"-").concat(e)}function Fv(t){return pe(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function Ra(t){let e=!0;for(const n in t){e=!1;break}return e}function Hb(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),s=Object.getPrototypeOf(t);i.forEach(o=>{s.methodName||(s[o]=()=>{throw Se.removed("Calling removed method ".concat(e,".").concat(o,": "),r)(),new Error(o)})})}const Lo="Resource subclass must define virtual methods";class Lr{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Mf(e);const{id:i,userData:r={}}=n;this.gl=e,this.gl2=e,this.id=i||rr(this[Symbol.toStringTag]),this.userData=r,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._initStats(),this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(i=>i.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=t0(this.gl,e),pe(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=We(this.gl);if(!((!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension)))){const a=r.webgl1,c="webgl2"in r?r.webgl2:r.webgl1;return s?c:a}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:i}=e,r=this.constructor.PARAMETERS||{},s=We(this.gl),o={},a=n||Object.keys(r);for(const c of a){const f=r[c];if(f&&(!("webgl2"in f)||s)&&(!("extension"in f)||this.gl.getExtension(f.extension))){const m=i?hs(this.gl,c):c;o[m]=this.getParameter(c,e),i&&f.type==="GLenum"&&(o[m]=hs(this.gl,o[m]))}}return o}setParameter(e,n){e=t0(this.gl,e),pe(e);const r=(this.constructor.PARAMETERS||{})[e];if(r){const s=We(this.gl);if(!((!("webgl2"in r)||s)&&(!("extension"in r)||this.gl.getExtension(r.extension))))throw new Error("Parameter not available on this platform");r.type==="GLenum"&&(n=t0(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,i){return Hb(this,e,n,i)}initialize(e){}_createHandle(){throw new Error(Lo)}_deleteHandle(){throw new Error(Lo)}_bindHandle(e){throw new Error(Lo)}_getOptsFromHandle(){throw new Error(Lo)}_getParameter(e,n){throw new Error(Lo)}_setParameter(e,n){throw new Error(Lo)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_initStats(){this.gl.stats=this.gl.stats||new Vb}_addStats(){const e=this[Symbol.toStringTag],n=Qs.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Qs.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._doTrackAllocatedMemory(e,n),this._doTrackAllocatedMemory(e,n,this.gl.stats.get("Memory Usage"))}_doTrackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Qs.get("Memory Usage");i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e),this.byteLength=e}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._doTrackDeallocatedMemory(e),this._doTrackDeallocatedMemory(e,this.gl.stats.get("Memory Usage"))}_doTrackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Qs.get("Memory Usage");n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(e," Memory")).subtractCount(this.byteLength),this.byteLength=0}}const qF="Failed to deduce GL constant from typed array";function sp(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(qF)}}function xl(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function $F(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:s}=t;const o=n*r;s=s||new Uint8Array(o);for(let a=0;a<i/2;++a){const c=a*o,f=(i-a-1)*o;s.set(e.subarray(c,c+o)),e.copyWithin(c,f,f+o),e.set(s,f)}}function eD(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),s=Math.round(i/2),o=new Uint8Array(r*s*4);for(let a=0;a<s;a++)for(let c=0;c<r;c++)for(let f=0;f<4;f++)o[(a*r+c)*4+f]=e[(a*2*n+c*2)*4+f];return{data:o,width:r,height:s}}function op(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:s={}}=n;for(const a in i)if(a in e){const f=i[a]?"".concat(t,".").concat(i[a]):"N/A";Se.removed("".concat(t,".").concat(a),f)()}for(const a in r)if(a in e){const c=r[a];Se.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))()}let o=null;for(const a in s)if(a in e){const c=s[a];Se.deprecated("".concat(t,".").concat(a),"".concat(t,".").concat(c))(),o=o||Object.assign({},e),o[c]=e[a],delete o[a]}return o||e}const tD={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},nD={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class Rn{static getBytesPerElement(e){return xl(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return pe(e.size),xl(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new Rn(tD,...n)}constructor(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return Rn.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return Rn.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=op("Accessor",e,nD),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const Dv=10,jb={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},iD={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:jb},rD={removedProps:jb};class ct extends Lr{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Rn.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/Rn.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=op("Buffer",e,iD),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=op("Buffer",e,rD),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new Rn(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:i=0,srcOffset:r=0}=e,s=e.byteLength||e.length;pe(n);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),r!==0||s!==void 0?(mn(this.gl),this.gl.bufferSubData(this.target,i,n,r,s)):this.gl.bufferSubData(o,i,n),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:i=0,writeOffset:r=0,size:s}=e;const{gl:o}=this;return mn(o),o.bindBuffer(36662,n.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,i,r,s),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:i=0,length:r=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};mn(this.gl);const s=xl(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(n),a=i;let c,f;e?(f=e.length,c=f-a):(c=Math.min(o,r||o),f=a+c);const p=Math.min(o,c);return r=r||p,pe(r<=p),e=e||new s(f),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,i,r),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:i=0,size:r}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?r!==void 0?this.gl.bindBufferRange(e,n,this.handle,i,r):(pe(i===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(Dv,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;pe(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,this.usage),this.gl.bufferSubData(r,n,e),this.gl.bindBuffer(r,null),this.debugData=e.slice(0,Dv),this.bytesUsed=i,this._trackAllocatedMemory(i);const s=sp(e);return pe(s),this.setAccessor(new Rn(this.accessor,{type:s})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;pe(e>=0),this._trackDeallocatedMemory();let i=e;e===0&&(i=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,i,n),this.gl.bindBuffer(r,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=xl(this.accessor.type||5126,{clamped:!1}),i=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-i}_inferType(e){this.accessor.type||this.setAccessor(new Rn(this.accessor,{type:sp(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Se.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Se.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Se.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Se.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new Rn(this.accessor,e),this}}const $m={[6407]:{dataFormat:6407,types:[5121,33635]},[6408]:{dataFormat:6408,types:[5121,32819,32820]},[6406]:{dataFormat:6406,types:[5121]},[6409]:{dataFormat:6409,types:[5121]},[6410]:{dataFormat:6410,types:[5121]},[33326]:{dataFormat:6403,types:[5126],gl2:!0},[33328]:{dataFormat:33319,types:[5126],gl2:!0},[34837]:{dataFormat:6407,types:[5126],gl2:!0},[34836]:{dataFormat:6408,types:[5126],gl2:!0}},Wb={[6403]:1,[36244]:1,[33319]:2,[33320]:2,[6407]:3,[36248]:3,[6408]:4,[36249]:4,[6402]:1,[34041]:1,[6406]:1,[6409]:1,[6410]:2},Qb={[5126]:4,[5125]:4,[5124]:4,[5123]:2,[5122]:2,[5131]:2,[5120]:1,[5121]:1};function sD(t,e){const n=$m[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const i=We(t)&&n.gl2||n.gl1;return typeof i=="string"?t.getExtension(i):i}function oD(t,e){const n=$m[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const aD=[9729,9728],kv=globalThis.WebGLBuffer||function(){};class ro extends Lr{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:i,linearFiltering:r}=n;let s=!0;return i&&(s=s&&sD(e,i),s=s&&(!r||oD(e,i))),s}constructor(e,n){const{id:i=rr("texture"),handle:r,target:s}=n;super(e,{id:i,handle:r}),this.target=s,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(P=>this.initialize(Object.assign({},e,{pixels:P,data:P}))),this;const i=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(i&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:r=null,format:s=6408,border:o=0,recreate:a=!1,parameters:c={},pixelStore:f={},textureUnit:p=void 0}=e;n||(n=r);let{width:m,height:v,dataFormat:w,type:C,compressed:S=!1,mipmaps:R=!0}=e;const{depth:x=0}=e;return{width:m,height:v,compressed:S,dataFormat:w,type:C}=this._deduceParameters({format:s,type:C,dataFormat:w,compressed:S,data:n,width:m,height:v}),this.width=m,this.height=v,this.depth=x,this.format=s,this.type=C,this.dataFormat=w,this.border=o,this.textureUnit=p,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),R&&this._isNPOT()&&(Se.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),R=!1,this._updateForNPOT(c)),this.mipmaps=R,this.setImageData({data:n,width:m,height:v,depth:x,format:s,type:C,dataFormat:w,border:o,mipmaps:R,parameters:f,compressed:S}),R&&this.generateMipmap(),this.setParameters(c),a&&(this.data=n),i&&(this._video={video:n,parameters:c,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:i}=this._video;if(i===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:i,mipmaps:r=!1}=e;return i!==this.width||n!==this.height?this.initialize({width:i,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:r}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Se.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),gi(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:i=null,level:r=0,format:s=this.format,border:o=this.border,offset:a=0,parameters:c={}}=e;let{data:f=null,type:p=this.type,width:m=this.width,height:v=this.height,dataFormat:w=this.dataFormat,compressed:C=!1}=e;f||(f=i),{type:p,dataFormat:w,compressed:C,width:m,height:v}=this._deduceParameters({format:s,type:p,dataFormat:w,compressed:C,data:f,width:m,height:v});const{gl:S}=this;S.bindTexture(this.target,this.handle);let R=null;({data:f,dataType:R}=this._getDataType({data:f,compressed:C}));let x,P=0;if(gi(this.gl,c,()=>{switch(R){case"null":S.texImage2D(n,r,s,m,v,o,w,p,f);break;case"typed-array":S.texImage2D(n,r,s,m,v,o,w,p,f,a);break;case"buffer":x=mn(S),x.bindBuffer(35052,f.handle||f),x.texImage2D(n,r,s,m,v,o,w,p,a),x.bindBuffer(35052,null);break;case"browser-object":We(S)?S.texImage2D(n,r,s,m,v,o,w,p,f):S.texImage2D(n,r,s,w,p,f);break;case"compressed":for(const[I,F]of f.entries())S.compressedTexImage2D(n,I,F.format,F.width,F.height,o,F.data),P+=F.levelSize;break;default:pe(!1,"Unknown image data type")}}),R==="compressed")this._trackAllocatedMemory(P,"Texture");else if(f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const I=Wb[this.dataFormat]||4,F=Qb[this.type]||1;this._trackAllocatedMemory(this.width*this.height*I*F,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:i=null,data:r=null,x:s=0,y:o=0,width:a=this.width,height:c=this.height,level:f=0,format:p=this.format,type:m=this.type,dataFormat:v=this.dataFormat,compressed:w=!1,offset:C=0,border:S=this.border,parameters:R={}}=e;if({type:m,dataFormat:v,compressed:w,width:a,height:c}=this._deduceParameters({format:p,type:m,dataFormat:v,compressed:w,data:r,width:a,height:c}),pe(this.depth===0,"texSubImage not supported for 3D textures"),r||(r=i),r&&r.data){const x=r;r=x.data,a=x.shape[0],c=x.shape[1]}r instanceof ct&&(r=r.handle),this.gl.bindTexture(this.target,this.handle),gi(this.gl,R,()=>{if(w)this.gl.compressedTexSubImage2D(n,f,s,o,a,c,p,r);else if(r===null)this.gl.texSubImage2D(n,f,s,o,a,c,v,m,null);else if(ArrayBuffer.isView(r))this.gl.texSubImage2D(n,f,s,o,a,c,v,m,r,C);else if(r instanceof kv){const x=mn(this.gl);x.bindBuffer(35052,r),x.texSubImage2D(n,f,s,o,a,c,v,m,C),x.bindBuffer(35052,null)}else We(this.gl)?mn(this.gl).texSubImage2D(n,f,s,o,a,c,v,m,r):this.gl.texSubImage2D(n,f,s,o,v,m,r)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Se.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:i=!1}=e;return i?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ct?{data:n.handle,dataType:"buffer"}:n instanceof kv?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:i}=e;let{width:r,height:s,dataFormat:o,type:a,compressed:c}=e;const f=$m[n];return o=o||f&&f.dataFormat,a=a||f&&f.types[0],c=c||f&&f.compressed,{width:r,height:s}=this._deduceImageSize(i,r,s),{dataFormat:o,type:a,compressed:c,width:r,height:s,format:n,data:i}}_deduceImageSize(e,n,i){let r;return typeof ImageData<"u"&&e instanceof ImageData?r={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?r={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?r={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?r={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?r={width:e.videoWidth,height:e.videoHeight}:e?r={width:n,height:i}:r={width:n>=0?n:1,height:i>=0?i:1},pe(r,"Could not deduced texture size"),pe(n===void 0||r.width===n,"Deduced texture width does not match supplied width"),pe(i===void 0||r.height===i,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:pe(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return We(this.gl)||!this.width||!this.height?!1:!Fv(this.width)||!Fv(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:aD.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let AD="";function lD(t,e){return pe(typeof t=="string"),t=AD+t,new Promise((n,i)=>{try{const r=new Image;r.onload=()=>n(r),r.onerror=()=>i(new Error("Could not load image ".concat(t,"."))),r.crossOrigin=e&&e.crossOrigin||"anonymous",r.src=t}catch(r){i(r)}})}class vn extends ro{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return ro.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Mf(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:lD(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const ap=[34069,34070,34071,34072,34073,34074];class Xb extends ro{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Mf(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:i={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(i)}),this}subImage(e){let{face:n,data:i,x:r=0,y:s=0,mipmapLevel:o=0}=e;return this._subImage({target:n,data:i,x:r,y:s,mipmapLevel:o})}async setCubeMapImageData(e){let{width:n,height:i,pixels:r,data:s,border:o=0,format:a=6408,type:c=5121}=e;const{gl:f}=this,p=r||s,m=await Promise.all(ap.map(v=>{const w=p[v];return Promise.all(Array.isArray(w)?w:[w])}));this.bind(),ap.forEach((v,w)=>{m[w].length>1&&this.opts.mipmaps!==!1&&Se.warn("".concat(this.id," has mipmap and multiple LODs."))(),m[w].forEach((C,S)=>{n&&i?f.texImage2D(v,S,a,n,i,o,a,c,C):f.texImage2D(v,S,a,a,c,C)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:i,height:r,pixels:s,data:o,border:a=0,format:c=6408,type:f=5121}=e,{gl:p}=this,m=s||o;return this.bind(),m instanceof Promise?m.then(v=>this.setImageDataForFace(Object.assign({},e,{face:n,data:v,pixels:v}))):this.width||this.height?p.texImage2D(n,0,c,i,r,a,c,f,m):p.texImage2D(n,0,c,c,f,m),this}}Xb.FACES=ap;class cD extends ro{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return We(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mn(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:i=6408,width:r,height:s,depth:o=1,border:a=0,format:c,type:f=5121,offset:p=0,data:m,parameters:v={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),gi(this.gl,v,()=>{ArrayBuffer.isView(m)&&this.gl.texImage3D(this.target,n,i,r,s,o,a,c,f,m),m instanceof ct&&(this.gl.bindBuffer(35052,m.handle),this.gl.texImage3D(this.target,n,i,r,s,o,a,c,f,p))}),m&&m.byteLength)this._trackAllocatedMemory(m.byteLength,"Texture");else{const w=Wb[this.dataFormat]||4,C=Qb[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*w*C,"Texture")}return this.loaded=!0,this}}const Os="EXT_color_buffer_float",Nv={[33189]:{bpp:2},[33190]:{gl2:!0,bpp:3},[36012]:{gl2:!0,bpp:4},[36168]:{bpp:1},[34041]:{bpp:4},[35056]:{gl2:!0,bpp:4},[36013]:{gl2:!0,bpp:5},[32854]:{bpp:2},[36194]:{bpp:2},[32855]:{bpp:2},[33321]:{gl2:!0,bpp:1},[33330]:{gl2:!0,bpp:1},[33329]:{gl2:!0,bpp:1},[33332]:{gl2:!0,bpp:2},[33331]:{gl2:!0,bpp:2},[33334]:{gl2:!0,bpp:4},[33333]:{gl2:!0,bpp:4},[33323]:{gl2:!0,bpp:2},[33336]:{gl2:!0,bpp:2},[33335]:{gl2:!0,bpp:2},[33338]:{gl2:!0,bpp:4},[33337]:{gl2:!0,bpp:4},[33340]:{gl2:!0,bpp:8},[33339]:{gl2:!0,bpp:8},[32849]:{gl2:!0,bpp:3},[32856]:{gl2:!0,bpp:4},[32857]:{gl2:!0,bpp:4},[36220]:{gl2:!0,bpp:4},[36238]:{gl2:!0,bpp:4},[36975]:{gl2:!0,bpp:4},[36214]:{gl2:!0,bpp:8},[36232]:{gl2:!0,bpp:8},[36226]:{gl2:!0,bpp:16},[36208]:{gl2:!0,bpp:16},[33325]:{gl2:Os,bpp:2},[33327]:{gl2:Os,bpp:4},[34842]:{gl2:Os,bpp:8},[33326]:{gl2:Os,bpp:4},[33328]:{gl2:Os,bpp:8},[34836]:{gl2:Os,bpp:16},[35898]:{gl2:Os,bpp:4}};function uD(t,e,n){const i=n[e];if(!i)return!1;const r=We(t)&&i.gl2||i.gl1;return typeof r=="string"?t.getExtension(r):r}class ta extends Lr{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||uD(e,n,Nv)}static getSamplesForFormat(e,n){let{format:i}=n;return e.getInternalformatParameter(36161,i,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:i=1,height:r=1,samples:s=0}=e;return pe(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),s!==0&&We(this.gl)?this.gl.renderbufferStorageMultisample(36161,s,n,i,r):this.gl.renderbufferStorage(36161,n,i,r),this.format=n,this.width=i,this.height=r,this.samples=s,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Nv[this.format].bpp),this}resize(e){let{width:n,height:i}=e;return n!==this.width||i!==this.height?this.initialize({width:n,height:i,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const hD=256,fD=1024,dD=16384,Uv=6144,Gv=6145,zv=6146,Vv=34041,Jb="clear: bad arguments";function e1(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s={};e&&(s.framebuffer=e);let o=0;n&&(o|=dD,n!==!0&&(s.clearColor=n)),i&&(o|=hD,i!==!0&&(s.clearDepth=i)),r&&(o|=fD,i!==!0&&(s.clearStencil=i)),pe(o!==0,Jb),gi(t,s,()=>{t.clear(o)})}function gD(t){let{framebuffer:e=null,buffer:n=Uv,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mn(t),gi(t,{framebuffer:e},()=>{switch(n){case Uv:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case Gv:t.clearBufferfv(Gv,0,[r]);break;case zv:t.clearBufferiv(zv,0,[r]);break;case Vv:const[s,o]=r;t.clearBufferfi(Vv,0,s,o);break;default:pe(!1,Jb)}})}function pD(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return pe(!1),0}}function If(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:s=36064,target:o=null,sourceWidth:a,sourceHeight:c,sourceType:f}=e;const{framebuffer:p,deleteFramebuffer:m}=Yb(t);pe(p);const{gl:v,handle:w,attachments:C}=p;a=a||p.width,c=c||p.height,s===36064&&w===null&&(s=1028),pe(C[s]),f=f||C[s].type,o=_D(o,f,r,a,c),f=f||sp(o);const S=v.bindFramebuffer(36160,w);return v.readPixels(n,i,a,c,r,f,o),v.bindFramebuffer(36160,S||null),m&&p.delete(),o}function Hv(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=If(t,{sourceAttachment:e}),{width:r,height:s}=t;for(;s>n;)({data:i,width:r,height:s}=eD({data:i,width:r,height:s}));$F({data:i,width:r,height:s});const o=document.createElement("canvas");o.width=r,o.height=s;const a=o.getContext("2d"),c=a.createImageData(r,s);return c.data.set(i),a.putImageData(c,0,0),o.toDataURL()}function mD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:s=0,targetInternalFormat:o=6408}=n;let{targetX:a,targetY:c,targetZ:f,width:p,height:m}=n;const{framebuffer:v,deleteFramebuffer:w}=Yb(t);pe(v);const{gl:C,handle:S}=v,R=typeof a<"u"||typeof c<"u"||typeof f<"u";a=a||0,c=c||0,f=f||0;const x=C.bindFramebuffer(36160,S);pe(e);let P=null;if(e instanceof ro&&(P=e,p=Number.isFinite(p)?p:P.width,m=Number.isFinite(m)?m:P.height,P.bind(0),e=P.target),!R)C.copyTexImage2D(e,s,o,i,r,p,m,0);else switch(e){case 3553:case 34067:C.copyTexSubImage2D(e,s,a,c,i,r,p,m);break;case 35866:case 32879:mn(C).copyTexSubImage3D(e,s,a,c,f,i,r,p,m);break}return P&&P.unbind(),C.bindFramebuffer(36160,x||null),w&&v.delete(),P}function Yb(t){return t instanceof jt?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:SD(t),deleteFramebuffer:!0}}function _D(t,e,n,i,r){if(t)return t;e=e||5121;const s=xl(e,{clamped:!1}),o=pD(n);return new s(i*r*o)}const ft={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function yD(t){const e=new vn(t,{format:6408,type:5126,dataFormat:6408}),n=new jt(t,{id:"test-framebuffer",check:!1,attachments:{[36064]:e}}),i=n.getStatus();return e.delete(),n.delete(),i===36053}const Kb={[ft.WEBGL2]:[!1,!0],[ft.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[ft.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[ft.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[ft.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[ft.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[ft.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[ft.FLOAT_BLEND]:["EXT_float_blend"],[ft.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[ft.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[ft.TEXTURE_FLOAT]:["OES_texture_float",!0],[ft.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[ft.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[ft.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[ft.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[ft.COLOR_ATTACHMENT_RGBA32F]:[yD,"EXT_color_buffer_float"],[ft.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[ft.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[ft.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[ft.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[ft.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[ft.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},vD=2;function Bf(t,e){return t1(t,e)}function t1(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>Zb(t,n))}function ED(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Kb)t.luma.caps[e]===void 0&&(t.luma.caps[e]=Zb(t,e));return t.luma.caps}function Zb(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=wD(t,e)),t.luma.caps[e]||Se.log(vD,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function wD(t,e){const n=Kb[e];pe(n,e);let i;const r=We(t)&&n[1]||n[0];if(typeof r=="function")i=r(t);else if(Array.isArray(r)){i=!0;for(const s of r)i=i&&Boolean(t.getExtension(s))}else typeof r=="string"?i=Boolean(t.getExtension(r)):typeof r=="boolean"?i=r:pe(!1);return i}const jv="Multiple render targets not supported";class jt extends Lr{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:i,colorBufferHalfFloat:r}=n;let s=!0;return i&&(s=Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),r&&(s=s&&Boolean(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),s}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new jt(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=mn(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=mn(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:i=1,attachments:r=null,color:s=!0,depth:o=!0,stencil:a=!1,check:c=!0,readBuffer:f=void 0,drawBuffers:p=void 0}=e;if(pe(n>=0&&i>=0,"Width and height need to be integers"),this.width=n,this.height=i,r)for(const m in r){const v=r[m];(Array.isArray(v)?v[0]:v).resize({width:n,height:i})}else r=this._createDefaultAttachments(s,o,a,n,i);this.update({clearAttachments:!0,attachments:r,readBuffer:f,drawBuffers:p}),r&&c&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:i,drawBuffers:r,clearAttachments:s=!1,resizeAttachments:o=!0}=e;this.attach(n,{clearAttachments:s,resizeAttachments:o});const{gl:a}=this,c=a.bindFramebuffer(36160,this.handle);return i&&this._setReadBuffer(i),r&&this._setDrawBuffers(r),a.bindFramebuffer(36160,c||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:i}=e;if(this.handle===null)return pe(n===void 0&&i===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),i===void 0&&(i=this.gl.drawingBufferHeight),n!==this.width&&i!==this.height&&Se.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(i))();for(const r in this.attachments)this.attachments[r].resize({width:n,height:i});return this.width=n,this.height=i,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:i=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r={};n&&Object.keys(this.attachments).forEach(o=>{r[o]=null}),Object.assign(r,e);const s=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){pe(o!==void 0,"Misspelled framebuffer binding point?");const a=Number(o),c=r[a];let f=c;if(!f)this._unattach(a);else if(f instanceof ta)this._attachRenderbuffer({attachment:a,renderbuffer:f});else if(Array.isArray(c)){const[p,m=0,v=0]=c;f=p,this._attachTexture({attachment:a,texture:p,layer:m,level:v})}else this._attachTexture({attachment:a,texture:f,layer:0,level:0});i&&f&&f.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,s||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(o=>!this.attachments[o]).forEach(o=>{delete this.attachments[o]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(CD(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),i=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),i}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:i,stencil:r,drawBuffers:s=[]}=e,o=this.gl.bindFramebuffer(36160,this.handle);return(n||i||r)&&e1(this.gl,{color:n,depth:i,stencil:r}),s.forEach((a,c)=>{gD(this.gl,{drawBuffer:c,value:a})}),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return Se.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Se.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Se.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Se.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Se.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Se.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:i=0,y:r=0,width:s,height:o}=e;const a=mn(this.gl),c=a.bindFramebuffer(36008,this.handle);return i===0&&r===0&&s===void 0&&o===void 0?a.invalidateFramebuffer(36008,n):a.invalidateFramebuffer(36008,n,i,r,s,o),a.bindFramebuffer(36008,c),this}getAttachmentParameter(e,n,i){let r=this._getAttachmentParameterFallback(n);return r===null&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),i&&r>1e3&&(r=hs(this.gl,r)),r}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const r={};for(const s of i){const o=n?hs(this.gl,s):s;r[o]=this.getAttachmentParameter(e,s,n)}return r}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),i={};for(const r of n){const s=Number(r),o=e?hs(this.gl,s):s;i[o]=this.getAttachmentParameters(s,e)}return i}show(){return typeof window<"u"&&window.open(Hv(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Se.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const i=Hv(this,{targetMaxHeight:100});return Se.image({logLevel:e,message:n,image:i},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,i,r,s){let o=null;return e&&(o=o||{},o[36064]=new vn(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:r,height:s,mipmaps:!1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.ownResources.push(o[36064])),n&&i?(o=o||{},o[33306]=new ta(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:r,height:111}),this.ownResources.push(o[33306])):n?(o=o||{},o[36096]=new ta(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:r,height:s}),this.ownResources.push(o[36096])):i&&pe(!1),o}_unattach(e){const n=this.attachments[e];!n||(n instanceof ta?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:i}=e;const{gl:r}=this;r.framebufferRenderbuffer(36160,n,36161,i.handle),this.attachments[n]=i}_attachTexture(e){let{attachment:n=36064,texture:i,layer:r,level:s}=e;const{gl:o}=this;switch(o.bindTexture(i.target,i.handle),i.target){case 35866:case 32879:mn(o).framebufferTextureLayer(36160,n,i.target,s,r);break;case 34067:const c=TD(r);o.framebufferTexture2D(36160,n,c,i.handle,s);break;case 3553:o.framebufferTexture2D(36160,n,3553,i.handle,s);break;default:pe(!1,"Illegal texture type")}o.bindTexture(i.target,null),this.attachments[n]=i}_setReadBuffer(e){const n=eF(this.gl);n?n.readBuffer(e):pe(e===36064||e===1029,jv),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,i=mn(n);if(i)i.drawBuffers(e);else{const r=n.getExtension("WEBGL_draw_buffers");r?r.drawBuffersWEBGL(e):pe(e.length===1&&(e[0]===36064||e[0]===1029),jv)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=ED(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function TD(t){return t<34069?t+34069:t}function CD(t){return(jt.STATUS||{})[t]||"Framebuffer error ".concat(t)}const bD=[36049,36048,33296,33298,33299,33300,33301,33302,33303];jt.ATTACHMENT_PARAMETERS=bD;function qb(t,e){pe(t instanceof vn||t instanceof Xb||t instanceof cD);const n=t.constructor,{gl:i,width:r,height:s,format:o,type:a,dataFormat:c,border:f,mipmaps:p}=t,m=Object.assign({width:r,height:s,format:o,type:a,dataFormat:c,border:f,mipmaps:p},e);return new n(i,m)}function SD(t,e){const{gl:n,width:i,height:r,id:s}=t;return new jt(n,Object.assign({},e,{id:"framebuffer-for-".concat(s),width:i,height:r,attachments:{[36064]:t}}))}function Zu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,i=t.match(n);return i?i[1]:e}const xD=35632,PD=35633;function MD(t){switch(t){case xD:return"fragment";case PD:return"vertex";default:return"unknown type"}}function ID(t,e,n,i){const r=t.split(/\r?\n/),s={},o={},a=i||Zu(e)||"(unnamed)",c="".concat(MD(n)," shader ").concat(a);for(let p=0;p<r.length;p++){const m=r[p];if(m.length<=1)continue;const v=m.split(":"),w=v[0],C=parseInt(v[2],10);if(isNaN(C))throw new Error("GLSL compilation error in ".concat(c,": ").concat(t));w!=="WARNING"?s[C]=m:o[C]=m}const f=BD(e);return{shaderName:c,errors:Wv(s,f),warnings:Wv(o,f)}}function Wv(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if(!(!t[i+3]&&!t[i+2]&&!t[i+1])&&(n+="".concat(r,`
`),t[i+1])){const s=t[i+1],o=s.split(":",3),a=o[0],c=parseInt(o[1],10)||0,f=s.substring(o.join(":").length+1).trim();n+=$b("^^^ ".concat(a,": ").concat(f,`

`),c)}}return n}function BD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map((s,o)=>{const a=String(o+e),c=a.length;return $b(a,r-c)+n+s})}function $b(t,e){let n="";for(let i=0;i<e;++i)n+=" ";return"".concat(n).concat(t)}function eS(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const i=parseInt(n[1],10);Number.isFinite(i)&&(e=i)}return e}const LD="Shader: GLSL source code must be a JavaScript string";class Pl extends Lr{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return pe(!1),"unknown"}}constructor(e,n){Mf(e),pe(typeof n.source=="string",LD);const i=Zu(n.source,null)||n.id||rr("unnamed ".concat(Pl.getTypeName(n.shaderType)));super(e,{id:i}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const i=Zu(n,null);i&&(this.id=rr(i)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(Pl.getTypeName(this.shaderType),":").concat(this.id)}getName(){return Zu(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const i=this.gl.getShaderInfoLog(this.handle),{shaderName:r,errors:s,warnings:o}=ID(i,this.source,this.shaderType,this.id);throw Se.error("GLSL compilation errors in ".concat(r,`
`).concat(s))(),Se.warn("GLSL compilation warnings in ".concat(r,`
`).concat(o))(),new Error("GLSL compilation errors in ".concat(r))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class i0 extends Pl{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class r0 extends Pl{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const RD={[5126]:vt.bind(null,"uniform1fv",Wn,1,fn),[35664]:vt.bind(null,"uniform2fv",Wn,2,fn),[35665]:vt.bind(null,"uniform3fv",Wn,3,fn),[35666]:vt.bind(null,"uniform4fv",Wn,4,fn),[5124]:vt.bind(null,"uniform1iv",Hr,1,fn),[35667]:vt.bind(null,"uniform2iv",Hr,2,fn),[35668]:vt.bind(null,"uniform3iv",Hr,3,fn),[35669]:vt.bind(null,"uniform4iv",Hr,4,fn),[35670]:vt.bind(null,"uniform1iv",Hr,1,fn),[35671]:vt.bind(null,"uniform2iv",Hr,2,fn),[35672]:vt.bind(null,"uniform3iv",Hr,3,fn),[35673]:vt.bind(null,"uniform4iv",Hr,4,fn),[35674]:vt.bind(null,"uniformMatrix2fv",Wn,4,hr),[35675]:vt.bind(null,"uniformMatrix3fv",Wn,9,hr),[35676]:vt.bind(null,"uniformMatrix4fv",Wn,16,hr),[35678]:sn,[35680]:sn,[5125]:vt.bind(null,"uniform1uiv",tu,1,fn),[36294]:vt.bind(null,"uniform2uiv",tu,2,fn),[36295]:vt.bind(null,"uniform3uiv",tu,3,fn),[36296]:vt.bind(null,"uniform4uiv",tu,4,fn),[35685]:vt.bind(null,"uniformMatrix2x3fv",Wn,6,hr),[35686]:vt.bind(null,"uniformMatrix2x4fv",Wn,8,hr),[35687]:vt.bind(null,"uniformMatrix3x2fv",Wn,6,hr),[35688]:vt.bind(null,"uniformMatrix3x4fv",Wn,12,hr),[35689]:vt.bind(null,"uniformMatrix4x2fv",Wn,8,hr),[35690]:vt.bind(null,"uniformMatrix4x3fv",Wn,12,hr),[35678]:sn,[35680]:sn,[35679]:sn,[35682]:sn,[36289]:sn,[36292]:sn,[36293]:sn,[36298]:sn,[36299]:sn,[36300]:sn,[36303]:sn,[36306]:sn,[36307]:sn,[36308]:sn,[36311]:sn},OD={},FD={},DD={},Qv=[0];function n1(t,e,n,i){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(Qv[0]=t,t=Qv);const r=t.length;if(r%e&&Se.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let s=i[r];s||(s=new n(r),i[r]=s);for(let o=0;o<r;o++)s[o]=t[o];return s}function Wn(t,e){return n1(t,e,Float32Array,OD)}function Hr(t,e){return n1(t,e,Int32Array,FD)}function tu(t,e){return n1(t,e,Uint32Array,DD)}function Xv(t,e,n){const i=RD[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function kD(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:Boolean(n[2])}}function ND(t,e,n){for(const i in t){const r=t[i];if((!n||Boolean(n[i]))&&!UD(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}return!0}function UD(t){return Array.isArray(t)||ArrayBuffer.isView(t)?zD(t):isFinite(t)||t===!0||t===!1||t instanceof ro||t instanceof ta?!0:t instanceof jt?Boolean(t.texture):!1}function GD(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let r=0,s=n.length;r<s;++r)i[r]=n[r]}else t[e]=n.slice();else t[e]=n}function zD(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function sn(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function vt(t,e,n,i){let r=null,s=null;return(o,a,c)=>{const f=e(c,n),p=f.length;let m=!1;if(r===null)r=new Float32Array(p),s=p,m=!0;else{pe(s===p,"Uniform length cannot change.");for(let v=0;v<p;++v)if(f[v]!==r[v]){m=!0;break}}return m&&(i(o,t,a,f),r.set(f)),m}}function fn(t,e,n,i){t[e](n,i)}function hr(t,e,n,i){t[e](n,!1,i)}const VD=5120,HD=5121,jD=5122,WD=5123,Jv=0,nu=1,QD=2,XD=3,iu=4,JD=5,YD=6,Jt=5126,KD=35664,ZD=35665,qD=35666,CA=5124,$D=35667,e4=35668,t4=35669,bA=5125,n4=36294,i4=36295,r4=36296,s4=35670,o4=35671,a4=35672,A4=35673,l4=35674,c4=35675,u4=35676,h4=35685,f4=35686,d4=35687,g4=35688,p4=35689,m4=35690,Ap={[Jt]:[Jt,1,"float"],[KD]:[Jt,2,"vec2"],[ZD]:[Jt,3,"vec3"],[qD]:[Jt,4,"vec4"],[CA]:[CA,1,"int"],[$D]:[CA,2,"ivec2"],[e4]:[CA,3,"ivec3"],[t4]:[CA,4,"ivec4"],[bA]:[bA,1,"uint"],[n4]:[bA,2,"uvec2"],[i4]:[bA,3,"uvec3"],[r4]:[bA,4,"uvec4"],[s4]:[Jt,1,"bool"],[o4]:[Jt,2,"bvec2"],[a4]:[Jt,3,"bvec3"],[A4]:[Jt,4,"bvec4"],[l4]:[Jt,8,"mat2"],[h4]:[Jt,8,"mat2x3"],[f4]:[Jt,8,"mat2x4"],[c4]:[Jt,12,"mat3"],[d4]:[Jt,12,"mat3x2"],[g4]:[Jt,12,"mat3x4"],[u4]:[Jt,16,"mat4"],[p4]:[Jt,16,"mat4x2"],[m4]:[Jt,16,"mat4x3"]};function _4(t){switch(t){case Jv:return Jv;case nu:return nu;case XD:return nu;case QD:return nu;case iu:return iu;case JD:return iu;case YD:return iu;default:return pe(!1),0}}function Yv(t){const e=Ap[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function tS(t,e){switch(t){case VD:case HD:case jD:case WD:t=Jt;break}for(const n in Ap){const[i,r,s]=Ap[n];if(i===t&&r===e)return{glType:n,name:s}}return null}class y4{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,i=n.getProgramParameter(e.handle,35721);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=n.getActiveAttrib(e.handle,r),c=n.getAttribLocation(e.handle,s);c>=0&&this._addAttribute(c,s,o,a)}this.attributeInfos.sort((r,s)=>r.location-s.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!We(n))return;const i=n.getProgramParameter(e.handle,35971);for(let r=0;r<i;r++){const{name:s,type:o,size:a}=n.getTransformFeedbackVarying(e.handle,r);this._addVarying(r,s,o,a)}this.varyingInfos.sort((r,s)=>r.location-s.location)}_addAttribute(e,n,i,r){const{type:s,components:o}=Yv(i),a={type:s,size:r*o};this._inferProperties(e,n,a);const c={location:e,name:n,accessor:new Rn(a)};this.attributeInfos.push(c),this.attributeInfosByLocation[e]=c,this.attributeInfosByName[c.name]=c}_inferProperties(e,n,i){/instance/i.test(n)&&(i.divisor=1)}_addVarying(e,n,i,r){const{type:s,components:o}=Yv(i),a=new Rn({type:s,size:r*o}),c={location:e,name:n,accessor:a};this.varyingInfos.push(c),this.varyingInfosByName[c.name]=c}}const Kv=4,v4=35981,E4=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class nS extends Lr{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",E4),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:i,fs:r,varyings:s,bufferMode:o=v4}=e;return this.hash=n||"",this.vs=typeof i=="string"?new i0(this.gl,{id:"".concat(e.id,"-vs"),source:i}):i,this.fs=typeof r=="string"?new r0(this.gl,{id:"".concat(e.id,"-fs"),source:r}):r,pe(this.vs instanceof i0),pe(this.fs instanceof r0),this.uniforms={},this._textureUniforms={},s&&s.length>0&&(mn(this.gl),this.varyings=s,this.gl2.transformFeedbackVaryings(this.handle,s,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new y4(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:i=4,vertexCount:r,offset:s=0,start:o,end:a,isIndexed:c=!1,indexType:f=5123,instanceCount:p=0,isInstanced:m=p>0,vertexArray:v=null,transformFeedback:w,framebuffer:C,parameters:S={},uniforms:R,samplers:x}=e;if((R||x)&&(Se.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(R||{})),Se.priority>=n){const P=C?C.id:"default",I="mode=".concat(hs(this.gl,i)," verts=").concat(r," ")+"instances=".concat(p," indexType=").concat(hs(this.gl,f)," ")+"isInstanced=".concat(m," isIndexed=").concat(c," ")+"Framebuffer=".concat(P);Se.log(n,I)()}return pe(v),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||r===0||m&&p===0?!1:(v.bindForDraw(r,p,()=>{if(C!==void 0&&(S=Object.assign({},S,{framebuffer:C})),w){const P=_4(i);w.begin(P)}this._bindTextures(),gi(this.gl,S,()=>{c&&m?this.gl2.drawElementsInstanced(i,r,f,s,p):c&&We(this.gl)&&!isNaN(o)&&!isNaN(a)?this.gl2.drawRangeElements(i,o,a,r,f,s):c?this.gl.drawElements(i,r,f,s):m?this.gl2.drawArraysInstanced(i,s,r,p):this.gl.drawArrays(i,s,r)}),w&&w.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Se.priority>=2&&ND(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const i=e[n],r=this._uniformSetters[n];if(r){let s=i,o=!1;if(s instanceof jt&&(s=s.texture),s instanceof ro)if(o=this.uniforms[n]!==i,o){r.textureIndex===void 0&&(r.textureIndex=this._textureIndexCounter++);const a=s,{textureIndex:c}=r;a.bind(c),s=c,this._textureUniforms[n]=a}else s=r.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(r(s)||o)&&GD(this.uniforms,n,i)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const i=this._textureUniforms[n];i.update(),e=e&&i.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),i={};for(const r of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:i.vs=new i0({handle:r});break;case 35632:i.fs=new r0({handle:r});break}return i}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=rr(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Se.time(Kv,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Se.timeEnd(Kv,"linkProgram for ".concat(this._getName()))(),e.debug||Se.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const i=this.gl.getActiveUniform(this.handle,n),{name:r}=kD(i.name);let s=e.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=Xv(e,s,i),i.size>1)for(let o=0;o<i.size;o++)s=e.getUniformLocation(this.handle,"".concat(r,"[").concat(o,"]")),this._uniformSetters["".concat(r,"[").concat(o,"]")]=Xv(e,s,i)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const w4=34918,T4=34919,C4=35007,b4=36795,S4=35976,x4=35887,P4=36202;class kh extends Lr{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=We(e),r=t1(e,ft.TIMER_QUERY);let s=i||r;for(const o of n)switch(o){case"queries":s=s&&i;break;case"timers":s=s&&r;break;default:pe(!1)}return s}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(C4)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?P4:x4)}beginTransformFeedbackQuery(){return this.begin(S4)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,T4);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(b4)}getResult(){return this.gl2.getQueryParameter(this.handle,w4)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((i,r)=>{const s=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):n++>e?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(s)};requestAnimationFrame(s)}),this._pollingPromise}_createHandle(){return kh.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class iS extends Lr{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return We(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};mn(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Ra(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const i=this._getVaryingIndex(e),{buffer:r,byteSize:s,byteOffset:o}=this._getBufferParams(n);return i<0?(this.unused[e]=r,Se.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[i]=n,this.bindOnUse||this._bindBuffer(i,r,o,s),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,i,r;return e instanceof ct?r=e:(r=e.buffer,i=e.byteSize,n=e.byteOffset),(n!==void 0||i!==void 0)&&(n=n||0,i=i||r.byteLength-n),{buffer:r,byteOffset:n,byteSize:i}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:i,byteOffset:r}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,r,i)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;const s=n&&n.handle;return!s||r===void 0?this.gl.bindBufferBase(35982,e,s):this.gl.bindBufferRange(35982,e,s,i,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let ru=null;function M4(t){return(!ru||ru.byteLength<t)&&(ru=new ArrayBuffer(t)),ru}function I4(t,e){const n=M4(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function B4(t){let{target:e,source:n,start:i=0,count:r=1}=t;const s=n.length,o=r*s;let a=0;for(let c=i;a<s;a++)e[c++]=n[a];for(;a<o;)a<o-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+o-a),a=o);return e}const L4="elements must be GL.ELEMENT_ARRAY_BUFFER";class Jn extends Lr{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?We(e)||Tb()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new Jn(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return Jn.MAX_ATTRIBUTES=Jn.MAX_ATTRIBUTES||e.getParameter(34921),Jn.MAX_ATTRIBUTES}static setConstant(e,n,i){switch(i.constructor){case Float32Array:Jn._setConstantFloatArray(e,n,i);break;case Int32Array:Jn._setConstantIntArray(e,n,i);break;case Uint32Array:Jn._setConstantUintArray(e,n,i);break;default:pe(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:i})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Jn.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return pe(!e||e.target===34963,L4),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,i){if(n.target===34963)return this.setElementBuffer(n,i);const{size:r,type:s,stride:o,offset:a,normalized:c,integer:f,divisor:p}=i,{gl:m,gl2:v}=this;return e=Number(e),this.bind(()=>{m.bindBuffer(34962,n.handle),f?(pe(We(m)),v.vertexAttribIPointer(e,r,s,o,a)):m.vertexAttribPointer(e,r,s,c,o,a),m.enableVertexAttribArray(e),v.vertexAttribDivisor(e,p||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!Jn.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const i=this._normalizeConstantArrayValue(n),r=i.byteLength*e,s=i.length*e;let o=!this.buffer;if(this.buffer=this.buffer||new ct(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(i,this.bufferValue),o){const a=I4(n.constructor,s);B4({target:a,source:i,start:0,count:s}),this.buffer.subData(a),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let i=0;i<e.length;++i)if(e[i]!==n[i])return!1;return!0}static _setConstantFloatArray(e,n,i){switch(i.length){case 1:e.vertexAttrib1fv(n,i);break;case 2:e.vertexAttrib2fv(n,i);break;case 3:e.vertexAttrib3fv(n,i);break;case 4:e.vertexAttrib4fv(n,i);break;default:pe(!1)}}static _setConstantIntArray(e,n,i){switch(pe(We(e)),i.length){case 1:e.vertexAttribI1iv(n,i);break;case 2:e.vertexAttribI2iv(n,i);break;case 3:e.vertexAttribI3iv(n,i);break;case 4:e.vertexAttribI4iv(n,i);break;default:pe(!1)}}static _setConstantUintArray(e,n,i){switch(pe(We(e)),i.length){case 1:e.vertexAttribI1uiv(n,i);break;case 2:e.vertexAttribI2uiv(n,i);break;case 3:e.vertexAttribI3uiv(n,i);break;case 4:e.vertexAttribI4uiv(n,i);break;default:pe(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:i}=n;return pe(Number.isFinite(i)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(i,e);default:return this.gl.getVertexAttrib(i,e)}})}}const R4="VertexArray: attributes must be Buffers or constants (i.e. typed array)",O4=/^(.+)__LOCATION_([0-9]+)$/,F4=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class D4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=n.id||n.program&&n.program.id;this.id=i,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Jn(e),Hb(this,"VertexArray","v6.0",F4),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const i=e[n];this._setAttribute(n,i)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,i);const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,n.accessor,i);return r>=0&&(this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,n,s)),this}setConstant(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:r,accessor:s}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},i));return r>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[r]=n,this.accessors[r]=s,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ct(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ct&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ct&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,i){let r;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),r=i()}),r}_resolveLocationAndAccessor(e,n,i,r){const s={location:-1,accessor:null},{location:o,name:a}=this._getAttributeIndex(e);if(!Number.isFinite(o)||o<0)return this.unused[e]=n,Se.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),s;const c=this._getAttributeInfo(a||o);if(!c)return s;const f=this.accessors[o]||{},p=Rn.resolve(c.accessor,f,i,r),{size:m,type:v}=p;return pe(Number.isFinite(m)&&Number.isFinite(v)),{location:o,accessor:p}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const i=O4.exec(e),r=i?i[1]:e,s=i?Number(i[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+s,name:r}:{location:-1}}_setAttribute(e,n){if(n instanceof ct)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ct){const i=n[0],r=n[1];this.setBuffer(e,i,r)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const i=n;this.setConstant(e,i)}else if(n.buffer instanceof ct){const i=n;this.setBuffer(e,i.buffer,i)}else throw new Error(R4)}_setConstantAttributes(e,n){const i=Math.max(e|0,n|0);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,i);for(let s=1;s<this.vertexArrayObject.MAX_ATTRIBUTES;s++)r=this.values[s],ArrayBuffer.isView(r)&&this._setConstantAttribute(s,r)}_setConstantAttributeZero(e,n){if(Jn.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const i=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,i,this.accessors[0])}_setConstantAttribute(e,n){Jn.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const i=this.values[n],r=this.accessors[n];if(!i)return;const{divisor:s}=r,o=s>0;if(e.isInstanced=e.isInstanced||o,i instanceof ct){const a=i;if(o){const c=a.getVertexCount(r);e.instanceCount=Math.min(e.instanceCount,c)}else{const c=a.getVertexCount(r);e.vertexCount=Math.min(e.vertexCount,c)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Se.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function k4(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(r+=",".concat(o%i===0?" ":"")),r+=Ml(t[o],e);const s=t.length>n?"...":"]";return"".concat(r).concat(s)}function Ml(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:i=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return k4(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return i?"0":"0.";if(i||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function Zv(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;pe(n);const s=".*_.*",o=".*Matrix",a=n._uniformSetters,c={},f=Object.keys(a).sort();let p=0;for(const w of f)!w.match(s)&&!w.match(o)&&s0({table:c,header:e,uniforms:i,uniformName:w,undefinedOnly:r})&&p++;for(const w of f)w.match(o)&&s0({table:c,header:e,uniforms:i,uniformName:w,undefinedOnly:r})&&p++;for(const w of f)c[w]||s0({table:c,header:e,uniforms:i,uniformName:w,undefinedOnly:r})&&p++;let m=0;const v={};if(!r)for(const w in i){const C=i[w];c[w]||(m++,v[w]={Type:"NOT USED: ".concat(C),[e]:Ml(C)})}return{table:c,count:p,unusedTable:v,unusedCount:m}}function s0(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:s}=t;const o=i[r],a=N4(o);return!s||!a?(e[r]={[n]:a?Ml(o):"N/A","Uniform Type":a?o:"NOT PROVIDED"},!0):!1}function N4(t){return t!=null}function U4(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=qv(e,e.elements,null,n));const r=e.values;for(const s in r){const o=e._getAttributeInfo(s);if(o){let a="".concat(s,": ").concat(o.name);const c=e.accessors[o.location];c&&(a="".concat(s,": ").concat(G4(o.name,c))),i[a]=qv(e,r[s],c,n)}}return i}function qv(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let s="NOT PROVIDED",o=1,a=0,c=0,f,p,m;if(n&&(s=n.type,o=n.size,s=String(s).replace("Array",""),f=s.indexOf("nt")!==-1),e instanceof ct){const v=e,{data:w,changed:C}=v.getDebugData();p=C?"*":"",m=w,c=v.byteLength,a=c/w.BYTES_PER_ELEMENT/o;let S;if(n){const R=n.divisor>0;S="".concat(R?"I ":"P "," ").concat(a," (x").concat(o,"=").concat(c," bytes ").concat(hs(r,s),")")}else f=!0,S="".concat(c," bytes");return{[i]:"".concat(p).concat(Ml(m,{size:o,isInteger:f})),"Format ":S}}return m=e,o=e.length,s=String(e.constructor.name).replace("Array",""),f=s.indexOf("nt")!==-1,{[i]:"".concat(Ml(m,{size:o,isInteger:f})," (constant)"),"Format ":"".concat(o,"x").concat(s," (constant)")}}function G4(t,e){const{type:n,size:i}=e,r=tS(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function z4(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const r=$v(i);e["in ".concat(r)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const r=$v(i);e["out ".concat(r)]={[n]:JSON.stringify(i.accessor)}}return e}function $v(t){const{type:e,size:n}=t.accessor,i=tS(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const e2=Br()&&typeof document<"u";let V4=0;class H4{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=R=>zb(R),onAddHTML:i=null,onInitialize:r=()=>{},onRender:s=()=>{},onFinalize:o=()=>{},onError:a,gl:c=null,glOptions:f={},debug:p=!1,createFramebuffer:m=!1,autoResizeViewport:v=!0,autoResizeDrawingBuffer:w=!0,stats:C=Qs.get("animation-loop-".concat(V4++))}=e;let{useDevicePixels:S=!0}=e;"useDevicePixelRatio"in e&&(Se.deprecated("useDevicePixelRatio","useDevicePixels")(),S=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:i,onInitialize:r,onRender:s,onFinalize:o,onError:a,gl:c,glOptions:f,debug:p,createFramebuffer:m},this.gl=c,this.needsRedraw=null,this.timeline=null,this.stats=C,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:v,autoResizeDrawingBuffer:w,useDevicePixels:S}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return pe(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=kh.isSupported(this.gl,["timers"])?new kh(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(i=>{this._running&&(this._addCallbackData(i||{}),i!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const i=document.getElementById(e);return i?Number(i.value):n}setViewParameters(){return Se.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{!this._running||(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=e2?new Promise((e,n)=>{if(e2&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):ZF(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):KF(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?qm(this.props.gl,e):this.onCreateContext(e),!Pf(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");NF(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const i=this.props.onAddHTML(n);i&&(n.innerHTML=i)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let i=1;const{canvas:r}=this.gl;return r&&r.clientHeight?i=r.clientWidth/r.clientHeight:e>0&&n>0&&(i=e/n),{width:e,height:n,aspect:i}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&HF(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new jt(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const ic="vs",i1="fs";function ei(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const o0={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function j4(t){const e={};for(const n in t){const i=t[n],r=W4(i);e[n]=r}return e}function W4(t){let e=t2(t);return e==="object"?t?"type"in t?Object.assign({},t,o0[t.type]):"value"in t?(e=t2(t.value),Object.assign({type:e},t,o0[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},o0[e])}function t2(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const Q4="vs",X4="fs";class n2{constructor(e){let{name:n,vs:i,fs:r,dependencies:s=[],uniforms:o,getUniforms:a,deprecations:c=[],defines:f={},inject:p={},vertexShader:m,fragmentShader:v}=e;ei(typeof n=="string"),this.name=n,this.vs=i||m,this.fs=r||v,this.getModuleUniforms=a,this.dependencies=s,this.deprecations=this._parseDeprecationDefinitions(c),this.defines=f,this.injections=J4(p),o&&(this.uniforms=j4(o))}getModuleSource(e){let n;switch(e){case Q4:n=this.vs||"";break;case X4:n=this.fs||"";break;default:ei(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(i=>{i.regex.test(e)&&(i.deprecated?n.deprecated(i.old,i.new)():n.removed(i.old,i.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},i=this.uniforms;for(const r in i){const s=i[r];r in e&&!s.private?(s.validate&&ei(s.validate(e[r],s),"".concat(this.name,": invalid ").concat(r)),n[r]=e[r]):n[r]=s.value}return n}}function J4(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];const r=n.slice(0,2);typeof i=="string"&&(i={order:0,injection:i}),e[r][n]=i}return e}function Y4(t){return K4(sS(t))}function K4(t){const e={},n={};return rS({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((i,r)=>n[r]-n[i]).map(i=>e[i])}function rS(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const s of e)i[s.name]=s,(r[s.name]===void 0||r[s.name]<n)&&(r[s.name]=n);for(const s of e)s.dependencies&&rS({modules:s.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function sS(t,e){return t.map(n=>(n instanceof n2||(ei(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),ei(n.name,"shader module has no name"),n=new n2(n),n.dependencies=sS(n.dependencies)),n))}function Z4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",i=n.indexOf("MSIE ")!==-1,r=n.indexOf("Trident/")!==-1;return i||r}const q4=7936,$4=7937,ek=7938,tk=35724,r1={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Vs={};Object.keys(r1).forEach(t=>{Vs[t]=t});function nk(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:Boolean(t&&t._version===2)}function ik(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||q4),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||$4);return{gpuVendor:rk(n,i),vendor:n,renderer:i,version:t.getParameter(ek),shadingLanguageVersion:t.getParameter(tk)}}function rk(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const a0={};function i2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=r1[e];if(ei(i,e),!Z4(n))return!0;if(e in a0)return a0[e];const r=i[0],s=n.behavior||"enable",o="#extension GL_".concat(r," : ").concat(s,`
void main(void) {}`),a=t.createShader(35633);t.shaderSource(a,o),t.compileShader(a);const c=t.getShaderParameter(a,35713);return t.deleteShader(a),a0[e]=c,c}function sk(t,e){const n=r1[e];ei(n,e);const i=nk(t)&&n[1]||n[0],r=typeof i=="string"?Boolean(t.getExtension(i)):i;return ei(r===!1||r===!0),r}function su(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>sk(t,n))}function ok(t){switch(ik(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function ak(t,e,n){let i=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return su(t,Vs.GLSL_FRAG_DEPTH)&&(i+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),su(t,Vs.GLSL_DERIVATIVES)&&i2(t,Vs.GLSL_DERIVATIVES)&&(i+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),su(t,Vs.GLSL_FRAG_DATA)&&i2(t,Vs.GLSL_FRAG_DATA,{behavior:"require"})&&(i+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),su(t,Vs.GLSL_TEXTURE_LOD)&&(i+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),i}const Ak=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,lk=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,ck={[ic]:Ak,[i1]:lk},qu="__LUMA_INJECT_DECLARATIONS__",r2=/void\s+main\s*\([^)]*\)\s*\{\n?/,s2=/}\n?[^{}]*$/,A0=[];function o2(t,e,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=e===ic;for(const s in n){const o=n[s];o.sort((c,f)=>c.order-f.order),A0.length=o.length;for(let c=0,f=o.length;c<f;++c)A0[c]=o[c].injection;const a="".concat(A0.join(`
`),`
`);switch(s){case"vs:#decl":r&&(t=t.replace(qu,a));break;case"vs:#main-start":r&&(t=t.replace(r2,c=>c+a));break;case"vs:#main-end":r&&(t=t.replace(s2,c=>a+c));break;case"fs:#decl":r||(t=t.replace(qu,a));break;case"fs:#main-start":r||(t=t.replace(r2,c=>c+a));break;case"fs:#main-end":r||(t=t.replace(s2,c=>a+c));break;default:t=t.replace(s,c=>c+a)}}return t=t.replace(qu,""),i&&(t=t.replace(/\}\s*$/,s=>s+ck[e])),t}function lp(t){const e={};return ei(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const i in n)e[i]=e[i]?"".concat(e[i],`
`).concat(n[i]):n[i]}),e}function Oa(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const oS=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],uk=[...oS,[Oa("attribute"),"in $1"],[Oa("varying"),"out $1"]],hk=[...oS,[Oa("varying"),"in $1"]],aS=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],fk=[...aS,[Oa("in"),"attribute $1"],[Oa("out"),"varying $1"]],dk=[...aS,[Oa("in"),"varying $1"]],cp="gl_FragColor",up=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,gk=/void\s+main\s*\([^)]*\)\s*\{\n?/;function pk(t,e,n){switch(e){case 300:return n?Nh(t,uk):mk(t);case 100:return n?Nh(t,fk):_k(t);default:throw new Error("unknown GLSL version ".concat(e))}}function Nh(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}function mk(t){t=Nh(t,hk);const e=t.match(up);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(cp,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(gk,i=>"out vec4 ".concat(n,`;
`).concat(i)).replace(new RegExp("\\b".concat(cp,"\\b"),"g"),n)}return t}function _k(t){t=Nh(t,dk);const e=t.match(up);if(e){const n=e[1];t=t.replace(up,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),cp)}return t}const yk=`

`.concat(qu,`

`),AS={[ic]:"vertex",[i1]:"fragment"},vk=`precision highp float;

`;function Ek(t,e){const{vs:n,fs:i}=e,r=Y4(e.modules||[]);return{gl:t,vs:a2(t,Object.assign({},e,{source:n,type:ic,modules:r})),fs:a2(t,Object.assign({},e,{source:i,type:i1,modules:r})),getUniforms:wk(r)}}function a2(t,e){let{id:n,source:i,type:r,modules:s,defines:o={},hookFunctions:a=[],inject:c={},transpileToGLSL100:f=!1,prologue:p=!0,log:m}=e;ei(typeof i=="string","shader source must be a string");const v=r===ic,w=i.split(`
`);let C=100,S="",R=i;w[0].indexOf("#version ")===0?(C=300,S=w[0],R=w.slice(1).join(`
`)):S="#version ".concat(C);const x={};s.forEach(q=>{Object.assign(x,q.getDefines())}),Object.assign(x,o);let P=p?"".concat(S,`
`).concat(Ck({id:n,source:i,type:r}),`
`).concat(Tk({type:r}),`
`).concat(ok(t),`
`).concat(ak(t),`
`).concat(bk(x),`
`).concat(v?"":vk,`
`):"".concat(S,`
`);const I=xk(a),F={},H={},Q={};for(const q in c){const ee=typeof c[q]=="string"?{injection:c[q],order:0}:c[q],X=q.match(/^(v|f)s:(#)?([\w-]+)$/);if(X){const V=X[2],D=X[3];V?D==="decl"?H[q]=[ee]:Q[q]=[ee]:F[q]=[ee]}else Q[q]=[ee]}for(const q of s){m&&q.checkDeprecations(R,m),P+=q.getModuleSource(r,C);const X=q.injections[r];for(const V in X){const D=V.match(/^(v|f)s:#([\w-]+)$/);if(D){const Ae=D[2]==="decl"?H:Q;Ae[V]=Ae[V]||[],Ae[V].push(X[V])}else F[V]=F[V]||[],F[V].push(X[V])}}return P+=yk,P=o2(P,r,H),P+=Sk(I[r],F),P+=R,P=o2(P,r,Q),P=pk(P,f?100:C,v),P}function wk(t){return function(n){const i={};for(const r of t){const s=r.getUniforms(n,i);Object.assign(i,s)}return i}}function Tk(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(AS[e].toUpperCase(),`
`)}function Ck(t){let{id:e,source:n,type:i}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(AS[i],`

`):""}function bk(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const i in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],`
`))}return e===0&&(n+=`
`),n}function Sk(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature,` {
`),r.header&&(n+="  ".concat(r.header)),e[i]){const s=e[i];s.sort((o,a)=>o.order-a.order);for(const o of s)n+="  ".concat(o.injection,`
`)}r.footer&&(n+="  ".concat(r.footer)),n+=`}
`}return n}function xk(t){const e={vs:{},fs:{}};return t.forEach(n=>{let i;typeof n!="string"?(i=n,n=i.hook):i={},n=n.trim();const[r,s]=n.split(":"),o=n.replace(/\(.+/,"");e[r][o]=Object.assign(i,{signature:s})}),e}const Pk="void main() {gl_FragColor = vec4(0);}",lS=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,Mk=`#version 300 es
`.concat(lS);function cS(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,s]=n;if(!e.includes(i)||!r||!s)return null;const o=s.split(";")[0];return{qualifier:i,type:r,name:o}}function uS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return e===300?Mk:e>300?"#version ".concat(e,`
`).concat(lS):Pk;const s=Lk(n,i);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(i," ").concat(n,`;
out vec4 `).concat(r,`;
void main() {
  `).concat(r," = ").concat(s,`;
}`):"varying ".concat(i," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(s,`;
}`)}function Ik(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return ei(!1),null}}function Bk(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return ei(!1),null}}function Lk(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return ei(!1),null}}const Rk=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,Ok={name:"fp32",vs:Rk,fs:null};function Bi(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Fk=1/Math.PI*180,Dk=1/180*Math.PI,Ht={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function hS(t,{precision:e=Ht.precision}={}){return t=Uk(t),"".concat(parseFloat(t.toPrecision(e)))}function gs(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function kk(t){return VA(t)}function Nk(t){return Ii(t)}function VA(t,e){return s1(t,n=>n*Dk,e)}function Ii(t,e){return s1(t,n=>n*Fk,e)}function kt(t,e,n){return s1(t,i=>Math.max(e,Math.min(n,i)))}function ps(t,e,n){return gs(t)?t.map((i,r)=>ps(i,e[r],n)):n*e+(1-n)*t}function _n(t,e,n){const i=Ht.EPSILON;n&&(Ht.EPSILON=n);try{if(t===e)return!0;if(gs(t)&&gs(e)){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!_n(t[r],e[r]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=Ht.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{Ht.EPSILON=i}}function Uk(t){return Math.round(t/Ht.EPSILON)*Ht.EPSILON}function Gk(t){return t.clone?t.clone():new Array(t.length)}function s1(t,e,n){if(gs(t)){const i=t;n=n||Gk(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}function zk(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class o1 extends zk(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+n];return this.check()}toArray(e=[],n=0){for(let i=0;i<this.ELEMENTS;++i)e[n+i]=this[i];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:gs(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ht)}formatString(e){let n="";for(let i=0;i<this.ELEMENTS;++i)n+=(i>0?", ":"")+hS(this[i],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!_n(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,i){if(i===void 0)return this.lerp(this,e,n);for(let r=0;r<this.ELEMENTS;++r){const s=e[r];this[r]=s+i*(n[r]-s)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),n[i]);return this.check()}add(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=n[i];return this.check()}subtract(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=n[i];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(Ht.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),n);return this.check()}get elements(){return this}}function Vk(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function at(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function ol(t,e,n=""){if(Ht.debug&&!Vk(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class a1 extends o1{get x(){return this[0]}set x(e){this[0]=at(e)}get y(){return this[1]}set y(e){this[1]=at(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let i=0;i<this.ELEMENTS;++i){const r=this[i]-e[i];n+=r*r}return at(n)}dot(e){let n=0;for(let i=0;i<this.ELEMENTS;++i)n+=this[i]*e[i];return at(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=n[i];return this.check()}divide(...e){for(const n of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=n[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return Bi(e>=0&&e<this.ELEMENTS,"index is out of range"),at(this[e])}setComponent(e,n){return Bi(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var al=1e-6,Ui=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Hk(){var t=new Ui(2);return Ui!=Float32Array&&(t[0]=0,t[1]=0),t}function Uh(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function fS(t,e){return t[0]=-e[0],t[1]=-e[1],t}function dS(t,e,n,i){var r=e[0],s=e[1];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t}function jk(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t}function Wk(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function gS(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}function pS(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(function(){var t=Hk();return function(e,n,i,r,s,o){var a,c;for(n||(n=2),i||(i=0),r?c=Math.min(r*n+i,e.length):c=e.length,a=i;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],s(t,t,o),e[a]=t[0],e[a+1]=t[1];return e}})();function mS(t,e,n){const i=e[0],r=e[1],s=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/s,t[1]=(n[1]*i+n[5]*r)/s,t}function _S(t,e,n){const i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s||1;return t[0]=(n[0]*i+n[4]*r+n[8]*s)/o,t[1]=(n[1]*i+n[5]*r+n[9]*s)/o,t[2]=(n[2]*i+n[6]*r+n[10]*s)/o,t}function Qk(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t}function Xk(t,e,n){const i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3],t}function yS(t,e,n){const i=e[0],r=e[1],s=e[2];return t[0]=n[0]*i+n[3]*r+n[6]*s,t[1]=n[1]*i+n[4]*r+n[7]*s,t[2]=n[2]*i+n[5]*r+n[8]*s,t[3]=e[3],t}class A1 extends a1{constructor(e=0,n=0){super(2),gs(e)&&arguments.length===1?this.copy(e):(Ht.debug&&(at(e),at(n)),this[0]=e,this[1]=n)}set(e,n){return this[0]=e,this[1]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return Ht.debug&&(at(e.x),at(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return pS(this,this,e),this.check()}transformAsVector(e){return mS(this,this,e),this.check()}transformByMatrix3(e){return gS(this,this,e),this.check()}transformByMatrix2x3(e){return Wk(this,this,e),this.check()}transformByMatrix2(e){return jk(this,this,e),this.check()}}function vS(){var t=new Ui(3);return Ui!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function l1(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function A2(t,e,n){var i=new Ui(3);return i[0]=t,i[1]=e,i[2]=n,i}function Jk(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Yk(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i}function Kk(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Zk(t,e){var n=e[0],i=e[1],r=e[2],s=n*n+i*i+r*r;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function c1(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function $u(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],c=n[2];return t[0]=r*c-s*a,t[1]=s*o-i*c,t[2]=i*a-r*o,t}function qk(t,e,n,i){var r=e[0],s=e[1],o=e[2];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t}function u1(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[3]*i+n[7]*r+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*i+n[4]*r+n[8]*s+n[12])/o,t[1]=(n[1]*i+n[5]*r+n[9]*s+n[13])/o,t[2]=(n[2]*i+n[6]*r+n[10]*s+n[14])/o,t}function ES(t,e,n){var i=e[0],r=e[1],s=e[2];return t[0]=i*n[0]+r*n[3]+s*n[6],t[1]=i*n[1]+r*n[4]+s*n[7],t[2]=i*n[2]+r*n[5]+s*n[8],t}function wS(t,e,n){var i=n[0],r=n[1],s=n[2],o=n[3],a=e[0],c=e[1],f=e[2],p=r*f-s*c,m=s*a-i*f,v=i*c-r*a,w=r*v-s*m,C=s*p-i*v,S=i*m-r*p,R=o*2;return p*=R,m*=R,v*=R,w*=2,C*=2,S*=2,t[0]=a+p+w,t[1]=c+m+C,t[2]=f+v+S,t}function $k(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0],s[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),s[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function eN(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),s[1]=r[1],s[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function tN(t,e,n,i){var r=[],s=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],s[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),s[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),s[2]=r[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function nN(t,e){var n=t[0],i=t[1],r=t[2],s=e[0],o=e[1],a=e[2],c=Math.sqrt(n*n+i*i+r*r),f=Math.sqrt(s*s+o*o+a*a),p=c*f,m=p&&c1(t,e)/p;return Math.acos(Math.min(Math.max(m,-1),1))}var TS=Jk,CS=l1,l0=Yk;(function(){var t=vS();return function(e,n,i,r,s,o){var a,c;for(n||(n=3),i||(i=0),r?c=Math.min(r*n+i,e.length):c=e.length,a=i;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const c0=[0,0,0];let ou;class K extends a1{static get ZERO(){return ou||(ou=new K(0,0,0),Object.freeze(ou)),ou}constructor(e=0,n=0,i=0){super(-0,-0,-0),arguments.length===1&&gs(e)?this.copy(e):(Ht.debug&&(at(e),at(n),at(i)),this[0]=e,this[1]=n,this[2]=i)}set(e,n,i){return this[0]=e,this[1]=n,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Ht.debug&&(at(e.x),at(e.y),at(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=at(e)}angle(e){return nN(this,e)}cross(e){return $u(this,this,e),this.check()}rotateX({radians:e,origin:n=c0}){return $k(this,this,n,e),this.check()}rotateY({radians:e,origin:n=c0}){return eN(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=c0}){return tN(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return u1(this,this,e),this.check()}transformAsVector(e){return _S(this,this,e),this.check()}transformByMatrix3(e){return ES(this,this,e),this.check()}transformByMatrix2(e){return Qk(this,this,e),this.check()}transformByQuaternion(e){return wS(this,this,e),this.check()}}let au;class h1 extends a1{static get ZERO(){return au||(au=new h1(0,0,0,0),Object.freeze(au)),au}constructor(e=0,n=0,i=0,r=0){super(-0,-0,-0,-0),gs(e)&&arguments.length===1?this.copy(e):(Ht.debug&&(at(e),at(n),at(i),at(r)),this[0]=e,this[1]=n,this[2]=i,this[3]=r)}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return Ht.debug&&(at(e.x),at(e.y),at(e.z),at(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=at(e)}get w(){return this[3]}set w(e){this[3]=at(e)}transform(e){return u1(this,this,e),this.check()}transformByMatrix3(e){return yS(this,this,e),this.check()}transformByMatrix2(e){return Xk(this,this,e),this.check()}transformByQuaternion(e){return wS(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class bS extends o1{toString(){let e="[";if(Ht.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let i=0;i<this.RANK;++i)e+=" ".concat(this[i*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,i){return this[n*this.RANK+e]=at(i),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)n[r]=this[i+r];return n}setColumn(e,n){const i=e*this.RANK;for(let r=0;r<this.RANK;++r)this[i+r]=n[r];return this}}function iN(){var t=new Ui(9);return Ui!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function rN(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function sN(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],f=e[7],p=e[8],m=p*o-a*f,v=-p*s+a*c,w=f*s-o*c,C=n*m+i*v+r*w;return C?(C=1/C,t[0]=m*C,t[1]=(-p*i+r*f)*C,t[2]=(a*i-r*o)*C,t[3]=v*C,t[4]=(p*n-r*c)*C,t[5]=(-a*n+r*s)*C,t[6]=w*C,t[7]=(-f*n+i*c)*C,t[8]=(o*n-i*s)*C,t):null}function oN(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],f=t[8];return e*(f*s-o*c)+n*(-f*r+o*a)+i*(c*r-s*a)}function l2(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],f=e[6],p=e[7],m=e[8],v=n[0],w=n[1],C=n[2],S=n[3],R=n[4],x=n[5],P=n[6],I=n[7],F=n[8];return t[0]=v*i+w*o+C*f,t[1]=v*r+w*a+C*p,t[2]=v*s+w*c+C*m,t[3]=S*i+R*o+x*f,t[4]=S*r+R*a+x*p,t[5]=S*s+R*c+x*m,t[6]=P*i+I*o+F*f,t[7]=P*r+I*a+F*p,t[8]=P*s+I*c+F*m,t}function aN(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],f=e[6],p=e[7],m=e[8],v=n[0],w=n[1];return t[0]=i,t[1]=r,t[2]=s,t[3]=o,t[4]=a,t[5]=c,t[6]=v*i+w*o+f,t[7]=v*r+w*a+p,t[8]=v*s+w*c+m,t}function AN(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],f=e[6],p=e[7],m=e[8],v=Math.sin(n),w=Math.cos(n);return t[0]=w*i+v*o,t[1]=w*r+v*a,t[2]=w*s+v*c,t[3]=w*o-v*i,t[4]=w*a-v*r,t[5]=w*c-v*s,t[6]=f,t[7]=p,t[8]=m,t}function c2(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function lN(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,c=r+r,f=n*o,p=i*o,m=i*a,v=r*o,w=r*a,C=r*c,S=s*o,R=s*a,x=s*c;return t[0]=1-m-C,t[3]=p-x,t[6]=v+R,t[1]=p+x,t[4]=1-f-C,t[7]=w-S,t[2]=v-R,t[5]=w+S,t[8]=1-f-m,t}var hp;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(hp||(hp={}));const cN=Object.freeze([1,0,0,0,1,0,0,0,1]);class Zt extends bS{static get IDENTITY(){return hN()}static get ZERO(){return uN()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return hp}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(cN)}fromObject(e){return this.check()}fromQuaternion(e){return lN(this,e),this.check()}set(e,n,i,r,s,o,a,c,f){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=f,this.check()}setRowMajor(e,n,i,r,s,o,a,c,f){return this[0]=e,this[1]=r,this[2]=a,this[3]=n,this[4]=s,this[5]=c,this[6]=i,this[7]=o,this[8]=f,this.check()}determinant(){return oN(this)}transpose(){return rN(this,this),this.check()}invert(){return sN(this,this),this.check()}multiplyLeft(e){return l2(this,e,this),this.check()}multiplyRight(e){return l2(this,this,e),this.check()}rotate(e){return AN(this,this,e),this.check()}scale(e){return Array.isArray(e)?c2(this,this,e):c2(this,this,[e,e]),this.check()}translate(e){return aN(this,this,e),this.check()}transform(e,n){let i;switch(e.length){case 2:i=gS(n||[-0,-0],e,this);break;case 3:i=ES(n||[-0,-0,-0],e,this);break;case 4:i=yS(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ol(i,e.length),i}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let Au,lu;function uN(){return Au||(Au=new Zt([0,0,0,0,0,0,0,0,0]),Object.freeze(Au)),Au}function hN(){return lu||(lu=new Zt,Object.freeze(lu)),lu}function fN(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function dN(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=r,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function fp(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],f=e[7],p=e[8],m=e[9],v=e[10],w=e[11],C=e[12],S=e[13],R=e[14],x=e[15],P=n*a-i*o,I=n*c-r*o,F=n*f-s*o,H=i*c-r*a,Q=i*f-s*a,q=r*f-s*c,ee=p*S-m*C,X=p*R-v*C,V=p*x-w*C,D=m*R-v*S,re=m*x-w*S,Ae=v*x-w*R,ge=P*Ae-I*re+F*D+H*V-Q*X+q*ee;return ge?(ge=1/ge,t[0]=(a*Ae-c*re+f*D)*ge,t[1]=(r*re-i*Ae-s*D)*ge,t[2]=(S*q-R*Q+x*H)*ge,t[3]=(v*Q-m*q-w*H)*ge,t[4]=(c*V-o*Ae-f*X)*ge,t[5]=(n*Ae-r*V+s*X)*ge,t[6]=(R*F-C*q-x*I)*ge,t[7]=(p*q-v*F+w*I)*ge,t[8]=(o*re-a*V+f*ee)*ge,t[9]=(i*V-n*re-s*ee)*ge,t[10]=(C*Q-S*F+x*P)*ge,t[11]=(m*F-p*Q-w*P)*ge,t[12]=(a*X-o*D-c*ee)*ge,t[13]=(n*D-i*X+r*ee)*ge,t[14]=(S*I-C*H-R*P)*ge,t[15]=(p*H-m*I+v*P)*ge,t):null}function gN(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],c=t[7],f=t[8],p=t[9],m=t[10],v=t[11],w=t[12],C=t[13],S=t[14],R=t[15],x=e*o-n*s,P=e*a-i*s,I=e*c-r*s,F=n*a-i*o,H=n*c-r*o,Q=i*c-r*a,q=f*C-p*w,ee=f*S-m*w,X=f*R-v*w,V=p*S-m*C,D=p*R-v*C,re=m*R-v*S;return x*re-P*D+I*V+F*X-H*ee+Q*q}function qs(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=e[4],c=e[5],f=e[6],p=e[7],m=e[8],v=e[9],w=e[10],C=e[11],S=e[12],R=e[13],x=e[14],P=e[15],I=n[0],F=n[1],H=n[2],Q=n[3];return t[0]=I*i+F*a+H*m+Q*S,t[1]=I*r+F*c+H*v+Q*R,t[2]=I*s+F*f+H*w+Q*x,t[3]=I*o+F*p+H*C+Q*P,I=n[4],F=n[5],H=n[6],Q=n[7],t[4]=I*i+F*a+H*m+Q*S,t[5]=I*r+F*c+H*v+Q*R,t[6]=I*s+F*f+H*w+Q*x,t[7]=I*o+F*p+H*C+Q*P,I=n[8],F=n[9],H=n[10],Q=n[11],t[8]=I*i+F*a+H*m+Q*S,t[9]=I*r+F*c+H*v+Q*R,t[10]=I*s+F*f+H*w+Q*x,t[11]=I*o+F*p+H*C+Q*P,I=n[12],F=n[13],H=n[14],Q=n[15],t[12]=I*i+F*a+H*m+Q*S,t[13]=I*r+F*c+H*v+Q*R,t[14]=I*s+F*f+H*w+Q*x,t[15]=I*o+F*p+H*C+Q*P,t}function Gh(t,e,n){var i=n[0],r=n[1],s=n[2],o,a,c,f,p,m,v,w,C,S,R,x;return e===t?(t[12]=e[0]*i+e[4]*r+e[8]*s+e[12],t[13]=e[1]*i+e[5]*r+e[9]*s+e[13],t[14]=e[2]*i+e[6]*r+e[10]*s+e[14],t[15]=e[3]*i+e[7]*r+e[11]*s+e[15]):(o=e[0],a=e[1],c=e[2],f=e[3],p=e[4],m=e[5],v=e[6],w=e[7],C=e[8],S=e[9],R=e[10],x=e[11],t[0]=o,t[1]=a,t[2]=c,t[3]=f,t[4]=p,t[5]=m,t[6]=v,t[7]=w,t[8]=C,t[9]=S,t[10]=R,t[11]=x,t[12]=o*i+p*r+C*s+e[12],t[13]=a*i+m*r+S*s+e[13],t[14]=c*i+v*r+R*s+e[14],t[15]=f*i+w*r+x*s+e[15]),t}function f1(t,e,n){var i=n[0],r=n[1],s=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function pN(t,e,n,i){var r=i[0],s=i[1],o=i[2],a=Math.hypot(r,s,o),c,f,p,m,v,w,C,S,R,x,P,I,F,H,Q,q,ee,X,V,D,re,Ae,ge,Be;return a<al?null:(a=1/a,r*=a,s*=a,o*=a,c=Math.sin(n),f=Math.cos(n),p=1-f,m=e[0],v=e[1],w=e[2],C=e[3],S=e[4],R=e[5],x=e[6],P=e[7],I=e[8],F=e[9],H=e[10],Q=e[11],q=r*r*p+f,ee=s*r*p+o*c,X=o*r*p-s*c,V=r*s*p-o*c,D=s*s*p+f,re=o*s*p+r*c,Ae=r*o*p+s*c,ge=s*o*p-r*c,Be=o*o*p+f,t[0]=m*q+S*ee+I*X,t[1]=v*q+R*ee+F*X,t[2]=w*q+x*ee+H*X,t[3]=C*q+P*ee+Q*X,t[4]=m*V+S*D+I*re,t[5]=v*V+R*D+F*re,t[6]=w*V+x*D+H*re,t[7]=C*V+P*D+Q*re,t[8]=m*Ae+S*ge+I*Be,t[9]=v*Ae+R*ge+F*Be,t[10]=w*Ae+x*ge+H*Be,t[11]=C*Ae+P*ge+Q*Be,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function SS(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[4],o=e[5],a=e[6],c=e[7],f=e[8],p=e[9],m=e[10],v=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*r+f*i,t[5]=o*r+p*i,t[6]=a*r+m*i,t[7]=c*r+v*i,t[8]=f*r-s*i,t[9]=p*r-o*i,t[10]=m*r-a*i,t[11]=v*r-c*i,t}function mN(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],f=e[8],p=e[9],m=e[10],v=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r-f*i,t[1]=o*r-p*i,t[2]=a*r-m*i,t[3]=c*r-v*i,t[8]=s*i+f*r,t[9]=o*i+p*r,t[10]=a*i+m*r,t[11]=c*i+v*r,t}function xS(t,e,n){var i=Math.sin(n),r=Math.cos(n),s=e[0],o=e[1],a=e[2],c=e[3],f=e[4],p=e[5],m=e[6],v=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*r+f*i,t[1]=o*r+p*i,t[2]=a*r+m*i,t[3]=c*r+v*i,t[4]=f*r-s*i,t[5]=p*r-o*i,t[6]=m*r-a*i,t[7]=v*r-c*i,t}function _N(t,e){var n=e[0],i=e[1],r=e[2],s=e[4],o=e[5],a=e[6],c=e[8],f=e[9],p=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(s,o,a),t[2]=Math.hypot(c,f,p),t}function yN(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n+n,a=i+i,c=r+r,f=n*o,p=i*o,m=i*a,v=r*o,w=r*a,C=r*c,S=s*o,R=s*a,x=s*c;return t[0]=1-m-C,t[1]=p+x,t[2]=v-R,t[3]=0,t[4]=p-x,t[5]=1-f-C,t[6]=w+S,t[7]=0,t[8]=v+R,t[9]=w-S,t[10]=1-f-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vN(t,e,n,i,r,s,o){var a=1/(n-e),c=1/(r-i),f=1/(s-o);return t[0]=s*2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s*2*c,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*c,t[10]=(o+s)*f,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*f,t[15]=0,t}function EN(t,e,n,i,r){var s=1/Math.tan(e/2),o;return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,r!=null&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i),t}var wN=EN;function TN(t,e,n,i,r,s,o){var a=1/(e-n),c=1/(i-r),f=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*f,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*c,t[14]=(o+s)*f,t[15]=1,t}var CN=TN;function bN(t,e,n,i){var r,s,o,a,c,f,p,m,v,w,C=e[0],S=e[1],R=e[2],x=i[0],P=i[1],I=i[2],F=n[0],H=n[1],Q=n[2];return Math.abs(C-F)<al&&Math.abs(S-H)<al&&Math.abs(R-Q)<al?fN(t):(p=C-F,m=S-H,v=R-Q,w=1/Math.hypot(p,m,v),p*=w,m*=w,v*=w,r=P*v-I*m,s=I*p-x*v,o=x*m-P*p,w=Math.hypot(r,s,o),w?(w=1/w,r*=w,s*=w,o*=w):(r=0,s=0,o=0),a=m*o-v*s,c=v*r-p*o,f=p*s-m*r,w=Math.hypot(a,c,f),w?(w=1/w,a*=w,c*=w,f*=w):(a=0,c=0,f=0),t[0]=r,t[1]=a,t[2]=p,t[3]=0,t[4]=s,t[5]=c,t[6]=m,t[7]=0,t[8]=o,t[9]=f,t[10]=v,t[11]=0,t[12]=-(r*C+s*S+o*R),t[13]=-(a*C+c*S+f*R),t[14]=-(p*C+m*S+v*R),t[15]=1,t)}function SN(){var t=new Ui(4);return Ui!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function xN(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function d1(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function PN(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)}function MN(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r}function IN(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=s*o,t}function BN(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function LN(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3];return t[0]=r+i*(n[0]-r),t[1]=s+i*(n[1]-s),t[2]=o+i*(n[2]-o),t[3]=a+i*(n[3]-a),t}function ja(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*s+n[12]*o,t[1]=n[1]*i+n[5]*r+n[9]*s+n[13]*o,t[2]=n[2]*i+n[6]*r+n[10]*s+n[14]*o,t[3]=n[3]*i+n[7]*r+n[11]*s+n[15]*o,t}function RN(t,e,n){var i=e[0],r=e[1],s=e[2],o=n[0],a=n[1],c=n[2],f=n[3],p=f*i+a*s-c*r,m=f*r+c*i-o*s,v=f*s+o*r-a*i,w=-o*i-a*r-c*s;return t[0]=p*f+w*-o+m*-c-v*-a,t[1]=m*f+w*-a+v*-o-p*-c,t[2]=v*f+w*-c+p*-a-m*-o,t[3]=e[3],t}(function(){var t=SN();return function(e,n,i,r,s,o){var a,c;for(n||(n=4),i||(i=0),r?c=Math.min(r*n+i,e.length):c=e.length,a=i;a<c;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],s(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}})();var dp;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(dp||(dp={}));const ON=45*Math.PI/180,FN=1,u0=.1,h0=500,DN=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class De extends bS{static get IDENTITY(){return NN()}static get ZERO(){return kN()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return dp}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,i,r,s,o,a,c,f,p,m,v,w,C,S,R){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this[4]=s,this[5]=o,this[6]=a,this[7]=c,this[8]=f,this[9]=p,this[10]=m,this[11]=v,this[12]=w,this[13]=C,this[14]=S,this[15]=R,this.check()}setRowMajor(e,n,i,r,s,o,a,c,f,p,m,v,w,C,S,R){return this[0]=e,this[1]=s,this[2]=f,this[3]=w,this[4]=n,this[5]=o,this[6]=p,this[7]=C,this[8]=i,this[9]=a,this[10]=m,this[11]=S,this[12]=r,this[13]=c,this[14]=v,this[15]=R,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(DN)}fromObject(e){return this.check()}fromQuaternion(e){return yN(this,e),this.check()}frustum(e){const{left:n,right:i,bottom:r,top:s,near:o=u0,far:a=h0}=e;return a===1/0?UN(this,n,i,r,s,o):vN(this,n,i,r,s,o,a),this.check()}lookAt(e){const{eye:n,center:i=[0,0,0],up:r=[0,1,0]}=e;return bN(this,n,i,r),this.check()}ortho(e){const{left:n,right:i,bottom:r,top:s,near:o=u0,far:a=h0}=e;return CN(this,n,i,r,s,o,a),this.check()}orthographic(e){const{fovy:n=ON,aspect:i=FN,focalDistance:r=1,near:s=u0,far:o=h0}=e;u2(n);const a=n/2,c=r*Math.tan(a),f=c*i;return this.ortho({left:-f,right:f,bottom:-c,top:c,near:s,far:o})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:i=1,near:r=.1,far:s=500}=e;return u2(n),wN(this,n,i,r,s),this.check()}determinant(){return gN(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=0,e[4]=this[4]*r,e[5]=this[5]*s,e[6]=this[6]*o,e[7]=0,e[8]=this[8]*r,e[9]=this[9]*s,e[10]=this[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const i=this.getScale(n),r=1/i[0],s=1/i[1],o=1/i[2];return e[0]=this[0]*r,e[1]=this[1]*s,e[2]=this[2]*o,e[3]=this[4]*r,e[4]=this[5]*s,e[5]=this[6]*o,e[6]=this[8]*r,e[7]=this[9]*s,e[8]=this[10]*o,e}transpose(){return dN(this,this),this.check()}invert(){return fp(this,this),this.check()}multiplyLeft(e){return qs(this,e,this),this.check()}multiplyRight(e){return qs(this,this,e),this.check()}rotateX(e){return SS(this,this,e),this.check()}rotateY(e){return mN(this,this,e),this.check()}rotateZ(e){return xS(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return pN(this,this,e,n),this.check()}scale(e){return f1(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Gh(this,this,e),this.check()}transform(e,n){return e.length===4?(n=ja(n||[-0,-0,-0,-0],e,this),ol(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:i}=e;let r;switch(i){case 2:r=pS(n||[-0,-0],e,this);break;case 3:r=u1(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ol(r,e.length),r}transformAsVector(e,n){let i;switch(e.length){case 2:i=mS(n||[-0,-0],e,this);break;case 3:i=_S(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return ol(i,e.length),i}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,i){return this.identity().translate([e,n,i])}}let cu,uu;function kN(){return cu||(cu=new De([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(cu)),cu}function NN(){return uu||(uu=new De,Object.freeze(uu)),uu}function u2(t){if(t>Math.PI*2)throw Error("expected radians")}function UN(t,e,n,i,r,s){const o=2*s/(n-e),a=2*s/(r-i),c=(n+e)/(n-e),f=(r+i)/(r-i),p=-1,m=-1,v=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=c,t[9]=f,t[10]=p,t[11]=m,t[12]=0,t[13]=0,t[14]=v,t[15]=0,t}function h2(){var t=new Ui(4);return Ui!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function GN(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function PS(t,e,n){n=n*.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function f2(t,e,n){var i=e[0],r=e[1],s=e[2],o=e[3],a=n[0],c=n[1],f=n[2],p=n[3];return t[0]=i*p+o*a+r*f-s*c,t[1]=r*p+o*c+s*a-i*f,t[2]=s*p+o*f+i*c-r*a,t[3]=o*p-i*a-r*c-s*f,t}function zN(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c+o*a,t[1]=r*c+s*a,t[2]=s*c-r*a,t[3]=o*c-i*a,t}function VN(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c-s*a,t[1]=r*c+o*a,t[2]=s*c+i*a,t[3]=o*c-r*a,t}function HN(t,e,n){n*=.5;var i=e[0],r=e[1],s=e[2],o=e[3],a=Math.sin(n),c=Math.cos(n);return t[0]=i*c+r*a,t[1]=r*c-i*a,t[2]=s*c+o*a,t[3]=o*c-s*a,t}function jN(t,e){var n=e[0],i=e[1],r=e[2];return t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t}function eh(t,e,n,i){var r=e[0],s=e[1],o=e[2],a=e[3],c=n[0],f=n[1],p=n[2],m=n[3],v,w,C,S,R;return w=r*c+s*f+o*p+a*m,w<0&&(w=-w,c=-c,f=-f,p=-p,m=-m),1-w>al?(v=Math.acos(w),C=Math.sin(v),S=Math.sin((1-i)*v)/C,R=Math.sin(i*v)/C):(S=1-i,R=i),t[0]=S*r+R*c,t[1]=S*s+R*f,t[2]=S*o+R*p,t[3]=S*a+R*m,t}function WN(t,e){var n=e[0],i=e[1],r=e[2],s=e[3],o=n*n+i*i+r*r+s*s,a=o?1/o:0;return t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=s*a,t}function QN(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function MS(t,e){var n=e[0]+e[4]+e[8],i;if(n>0)i=Math.sqrt(n+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[r*3+r]&&(r=2);var s=(r+1)%3,o=(r+2)%3;i=Math.sqrt(e[r*3+r]-e[s*3+s]-e[o*3+o]+1),t[r]=.5*i,i=.5/i,t[3]=(e[s*3+o]-e[o*3+s])*i,t[s]=(e[s*3+r]+e[r*3+s])*i,t[o]=(e[o*3+r]+e[r*3+o])*i}return t}var XN=xN,JN=d1,YN=BN,KN=LN,ZN=PN,qN=MN,IS=IN,$N=function(){var t=vS(),e=A2(1,0,0),n=A2(0,1,0);return function(i,r,s){var o=c1(r,s);return o<-.999999?($u(t,e,r),CS(t)<1e-6&&$u(t,n,r),Zk(t,t),PS(i,t,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):($u(t,r,s),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+o,IS(i,i))}}();(function(){var t=h2(),e=h2();return function(n,i,r,s,o,a){return eh(t,i,o,a),eh(e,r,s,a),eh(n,t,e,2*a*(1-a)),n}})();(function(){var t=iN();return function(e,n,i,r){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=r[0],t[4]=r[1],t[7]=r[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],IS(e,MS(e,t))}})();const e8=[0,0,0,1];class Il extends o1{constructor(e=0,n=0,i=0,r=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,i,r)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,i,r){return this[0]=e,this[1]=n,this[2]=i,this[3]=r,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return MS(this,e),this.check()}fromAxisRotation(e,n){return PS(this,e,n),this.check()}identity(){return GN(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=at(e)}get y(){return this[1]}set y(e){this[1]=at(e)}get z(){return this[2]}set z(e){this[2]=at(e)}get w(){return this[3]}set w(e){this[3]=at(e)}len(){return ZN(this)}lengthSquared(){return qN(this)}dot(e){return YN(this,e)}rotationTo(e,n){return $N(this,e,n),this.check()}add(e){return XN(this,this,e),this.check()}calculateW(){return jN(this,this),this.check()}conjugate(){return QN(this,this),this.check()}invert(){return WN(this,this),this.check()}lerp(e,n,i){return i===void 0?this.lerp(this,e,n):(KN(this,e,n,i),this.check())}multiplyRight(e){return f2(this,this,e),this.check()}multiplyLeft(e){return f2(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return zN(this,this,e),this.check()}rotateY(e){return VN(this,this,e),this.check()}rotateZ(e){return HN(this,this,e),this.check()}scale(e){return JN(this,this,e),this.check()}slerp(e,n,i){let r,s,o;switch(arguments.length){case 1:({start:r=e8,target:s,ratio:o}=e);break;case 2:r=this,s=e,o=n;break;default:r=e,s=n,o=i}return eh(this,r,s,o),this.check()}transformVector4(e,n=new h1){return RN(n,e,this),ol(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const d2=1e-6,t8=6371e3;class Lf{constructor({phi:e=0,theta:n=0,radius:i=1,bearing:r,pitch:s,altitude:o,radiusScale:a=t8}={}){T(this,"phi",void 0),T(this,"theta",void 0),T(this,"radius",void 0),T(this,"radiusScale",void 0),this.phi=e,this.theta=n,this.radius=i||o||1,this.radiusScale=a||1,r!==void 0&&(this.bearing=r),s!==void 0&&(this.pitch=s),this.check()}toString(){return this.formatString(Ht)}formatString({printTypes:e=!1}){const n=hS;return"".concat(e?"Spherical":"","[rho:").concat(n(this.radius),",theta:").concat(n(this.theta),",phi:").concat(n(this.phi),"]")}equals(e){return _n(this.radius,e.radius)&&_n(this.theta,e.theta)&&_n(this.phi,e.phi)}exactEquals(e){return this.radius===e.radius&&this.theta===e.theta&&this.phi===e.phi}get bearing(){return 180-Ii(this.phi)}set bearing(e){this.phi=Math.PI-VA(e)}get pitch(){return Ii(this.theta)}set pitch(e){this.theta=VA(e)}get longitude(){return Ii(this.phi)}get latitude(){return Ii(this.theta)}get lng(){return Ii(this.phi)}get lat(){return Ii(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this.check()}clone(){return new Lf().copy(this)}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this.check()}fromLngLatZ([e,n,i]){return this.radius=1+i/this.radiusScale,this.phi=VA(n),this.theta=VA(e),this.check()}fromVector3(e){return this.radius=l1(e),this.radius>0&&(this.theta=Math.atan2(e[0],e[1]),this.phi=Math.acos(kt(e[2]/this.radius,-1,1))),this.check()}toVector3(){return new K(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(d2,Math.min(Math.PI-d2,this.phi)),this}check(){if(!Number.isFinite(this.phi)||!Number.isFinite(this.theta)||!(this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}const Bl={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},g2=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,n8={lightSources:{}};function f0(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function i8(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return e?r["lighting_uAmbientLight.color"]=f0(e):r["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((s,o)=>{r["lighting_uPointLight[".concat(o,"].color")]=f0(s),r["lighting_uPointLight[".concat(o,"].position")]=s.position,r["lighting_uPointLight[".concat(o,"].attenuation")]=s.attenuation||[1,0,0]}),r.lighting_uPointLightCount=n.length,i.forEach((s,o)=>{r["lighting_uDirectionalLight[".concat(o,"].color")]=f0(s),r["lighting_uDirectionalLight[".concat(o,"].direction")]=s.direction}),r.lighting_uDirectionalLightCount=i.length,r}function BS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:n8;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:i}=t.lightSources||{};return e||n&&n.length>0||i&&i.length>0?Object.assign({},i8({ambientLight:e,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return BS({lightSources:e})}return{}}const g1={name:"lights",vs:g2,fs:g2,getUniforms:BS,defines:{MAX_LIGHTS:3}},r8=new Uint8Array([0,255,255,255]),s8={pickingSelectedColor:null,pickingHighlightColor:r8,pickingActive:!1,pickingAttribute:!1};function o8(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s8;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,i=>i/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}const a8=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,A8=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,l8={name:"picking",vs:a8,fs:A8,getUniforms:o8},LS=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,c8={};function u8(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map(s=>s/255)}}function RS(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:c8;if(!("material"in t))return{};const{material:e}=t;return e?u8(e):{lighting_uEnabled:!1}}const p1={name:"gouraud-lighting",dependencies:[g1],vs:LS,defines:{LIGHTING_VERTEX:1},getUniforms:RS},OS={name:"phong-lighting",dependencies:[g1],fs:LS,defines:{LIGHTING_FRAGMENT:1},getUniforms:RS},h8=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,f8=`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,m1={name:"pbr",vs:h8,fs:f8,defines:{LIGHTING_FRAGMENT:1},dependencies:[g1]},d8=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,g8={name:"transform",vs:d8,fs:null};class rc{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new rc(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:i="",defines:r={},inject:s={},varyings:o=[],bufferMode:a=35981,transpileToGLSL100:c=!1}=e,f=this._getModuleList(e.modules),p=this._getHash(n),m=this._getHash(i),v=f.map(I=>this._getHash(I.name)).sort(),w=o.map(I=>this._getHash(I)),C=Object.keys(r).sort(),S=Object.keys(s).sort(),R=[],x=[];for(const I of C)R.push(this._getHash(I)),R.push(this._getHash(r[I]));for(const I of S)x.push(this._getHash(I)),x.push(this._getHash(s[I]));const P="".concat(p,"/").concat(m,"D").concat(R.join("/"),"M").concat(v.join("/"),"I").concat(x.join("/"),"V").concat(w.join("/"),"H").concat(this.stateHash,"B").concat(a).concat(c?"T":"");if(!this._programCache[P]){const I=Ek(this.gl,{vs:n,fs:i,modules:f,inject:s,defines:r,hookFunctions:this._hookFunctions,transpileToGLSL100:c});this._programCache[P]=new nS(this.gl,{hash:P,vs:I.vs,fs:I.fs,varyings:o,bufferMode:a}),this._getUniforms[P]=I.getUniforms||(F=>{}),this._useCounts[P]=0}return this._useCounts[P]++,this._programCache[P]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),i={};let r=0;for(let s=0,o=this._defaultModules.length;s<o;++s){const a=this._defaultModules[s],c=a.name;n[r++]=a,i[c]=!0}for(let s=0,o=e.length;s<o;++s){const a=e[s],c=a.name;i[c]||(n[r++]=a,i[c]=!0)}return n.length=r,n}}const p8={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function m8(t,e,n){const i={};let r=e.indices;for(const s in e.attributes){const o=e.attributes[s],a=_8(s,n);if(s==="indices")r=o;else if(o.constant)i[a]=o.value;else{const c=o.value,f={...o};delete f.value,i[a]=[new ct(t,c),f],y8(s,f)}}if(r){const s=r.value||r;pe(s instanceof Uint16Array||s instanceof Uint32Array,'attribute array for "indices" must be of integer type');const o={size:1,isIndexed:r.isIndexed===void 0?!0:r.isIndexed};i.indices=[new ct(t,{data:s,target:34963}),o]}return i}function _8(t,e){const{attributeMap:n=p8}=e||{};return n&&n[t]||t}function y8(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}pe(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Ro=2,v8=1e4,E8="Model needs drawMode and vertexCount",p2=()=>{},w8={};class Nn{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:i=rr("model")}=n;pe(Pf(e)),this.id=i,this.gl=e,this.id=n.id||rr("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||rc.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:f,transpileToGLSL100:p}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:f,transpileToGLSL100:p},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},pe(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),E8)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:f,transpileToGLSL100:p}=e;this.programProps={program:n,vs:i,fs:r,modules:s,defines:o,inject:a,varyings:c,bufferMode:f,transpileToGLSL100:p},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return pe(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return pe(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=m8(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ra(e))return this;const n={};for(const i in e){const r=e[i];n[i]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return e1(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:i,uniforms:r={},attributes:s={},transformFeedback:o=this.transformFeedback,parameters:a={},vertexArray:c=this.vertexArray}=e;this.setAttributes(s),this.updateModuleSettings(n),this.setUniforms(r);let f;Se.priority>=Ro&&(f=this._logDrawCallStart(Ro));const p=this.vertexArray.getDrawParams(),{isIndexed:m=p.isIndexed,indexType:v=p.indexType,indexOffset:w=p.indexOffset,vertexArrayInstanced:C=p.isInstanced}=this.props;C&&!this.isInstanced&&Se.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:S,instanceCount:R}=this,{onBeforeRender:x=p2,onAfterRender:P=p2}=this.props;x(),this.program.setUniforms(this.uniforms);const I=this.program.draw(Object.assign(w8,e,{logPriority:f,uniforms:null,framebuffer:i,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:c,transformFeedback:o,isIndexed:m,indexType:v,isInstanced:S,instanceCount:R,offset:m?w:0}));return P(),Se.priority>=Ro&&this._logDrawCallEnd(f,c,i),I}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:i,unbindModels:r=[]}=e;let{parameters:s}=e;i&&this._setFeedbackBuffers(i),n&&(s=Object.assign({},s,{[35977]:n})),r.forEach(o=>o.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:s}))}finally{r.forEach(o=>o.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Se.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:i,fs:r,modules:s,inject:o,defines:a,varyings:c,bufferMode:f,transpileToGLSL100:p}=this.programProps;n=this.programManager.get({vs:i,fs:r,modules:s,inject:o,defines:a,varyings:c,bufferMode:f,transpileToGLSL100:p}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}pe(n instanceof nS,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new D4(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ct&&n.delete()}}_setAnimationProps(e){this.animated&&pe(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Ra(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new iS(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:v8;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Se.group(Ro,">>> DRAWING MODEL ".concat(this.id),{collapsed:Se.level<=2})(),e}_logDrawCallEnd(e,n,i,r){if(e===void 0)return;const s=U4({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:a,unusedCount:c}=Zv({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i)}),{table:f,count:p}=Zv({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,i),undefinedOnly:!0});p>0&&Se.log("MISSING UNIFORMS",Object.keys(f))(),c>0&&Se.log("UNUSED UNIFORMS",Object.keys(a))();const m=z4(this.vertexArray.configuration);Se.table(e,s)(),Se.table(e,o)(),Se.table(e+1,m)(),r&&r.log({logLevel:Ro,message:"Rendered to ".concat(r.id)}),Se.groupEnd(Ro)()}}class T8{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:i,transformFeedback:r}=n;return{attributes:Object.assign({},i,e.attributes),transformFeedback:r}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],i=e?n[e]:null;return i?i instanceof ct?i:i.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,i=this.getBuffer(n);return i?i.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&pe(We(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,i={};if(this.bindings[this.currentIndex]&&Object.assign(i,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const s=this.feedbackMap[r];r in n&&(i[s]=r)}Object.assign(i,e.feedbackBuffers);for(const r in i){const s=i[r];if(typeof s=="string"){const o=n[s],{byteLength:a,usage:c,accessor:f}=o;i[r]=this._createNewBuffer(r,{byteLength:a,usage:c,accessor:f})}}return i}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const i=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:i})}_setupTransformFeedback(e,n){let{model:i}=n;const{program:r}=i;e.transformFeedback=new iS(this.gl,{program:r,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:i}=this._swapBuffers(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceBuffers:n,feedbackBuffers:i})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),i=Object.assign({},e.feedbackBuffers);for(const r in this.feedbackMap){const s=this.feedbackMap[r];n[r]=e.feedbackBuffers[s],i[s]=e.sourceBuffers[r],pe(i[s]instanceof ct)}return{sourceBuffers:n,feedbackBuffers:i}}_createNewBuffer(e,n){const i=new ct(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=i,i}_getNextIndex(){return(this.currentIndex+1)%2}}const C8="transform_uSampler_",zh="transform_uSize_",m2="transform_position";function b8(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,o=Object.keys(n).length,a=null;const c={};let f=e,p={};if(o>0||i){const m=f.split(`
`),v=m.slice();if(m.forEach((w,C,S)=>{if(o>0){const R=I8(w,n);if(R){const{updatedLine:x,inject:P}=R;v[C]=x,p=lp([p,P]),Object.assign(c,R.samplerTextureMap),o--}}i&&!a&&(a=M8(w,i))}),i){pe(r);const w="".concat(zh).concat(i),C="uniform vec2 ".concat(w,`;
`),S="     vec2 ".concat(m2," = transform_getPos(").concat(w,`);
     gl_Position = vec4(`).concat(m2,`, 0, 1.);
`);p=lp([p,{"vs:#decl":C,"vs:#main-start":S}])}f=v.join(`
`)}return{vs:f,targetTextureType:a,inject:p,samplerTextureMap:c}}function S8(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let s,o;n&&({width:s,height:o}=i,r["".concat(zh).concat(n)]=[s,o]);for(const a in e)({width:s,height:o}=e[a]),r["".concat(zh).concat(a)]=[s,o];return r}function x8(t){return cS(t,["attribute","in"])}function P8(t){const e="".concat(C8).concat(t),n="".concat(zh).concat(t),i="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:i}}function M8(t,e){const n=cS(t,["varying","out"]);return n&&n.name===e?n.type:null}function I8(t,e){const n={},i=x8(t);if(!i)return null;const{type:r,name:s}=i;if(s&&e[s]){const o="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:a,sizeName:c,uniformDeclerations:f}=P8(s),p=Ik(r),m="  ".concat(r," ").concat(s," = transform_getInput(").concat(a,", ").concat(c,").").concat(p,`;
`);return n[a]=s,{updatedLine:o,inject:{"vs:#decl":f,"vs:#main-start":m},samplerTextureMap:n}}return null}const B8={[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},L8="transform_output";class R8{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:i,framebuffer:r,targetTexture:s}=this.bindings[this.currentIndex],o=Object.assign({},n,e.attributes),a=Object.assign({},e.uniforms),c=Object.assign({},e.parameters);let f=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const m in this.samplerTextureMap){const v=this.samplerTextureMap[m];a[m]=i[v]}this._setSourceTextureParameters();const p=S8({sourceTextureMap:i,targetTextureVarying:this.targetTextureVarying,targetTexture:s});Object.assign(a,p)}return this.hasTargetTexture&&(f=!1,c.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:a,discard:f,parameters:c}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],i=If(n);if(!e)return i;const r=i.constructor,s=Bk(this.targetTextureType),o=new r(i.length*s/4);let a=0;for(let c=0;c<i.length;c+=4)for(let f=0;f<s;f++)o[a++]=i[c+f];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:i}=e;this._swapTexture=i,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:i}=e;if(i instanceof vn)return i;const r=n[i];return r?(this._targetRefTexName=i,this._createNewTexture(r)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:i={},_targetTexture:r}=e,s=this._createTargetTexture({sourceTextures:i,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||i&&Object.keys(i).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:i,targetTexture:s}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((i,r,s)=>{s[r]=r}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ct(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:i}=this._swapTextures(this.bindings[this.currentIndex]),r=this._getNextIndex();this.bindings[r]=this._updateBinding(this.bindings[r],{sourceTextures:n,targetTexture:i})}}_updateBinding(e,n){const{sourceBuffers:i,sourceTextures:r,targetTexture:s}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,r),Object.assign(e.sourceBuffers,i),s){e.targetTexture=s;const{width:o,height:a}=s,{framebuffer:c}=e;c?(c.update({attachments:{[36064]:s},resizeAttachments:!1}),c.resize({width:o,height:a})):e.framebuffer=new jt(this.gl,{id:"transform-framebuffer",width:o,height:a,attachments:{[36064]:s}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const i in n)n[i].setParameters(B8)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const i=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:i}}_createNewTexture(e){const n=qb(e,{parameters:{[10241]:9728,[10240]:9728,[10242]:33071,[10243]:33071},pixelStore:{[37440]:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:i}=this.bindings[this.currentIndex],{vs:r,uniforms:s,targetTextureType:o,inject:a,samplerTextureMap:c}=b8({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i}),f=lp([e.inject||{},a]);this.targetTextureType=o,this.samplerTextureMap=c;const p=e._fs||uS({version:eS(r),input:this.targetTextureVarying,inputType:o,output:L8}),m=this.hasSourceTextures||this.targetTextureVarying?[g8].concat(e.modules||[]):e.modules;return{vs:r,fs:p,modules:m,uniforms:s,inject:f}}}class _1{static isSupported(e){return We(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:i}=this;e&&e.delete(),n&&n.delete(),i&&i.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,i=this._updateDrawOptions(e);n&&i.framebuffer&&i.framebuffer.clear({color:!0}),this.model.transform(i)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)e=e||i.swap();pe(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n){const r=i.getData(e);if(r)return r}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of n)i.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Nn(n,Object.assign({},e,{fs:e.fs||uS({version:eS(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=r.updateModelProps(n);return n}_buildResourceTransforms(e,n){O8(n)&&(this.bufferTransform=new T8(e,n)),F8(n)&&(this.textureTransform=new R8(e,n)),pe(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const i=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of i)n=Object.assign(n,r.getDrawOptions(n));return n}}function O8(t){return!!(!Ra(t.feedbackBuffers)||!Ra(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function F8(t){return!!(!Ra(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const _2={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class pi{static get DRAW_MODE(){return _2}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=rr("geometry"),drawMode:i=_2.TRIANGLES,attributes:r={},indices:s=null,vertexCount:o=null}=e;this.id=n,this.drawMode=i|0,this.attributes={},this.userData={},this._setAttributes(r,s),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const i in e){let r=e[i];r=ArrayBuffer.isView(r)?{value:r}:r,pe(ArrayBuffer.isView(r.value),"".concat(this._print(i),": must be typed array or object with value as typed array")),(i==="POSITION"||i==="positions")&&!r.size&&(r.size=3),i==="indices"?(pe(!this.indices),this.indices=r):this.attributes[i]=r}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let i=1/0;for(const r in e){const s=e[r],{value:o,size:a,constant:c}=s;!c&&o&&a>=1&&(i=Math.min(i,o.length/a))}return pe(Number.isFinite(i)),i}}let D8=1,k8=1;class FS{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:i=Number.POSITIVE_INFINITY,rate:r=1,repeat:s=1}=e,o=D8++,a={time:0,delay:n,duration:i,rate:r,repeat:s};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(e){this.channels.delete(e);for(const[n,i]of this.animations)i.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const r of n)this._setChannelTime(r,this.time);const i=this.animations.values();for(const r of i){const{animation:s,channel:o}=r;s.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const i=k8++;return this.animations.set(i,{animation:e,channel:n}),e.setTime(this.getTime(n)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const i=n-e.delay,r=e.duration*e.repeat;i>=r?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}const DS="#define SMOOTH_EDGE_RADIUS 0.5",N8=`
`.concat(DS,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),U8=`
`.concat(DS,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),G8={name:"geometry",vs:N8,fs:U8},ze={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ze,"IDENTITY",{get:()=>(Re.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const Li={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Gi={common:0,meters:1,pixels:2},y2={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},sc={DRAW:"draw",MASK:"mask"},z8=Object.keys(ze).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(ze[t],";")).join(""),V8=Object.keys(Li).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(Li[t],";")).join(""),H8=Object.keys(Gi).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Gi[t],";")).join(""),j8="".concat(z8,`
`).concat(V8,`
`).concat(H8,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0; // meters
const float GLOBE_RADIUS = 256.0;

// returns an adjustment factor for uCommonUnitsPerMeter
float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {

    // uCommonUnitsPerMeter in low-zoom Web Mercator is non-linear
    // Adjust by 1 / cos(latitude)
    // If geometry.position (vertex in common space) is populated, use it
    // Otherwise use geometry.worldPosition (anchor in world space)
    
    if (geometry.position.w == 0.0) {
      float y = clamp(geometry.worldPosition.y, -89.9, 89.9);
      return 1.0 / cos(radians(y));
    }

    // latitude from common y: 2.0 * (atan(exp(y / TILE_SIZE * 2.0 * PI - PI)) - PI / 4.0)
    // Taylor series of 1 / cos(latitude)
    // Max error < 0.003
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}
//
// Scaling offsets - scales meters to "world distance"
// Note the scalar version of project_size is for scaling the z component only
//
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}

// Get rotation matrix that aligns the z axis with the given up vector
// Find 3 unit vectors ux, uy, uz that are perpendicular to each other and uz == up
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  // Tangent on XY plane
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}

//
// Projecting normal - transform deltas from current coordinate system to
// normals in the worldspace
//
vec3 project_normal(vec3 vector) {
  // Apply model matrix
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

//
// Projecting positions - non-linear projection: lnglats => unit tile [0-1, 0-1]
//
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

//
// Projects positions (defined by project_uCoordinateSystem) to common space (defined by project_uProjectionMode)
//
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;

  // Work around for a Mac+NVIDIA bug https://github.com/visgl/deck.gl/issues/4145
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size(position_world.z),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        // Too far from the projection center for offset mode to be accurate
        // Only use high parts
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    // Subtract high part of 64 bit value. Convert remainder to float32, preserving precision.
    position_world.xyz -= project_uCoordinateOrigin;
  }

  // Translation is already added to the high parts
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}

//
// Projects from common space coordinates to clip space.
// Uses project_uViewProjectionMatrix
//
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}

// Returns a clip space offset that corresponds to a given number of screen pixels
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  // UNIT_PIXELS
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function W8(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function oc(t){let e={},n;return i=>{for(const r in i)if(!W8(i[r],e[r])){n=t(i),e=i;break}return n}}const v2=[0,0,0,0],Q8=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],kS=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X8=[0,0,0],NS=[0,0,0],J8=oc(Z8);function US(t,e,n=NS){n.length<3&&(n=[n[0],n[1],0]);let i=n,r,s=!0;switch(e===ze.LNGLAT_OFFSETS||e===ze.METER_OFFSETS?r=n:r=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case Li.WEB_MERCATOR:(e===ze.LNGLAT||e===ze.CARTESIAN)&&(r=[0,0,0],s=!1);break;case Li.WEB_MERCATOR_AUTO_OFFSET:e===ze.LNGLAT?i=r:e===ze.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case Li.IDENTITY:i=t.position.map(Math.fround),i[2]=i[2]||0;break;case Li.GLOBE:s=!1,r=null;break;default:s=!1}return{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function Y8(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:s,viewProjectionMatrix:o}=t,a=v2,c=v2,f=t.cameraPosition;const{geospatialOrigin:p,shaderCoordinateOrigin:m,offsetMode:v}=US(t,e,n);return v&&(c=t.projectPosition(p||m),f=[f[0]-c[0],f[1]-c[1],f[2]-c[2]],c[3]=1,a=ja([],c,o),s=i||s,o=qs([],r,s),o=qs([],o,Q8)),{viewMatrix:s,viewProjectionMatrix:o,projectionCenter:a,originCommon:c,cameraPosCommon:f,shaderCoordinateOrigin:m,geospatialOrigin:p}}function K8({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=ze.DEFAULT,coordinateOrigin:r=NS,autoWrapLongitude:s=!1}){i===ze.DEFAULT&&(i=t.isGeospatial?ze.LNGLAT:ze.CARTESIAN);const o=J8({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return o.project_uWrapLongitude=s,o.project_uModelMatrix=n||kS,o}function Z8({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:s,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:c,geospatialOrigin:f}=Y8(t,n,i),p=t.getDistanceScales(),m=[t.width*e,t.height*e],v=ja([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,w={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:c,project_uCommonOrigin:o.slice(0,3),project_uCenter:r,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:m,project_uDevicePixelRatio:e,project_uFocalDistance:v,project_uCommonUnitsPerMeter:p.unitsPerMeter,project_uCommonUnitsPerWorldUnit:p.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:X8,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:s,project_uModelMatrix:kS,project_uCameraPosition:a};if(f){const C=t.getDistanceScales(f);switch(n){case ze.METER_OFFSETS:w.project_uCommonUnitsPerWorldUnit=C.unitsPerMeter,w.project_uCommonUnitsPerWorldUnit2=C.unitsPerMeter2;break;case ze.LNGLAT:case ze.LNGLAT_OFFSETS:t._pseudoMeters||(w.project_uCommonUnitsPerMeter=C.unitsPerMeter),w.project_uCommonUnitsPerWorldUnit=C.unitsPerDegree,w.project_uCommonUnitsPerWorldUnit2=C.unitsPerDegree2;break;case ze.CARTESIAN:w.project_uCommonUnitsPerWorldUnit=[1,1,C.unitsPerMeter[2]],w.project_uCommonUnitsPerWorldUnit2=[0,0,C.unitsPerMeter2[2]];break}}return w}const q8={};function $8(t=q8){return"viewport"in t?K8(t):{}}const y1={name:"project",dependencies:[Ok,G8],vs:j8,getUniforms:$8},e6=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,ar={name:"project32",dependencies:[y1],vs:e6};function t6(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function ma(t,e){const n=ja([],e,t);return d1(n,n,1/n[3]),n}function E2(t,e){const n=t%e;return n<0?e+n:n}function gp(t,e,n){return t<e?e:t>n?n:t}function n6(t){return Math.log(t)*Math.LOG2E}const v1=Math.log2||n6;function Pr(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const Ri=Math.PI,GS=Ri/4,ki=Ri/180,pp=180/Ri,Ll=512,mp=4003e4,hu=85.051129,i6=1.5;function r6(t){return v1(t)}function Fa(t){const[e,n]=t;Pr(Number.isFinite(e)),Pr(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=e*ki,r=n*ki,s=Ll*(i+Ri)/(2*Ri),o=Ll*(Ri+Math.log(Math.tan(GS+r*.5)))/(2*Ri);return[s,o]}function ms(t){const[e,n]=t,i=e/Ll*(2*Ri)-Ri,r=2*(Math.atan(Math.exp(n/Ll*(2*Ri)-Ri))-GS);return[i*pp,r*pp]}function zS(t){const{latitude:e}=t;Pr(Number.isFinite(e));const n=Math.cos(e*ki);return r6(mp*n)-9}function _p(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;Pr(Number.isFinite(e)&&Number.isFinite(n));const r=Ll,s=Math.cos(e*ki),o=r/360,a=o/s,c=r/mp/s,f={unitsPerMeter:[c,c,c],metersPerUnit:[1/c,1/c,1/c],unitsPerDegree:[o,a,c],degreesPerUnit:[1/o,1/a,1/c]};if(i){const p=ki*Math.tan(e*ki)/s,m=o*p/2,v=r/mp*p,w=v/a*c;f.unitsPerDegree2=[0,m,v],f.unitsPerMeter2=[w,0,w]}return f}function VS(t,e){const[n,i,r]=t,[s,o,a]=e,{unitsPerMeter:c,unitsPerMeter2:f}=_p({longitude:n,latitude:i,highPrecision:!0}),p=Fa(t);p[0]+=s*(c[0]+f[0]*o),p[1]+=o*(c[1]+f[1]*o);const m=ms(p),v=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[m[0],m[1],v]:m}function s6(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:s,center:o}=t,a=t6();Gh(a,a,[0,0,-r]),SS(a,a,-n*ki),xS(a,a,i*ki);const c=s/e;return f1(a,a,[c,c,c]),o&&Gh(a,a,Kk([],o)),a}function o6(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:s,center:o,scale:a,nearZMultiplier:c=1,farZMultiplier:f=1}=t;let{fovy:p=Vh(i6)}=t;i!==void 0&&(p=Vh(i));const m=p*ki,v=r*ki,w=E1(p);let C=w;o&&(C+=o[2]*a/Math.cos(v)/n);const S=m*(.5+(s?s[1]:0)/n),R=Math.sin(S)*C/Math.sin(gp(Math.PI/2-v-S,.01,Math.PI-.01)),x=Math.sin(v)*R+C,P=C*10,I=Math.min(x*f,P);return{fov:m,aspect:e/n,focalDistance:w,near:c,far:I}}function Vh(t){return 2*Math.atan(.5/t)*pp}function E1(t){return .5/Math.tan(.5*t*ki)}function HS(t,e){const[n,i,r=0]=t;return Pr(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),ma(e,[n,i,r,1])}function ac(t,e,n=0){const[i,r,s]=t;if(Pr(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(s))return ma(e,[i,r,s,1]);const o=ma(e,[i,r,0,1]),a=ma(e,[i,r,1,1]),c=o[2],f=a[2],p=c===f?0:((n||0)-c)/(f-c);return dS([],o,a,p)}function jS(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:s=24,offset:o=[0,0]}=t,[[a,c],[f,p]]=i,m=a6(t.padding),v=Fa([a,gp(p,-hu,hu)]),w=Fa([f,gp(c,-hu,hu)]),C=[Math.max(Math.abs(w[0]-v[0]),r),Math.max(Math.abs(w[1]-v[1]),r)],S=[e-m.left-m.right-Math.abs(o[0])*2,n-m.top-m.bottom-Math.abs(o[1])*2];Pr(S[0]>0&&S[1]>0);const R=S[0]/C[0],x=S[1]/C[1],P=(m.right-m.left)/2/R,I=(m.bottom-m.top)/2/x,F=[(w[0]+v[0])/2+P,(w[1]+v[1])/2+I],H=ms(F),Q=Math.min(s,v1(Math.abs(Math.min(R,x))));return Pr(Number.isFinite(Q)),{longitude:H[0],latitude:H[1],zoom:Q}}function a6(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(Pr(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const w2=Math.PI/180;function A6(t,e=0){const{width:n,height:i,unproject:r}=t,s={targetZ:e},o=r([0,i],s),a=r([n,i],s);let c,f;const p=t.fovy?.5*t.fovy*w2:Math.atan(.5/t.altitude),m=(90-t.pitch)*w2;return p>m-.01?(c=T2(t,0,e),f=T2(t,n,e)):(c=r([0,0],s),f=r([n,0],s)),[o,a,f,c]}function T2(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=ma(i,[e,0,1,1]),s=ma(i,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-r[2])/(s[2]-r[2]),c=dS([],r,s,a),f=ms(c);return f.push(n),f}const C2=512;function l6(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:s,zoom:o,bearing:a=0}=t;(r<-180||r>180)&&(r=E2(r+180,360)-180),(a<-180||a>180)&&(a=E2(a+180,360)-180);const c=v1(n/C2);if(o<=c)o=c,s=0;else{const f=n/2/Math.pow(2,o),p=ms([0,f])[1];if(s<p)s=p;else{const m=ms([0,C2-f])[1];s>m&&(s=m)}}return{width:e,height:n,longitude:r,latitude:s,zoom:o,pitch:i,bearing:a}}const c6=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,u6=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,h6=oc(m6),f6=oc(_6),d6=[0,0,0,1],g6=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function p6(t,e){const[n,i,r]=t,s=ac([n,i,r],e);return Number.isFinite(r)?s:[s[0],s[1],0]}function m6({viewport:t,center:e}){return new De(t.viewProjectionMatrix).invert().transform(e)}function _6({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,s=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(o=>p6(o,i));for(const o of e){const a=o.clone().translate(new K(t.center).negate()),c=s.map(p=>a.transform(p)),f=new De().ortho({left:Math.min(...c.map(p=>p[0])),right:Math.max(...c.map(p=>p[0])),bottom:Math.min(...c.map(p=>p[1])),top:Math.max(...c.map(p=>p[1])),near:Math.min(...c.map(p=>-p[2])),far:Math.max(...c.map(p=>-p[2]))});n.push(f.multiplyRight(o))}return n}function y6(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||d6,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=h6({viewport:t.viewport,center:e.project_uCenter}),s=[],o=f6({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let a=0;a<t.shadowMatrices.length;a++){const c=o[a],f=c.clone().translate(new K(t.viewport.center).negate());e.project_uCoordinateSystem===ze.LNGLAT&&e.project_uProjectionMode===Li.WEB_MERCATOR?(o[a]=f,s[a]=r):(o[a]=c.clone().multiplyRight(g6),s[a]=f.transform(r))}for(let a=0;a<o.length;a++)i["shadow_uViewProjectionMatrices[".concat(a,"]")]=o[a],i["shadow_uProjectCenters[".concat(a,"]")]=s[a],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(a)]=t.shadowMaps[a]:i["shadow_uShadowMap".concat(a)]=t.dummyShadowMap;return i}const d0={name:"shadow",dependencies:[y1],vs:c6,fs:u6,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?y6(t,e):{}},Ar={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...l8},v6=[y1],E6=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function w6(t){const e=rc.getDefaultProgramManager(t);for(const n of v6)e.addDefaultModule(n);for(const n of E6)e.addShaderHook(n);return e}const T6=[255,255,255],C6=1;let b6=0;class WS{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","ambient");const{color:n=T6}=e,{intensity:i=C6}=e;this.id=e.id||"ambient-".concat(b6++),this.color=n,this.intensity=i}}const S6=[255,255,255],x6=1,P6=[0,0,-1];let M6=0;class b2{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","directional"),T(this,"direction",void 0),T(this,"shadow",void 0);const{color:n=S6}=e,{intensity:i=x6}=e,{direction:r=P6}=e,{_shadow:s=!1}=e;this.id=e.id||"directional-".concat(M6++),this.color=n,this.intensity=i,this.type="directional",this.direction=new K(r).normalize().toArray(),this.shadow=s}getProjectedLight(e){return this}}class I6{constructor(e,n={id:"pass"}){T(this,"id",void 0),T(this,"gl",void 0),T(this,"props",void 0);const{id:i}=n;this.id=i,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class Rf extends I6{constructor(...e){super(...e),T(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return xr(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:i,viewports:r,views:s,onViewportActive:o,clearStack:a=!0,clearCanvas:c=!0}=e;e.pass=e.pass||"unknown";const f=this.gl;c&&L6(f),a&&(this._lastRenderIndex=-1);const p=[];for(const m of r){const v=s&&s[m.id];o(m);const w=this._getDrawLayerParams(m,e),C=m.subViewports||[m];for(const S of C){const R=this._drawLayersInViewport(f,{target:n,moduleParameters:i,viewport:S,view:v,pass:e.pass,layers:e.layers},w);p.push(R)}}return p}_getDrawLayerParams(e,{layers:n,pass:i,layerFilter:r,cullRect:s,effects:o,moduleParameters:a}){const c=[],f=QS(this._lastRenderIndex+1),p={layer:n[0],viewport:e,isPicking:i.startsWith("picking"),renderPass:i,cullRect:s},m={};for(let v=0;v<n.length;v++){const w=n[v],C=this._shouldDrawLayer(w,p,r,m),S={shouldDrawLayer:C};C&&(S.layerRenderIndex=f(w,C),S.moduleParameters=this._getModuleParameters(w,o,i,a),S.layerParameters=this.getLayerParameters(w,v,e)),c[v]=S}return c}_drawLayersInViewport(e,{layers:n,moduleParameters:i,pass:r,target:s,viewport:o,view:a},c){const f=B6(e,{moduleParameters:i,target:s,viewport:o});if(a&&a.props.clear){const m=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;gi(e,{scissorTest:!0,scissor:f},()=>e1(e,m))}const p={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};xr(e,{viewport:f});for(let m=0;m<n.length;m++){const v=n[m],{shouldDrawLayer:w,layerRenderIndex:C,moduleParameters:S,layerParameters:R}=c[m];if(w&&v.props.pickable&&p.pickableCount++,v.isComposite)p.compositeCount++;else if(w){p.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,C),S.viewport=o;try{v._drawLayer({moduleParameters:S,uniforms:{layerIndex:C},parameters:R})}catch(x){v.raiseError(x,"drawing ".concat(v," to ").concat(r))}}}return p}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,i){return e.props.parameters}_shouldDrawLayer(e,n,i,r){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let o=e.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(n))return!1;n.layer=o,o=o.parent}if(i){const a=n.layer.id;if(a in r||(r[a]=i(n)),!r[a])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,i,r){var s;const o=Object.assign(Object.create(((s=e.internalState)===null||s===void 0?void 0:s.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:La(this.gl)});if(n)for(const c of n){var a;Object.assign(o,(a=c.getModuleParameters)===null||a===void 0?void 0:a.call(c,e))}return Object.assign(o,this.getModuleParameters(e,n),r)}}function QS(t=0,e={}){const n={},i=(r,s)=>{const o=r.props._offset,a=r.id,c=r.parent&&r.parent.id;let f;if(c&&!(c in e)&&i(r.parent,!1),c in n){const p=n[c]=n[c]||QS(e[c],e);f=p(r,s),n[a]=p}else Number.isFinite(o)?(f=o+(e[c]||0),n[a]=null):f=t;return s&&f>=t&&(t=f+1),e[a]=f,f};return i}function B6(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&n.id!=="default-framebuffer",s=e&&e.devicePixelRatio||La(t),o=r?n.height:t.drawingBufferHeight,a=i;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}function L6(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;xr(t,{viewport:[0,0,e,n]}),t.clear(16640)}class R6 extends Rf{constructor(e,n){super(e,n),T(this,"shadowMap",void 0),T(this,"depthBuffer",void 0),T(this,"fbo",void 0),this.shadowMap=new vn(e,{width:1,height:1,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.depthBuffer=new ta(e,{format:33189,width:1,height:1}),this.fbo=new jt(e,{id:"shadowmap",width:1,height:1,attachments:{[36064]:this.shadowMap,[36096]:this.depthBuffer}})}render(e){const n=this.fbo;gi(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const i=e.viewports[0],r=La(this.gl),s=i.width*r,o=i.height*r;(s!==n.width||o!==n.height)&&n.resize({width:s,height:o}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const O6={color:[255,255,255],intensity:1},S2=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],F6=[0,0,0,200/255];class w1{constructor(e={}){T(this,"id","lighting-effect"),T(this,"props",null),T(this,"shadowColor",F6),T(this,"shadow",void 0),T(this,"ambientLight",null),T(this,"directionalLights",[]),T(this,"pointLights",[]),T(this,"shadowPasses",[]),T(this,"shadowMaps",[]),T(this,"dummyShadowMap",null),T(this,"programManager",void 0),T(this,"shadowMatrices",void 0);for(const n in e){const i=e[n];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow)}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:o}){if(!!this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=rc.getDefaultProgramManager(e),d0&&this.programManager.addDefaultModule(d0)),this.dummyShadowMap||(this.dummyShadowMap=new vn(e,{width:1,height:1}));for(let a=0;a<this.shadowPasses.length;a++)this.shadowPasses[a].render({layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:o,moduleParameters:{shadowLightId:a,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:e})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(d0),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const i=new De().lookAt({eye:new K(n.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const i=new R6(e);this.shadowPasses[n]=i,this.shadowMaps[n]=i.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:i}=this;!e&&n.length===0&&i.length===0&&(this.ambientLight=new WS(O6),this.directionalLights.push(new b2(S2[0]),new b2(S2[1])))}}class D6{constructor(e={}){T(this,"_pool",[]),T(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:i=1,type:r,padding:s=0,copy:o=!1,initialize:a=!1,maxCount:c}){const f=r||e&&e.constructor||Float32Array,p=n*i+s;if(ArrayBuffer.isView(e)){if(p<=e.length)return e;if(p*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new f(e.buffer,0,p)}let m=1/0;c&&(m=c*i+s);const v=this._allocate(f,p,a,m);return e&&o?v.set(e):a||v.fill(0,0,4),this._release(e),v}release(e){this._release(e)}_allocate(e,n,i,r){let s=Math.max(Math.ceil(n*this.opts.overAlloc),1);s>r&&(s=r);const o=this._pool,a=e.BYTES_PER_ELEMENT*s,c=o.findIndex(f=>f.byteLength>=a);if(c>=0){const f=new e(o.splice(c,1)[0],0,s);return i&&f.fill(0),f}return new e(s)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:i}=e,{byteLength:r}=i,s=n.findIndex(o=>o.byteLength>=r);s<0?n.push(i):(s>0||n.length<this.opts.poolSize)&&n.splice(s,0,i),n.length>this.opts.poolSize&&n.shift()}}const Da=new D6;function HA(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Hh(t,e){const n=t%e;return n<0?e+n:n}function k6(t){return[t[12],t[13],t[14]]}function N6(t){return{left:Oo(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Oo(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Oo(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Oo(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Oo(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Oo(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const x2=new K;function Oo(t,e,n,i){x2.set(t,e,n);const r=x2.len();return{distance:i/r,normal:new K(-t/r,-e/r,-n/r)}}function U6(t){return t-Math.fround(t)}let SA;function g0(t,e){const{size:n=1,startIndex:i=0}=e,r=e.endIndex!==void 0?e.endIndex:t.length,s=(r-i)/n;SA=Da.allocate(SA,s,{type:Float32Array,size:n*2});let o=i,a=0;for(;o<r;){for(let c=0;c<n;c++){const f=t[o++];SA[a+c]=f,SA[a+c+n]=U6(f)}a+=n*2}return SA.subarray(0,s*n*2)}const G6=Math.PI/180,z6=HA(),P2=[0,0,0],V6={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function H6({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:s,near:o,far:a}){const c=t/e,f=n?new De().orthographic({fovy:i,aspect:c,focalDistance:r,near:o,far:a}):new De().perspective({fovy:i,aspect:c,near:o,far:a});if(s){const{left:p=0,right:m=0,top:v=0,bottom:w=0}=s,C=kt((p+t-m)/2,0,t)-t/2,S=kt((v+e-w)/2,0,e)-e/2;f[8]-=C*2/t,f[9]+=S*2/e}return f}class lr{constructor(e={}){T(this,"id",void 0),T(this,"x",void 0),T(this,"y",void 0),T(this,"width",void 0),T(this,"height",void 0),T(this,"isGeospatial",void 0),T(this,"zoom",void 0),T(this,"focalDistance",void 0),T(this,"position",void 0),T(this,"modelMatrix",void 0),T(this,"distanceScales",void 0),T(this,"scale",void 0),T(this,"center",void 0),T(this,"cameraPosition",void 0),T(this,"projectionMatrix",void 0),T(this,"viewMatrix",void 0),T(this,"viewMatrixUncentered",void 0),T(this,"viewMatrixInverse",void 0),T(this,"viewProjectionMatrix",void 0),T(this,"pixelProjectionMatrix",void 0),T(this,"pixelUnprojectionMatrix",void 0),T(this,"resolution",void 0),T(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.distanceScales=e.distanceScales||V6,this.focalDistance=e.focalDistance||1,this.position=e.position||P2,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?Li.WEB_MERCATOR:Li.WEB_MERCATOR_AUTO_OFFSET:Li.IDENTITY}equals(e){return e instanceof lr?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&_n(e.projectionMatrix,this.projectionMatrix)&&_n(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const i=this.projectPosition(e),r=HS(i,this.pixelProjectionMatrix),[s,o]=r,a=n?o:this.height-o;return e.length===2?[s,a]:[s,a,r[2]]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,o]=e,a=n?s:this.height-s,c=i&&i*this.distanceScales.unitsPerMeter[2],f=ac([r,a,o],this.pixelUnprojectionMatrix,c),[p,m,v]=this.unprojectPosition(f);return Number.isFinite(o)?[p,m,v]:Number.isFinite(i)?[p,m,i]:[p,m]}projectPosition(e){const[n,i]=this.projectFlat(e),r=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,i,r]}unprojectPosition(e){const[n,i]=this.unprojectFlat(e),r=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,i,r]}projectFlat(e){if(this.isGeospatial){const n=Fa(e);return n[1]=kt(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?ms(e):e}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,0],n),r=this.unproject([this.width,0],n),s=this.unproject([0,this.height],n),o=this.unproject([this.width,this.height],n);return[Math.min(i[0],r[0],s[0],o[0]),Math.min(i[1],r[1],s[1],o[1]),Math.max(i[0],r[0],s[0],o[0]),Math.max(i[1],r[1],s[1],o[1])]}getDistanceScales(e){return e?_p({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:i=1,height:r=1}){return e<this.x+this.width&&this.x<e+i&&n<this.y+this.height&&this.y<n+r}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,N6(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=zS({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||_p({latitude:i,longitude:n}));const r=Math.pow(2,this.zoom);this.scale=r;const{position:s,modelMatrix:o}=e;let a=P2;if(s&&(a=o?new De(o).transformAsVector(s,[]):s),this.isGeospatial){const c=this.projectPosition([n,i,0]);this.center=new K(a).scale(this.distanceScales.unitsPerMeter).add(c)}else this.center=this.projectPosition(a)}_initMatrices(e){const{viewMatrix:n=z6,projectionMatrix:i=null,orthographic:r=!1,fovyRadians:s,fovy:o=75,near:a=.1,far:c=1e3,padding:f=null,focalDistance:p=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new De().multiplyRight(n).translate(new K(this.center).negate()),this.projectionMatrix=i||H6({width:this.width,height:this.height,orthographic:r,fovyRadians:s||o*G6,focalDistance:p,padding:f,near:a,far:c});const m=HA();qs(m,m,this.projectionMatrix),qs(m,m,this.viewMatrix),this.viewProjectionMatrix=m,this.viewMatrixInverse=fp([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=k6(this.viewMatrixInverse);const v=HA(),w=HA();f1(v,v,[this.width/2,-this.height/2,1]),Gh(v,v,[1,-1,0]),qs(w,v,this.viewProjectionMatrix),this.pixelProjectionMatrix=w,this.pixelUnprojectionMatrix=fp(HA(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Re.warn("Pixel project matrix not invertible")()}}T(lr,"displayName","Viewport");const j6=512,W6=4003e4,Q6=Math.PI/180;function M2(t){const e=Math.cos(t*Q6);return j6/W6/e}class sr extends lr{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,pitch:s=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:c=1.01,orthographic:f=!1,projectionMatrix:p,repeat:m=!1,worldOffset:v=0,legacyMeterSizes:w=!1}=e;let{width:C,height:S,altitude:R=1.5}=e;const x=Math.pow(2,r);C=C||1,S=S||1;let P,I=null;p?(R=p[5]/2,P=Vh(R)):(e.fovy?(P=e.fovy,R=E1(P)):P=Vh(R),I=o6({width:C,height:S,pitch:s,fovy:P,nearZMultiplier:a,farZMultiplier:c}));let F=s6({height:S,pitch:s,bearing:o,scale:x,altitude:R});v&&(F=new De().translate([512*v,0,0]).multiplyLeft(F)),super({...e,width:C,height:S,viewMatrix:F,longitude:i,latitude:n,zoom:r,...I,fovy:P,focalDistance:R}),T(this,"longitude",void 0),T(this,"latitude",void 0),T(this,"pitch",void 0),T(this,"bearing",void 0),T(this,"altitude",void 0),T(this,"fovy",void 0),T(this,"orthographic",void 0),T(this,"_subViewports",void 0),T(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=i,this.zoom=r,this.pitch=s,this.bearing=o,this.altitude=R,this.fovy=P,this.orthographic=f,this._subViewports=m?[]:null,this._pseudoMeters=w,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let r=n;r<=i;r++){const s=r?new sr({...this,worldOffset:r}):this;this._subViewports.push(s)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,i]=this.projectFlat(e),r=(e[2]||0)*M2(e[1]);return[n,i,r]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,i]=this.unprojectFlat(e),r=(e[2]||0)/M2(i);return[n,i,r]}addMetersToLngLat(e,n){return VS(e,n)}panByPosition(e,n){const i=ac(n,this.pixelUnprojectionMatrix),r=this.projectFlat(e),s=Uh([],r,fS([],i)),o=Uh([],this.center,s),[a,c]=this.unprojectFlat(o);return{longitude:a,latitude:c}}getBounds(e={}){const n=A6(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:i,height:r}=this,{longitude:s,latitude:o,zoom:a}=jS({width:i,height:r,bounds:e,...n});return new sr({width:i,height:r,longitude:s,latitude:o,zoom:a})}}T(sr,"displayName","WebMercatorViewport");function p0(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof sr){const[r,s,o=0]=t,a=e.getDistanceScales([r,s]);i[2]=o*a.unitsPerMeter[2]}return i}function X6(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:s,fromCoordinateOrigin:o}=t;return r===ze.DEFAULT&&(r=e.isGeospatial?ze.LNGLAT:ze.CARTESIAN),s===void 0&&(s=r),o===void 0&&(o=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:s,fromCoordinateOrigin:o}}function XS(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:s}){let[o,a,c=0]=t;switch(n&&([o,a,c]=ja([],[o,a,c,1],n)),i){case ze.LNGLAT:return p0([o,a,c],e,s);case ze.LNGLAT_OFFSETS:return p0([o+r[0],a+r[1],c+(r[2]||0)],e,s);case ze.METER_OFFSETS:return p0(VS(r,[o,a,c]),e,s);case ze.CARTESIAN:default:return e.isGeospatial?[o+r[0],a+r[1],c+r[2]]:e.projectPosition([o,a,c])}}function JS(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:s,fromCoordinateSystem:o,fromCoordinateOrigin:a}=X6(e),{geospatialOrigin:c,shaderCoordinateOrigin:f,offsetMode:p}=US(n,i,r),m=XS(t,{viewport:n,modelMatrix:s,coordinateSystem:o,coordinateOrigin:a,offsetMode:p});if(p){const v=n.projectPosition(c||f);TS(m,m,v)}return m}const J6=[255,255,255],Y6=1,K6=[0,0,1],Z6=[0,0,1];let q6=0;class $6{constructor(e={}){T(this,"id",void 0),T(this,"color",void 0),T(this,"intensity",void 0),T(this,"type","point"),T(this,"position",void 0),T(this,"attenuation",void 0),T(this,"projectedLight",void 0);const{color:n=J6}=e,{intensity:i=Y6}=e,{position:r=Z6}=e;this.id=e.id||"point-".concat(q6++),this.color=n,this.intensity=i,this.type="point",this.position=r,this.attenuation=eU(e),this.projectedLight={...this}}getProjectedLight({layer:e}){const{projectedLight:n}=this,i=e.context.viewport,{coordinateSystem:r,coordinateOrigin:s}=e.props,o=JS(this.position,{viewport:i,coordinateSystem:r,coordinateOrigin:s,fromCoordinateSystem:i.isGeospatial?ze.LNGLAT:ze.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=o,n}}function eU(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:K6}const zo={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},jh=Symbol.for("component"),_a=Symbol.for("asyncPropDefaults"),so=Symbol.for("asyncPropOriginal"),ns=Symbol.for("asyncPropResolved");function Of(t,e=()=>!0){return Array.isArray(t)?YS(t,e,[]):e(t)?[t]:[]}function YS(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?YS(r,e,n):e(r)&&n.push(r)}return n}function tU({target:t,source:e,start:n=0,count:i=1}){const r=e.length,s=i*r;let o=0;for(let a=n;o<r;o++)t[a++]=e[o];for(;o<s;)o<s-o?(t.copyWithin(n+o,n,n+o),o*=2):(t.copyWithin(n+o,n,n+s-o),o=s);return t}class nU{constructor(e,n,i){T(this,"id",void 0),T(this,"context",void 0),T(this,"isLoaded",void 0),T(this,"persistent",void 0),T(this,"_loadCount",0),T(this,"_subscribers",new Set),T(this,"_data",void 0),T(this,"_loader",void 0),T(this,"_error",void 0),T(this,"_content",void 0),this.id=e,this.context=i,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const i=++this._loadCount;let r=e;typeof e=="string"&&(r=Sr(e)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=s)}).catch(s=>{this._loadCount===i&&(this.isLoaded=!0,this._error=s||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const s of this._subscribers)s.onChange(this.getData())}}class iU{constructor({gl:e,protocol:n}){T(this,"protocol",void 0),T(this,"_context",void 0),T(this,"_resources",void 0),T(this,"_consumers",void 0),T(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:i=!1,persistent:r=!0}){let s=this._resources[e];s?s.setData(n,i):(s=new nU(e,n,this._context),this._resources[e]=s),s.persistent=r}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const i in n){const r=n[i],s=this._resources[r.resourceId];s&&s.unsubscribe(r)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:i,requestId:r="default"}){const{_resources:s,protocol:o}=this;e.startsWith(o)&&(e=e.replace(o,""),s[e]||this.add({resourceId:e,data:null,persistent:!1}));const a=s[e];if(this._track(i,r,a,n),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,i,r){const s=this._consumers,o=s[e]=s[e]||{},a=o[n]||{},c=a.resourceId&&this._resources[a.resourceId];c&&(c.unsubscribe(a),this.prune()),i&&(o[n]=a,a.onChange=r,a.resourceId=i.id,i.subscribe(a))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const rU="layerManager.setLayers",sU="layerManager.activateViewport";class oU{constructor(e,{deck:n,stats:i,viewport:r,timeline:s}={}){T(this,"layers",void 0),T(this,"context",void 0),T(this,"resourceManager",void 0),T(this,"_lastRenderedLayers",[]),T(this,"_needsRedraw",!1),T(this,"_needsUpdate",!1),T(this,"_nextLayers",null),T(this,"_debug",!1),T(this,"activateViewport",o=>{dn(sU,this,o),o&&(this.context.viewport=o)}),this.layers=[],this.resourceManager=new iU({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&w6(e),stats:i||new ql({id:"deck.gl"}),viewport:r||new lr({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:s||new FS,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const r=i.getNeedsRedraw(e);n=n||r}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(i=>n.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){dn(rU,this,n,e),this._lastRenderedLayers=e;const i=Of(e,Boolean);for(const r of i)r.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,i){i.raiseError(n,"".concat(e," of ").concat(i))}_updateLayers(e,n){const i={};for(const o of e)i[o.id]?Re.warn("Multiple old layers with same id ".concat(o.id))():i[o.id]=o;const r=[];this._updateSublayersRecursively(n,i,r),this._finalizeOldLayers(i);let s=!1;for(const o of r)if(o.hasUniformTransition()){s="Uniform transition in ".concat(o);break}this._needsUpdate=s,this.layers=r}_updateSublayersRecursively(e,n,i){for(const r of e){r.context=this.context;const s=n[r.id];s===null&&Re.warn("Multiple new layers with same id ".concat(r.id))(),n[r.id]=null;let o=null;try{this._debug&&s!==r&&r.validateProps(),s?(this._transferLayerState(s,r),this._updateLayer(r)):this._initializeLayer(r),i.push(r),o=r.isComposite?r.getSubLayers():null}catch(a){this._handleError("matching",a,r)}o&&this._updateSublayersRecursively(o,n,i)}}_finalizeOldLayers(e){for(const n in e){const i=e[n];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=zo.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=zo.MATCHED,n!==e&&(e.lifecycle=zo.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=zo.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=zo.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function fo(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const i=t[n],r=e[n];if(!(i===r||Array.isArray(i)&&Array.isArray(r)&&fo(i,r)))return!1}return!0}class aU{constructor(e){T(this,"width",void 0),T(this,"height",void 0),T(this,"views",void 0),T(this,"viewState",void 0),T(this,"controllers",void 0),T(this,"timeline",void 0),T(this,"_viewports",void 0),T(this,"_viewportMap",void 0),T(this,"_isUpdating",void 0),T(this,"_needsRedraw",void 0),T(this,"_needsUpdate",void 0),T(this,"_eventManager",void 0),T(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,i=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,n){const i=this.getViewports(),r={x:e[0],y:e[1]};for(let s=i.length-1;s>=0;--s){const o=i[s];if(o.containsPixel(r)){const a=e.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Of(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!fo(e,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Re.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const i=n.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:s=>e.makeViewport({viewState:s,width:this.width,height:this.height})})}_updateController(e,n,i,r){const s=e.controller;if(s){const o={...n,...s,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return r||(r=this._createController(e,o)),r&&r.setProps(o),r}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let r=e.length;r--;){const s=e[r],o=this.getViewState(s),a=s.makeViewport({viewState:o,width:this.width,height:this.height});let c=n[s.id];const f=Boolean(s.controller);f&&!c&&(i=!0),(i||!f)&&c&&(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,o,a,c),this._viewports.unshift(a)}for(const r in n){const s=n[r];s&&!this.controllers[r]&&s.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((i,r)=>!e[r].equals(n[r]))}}const AU=/([0-9]+\.?[0-9]*)(%|px)/;function jr(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=AU.exec(t);if(e&&e.length>=3){const n=e[2]==="%",i=parseFloat(e[1]);return{position:n?i/100:i,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function Wr(t,e){return t.relative?Math.round(t.position*e):t.position}function tn(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class or{constructor(e){T(this,"id",void 0),T(this,"viewportInstance",void 0),T(this,"_x",void 0),T(this,"_y",void 0),T(this,"_width",void 0),T(this,"_height",void 0),T(this,"_padding",void 0),T(this,"props",void 0);const{id:n,x:i=0,y:r=0,width:s="100%",height:o="100%",padding:a=null,viewportInstance:c}=e||{};tn(!c||c instanceof lr),this.viewportInstance=c,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=jr(i),this._y=jr(r),this._width=jr(s),this._height=jr(o),this._padding=a&&{left:jr(a.left||0),right:jr(a.right||0),top:jr(a.top||0),bottom:jr(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&fo(this.props,e.props)}makeViewport({width:e,height:n,viewState:i}){if(this.viewportInstance)return this.viewportInstance;i=this.filterViewState(i);const r=this.getDimensions({width:e,height:n});return new this.ViewportType({...i,...this.props,...r})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const i in this.props.viewState)i!=="id"&&(n[i]=this.props.viewState[i]);return n}return e}getDimensions({width:e,height:n}){const i={x:Wr(this._x,e),y:Wr(this._y,n),width:Wr(this._width,e),height:Wr(this._height,n)};return this._padding&&(i.padding={left:Wr(this._padding.left,e),top:Wr(this._padding.top,n),right:Wr(this._padding.right,e),bottom:Wr(this._padding.bottom,n)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class Ac{constructor(e){T(this,"_inProgress",void 0),T(this,"_handle",void 0),T(this,"_timeline",void 0),T(this,"time",void 0),T(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,i;this.cancel(),this.settings=e,this._inProgress=!0,(n=(i=this.settings).onStart)===null||n===void 0||n.call(i,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:i,settings:r}=this;this._handle=i.addChannel({delay:i.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const I2=()=>{},yp={BREAK:1,SNAP_TO_END:2,IGNORE:3},lU=t=>t,cU=yp.BREAK;class uU{constructor(e){T(this,"getControllerState",void 0),T(this,"props",void 0),T(this,"propsInTransition",void 0),T(this,"transition",void 0),T(this,"onViewStateChange",void 0),T(this,"onStateChange",void 0),T(this,"_onTransitionUpdate",n=>{const{time:i,settings:{interpolator:r,startProps:s,endProps:o,duration:a,easing:c}}=n,f=c(i/a),p=r.interpolateProps(s,o,f);this.propsInTransition=this.getControllerState({...this.props,...p}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new Ac(e.timeline),this.onViewStateChange=e.onViewStateChange||I2,this.onStateChange=e.onStateChange||I2}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let r=i;if(this.transition.inProgress){const{interruption:s,endProps:o}=this.transition.settings;r={...i,...s===yp.SNAP_TO_END?o:this.propsInTransition||i}}this._triggerTransition(r,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:i}=e;return(n>0||n==="auto")&&Boolean(i)}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===yp.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const i=this.getControllerState(e),r=this.getControllerState(n).shortestPathFrom(i),s=n.transitionInterpolator,o=s.getDuration?s.getDuration(e,n):n.transitionDuration;if(o===0)return;const a=s.initializeProps(e,r);this.propsInTransition={};const c={duration:o,easing:n.transitionEasing||lU,interpolator:s,interruption:n.transitionInterruption||cU,startProps:a.start,endProps:a.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(c),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class hU{constructor(e){T(this,"_propsToCompare",void 0),T(this,"_propsToExtract",void 0),T(this,"_requiredProps",void 0);const{compare:n,extract:i,required:r}=e;this._propsToCompare=n,this._propsToExtract=i||n,this._requiredProps=r}arePropsEqual(e,n){for(const i of this._propsToCompare)if(!(i in e)||!(i in n)||!_n(e[i],n[i]))return!1;return!0}initializeProps(e,n){const i={},r={};for(const s of this._propsToExtract)(s in e||s in n)&&(i[s]=e[s],r[s]=n[s]);return this._checkRequiredProps(i),this._checkRequiredProps(r),{start:i,end:r}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){!this._requiredProps||this._requiredProps.forEach(n=>{const i=e[n];tn(Number.isFinite(i)||Array.isArray(i),"".concat(n," is required for transition"))})}}const fU=["longitude","latitude","zoom","bearing","pitch"],dU=["longitude","latitude","zoom"];class Wa extends hU{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:fU,required:dU},super(i.transitionProps),T(this,"opts",void 0),this.opts=i}initializeProps(e,n){const i=super.initializeProps(e,n),{makeViewport:r,around:s}=this.opts;if(r&&s){const o=r(e),a=r(n),c=o.unproject(s);i.start.around=s,Object.assign(i.end,{around:a.project(c),aroundPosition:c,width:n.width,height:n.height})}return i}interpolateProps(e,n,i){const r={};for(const s of this._propsToExtract)r[s]=ps(e[s]||0,n[s]||0,i);if(n.aroundPosition&&this.opts.makeViewport){const s=this.opts.makeViewport({...n,...r});Object.assign(r,s.panByPosition(n.aroundPosition,ps(e.around,n.around,i)))}return r}}const Qr={transitionDuration:0},gU=300,fu=t=>1-(1-t)*(1-t),Fo={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Fs={};class lc{constructor(e){T(this,"props",void 0),T(this,"state",{}),T(this,"transitionManager",void 0),T(this,"eventManager",void 0),T(this,"onViewStateChange",void 0),T(this,"onStateChange",void 0),T(this,"makeViewport",void 0),T(this,"_controllerState",void 0),T(this,"_events",{}),T(this,"_interactionState",{isDragging:!1}),T(this,"_customEvents",[]),T(this,"_eventStartBlocked",null),T(this,"_panMove",!1),T(this,"invertPan",!1),T(this,"dragMode","rotate"),T(this,"inertia",0),T(this,"scrollZoom",!0),T(this,"dragPan",!0),T(this,"dragRotate",!0),T(this,"doubleClickZoom",!0),T(this,"touchZoom",!0),T(this,"touchRotate",!1),T(this,"keyboard",!0),this.transitionManager=new uU({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:i}=this.props,{offsetCenter:r}=e;return[r.x-n,r.y-i]}isPointInBounds(e,n){const{width:i,height:r}=this.props;if(n&&n.handled)return!1;const s=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=r;return s&&n&&n.stopPropagation(),s}isFunctionKeyPressed(e){const{srcEvent:n}=e;return Boolean(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?gU:0;const{scrollZoom:i=!0,dragPan:r=!0,dragRotate:s=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:c=!1,keyboard:f=!0}=e,p=Boolean(this.onViewStateChange);this.toggleEvents(Fo.WHEEL,p&&i),this.toggleEvents(Fo.PAN,p&&(r||s)),this.toggleEvents(Fo.PINCH,p&&(a||c)),this.toggleEvents(Fo.TRIPLE_PAN,p&&c),this.toggleEvents(Fo.DOUBLE_TAP,p&&o),this.toggleEvents(Fo.KEYBOARD,p&&f),this.scrollZoom=i,this.dragPan=r,this.dragRotate=s,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=c,this.keyboard=f}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(i=>{this._events[i]!==n&&(this._events[i]=n,n?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,n=null,i={}){const r={...e.getViewportProps(),...n},s=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),s){const o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:o})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const r=this.controllerState[i?"panStart":"rotateStart"]({pos:n});return this._panMove=i,this.updateViewport(r,Qr,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),i=this.controllerState.pan({pos:n});return this.updateViewport(i,Qr,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],s=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:fu},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),i=this.controllerState.rotate({pos:n});return this.updateViewport(i,Qr,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const i=this.getCenter(e),r=[i[0]+e.velocityX*n/2,i[1]+e.velocityY*n/2],s=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:fu},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;e.srcEvent.preventDefault();const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const{speed:i=.01,smooth:r=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:s}=e;let o=2/(1+Math.exp(-Math.abs(s*i)));s<0&&o!==0&&(o=1/o);const a=this.controllerState.zoom({pos:n,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:n}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.rotateStart({pos:n});return this.updateViewport(i,Qr,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const i=this.controllerState.rotate({pos:n});return this.updateViewport(i,Qr,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const i=this.getCenter(e),r=[i[0],i[1]+=e.velocityY*n/2],s=this.controllerState.rotate({pos:r});this.updateViewport(s,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:fu},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return Fs._startPinchRotation=e.rotation,Fs._lastPinchEvent=e,this.updateViewport(i,Qr,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:i}=e,r=this.getCenter(e);n=n.zoom({pos:r,scale:i})}if(this.touchRotate){const{rotation:i}=e;n=n.rotate({deltaAngleX:Fs._startPinchRotation-i})}return this.updateViewport(n,Qr,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Fs._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:i}=Fs;if(this.touchZoom&&n&&i&&e.scale!==i.scale){const r=this.getCenter(e);let s=this.controllerState.rotateEnd();const o=Math.log2(e.scale),a=(o-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),c=Math.pow(2,o+a*n/2);s=s.zoom({pos:r,scale:c}).zoomEnd(),this.updateViewport(s,{...this._getTransitionProps({around:r}),transitionDuration:n,transitionEasing:fu},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const r=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Fs._startPinchRotation=null,Fs._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const i=this.isFunctionKeyPressed(e),r=this.controllerState.zoom({pos:n,scale:i?.5:2});return this.updateViewport(r,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:r,rotateSpeedX:s,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this;let c;const f={};switch(e.srcEvent.code){case"Minus":c=n?a.zoomOut(i).zoomOut(i):a.zoomOut(i),f.isZooming=!0;break;case"Equal":c=n?a.zoomIn(i).zoomIn(i):a.zoomIn(i),f.isZooming=!0;break;case"ArrowLeft":n?(c=a.rotateLeft(s),f.isRotating=!0):(c=a.moveLeft(r),f.isPanning=!0);break;case"ArrowRight":n?(c=a.rotateRight(s),f.isRotating=!0):(c=a.moveRight(r),f.isPanning=!0);break;case"ArrowUp":n?(c=a.rotateUp(o),f.isRotating=!0):(c=a.moveUp(r),f.isPanning=!0);break;case"ArrowDown":n?(c=a.rotateDown(o),f.isRotating=!0):(c=a.moveDown(r),f.isPanning=!0);break;default:return!1}return this.updateViewport(c,this._getTransitionProps(),f),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?Qr:e?{...n,transitionInterpolator:new Wa({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class T1{constructor(e,n){T(this,"_viewportProps",void 0),T(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const B2=5,pU=1.2;class KS extends T1{constructor(e){const{width:n,height:i,latitude:r,longitude:s,zoom:o,bearing:a=0,pitch:c=0,altitude:f=1.5,position:p=[0,0,0],maxZoom:m=20,minZoom:v=0,maxPitch:w=60,minPitch:C=0,startPanLngLat:S,startZoomLngLat:R,startRotatePos:x,startBearing:P,startPitch:I,startZoom:F,normalize:H=!0}=e;tn(Number.isFinite(s)),tn(Number.isFinite(r)),tn(Number.isFinite(o)),super({width:n,height:i,latitude:r,longitude:s,zoom:o,bearing:a,pitch:c,altitude:f,maxZoom:m,minZoom:v,maxPitch:w,minPitch:C,normalize:H,position:p},{startPanLngLat:S,startZoomLngLat:R,startRotatePos:x,startBearing:P,startPitch:I,startZoom:F}),T(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const i=this.getState().startPanLngLat||this._unproject(n);if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this.getState();if(!r||s===void 0||o===void 0)return this;let a;return e?a=this._getNewRotation(e,r,o,s):a={bearing:s+n,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomLngLat:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const{maxZoom:o,minZoom:a}=this.getViewportProps();let c=r+Math.log2(i);c=kt(c,a,o);const f=this.makeViewport({...this.getViewportProps(),zoom:c});return this._getUpdatedState({zoom:c,...f.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:s}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),Math.abs(s-n.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=kt(r,i,n);const{maxPitch:s,minPitch:o,pitch:a}=e;e.pitch=kt(a,o,s);const{normalize:c=!0}=e;return c&&Object.assign(e,l6(e)),e}_zoomFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.zoom({pos:[n/2,i/2],scale:e})}_panFromCenter(e){const{width:n,height:i}=this.getViewportProps();return this.pan({startPos:[n/2,i/2],pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,i,r){const s=e[0]-n[0],o=e[1]-n[1],a=e[1],c=n[1],{width:f,height:p}=this.getViewportProps(),m=s/f;let v=0;o>0?Math.abs(p-c)>B2&&(v=o/(c-p)*pU):o<0&&c>B2&&(v=1-a/c),v=kt(v,-1,1);const{minPitch:w,maxPitch:C}=this.getViewportProps(),S=r+180*m;let R=i;return v>0?R=i+v*(C-i):v<0&&(R=i-v*(w-i)),{pitch:R,bearing:S}}}class mU extends lc{constructor(...e){super(...e),T(this,"ControllerState",KS),T(this,"transition",{transitionDuration:300,transitionInterpolator:new Wa({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),T(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class ZS extends or{get ViewportType(){return sr}get ControllerType(){return mU}}T(ZS,"displayName","MapView");class _U extends Rf{constructor(e,n){super(e,n),T(this,"maskMap",void 0),T(this,"fbo",void 0);const{mapSize:i=2048}=n;this.maskMap=new vn(e,{width:i,height:i,parameters:{[10241]:9729,[10240]:9729,[10242]:33071,[10243]:33071}}),this.fbo=new jt(e,{id:"maskmap",width:i,height:i,attachments:{[36064]:this.maskMap}})}render(e){const n=this.gl,i=[!1,!1,!1,!1];return i[e.channel]=!0,gi(n,{clearColor:[255,255,255,255],blend:!0,blendFunc:[0,1],blendEquation:32778,colorMask:i,depthTest:!1},()=>super.render({...e,target:this.fbo,pass:"mask"}))}shouldDrawLayer(e){return e.props.operation===sc.MASK}delete(){this.fbo.delete(),this.maskMap.delete()}}const yU=new De().lookAt({eye:[0,0,1]});function vU({width:t,height:e,near:n,far:i,padding:r}){let s=-t/2,o=t/2,a=-e/2,c=e/2;if(r){const{left:f=0,right:p=0,top:m=0,bottom:v=0}=r,w=kt((f+t-p)/2,0,t)-t/2,C=kt((m+e-v)/2,0,e)-e/2;s-=w,o-=w,a+=C,c+=C}return new De().ortho({left:s,right:o,bottom:a,top:c,near:n,far:i})}class EU extends lr{constructor(e){const{width:n,height:i,near:r=.1,far:s=1e3,zoom:o=0,target:a=[0,0,0],padding:c=null,flipY:f=!0}=e,p=Array.isArray(o)?o[0]:o,m=Array.isArray(o)?o[1]:o,v=Math.min(p,m),w=Math.pow(2,v);let C;if(p!==m){const S=Math.pow(2,p),R=Math.pow(2,m);C={unitsPerMeter:[S/w,R/w,1],metersPerUnit:[w/S,w/R,1]}}super({...e,longitude:void 0,position:a,viewMatrix:yU.clone().scale([w,w*(f?-1:1),w]),projectionMatrix:vU({width:n||1,height:i||1,padding:c,near:r,far:s}),zoom:v,distanceScales:C})}projectFlat([e,n]){const{unitsPerMeter:i}=this.distanceScales;return[e*i[0],n*i[1]]}unprojectFlat([e,n]){const{metersPerUnit:i}=this.distanceScales;return[e*i[0],n*i[1]]}panByPosition(e,n){const i=ac(n,this.pixelUnprojectionMatrix),r=this.projectFlat(e),s=Uh([],r,fS([],i)),o=Uh([],this.center,s);return{target:this.unprojectFlat(o)}}}class qS extends T1{constructor(e){const{width:n,height:i,rotationX:r=0,rotationOrbit:s=0,target:o=[0,0,0],zoom:a=0,minRotationX:c=-90,maxRotationX:f=90,minZoom:p=-1/0,maxZoom:m=1/0,startPanPosition:v,startRotatePos:w,startRotationX:C,startRotationOrbit:S,startZoomPosition:R,startZoom:x}=e;super({width:n,height:i,rotationX:r,rotationOrbit:s,target:o,zoom:a,minRotationX:c,maxRotationX:f,minZoom:p,maxZoom:m},{startPanPosition:v,startRotatePos:w,startRotationX:C,startRotationOrbit:S,startZoomPosition:R,startZoom:x}),T(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:n}){const i=this.getState().startPanPosition||n;if(!i)return this;const s=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(s)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startRotationX:s,startRotationOrbit:o}=this.getState(),{width:a,height:c}=this.getViewportProps();if(!r||s===void 0||o===void 0)return this;let f;if(e){let p=(e[0]-r[0])/a;const m=(e[1]-r[1])/c;(s<-90||s>90)&&(p*=-1),f={rotationX:s+m*180,rotationOrbit:o+p*180}}else f={rotationX:s+i,rotationOrbit:o+n};return this._getUpdatedState(f)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{rotationOrbit:r}=i;return Math.abs(r-n.rotationOrbit)>180&&(i.rotationOrbit=r<0?r+360:r-360),i}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:i}){let{startZoom:r,startZoomPosition:s}=this.getState();if(s||(r=this.getViewportProps().zoom,s=this._unproject(n)||this._unproject(e)),!s)return this;const o=this._calculateNewZoom({scale:i,startZoom:r}),a=this.makeViewport({...this.getViewportProps(),zoom:o});return this._getUpdatedState({zoom:o,...a.panByPosition(s,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:i,minZoom:r}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);const s=n+Math.log2(e);return kt(s,r,i)}_panFromCenter(e){const{width:n,height:i,target:r}=this.getViewportProps();return this.pan({startPosition:r,pos:[n/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r,maxRotationX:s,minRotationX:o,rotationOrbit:a}=e;return e.zoom=Array.isArray(r)?[kt(r[0],i,n),kt(r[1],i,n)]:kt(r,i,n),e.rotationX=kt(e.rotationX,o,s),(a<-180||a>180)&&(e.rotationOrbit=Hh(a+180,360)-180),e}}class wU extends lc{constructor(...e){super(...e),T(this,"ControllerState",qS),T(this,"transition",{transitionDuration:300,transitionInterpolator:new Wa({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}class TU extends qS{constructor(e){super(e),T(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:i,minZoom:r}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);let s=Math.log2(e);if(Array.isArray(n)){let[o,a]=n;switch(this.zoomAxis){case"X":o=kt(o+s,r,i);break;case"Y":a=kt(a+s,r,i);break;default:let c=Math.min(o+s,a+s);c<r&&(s+=r-c),c=Math.max(o+s,a+s),c>i&&(s+=i-c),o+=s,a+=s}return[o,a]}return kt(n+s,r,i)}}class CU extends lc{constructor(...e){super(...e),T(this,"ControllerState",TU),T(this,"transition",{transitionDuration:300,transitionInterpolator:new Wa(["target","zoom"])}),T(this,"dragMode","pan")}_onPanRotate(){return!1}}class $S extends or{get ViewportType(){return EU}get ControllerType(){return CU}}T($S,"displayName","OrthographicView");function bU({layers:t,viewport:e}){let n=null;for(const s of t){const o=s.getBounds();o&&(n?(n[0]=Math.min(n[0],o[0][0]),n[1]=Math.min(n[1],o[0][1]),n[2]=Math.max(n[2],o[1][0]),n[3]=Math.max(n[3],o[1][1])):n=[o[0][0],o[0][1],o[1][0],o[1][1]])}const i=e.getBounds();if(!n)return i;const r=xU(i);return n[2]-n[0]<r[2]-r[0]||n[3]-n[1]<r[3]-r[1]||(n[0]=Math.max(n[0],r[0]),n[1]=Math.max(n[1],r[1]),n[2]=Math.min(n[2],r[2]),n[3]=Math.min(n[3],r[3])),n}function SU({bounds:t,viewport:e,width:n,height:i}){if(t[2]<=t[0]||t[3]<=t[1])return null;const r=1;if(n-=r*2,i-=r*2,e instanceof sr){const{longitude:a,latitude:c,zoom:f}=jS({width:n,height:i,bounds:[[t[0],t[1]],[t[2],t[3]]],maxZoom:20});return new sr({longitude:a,latitude:c,zoom:f,x:r,y:r,width:n,height:i})}const s=[(t[0]+t[2])/2,(t[1]+t[3])/2,0],o=Math.min(20,n/(t[2]-t[0]),i/(t[3]-t[1]));return new $S({x:r,y:r}).makeViewport({width:n,height:i,viewState:{target:s,zoom:Math.log2(o)}})}function xU(t){const e={x:t[2]-t[0],y:t[3]-t[1]},n={x:t[0]+.5*e.x,y:t[1]+.5*e.y};return[n.x-e.x,n.y-e.y,n.x+e.x,n.y+e.y]}class PU{constructor(){T(this,"id","mask-effect"),T(this,"props",null),T(this,"useInPicking",!0),T(this,"dummyMaskMap",void 0),T(this,"channels",[]),T(this,"masks",null),T(this,"maskPass",void 0),T(this,"maskMap",void 0),T(this,"lastViewport",void 0)}preRender(e,{layers:n,layerFilter:i,viewports:r,onViewportActive:s,views:o}){this.dummyMaskMap||(this.dummyMaskMap=new vn(e,{width:1,height:1}));const a=n.filter(m=>m.props.visible&&m.props.operation===sc.MASK);if(a.length===0){this.masks=null,this.channels.length=0;return}this.masks={},this.maskPass||(this.maskPass=new _U(e,{id:"default-mask"}),this.maskMap=this.maskPass.maskMap);const c=this._sortMaskChannels(a),f=r[0],p=!this.lastViewport||!this.lastViewport.equals(f);for(const m in c)this._renderChannel(c[m],{layerFilter:i,onViewportActive:s,views:o,viewport:f,viewportChanged:p})}_renderChannel(e,{layerFilter:n,onViewportActive:i,views:r,viewport:s,viewportChanged:o}){const a=this.channels[e.index];if(!a)return;const c=e===a||a.layers.length!==e.layers.length||e.layerBounds.some((f,p)=>f!==a.layerBounds[p]);if(e.bounds=a.bounds,e.maskBounds=a.maskBounds,this.channels[e.index]=e,(c||o)&&(this.lastViewport=s,e.bounds=bU({layers:e.layers,viewport:s}),c||!_n(e.bounds,a.bounds))){const{maskPass:f,maskMap:p}=this,m=SU({bounds:e.bounds,viewport:s,width:p.width,height:p.height});e.maskBounds=m?m.getBounds():[0,0,1,1],f.render({pass:"mask",channel:e.index,layers:e.layers,layerFilter:n,viewports:m?[m]:[],onViewportActive:i,views:r,moduleParameters:{devicePixelRatio:1}})}this.masks[e.id]={index:e.index,bounds:e.maskBounds,coordinateOrigin:e.coordinateOrigin,coordinateSystem:e.coordinateSystem}}_sortMaskChannels(e){const n={};let i=0;for(const r of e){const{id:s}=r.root;let o=n[s];if(!o){if(++i>4){Re.warn("Too many mask layers. The max supported is 4")();continue}o={id:s,index:this.channels.findIndex(a=>(a==null?void 0:a.id)===s),layers:[],layerBounds:[],coordinateOrigin:r.root.props.coordinateOrigin,coordinateSystem:r.root.props.coordinateSystem},n[s]=o}o.layers.push(r),o.layerBounds.push(r.getBounds())}for(let r=0;r<4;r++){const s=this.channels[r];(!s||!(s.id in n))&&(this.channels[r]=null)}for(const r in n){const s=n[r];s.index<0&&(s.index=this.channels.findIndex(o=>!o),this.channels[s.index]=s)}return n}getModuleParameters(){return{maskMap:this.masks?this.maskMap:this.dummyMaskMap,maskChannels:this.masks}}cleanup(){this.dummyMaskMap&&(this.dummyMaskMap.delete(),this.dummyMaskMap=void 0),this.maskPass&&(this.maskPass.delete(),this.maskPass=void 0,this.maskMap=void 0),this.lastViewport=void 0,this.masks=null,this.channels.length=0}}const MU=new w1;class IU{constructor(){T(this,"effects",void 0),T(this,"_internalEffects",void 0),T(this,"_needsRedraw",void 0),this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(e){"effects"in e&&(e.effects.length!==this.effects.length||!fo(e.effects,this.effects))&&(this.setEffects(e.effects),this._needsRedraw="effects changed")}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(e=[]){this.cleanup(),this.effects=e,this._internalEffects=e.slice(),this._internalEffects.push(new PU),e.some(n=>n instanceof w1)||this._internalEffects.push(MU)}cleanup(){for(const e of this.effects)e.cleanup();for(const e of this._internalEffects)e.cleanup();this.effects.length=0,this._internalEffects.length=0}}class BU extends Rf{shouldDrawLayer(e){return e.props.operation===sc.DRAW}}const L2={blendFunc:[1,0,32771,0],blendEquation:32774};class ex extends Rf{constructor(...e){super(...e),T(this,"pickZ",void 0),T(this,"_colors",null)}render(e){return e.pickingFBO?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,pickingFBO:o,deviceRect:{x:a,y:c,width:f,height:p},cullRect:m,effects:v,pass:w="picking",pickZ:C}){const S=this.gl;this.pickZ=C;const R=C?null:{byLayer:new Map,byAlpha:[]};this._colors=R;const x=gi(S,{scissorTest:!0,scissor:[a,c,f,p],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...L2,blend:!C},()=>super.render({target:o,layers:e,layerFilter:n,views:i,viewports:r,onViewportActive:s,cullRect:m,effects:v==null?void 0:v.filter(I=>I.useInPicking),pass:w}));return this._colors=null,{decodePickingColor:R&&RU.bind(null,R),stats:x}}shouldDrawLayer(e){return e.props.pickable&&e.props.operation===sc.DRAW}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,i){const r={...e.props.parameters};return this._colors?(Object.assign(r,L2),r.blend=!0,r.blendColor=LU(this._colors,e,i)):r.blend=!1,r}}function LU(t,e,n){const{byLayer:i,byAlpha:r}=t;let s,o=i.get(e);return o?(o.viewports.push(n),s=o.a):(s=i.size+1,s<=255?(o={a:s,layer:e,viewports:[n]},i.set(e,o),r[s]=o):(Re.warn("Too many pickable layers, only picking the first 255")(),s=0)),[0,0,0,s/255]}function RU(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const OU="deckRenderer.renderLayers";class FU{constructor(e){this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new BU(e),this.pickLayersPass=new ex(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){"layerFilter"in e&&this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in e&&this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;e.layerFilter=e.layerFilter||this.layerFilter,e.effects=e.effects||[],e.target=e.target||jt.getDefaultFramebuffer(this.gl),this._preRender(e.effects,e);const i=this.lastPostProcessEffect?this.renderBuffers[0]:e.target,r=n.render({...e,target:i});this._postRender(e.effects,e),this.renderCount++,dn(OU,this,r,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){let i=null;for(const r of e)r.preRender(this.gl,n),r.postRender&&(i=r);i&&this._resizeRenderBuffers(),this.lastPostProcessEffect=i}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new jt(this.gl),new jt(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:i}=this,r={inputBuffer:i[0],swapBuffer:i[1],target:null};for(const s of e)if(s.postRender){if(s===this.lastPostProcessEffect){r.target=n.target,s.postRender(this.gl,r);break}const o=s.postRender(this.gl,r);r.inputBuffer=o,r.swapBuffer=o===i[0]?i[1]:i[0]}}}const DU={pickedColor:null,pickedObjectIndex:-1};function kU({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:s}){const{x:o,y:a,width:c,height:f}=s;let p=r*r,m=-1,v=0;for(let w=0;w<f;w++){const C=w+a-i,S=C*C;if(S>p)v+=4*c;else for(let R=0;R<c;R++){if(t[v+3]-1>=0){const P=R+o-n,I=P*P+S;I<=p&&(p=I,m=v)}v+=4}}if(m>=0){const w=t.slice(m,m+4),C=e(w);if(C){const S=Math.floor(m/4/c),R=m/4-S*c;return{...C,pickedColor:w,pickedX:o+R,pickedY:a+S}}Re.error("Picked non-existent layer. Is picking buffer corrupt?")()}return DU}function NU({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const s=t.slice(i,i+4),o=s.join(",");if(!n.has(o)){const a=e(s);a?n.set(o,{...a,color:s}):Re.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function tx({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:s}){let o=e[0];e.length>1&&(o=GU((t==null?void 0:t.pickedViewports)||e,{x:i,y:r}));let a;if(o){const c=[i-o.x,r-o.y];s!==void 0&&(c[2]=s),a=o.unproject(c)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:a,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function UU(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:s,pickedLayer:o,pickedObjectIndex:a}=e,c=o?[o]:[];if(i==="hover"){const m=n.index,v=n.layerId,w=o?o.props.id:null;if(w!==v||a!==m){if(w!==v){const C=r.find(S=>S.props.id===v);C&&c.unshift(C)}n.layerId=w,n.index=a,n.info=null}}const f=tx(t),p=new Map;return p.set(null,f),c.forEach(m=>{let v={...f};m===o&&(v.color=s,v.index=a,v.picked=!0),v=nx({layer:m,info:v,mode:i});const w=v.layer;m===o&&i==="hover"&&(n.info=v),p.set(w.id,v),i==="hover"&&w.updateAutoHighlight(v)}),p}function nx({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}function GU(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}class zU{constructor(e){T(this,"gl",void 0),T(this,"pickingFBO",void 0),T(this,"depthFBO",void 0),T(this,"pickLayersPass",void 0),T(this,"layerFilter",void 0),T(this,"lastPickedInfo",void 0),T(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new ex(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:i,viewports:r},s=this.lastPickedInfo.info){const o=s&&s.layer&&s.layer.id,a=s&&s.viewport&&s.viewport.id,c=o?i.find(v=>v.id===o):null,f=a&&r.find(v=>v.id===a)||r[0],p=f&&f.unproject([e-f.x,n-f.y]);return{...s,...{x:e,y:n,viewport:f,coordinate:p,layer:c}}}_resizeBuffer(){var e,n;const{gl:i}=this;if(!this.pickingFBO&&(this.pickingFBO=new jt(i),jt.isSupported(i,{colorBufferFloat:!0}))){const r=new jt(i);r.attach({[36064]:new vn(i,{format:We(i)?34836:6408,type:5126})}),this.depthFBO=r}(e=this.pickingFBO)===null||e===void 0||e.resize({width:i.canvas.width,height:i.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:i.canvas.width,height:i.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(i=>i.isPickable()&&!i.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:i,x:r,y:s,radius:o=0,depth:a=1,mode:c="query",unproject3D:f,onViewportActive:p,effects:m}){const v=this._getPickable(e),w=La(this.gl);if(!v)return{result:[],emptyInfo:tx({viewports:i,x:r,y:s,pixelRatio:w})};this._resizeBuffer();const C=e0(this.gl,[r,s],!0),S=[C.x+Math.floor(C.width/2),C.y+Math.floor(C.height/2)],R=Math.round(o*w),{width:x,height:P}=this.pickingFBO,I=this._getPickingRect({deviceX:S[0],deviceY:S[1],deviceRadius:R,deviceWidth:x,deviceHeight:P}),F={x:r-o,y:s-o,width:o*2+1,height:o*2+1};let H;const Q=[],q=new Set;for(let ee=0;ee<a;ee++){let X;if(I){const D=this._drawAndSample({layers:v,views:n,viewports:i,onViewportActive:p,deviceRect:I,cullRect:F,effects:m,pass:"picking:".concat(c)});X=kU({...D,deviceX:S[0],deviceY:S[1],deviceRadius:R,deviceRect:I})}else X={pickedColor:null,pickedObjectIndex:-1};let V;X.pickedLayer&&f&&this.depthFBO&&(V=this._drawAndSample({layers:[X.pickedLayer],views:n,viewports:i,onViewportActive:p,deviceRect:{x:X.pickedX,y:X.pickedY,width:1,height:1},cullRect:F,effects:m,pass:"picking:".concat(c,":z")},!0).pickedColors[0]),X.pickedLayer&&ee+1<a&&(q.add(X.pickedLayer),X.pickedLayer.disablePickingIndex(X.pickedObjectIndex)),H=UU({pickInfo:X,lastPickedInfo:this.lastPickedInfo,mode:c,layers:v,viewports:i,x:r,y:s,z:V,pixelRatio:w});for(const D of H.values())D.layer&&Q.push(D);if(!X.pickedColor)break}for(const ee of q)ee.restorePickingColors();return{result:Q,emptyInfo:H.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:i,x:r,y:s,width:o=1,height:a=1,mode:c="query",maxObjects:f=null,onViewportActive:p,effects:m}){const v=this._getPickable(e);if(!v)return[];this._resizeBuffer();const w=La(this.gl),C=e0(this.gl,[r,s],!0),S=C.x,R=C.y+C.height,x=e0(this.gl,[r+o,s+a],!0),P=x.x+x.width,I=x.y,F={x:S,y:I,width:P-S,height:R-I},H=this._drawAndSample({layers:v,views:n,viewports:i,onViewportActive:p,deviceRect:F,cullRect:{x:r,y:s,width:o,height:a},effects:m,pass:"picking:".concat(c)}),Q=NU(H),q=new Map,ee=Number.isFinite(f);for(let X=0;X<Q.length&&!(ee&&f&&q.size>=f);X++){const V=Q[X];let D={color:V.pickedColor,layer:null,index:V.pickedObjectIndex,picked:!0,x:r,y:s,pixelRatio:w};D=nx({layer:V.pickedLayer,info:D,mode:c}),q.has(D.object)||q.set(D.object,D)}return Array.from(q.values())}_drawAndSample({layers:e,views:n,viewports:i,onViewportActive:r,deviceRect:s,cullRect:o,effects:a,pass:c},f=!1){const p=f?this.depthFBO:this.pickingFBO,{decodePickingColor:m}=this.pickLayersPass.render({layers:e,layerFilter:this.layerFilter,views:n,viewports:i,onViewportActive:r,pickingFBO:p,deviceRect:s,cullRect:o,effects:a,pass:c,pickZ:f}),{x:v,y:w,width:C,height:S}=s,R=new(f?Float32Array:Uint8Array)(C*S*4);return If(p,{sourceX:v,sourceY:w,sourceWidth:C,sourceHeight:S,target:R}),{pickedColors:R,decodePickingColor:m}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:i,deviceWidth:r,deviceHeight:s}){const o=Math.max(0,e-i),a=Math.max(0,n-i),c=Math.min(r,e+i+1)-o,f=Math.min(s,n+i+1)-a;return c<=0||f<=0?null:{x:o,y:a,width:c,height:f}}}const VU={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class HU{constructor(e){T(this,"el",null),T(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,VU),n.appendChild(this.el))}setTooltip(e,n,i){const r=this.el;if(!!r){if(typeof e=="string")r.innerText=e;else if(e)e.text&&(r.innerText=e.text),e.html&&(r.innerHTML=e.html),e.className&&(r.className=e.className),Object.assign(r.style,e.style);else{this.isVisible=!1,r.style.display="none";return}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(n,"px, ").concat(i,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}var Qa={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,i,r){var s=["","webkit","Moz","MS","ms","o"],o=n.createElement("div"),a="function",c=Math.round,f=Math.abs,p=Date.now;function m(L,O,G){return setTimeout(I(L,G),O)}function v(L,O,G){return Array.isArray(L)?(w(L,G[O],G),!0):!1}function w(L,O,G){var Z;if(!!L)if(L.forEach)L.forEach(O,G);else if(L.length!==r)for(Z=0;Z<L.length;)O.call(G,L[Z],Z,L),Z++;else for(Z in L)L.hasOwnProperty(Z)&&O.call(G,L[Z],Z,L)}function C(L,O,G){var Z="DEPRECATED METHOD: "+O+`
`+G+` AT 
`;return function(){var se=new Error("get-stack-trace"),we=se&&se.stack?se.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Xe=e.console&&(e.console.warn||e.console.log);return Xe&&Xe.call(e.console,Z,we),L.apply(this,arguments)}}var S;typeof Object.assign!="function"?S=function(O){if(O===r||O===null)throw new TypeError("Cannot convert undefined or null to object");for(var G=Object(O),Z=1;Z<arguments.length;Z++){var se=arguments[Z];if(se!==r&&se!==null)for(var we in se)se.hasOwnProperty(we)&&(G[we]=se[we])}return G}:S=Object.assign;var R=C(function(O,G,Z){for(var se=Object.keys(G),we=0;we<se.length;)(!Z||Z&&O[se[we]]===r)&&(O[se[we]]=G[se[we]]),we++;return O},"extend","Use `assign`."),x=C(function(O,G){return R(O,G,!0)},"merge","Use `assign`.");function P(L,O,G){var Z=O.prototype,se;se=L.prototype=Object.create(Z),se.constructor=L,se._super=Z,G&&S(se,G)}function I(L,O){return function(){return L.apply(O,arguments)}}function F(L,O){return typeof L==a?L.apply(O&&O[0]||r,O):L}function H(L,O){return L===r?O:L}function Q(L,O,G){w(V(O),function(Z){L.addEventListener(Z,G,!1)})}function q(L,O,G){w(V(O),function(Z){L.removeEventListener(Z,G,!1)})}function ee(L,O){for(;L;){if(L==O)return!0;L=L.parentNode}return!1}function X(L,O){return L.indexOf(O)>-1}function V(L){return L.trim().split(/\s+/g)}function D(L,O,G){if(L.indexOf&&!G)return L.indexOf(O);for(var Z=0;Z<L.length;){if(G&&L[Z][G]==O||!G&&L[Z]===O)return Z;Z++}return-1}function re(L){return Array.prototype.slice.call(L,0)}function Ae(L,O,G){for(var Z=[],se=[],we=0;we<L.length;){var Xe=O?L[we][O]:L[we];D(se,Xe)<0&&Z.push(L[we]),se[we]=Xe,we++}return G&&(O?Z=Z.sort(function(Ue,Qt){return Ue[O]>Qt[O]}):Z=Z.sort()),Z}function ge(L,O){for(var G,Z,se=O[0].toUpperCase()+O.slice(1),we=0;we<s.length;){if(G=s[we],Z=G?G+se:O,Z in L)return Z;we++}return r}var Be=1;function Ye(){return Be++}function Qe(L){var O=L.ownerDocument||L;return O.defaultView||O.parentWindow||e}var oe=/mobile|tablet|ip(ad|hone|od)|android/i,ve="ontouchstart"in e,xe=ge(e,"PointerEvent")!==r,Le=ve&&oe.test(navigator.userAgent),ke="touch",Wt="pen",Gn="mouse",Ts="kinect",ri=25,Bt=1,cr=2,Lt=4,ln=8,go=1,Cs=2,bs=4,Ss=8,xs=16,si=Cs|bs,En=Ss|xs,Or=si|En,pc=["x","y"],po=["clientX","clientY"];function Rt(L,O){var G=this;this.manager=L,this.callback=O,this.element=L.element,this.target=L.options.inputTarget,this.domHandler=function(Z){F(L.options.enable,[L])&&G.handler(Z)},this.init()}Rt.prototype={handler:function(){},init:function(){this.evEl&&Q(this.element,this.evEl,this.domHandler),this.evTarget&&Q(this.target,this.evTarget,this.domHandler),this.evWin&&Q(Qe(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&q(this.element,this.evEl,this.domHandler),this.evTarget&&q(this.target,this.evTarget,this.domHandler),this.evWin&&q(Qe(this.element),this.evWin,this.domHandler)}};function Za(L){var O,G=L.options.inputClass;return G?O=G:xe?O=he:Le?O=Ps:ve?O=Y:O=yo,new O(L,mc)}function mc(L,O,G){var Z=G.pointers.length,se=G.changedPointers.length,we=O&Bt&&Z-se===0,Xe=O&(Lt|ln)&&Z-se===0;G.isFirst=!!we,G.isFinal=!!Xe,we&&(L.session={}),G.eventType=O,Fr(L,G),L.emit("hammer.input",G),L.recognize(G),L.session.prevInput=G}function Fr(L,O){var G=L.session,Z=O.pointers,se=Z.length;G.firstInput||(G.firstInput=_c(O)),se>1&&!G.firstMultiple?G.firstMultiple=_c(O):se===1&&(G.firstMultiple=!1);var we=G.firstInput,Xe=G.firstMultiple,Ut=Xe?Xe.center:we.center,Ue=O.center=$a(Z);O.timeStamp=p(),O.deltaTime=O.timeStamp-we.timeStamp,O.angle=_o(Ut,Ue),O.distance=mo(Ut,Ue),qa(G,O),O.offsetDirection=yc(O.deltaX,O.deltaY);var Qt=eA(O.deltaTime,O.deltaX,O.deltaY);O.overallVelocityX=Qt.x,O.overallVelocityY=Qt.y,O.overallVelocity=f(Qt.x)>f(Qt.y)?Qt.x:Qt.y,O.scale=Xe?Kf(Xe.pointers,Z):1,O.rotation=Xe?Yf(Xe.pointers,Z):0,O.maxPointers=G.prevInput?O.pointers.length>G.prevInput.maxPointers?O.pointers.length:G.prevInput.maxPointers:O.pointers.length,Jf(G,O);var Hn=L.element;ee(O.srcEvent.target,Hn)&&(Hn=O.srcEvent.target),O.target=Hn}function qa(L,O){var G=O.center,Z=L.offsetDelta||{},se=L.prevDelta||{},we=L.prevInput||{};(O.eventType===Bt||we.eventType===Lt)&&(se=L.prevDelta={x:we.deltaX||0,y:we.deltaY||0},Z=L.offsetDelta={x:G.x,y:G.y}),O.deltaX=se.x+(G.x-Z.x),O.deltaY=se.y+(G.y-Z.y)}function Jf(L,O){var G=L.lastInterval||O,Z=O.timeStamp-G.timeStamp,se,we,Xe,Ut;if(O.eventType!=ln&&(Z>ri||G.velocity===r)){var Ue=O.deltaX-G.deltaX,Qt=O.deltaY-G.deltaY,Hn=eA(Z,Ue,Qt);we=Hn.x,Xe=Hn.y,se=f(Hn.x)>f(Hn.y)?Hn.x:Hn.y,Ut=yc(Ue,Qt),L.lastInterval=O}else se=G.velocity,we=G.velocityX,Xe=G.velocityY,Ut=G.direction;O.velocity=se,O.velocityX=we,O.velocityY=Xe,O.direction=Ut}function _c(L){for(var O=[],G=0;G<L.pointers.length;)O[G]={clientX:c(L.pointers[G].clientX),clientY:c(L.pointers[G].clientY)},G++;return{timeStamp:p(),pointers:O,center:$a(O),deltaX:L.deltaX,deltaY:L.deltaY}}function $a(L){var O=L.length;if(O===1)return{x:c(L[0].clientX),y:c(L[0].clientY)};for(var G=0,Z=0,se=0;se<O;)G+=L[se].clientX,Z+=L[se].clientY,se++;return{x:c(G/O),y:c(Z/O)}}function eA(L,O,G){return{x:O/L||0,y:G/L||0}}function yc(L,O){return L===O?go:f(L)>=f(O)?L<0?Cs:bs:O<0?Ss:xs}function mo(L,O,G){G||(G=pc);var Z=O[G[0]]-L[G[0]],se=O[G[1]]-L[G[1]];return Math.sqrt(Z*Z+se*se)}function _o(L,O,G){G||(G=pc);var Z=O[G[0]]-L[G[0]],se=O[G[1]]-L[G[1]];return Math.atan2(se,Z)*180/Math.PI}function Yf(L,O){return _o(O[1],O[0],po)+_o(L[1],L[0],po)}function Kf(L,O){return mo(O[0],O[1],po)/mo(L[0],L[1],po)}var Zf={mousedown:Bt,mousemove:cr,mouseup:Lt},vc="mousedown",qf="mousemove mouseup";function yo(){this.evEl=vc,this.evWin=qf,this.pressed=!1,Rt.apply(this,arguments)}P(yo,Rt,{handler:function(O){var G=Zf[O.type];G&Bt&&O.button===0&&(this.pressed=!0),G&cr&&O.which!==1&&(G=Lt),this.pressed&&(G&Lt&&(this.pressed=!1),this.callback(this.manager,G,{pointers:[O],changedPointers:[O],pointerType:Gn,srcEvent:O}))}});var $f={pointerdown:Bt,pointermove:cr,pointerup:Lt,pointercancel:ln,pointerout:ln},tA={2:ke,3:Wt,4:Gn,5:Ts},Ec="pointerdown",wc="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ec="MSPointerDown",wc="MSPointerMove MSPointerUp MSPointerCancel");function he(){this.evEl=Ec,this.evWin=wc,Rt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}P(he,Rt,{handler:function(O){var G=this.store,Z=!1,se=O.type.toLowerCase().replace("ms",""),we=$f[se],Xe=tA[O.pointerType]||O.pointerType,Ut=Xe==ke,Ue=D(G,O.pointerId,"pointerId");we&Bt&&(O.button===0||Ut)?Ue<0&&(G.push(O),Ue=G.length-1):we&(Lt|ln)&&(Z=!0),!(Ue<0)&&(G[Ue]=O,this.callback(this.manager,we,{pointers:G,changedPointers:[O],pointerType:Xe,srcEvent:O}),Z&&G.splice(Ue,1))}});var ed={touchstart:Bt,touchmove:cr,touchend:Lt,touchcancel:ln},Tc="touchstart",td="touchstart touchmove touchend touchcancel";function Cc(){this.evTarget=Tc,this.evWin=td,this.started=!1,Rt.apply(this,arguments)}P(Cc,Rt,{handler:function(O){var G=ed[O.type];if(G===Bt&&(this.started=!0),!!this.started){var Z=nA.call(this,O,G);G&(Lt|ln)&&Z[0].length-Z[1].length===0&&(this.started=!1),this.callback(this.manager,G,{pointers:Z[0],changedPointers:Z[1],pointerType:ke,srcEvent:O})}}});function nA(L,O){var G=re(L.touches),Z=re(L.changedTouches);return O&(Lt|ln)&&(G=Ae(G.concat(Z),"identifier",!0)),[G,Z]}var bc={touchstart:Bt,touchmove:cr,touchend:Lt,touchcancel:ln},Sc="touchstart touchmove touchend touchcancel";function Ps(){this.evTarget=Sc,this.targetIds={},Rt.apply(this,arguments)}P(Ps,Rt,{handler:function(O){var G=bc[O.type],Z=vo.call(this,O,G);!Z||this.callback(this.manager,G,{pointers:Z[0],changedPointers:Z[1],pointerType:ke,srcEvent:O})}});function vo(L,O){var G=re(L.touches),Z=this.targetIds;if(O&(Bt|cr)&&G.length===1)return Z[G[0].identifier]=!0,[G,G];var se,we,Xe=re(L.changedTouches),Ut=[],Ue=this.target;if(we=G.filter(function(Qt){return ee(Qt.target,Ue)}),O===Bt)for(se=0;se<we.length;)Z[we[se].identifier]=!0,se++;for(se=0;se<Xe.length;)Z[Xe[se].identifier]&&Ut.push(Xe[se]),O&(Lt|ln)&&delete Z[Xe[se].identifier],se++;if(!!Ut.length)return[Ae(we.concat(Ut),"identifier",!0),Ut]}var iA=2500,zi=25;function Y(){Rt.apply(this,arguments);var L=I(this.handler,this);this.touch=new Ps(this.manager,L),this.mouse=new yo(this.manager,L),this.primaryTouch=null,this.lastTouches=[]}P(Y,Rt,{handler:function(O,G,Z){var se=Z.pointerType==ke,we=Z.pointerType==Gn;if(!(we&&Z.sourceCapabilities&&Z.sourceCapabilities.firesTouchEvents)){if(se)ie.call(this,G,Z);else if(we&&Ie.call(this,Z))return;this.callback(O,G,Z)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function ie(L,O){L&Bt?(this.primaryTouch=O.changedPointers[0].identifier,fe.call(this,O)):L&(Lt|ln)&&fe.call(this,O)}function fe(L){var O=L.changedPointers[0];if(O.identifier===this.primaryTouch){var G={x:O.clientX,y:O.clientY};this.lastTouches.push(G);var Z=this.lastTouches,se=function(){var we=Z.indexOf(G);we>-1&&Z.splice(we,1)};setTimeout(se,iA)}}function Ie(L){for(var O=L.srcEvent.clientX,G=L.srcEvent.clientY,Z=0;Z<this.lastTouches.length;Z++){var se=this.lastTouches[Z],we=Math.abs(O-se.x),Xe=Math.abs(G-se.y);if(we<=zi&&Xe<=zi)return!0}return!1}var u=ge(o.style,"touchAction"),N=u!==r,Ze="compute",et="auto",Ve="manipulation",je="none",_t="pan-x",qe="pan-y",Je=Eo();function Ot(L,O){this.manager=L,this.set(O)}Ot.prototype={set:function(L){L==Ze&&(L=this.compute()),N&&this.manager.element.style&&Je[L]&&(this.manager.element.style[u]=L),this.actions=L.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var L=[];return w(this.manager.recognizers,function(O){F(O.options.enable,[O])&&(L=L.concat(O.getTouchAction()))}),Vi(L.join(" "))},preventDefaults:function(L){var O=L.srcEvent,G=L.offsetDirection;if(this.manager.session.prevented){O.preventDefault();return}var Z=this.actions,se=X(Z,je)&&!Je[je],we=X(Z,qe)&&!Je[qe],Xe=X(Z,_t)&&!Je[_t];if(se){var Ut=L.pointers.length===1,Ue=L.distance<2,Qt=L.deltaTime<250;if(Ut&&Ue&&Qt)return}if(!(Xe&&we)&&(se||we&&G&si||Xe&&G&En))return this.preventSrc(O)},preventSrc:function(L){this.manager.session.prevented=!0,L.preventDefault()}};function Vi(L){if(X(L,je))return je;var O=X(L,_t),G=X(L,qe);return O&&G?je:O||G?O?_t:qe:X(L,Ve)?Ve:et}function Eo(){if(!N)return!1;var L={},O=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(G){L[G]=O?e.CSS.supports("touch-action",G):!0}),L}var Dr=1,yt=2,vi=4,$t=8,Ei=$t,zn=16,Pe=32;function z(L){this.options=S({},this.defaults,L||{}),this.id=Ye(),this.manager=null,this.options.enable=H(this.options.enable,!0),this.state=Dr,this.simultaneous={},this.requireFail=[]}z.prototype={defaults:{},set:function(L){return S(this.options,L),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(L){if(v(L,"recognizeWith",this))return this;var O=this.simultaneous;return L=wo(L,this),O[L.id]||(O[L.id]=L,L.recognizeWith(this)),this},dropRecognizeWith:function(L){return v(L,"dropRecognizeWith",this)?this:(L=wo(L,this),delete this.simultaneous[L.id],this)},requireFailure:function(L){if(v(L,"requireFailure",this))return this;var O=this.requireFail;return L=wo(L,this),D(O,L)===-1&&(O.push(L),L.requireFailure(this)),this},dropRequireFailure:function(L){if(v(L,"dropRequireFailure",this))return this;L=wo(L,this);var O=D(this.requireFail,L);return O>-1&&this.requireFail.splice(O,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(L){return!!this.simultaneous[L.id]},emit:function(L){var O=this,G=this.state;function Z(se){O.manager.emit(se,L)}G<$t&&Z(O.options.event+tt(G)),Z(O.options.event),L.additionalEvent&&Z(L.additionalEvent),G>=$t&&Z(O.options.event+tt(G))},tryEmit:function(L){if(this.canEmit())return this.emit(L);this.state=Pe},canEmit:function(){for(var L=0;L<this.requireFail.length;){if(!(this.requireFail[L].state&(Pe|Dr)))return!1;L++}return!0},recognize:function(L){var O=S({},L);if(!F(this.options.enable,[this,O])){this.reset(),this.state=Pe;return}this.state&(Ei|zn|Pe)&&(this.state=Dr),this.state=this.process(O),this.state&(yt|vi|$t|zn)&&this.tryEmit(O)},process:function(L){},getTouchAction:function(){},reset:function(){}};function tt(L){return L&zn?"cancel":L&$t?"end":L&vi?"move":L&yt?"start":""}function rA(L){return L==xs?"down":L==Ss?"up":L==Cs?"left":L==bs?"right":""}function wo(L,O){var G=O.manager;return G?G.get(L):L}function Vn(){z.apply(this,arguments)}P(Vn,z,{defaults:{pointers:1},attrTest:function(L){var O=this.options.pointers;return O===0||L.pointers.length===O},process:function(L){var O=this.state,G=L.eventType,Z=O&(yt|vi),se=this.attrTest(L);return Z&&(G&ln||!se)?O|zn:Z||se?G&Lt?O|$t:O&yt?O|vi:yt:Pe}});function To(){Vn.apply(this,arguments),this.pX=null,this.pY=null}P(To,Vn,{defaults:{event:"pan",threshold:10,pointers:1,direction:Or},getTouchAction:function(){var L=this.options.direction,O=[];return L&si&&O.push(qe),L&En&&O.push(_t),O},directionTest:function(L){var O=this.options,G=!0,Z=L.distance,se=L.direction,we=L.deltaX,Xe=L.deltaY;return se&O.direction||(O.direction&si?(se=we===0?go:we<0?Cs:bs,G=we!=this.pX,Z=Math.abs(L.deltaX)):(se=Xe===0?go:Xe<0?Ss:xs,G=Xe!=this.pY,Z=Math.abs(L.deltaY))),L.direction=se,G&&Z>O.threshold&&se&O.direction},attrTest:function(L){return Vn.prototype.attrTest.call(this,L)&&(this.state&yt||!(this.state&yt)&&this.directionTest(L))},emit:function(L){this.pX=L.deltaX,this.pY=L.deltaY;var O=rA(L.direction);O&&(L.additionalEvent=this.options.event+O),this._super.emit.call(this,L)}});function sA(){Vn.apply(this,arguments)}P(sA,Vn,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[je]},attrTest:function(L){return this._super.attrTest.call(this,L)&&(Math.abs(L.scale-1)>this.options.threshold||this.state&yt)},emit:function(L){if(L.scale!==1){var O=L.scale<1?"in":"out";L.additionalEvent=this.options.event+O}this._super.emit.call(this,L)}});function k(){z.apply(this,arguments),this._timer=null,this._input=null}P(k,z,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[et]},process:function(L){var O=this.options,G=L.pointers.length===O.pointers,Z=L.distance<O.threshold,se=L.deltaTime>O.time;if(this._input=L,!Z||!G||L.eventType&(Lt|ln)&&!se)this.reset();else if(L.eventType&Bt)this.reset(),this._timer=m(function(){this.state=Ei,this.tryEmit()},O.time,this);else if(L.eventType&Lt)return Ei;return Pe},reset:function(){clearTimeout(this._timer)},emit:function(L){this.state===Ei&&(L&&L.eventType&Lt?this.manager.emit(this.options.event+"up",L):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function oA(){Vn.apply(this,arguments)}P(oA,Vn,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[je]},attrTest:function(L){return this._super.attrTest.call(this,L)&&(Math.abs(L.rotation)>this.options.threshold||this.state&yt)}});function aA(){Vn.apply(this,arguments)}P(aA,Vn,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:si|En,pointers:1},getTouchAction:function(){return To.prototype.getTouchAction.call(this)},attrTest:function(L){var O=this.options.direction,G;return O&(si|En)?G=L.overallVelocity:O&si?G=L.overallVelocityX:O&En&&(G=L.overallVelocityY),this._super.attrTest.call(this,L)&&O&L.offsetDirection&&L.distance>this.options.threshold&&L.maxPointers==this.options.pointers&&f(G)>this.options.velocity&&L.eventType&Lt},emit:function(L){var O=rA(L.offsetDirection);O&&this.manager.emit(this.options.event+O,L),this.manager.emit(this.options.event,L)}});function Co(){z.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}P(Co,z,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ve]},process:function(L){var O=this.options,G=L.pointers.length===O.pointers,Z=L.distance<O.threshold,se=L.deltaTime<O.time;if(this.reset(),L.eventType&Bt&&this.count===0)return this.failTimeout();if(Z&&se&&G){if(L.eventType!=Lt)return this.failTimeout();var we=this.pTime?L.timeStamp-this.pTime<O.interval:!0,Xe=!this.pCenter||mo(this.pCenter,L.center)<O.posThreshold;this.pTime=L.timeStamp,this.pCenter=L.center,!Xe||!we?this.count=1:this.count+=1,this._input=L;var Ut=this.count%O.taps;if(Ut===0)return this.hasRequireFailures()?(this._timer=m(function(){this.state=Ei,this.tryEmit()},O.interval,this),yt):Ei}return Pe},failTimeout:function(){return this._timer=m(function(){this.state=Pe},this.options.interval,this),Pe},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Ei&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function wi(L,O){return O=O||{},O.recognizers=H(O.recognizers,wi.defaults.preset),new bo(L,O)}wi.VERSION="2.0.7",wi.defaults={domEvents:!1,touchAction:Ze,enable:!0,inputTarget:null,inputClass:null,preset:[[oA,{enable:!1}],[sA,{enable:!1},["rotate"]],[aA,{direction:si}],[To,{direction:si},["swipe"]],[Co],[Co,{event:"doubletap",taps:2},["tap"]],[k]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var nd=1,xc=2;function bo(L,O){this.options=S({},wi.defaults,O||{}),this.options.inputTarget=this.options.inputTarget||L,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=L,this.input=Za(this),this.touchAction=new Ot(this,this.options.touchAction),Pc(this,!0),w(this.options.recognizers,function(G){var Z=this.add(new G[0](G[1]));G[2]&&Z.recognizeWith(G[2]),G[3]&&Z.requireFailure(G[3])},this)}bo.prototype={set:function(L){return S(this.options,L),L.touchAction&&this.touchAction.update(),L.inputTarget&&(this.input.destroy(),this.input.target=L.inputTarget,this.input.init()),this},stop:function(L){this.session.stopped=L?xc:nd},recognize:function(L){var O=this.session;if(!O.stopped){this.touchAction.preventDefaults(L);var G,Z=this.recognizers,se=O.curRecognizer;(!se||se&&se.state&Ei)&&(se=O.curRecognizer=null);for(var we=0;we<Z.length;)G=Z[we],O.stopped!==xc&&(!se||G==se||G.canRecognizeWith(se))?G.recognize(L):G.reset(),!se&&G.state&(yt|vi|$t)&&(se=O.curRecognizer=G),we++}},get:function(L){if(L instanceof z)return L;for(var O=this.recognizers,G=0;G<O.length;G++)if(O[G].options.event==L)return O[G];return null},add:function(L){if(v(L,"add",this))return this;var O=this.get(L.options.event);return O&&this.remove(O),this.recognizers.push(L),L.manager=this,this.touchAction.update(),L},remove:function(L){if(v(L,"remove",this))return this;if(L=this.get(L),L){var O=this.recognizers,G=D(O,L);G!==-1&&(O.splice(G,1),this.touchAction.update())}return this},on:function(L,O){if(L!==r&&O!==r){var G=this.handlers;return w(V(L),function(Z){G[Z]=G[Z]||[],G[Z].push(O)}),this}},off:function(L,O){if(L!==r){var G=this.handlers;return w(V(L),function(Z){O?G[Z]&&G[Z].splice(D(G[Z],O),1):delete G[Z]}),this}},emit:function(L,O){this.options.domEvents&&AA(L,O);var G=this.handlers[L]&&this.handlers[L].slice();if(!(!G||!G.length)){O.type=L,O.preventDefault=function(){O.srcEvent.preventDefault()};for(var Z=0;Z<G.length;)G[Z](O),Z++}},destroy:function(){this.element&&Pc(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Pc(L,O){var G=L.element;if(!!G.style){var Z;w(L.options.cssProps,function(se,we){Z=ge(G.style,we),O?(L.oldCssProps[Z]=G.style[Z],G.style[Z]=se):G.style[Z]=L.oldCssProps[Z]||""}),O||(L.oldCssProps={})}}function AA(L,O){var G=n.createEvent("Event");G.initEvent(L,!0,!0),G.gesture=O,O.target.dispatchEvent(G)}S(wi,{INPUT_START:Bt,INPUT_MOVE:cr,INPUT_END:Lt,INPUT_CANCEL:ln,STATE_POSSIBLE:Dr,STATE_BEGAN:yt,STATE_CHANGED:vi,STATE_ENDED:$t,STATE_RECOGNIZED:Ei,STATE_CANCELLED:zn,STATE_FAILED:Pe,DIRECTION_NONE:go,DIRECTION_LEFT:Cs,DIRECTION_RIGHT:bs,DIRECTION_UP:Ss,DIRECTION_DOWN:xs,DIRECTION_HORIZONTAL:si,DIRECTION_VERTICAL:En,DIRECTION_ALL:Or,Manager:bo,Input:Rt,TouchAction:Ot,TouchInput:Ps,MouseInput:yo,PointerEventInput:he,TouchMouseInput:Y,SingleTouchInput:Cc,Recognizer:z,AttrRecognizer:Vn,Tap:Co,Pan:To,Swipe:aA,Pinch:sA,Rotate:oA,Press:k,on:Q,off:q,each:w,merge:x,extend:R,assign:S,inherit:P,bindFn:I,prefixed:ge});var oi=typeof e<"u"?e:typeof self<"u"?self:{};oi.Hammer=wi,typeof r=="function"&&r.amd?r(function(){return wi}):t.exports?t.exports=wi:e[i]=wi})(window,document,"Hammer")})(Qa);const jU=Qa.exports,Qi=xM({__proto__:null,default:jU},[Qa.exports]),ix=1,rx=2,vp=4,WU={mousedown:ix,mousemove:rx,mouseup:vp};function QU(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function XU(t){const e=t.prototype.handler;t.prototype.handler=function(i){const r=this.store;i.button>0&&i.type==="pointerdown"&&(QU(r,s=>s.pointerId===i.pointerId)||r.push(i)),e.call(this,i)}}function JU(t){t.prototype.handler=function(n){let i=WU[n.type];i&ix&&n.button>=0&&(this.pressed=!0),i&rx&&n.which===0&&(i=vp),this.pressed&&(i&vp&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}XU(Qa.exports.PointerEventInput);JU(Qa.exports.MouseInput);const YU=Qa.exports.Manager;class Ff{constructor(e,n,i){this.element=e,this.callback=n,this.options={enable:!0,...i}}}const KU=Qi?[[Qi.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Qi.Rotate,{enable:!1}],[Qi.Pinch,{enable:!1}],[Qi.Swipe,{enable:!1}],[Qi.Pan,{threshold:0,enable:!1}],[Qi.Press,{enable:!1}],[Qi.Tap,{event:"doubletap",taps:2,enable:!1}],[Qi.Tap,{event:"anytap",enable:!1}],[Qi.Tap,{enable:!1}]]:null,R2={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},ZU={doubletap:["tap"]},qU={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},C1={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},$U={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},O2={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},e5=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",na=typeof window<"u"?window:global;let Ep=!1;try{const t={get passive(){return Ep=!0,!0}};na.addEventListener("test",null,t),na.removeEventListener("test",null)}catch{Ep=!1}const t5=e5.indexOf("firefox")!==-1,{WHEEL_EVENTS:n5}=C1,F2="wheel",D2=4.000244140625,i5=40,r5=.25;class s5 extends Ff{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{if(!this.options.enable)return;let s=r.deltaY;na.WheelEvent&&(t5&&r.deltaMode===na.WheelEvent.DOM_DELTA_PIXEL&&(s/=na.devicePixelRatio),r.deltaMode===na.WheelEvent.DOM_DELTA_LINE&&(s*=i5)),s!==0&&s%D2===0&&(s=Math.floor(s/D2)),r.shiftKey&&s&&(s=s*r5),this.callback({type:F2,center:{x:r.clientX,y:r.clientY},delta:-s,srcEvent:r,pointerType:"mouse",target:r.target})},this.events=(this.options.events||[]).concat(n5),this.events.forEach(r=>e.addEventListener(r,this.handleEvent,Ep?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===F2&&(this.options.enable=n)}}const{MOUSE_EVENTS:o5}=C1,k2="pointermove",N2="pointerover",U2="pointerout",G2="pointerenter",z2="pointerleave";class a5 extends Ff{constructor(e,n,i){super(e,n,i),this.handleEvent=s=>{this.handleOverEvent(s),this.handleOutEvent(s),this.handleEnterEvent(s),this.handleLeaveEvent(s),this.handleMoveEvent(s)},this.pressed=!1;const{enable:r}=this.options;this.enableMoveEvent=r,this.enableLeaveEvent=r,this.enableEnterEvent=r,this.enableOutEvent=r,this.enableOverEvent=r,this.events=(this.options.events||[]).concat(o5),this.events.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===k2&&(this.enableMoveEvent=n),e===N2&&(this.enableOverEvent=n),e===U2&&(this.enableOutEvent=n),e===G2&&(this.enableEnterEvent=n),e===z2&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(N2,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(U2,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(G2,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(z2,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(k2,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:A5}=C1,V2="keydown",H2="keyup";class l5 extends Ff{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{const s=r.target||r.srcElement;s.tagName==="INPUT"&&s.type==="text"||s.tagName==="TEXTAREA"||(this.enableDownEvent&&r.type==="keydown"&&this.callback({type:V2,srcEvent:r,key:r.key,target:r.target}),this.enableUpEvent&&r.type==="keyup"&&this.callback({type:H2,srcEvent:r,key:r.key,target:r.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(A5),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(r=>e.addEventListener(r,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===V2&&(this.enableDownEvent=n),e===H2&&(this.enableUpEvent=n)}}const j2="contextmenu";class c5 extends Ff{constructor(e,n,i){super(e,n,i),this.handleEvent=r=>{!this.options.enable||this.callback({type:j2,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===j2&&(this.options.enable=n)}}const wp=1,Wh=2,Tp=4,u5={pointerdown:wp,pointermove:Wh,pointerup:Tp,mousedown:wp,mousemove:Wh,mouseup:Tp},h5=1,f5=2,d5=3,g5=0,p5=1,m5=2,_5=1,y5=2,v5=4;function E5(t){const e=u5[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let s=!1,o=!1,a=!1;return e===Tp||e===Wh&&!Number.isFinite(n)?(s=r===h5,o=r===f5,a=r===d5):e===Wh?(s=Boolean(n&_5),o=Boolean(n&v5),a=Boolean(n&y5)):e===wp&&(s=i===g5,o=i===p5,a=i===m5),{leftButton:s,middleButton:o,rightButton:a}}function w5(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1,o={x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/s};return{center:n,offsetCenter:o}}const m0={srcElement:"root",priority:0};class T5{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const i=this._normalizeEvent(n);let r=n.srcEvent.target;for(;r&&r!==i.rootElement;){if(this._emit(i,r),i.handled)return;r=r.parentNode}this._emit(i,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,i,r=!1,s=!1){const{handlers:o,handlersByElement:a}=this;let c=m0;typeof i=="string"||i&&i.addEventListener?c={...m0,srcElement:i}:i&&(c={...m0,...i});let f=a.get(c.srcElement);f||(f=[],a.set(c.srcElement,f));const p={type:e,handler:n,srcElement:c.srcElement,priority:c.priority};r&&(p.once=!0),s&&(p.passive=!0),o.push(p),this._active=this._active||!p.passive;let m=f.length-1;for(;m>=0&&!(f[m].priority>=p.priority);)m--;f.splice(m+1,0,p)}remove(e,n){const{handlers:i,handlersByElement:r}=this;for(let s=i.length-1;s>=0;s--){const o=i[s];if(o.type===e&&o.handler===n){i.splice(s,1);const a=r.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&r.delete(o.srcElement)}}this._active=i.some(s=>!s.passive)}_emit(e,n){const i=this.handlersByElement.get(n);if(i){let r=!1;const s=()=>{e.handled=!0},o=()=>{e.handled=!0,r=!0},a=[];for(let c=0;c<i.length;c++){const{type:f,handler:p,once:m}=i[c];if(p({...e,type:f,stopPropagation:s,stopImmediatePropagation:o}),m&&a.push(i[c]),r)break}for(let c=0;c<a.length;c++){const{type:f,handler:p}=a[c];this.remove(f,p)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...E5(e),...w5(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const C5={events:null,recognizers:null,recognizerOptions:{},Manager:YU,touchAction:"none",tabIndex:0};class b5{constructor(e=null,n){this._onBasicInput=r=>{const{srcEvent:s}=r,o=qU[s.type];o&&this.manager.emit(o,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={...C5,...n},this.events=new Map,this.setElement(e);const{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,i=n.Manager;this.manager=new i(e,{touchAction:n.touchAction,recognizers:n.recognizers||KU}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(R2).forEach(r=>{const s=this.manager.get(r);s&&R2[r].forEach(o=>{s.recognizeWith(o)})});for(const r in n.recognizerOptions){const s=this.manager.get(r);if(s){const o=n.recognizerOptions[r];delete o.enable,s.set(o)}}this.wheelInput=new s5(e,this._onOtherEvent,{enable:!1}),this.moveInput=new a5(e,this._onOtherEvent,{enable:!1}),this.keyInput=new l5(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new c5(e,this._onOtherEvent,{enable:!1});for(const[r,s]of this.events)s.isEmpty()||(this._toggleRecognizer(s.recognizerName,!0),this.manager.on(r,s.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,i){this._addEventHandler(e,n,i,!1)}once(e,n,i){this._addEventHandler(e,n,i,!0)}watch(e,n,i){this._addEventHandler(e,n,i,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:i}=this;if(!i)return;const r=i.get(e);if(r&&r.options.enable!==n){r.set({enable:n});const s=ZU[e];s&&!this.options.recognizers&&s.forEach(o=>{const a=i.get(o);n?(a.requireFailure(e),r.dropRequireFailure(o)):a.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,i,r,s){if(typeof e!="string"){i=n;for(const p in e)this._addEventHandler(p,e[p],i,r,s);return}const{manager:o,events:a}=this,c=O2[e]||e;let f=a.get(c);f||(f=new T5(this),a.set(c,f),f.recognizerName=$U[c]||c,o&&o.on(c,f.handleEvent)),f.add(e,n,i,r,s),f.isEmpty()||this._toggleRecognizer(f.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const o in e)this._removeEventHandler(o,e[o]);return}const{events:i}=this,r=O2[e]||e,s=i.get(r);if(!!s&&(s.remove(e,n),s.isEmpty())){const{recognizerName:o}=s;let a=!1;for(const c of i.values())if(c.recognizerName===o&&!c.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}}function Ds(){}const S5=({isDragging:t})=>t?"grabbing":"grab",sx={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Ds,onResize:Ds,onViewStateChange:Ds,onInteractionStateChange:Ds,onBeforeRender:Ds,onAfterRender:Ds,onLoad:Ds,onError:t=>Re.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:S5,getTooltip:null,debug:!1,drawPickingColors:!1};class Df{constructor(e){T(this,"props",void 0),T(this,"width",0),T(this,"height",0),T(this,"userData",{}),T(this,"canvas",null),T(this,"viewManager",null),T(this,"layerManager",null),T(this,"effectManager",null),T(this,"deckRenderer",null),T(this,"deckPicker",null),T(this,"eventManager",null),T(this,"tooltip",null),T(this,"metrics",void 0),T(this,"animationLoop",void 0),T(this,"stats",void 0),T(this,"viewState",void 0),T(this,"cursorState",void 0),T(this,"_needsRedraw",void 0),T(this,"_pickRequest",void 0),T(this,"_lastPointerDownInfo",null),T(this,"_metricsCounter",void 0),T(this,"_onPointerMove",n=>{const{_pickRequest:i}=this;if(n.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(n.leftButton||n.rightButton)return;{const r=n.offsetCenter;if(!r)return;i.x=r.x,i.y=r.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=n}),T(this,"_onEvent",n=>{const i=y2[n.type],r=n.offsetCenter;if(!i||!r||!this.layerManager)return;const s=this.layerManager.getLayers(),o=this.deckPicker.getLastPickedObject({x:r.x,y:r.y,layers:s,viewports:this.getViewports(r)},this._lastPointerDownInfo),{layer:a}=o,c=a&&(a[i.handler]||a.props[i.handler]),f=this.props[i.handler];let p=!1;c&&(p=c.call(a,o,n)),!p&&f&&f(o,n)}),T(this,"_onPointerDown",n=>{const i=n.offsetCenter,r=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=r.result[0]||r.emptyInfo}),this.props={...sx,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Re.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),Tb()==="IE"&&Re.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new ql({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&Da.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,i,r,s,o,a;if(this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(e=this.layerManager)===null||e===void 0||e.finalize(),this.layerManager=null,(n=this.viewManager)===null||n===void 0||n.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(r=this.deckRenderer)===null||r===void 0||r.finalize(),this.deckRenderer=null,(s=this.deckPicker)===null||s===void 0||s.finalize(),this.deckPicker=null,(o=this.eventManager)===null||o===void 0||o.destroy(),this.eventManager=null,(a=this.tooltip)===null||a===void 0||a.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var c;(c=this.canvas.parentElement)===null||c===void 0||c.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Re.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Re.removed("onLayerClick","onClick")(),e.initialViewState&&!fo(this.props.initialViewState,e.initialViewState)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),r=this.layerManager.needsRedraw(e),s=this.effectManager.needsRedraw(e),o=this.deckRenderer.needsRedraw(e);return n=n||i||r||s||o,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return tn(this.viewManager),this.viewManager.views}getViewports(e){return tn(this.viewManager),this.viewManager.getViewports(e)}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_pick(e,n,i){tn(this.deckPicker);const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(n).timeStart();const s=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return r.get(n).timeEnd(),s}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),tn(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:i}=e;if(n||n===0){const s=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=s}if(i||i===0){var r;const s=Number.isFinite(i)?"".concat(i,"px"):i;this.canvas.style.position=((r=e.style)===null||r===void 0?void 0:r.position)||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const n=e.clientWidth||e.width,i=e.clientHeight||e.height;if(n!==this.width||i!==this.height){var r;this.width=n,this.height=i,(r=this.viewManager)===null||r===void 0||r.setProps({width:n,height:i}),this.props.onResize({width:n,height:i})}}_createAnimationLoop(e){const{width:n,height:i,gl:r,glOptions:s,debug:o,onError:a,onBeforeRender:c,onAfterRender:f,useDevicePixels:p}=e;return new H4({width:n,height:i,useDevicePixels:p,autoResizeViewport:!1,gl:r,onCreateContext:m=>zb({...s,...m,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:m=>this._setGLContext(m.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:c,onAfterRender:f,onError:a})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new ZS({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:i,emptyInfo:r}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=i.length>0;let s=r,o=!1;for(const a of i){var n;s=a,o=((n=a.layer)===null||n===void 0?void 0:n.onHover(a,e.event))||o}if(!o&&this.props.onHover&&this.props.onHover(s,e.event),this.props.getTooltip&&this.tooltip){const a=this.props.getTooltip(s);this.tooltip.setTooltip(a,s.x,s.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,qm(e,{enable:!0,copyState:!0})),this.tooltip=new HU(this.canvas),xr(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new FS;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new b5(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in y2)this.eventManager.on(r,this._onEvent);this.viewManager=new aU({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new oU(e,{deck:this,stats:this.stats,viewport:i,timeline:n}),this.effectManager=new IU,this.deckRenderer=new FU(e),this.deckPicker=new zU(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:i}=this.layerManager.context;xr(i,this.props.parameters),this.props.onBeforeRender({gl:i}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:e,effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:i})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Re.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const i=Qs.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}T(Df,"defaultProps",sx);T(Df,"VERSION",ZO.VERSION);class _0{constructor(e,n){T(this,"opts",void 0),T(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:i}=this.source,{size:r}=n;let s=i;if(i&&i.length!==r){s=new Float32Array(r);const o=n.elementOffset||0;for(let a=0;a<r;++a)s[a]=i[o+a]}return s}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function x5(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function th(t){return t.stride||t.size*t.bytesPerElement}function ox(t,e){e.offset&&Re.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=th(t),i=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,r=e.elementOffset||0,s=i*n+r*t.bytesPerElement+(t.offset||0);return{...e,offset:s,stride:n}}function P5(t,e){const n=ox(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class M5{constructor(e,n,i){T(this,"gl",void 0),T(this,"id",void 0),T(this,"size",void 0),T(this,"settings",void 0),T(this,"value",void 0),T(this,"doublePrecision",void 0),T(this,"_buffer",void 0),T(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const r=n.logicalType||n.type,s=r===5130;let{defaultValue:o}=n;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;s?a=5126:!r&&n.isIndexed?a=e&&Bf(e,ft.ELEMENT_INDEX_UINT32)?5125:5123:a=r||5126;let c=x5(r||a||5126);this.doublePrecision=s,s&&n.fp64===!1&&(c=Float32Array),this.value=null,this.settings={...n,defaultType:c,defaultValue:o,logicalType:r,type:a,size:this.size,bytesPerElement:c.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ct(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*th(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Da.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const i={},r=this.value instanceof Float64Array,s=P5(this.getAccessor(),n||{});return i[e]=new _0(this,s.high),i["".concat(e,"64Low")]=r?new _0(this,s.low):new Float32Array(this.size),i}if(n){const i=ox(this.getAccessor(),n);return{[e]:new _0(this,i)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:i,size:r}=this,s=i*r;if(n&&s&&n.length>=s){const o=new Array(r).fill(1/0),a=new Array(r).fill(-1/0);for(let c=0;c<s;)for(let f=0;f<r;f++){const p=n[c++];p<o[f]&&(o[f]=p),p>a[f]&&(a[f]=p)}e=[o,a]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof ct?i={buffer:e}:i=e;const r={...this.settings,...i};if(n.bufferAccessor=r,n.bounds=null,i.constant){let s=i.value;if(s=this._normalizeValue(s,[],0),this.settings.normalized&&(s=this.normalizeConstant(s)),!(!n.constant||!this._areValuesEqual(s,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=s}else if(i.buffer){const s=i.buffer;n.externalBuffer=s,n.constant=!1,this.value=i.value||null;const o=i.value instanceof Float64Array;r.type=i.type||s.accessor.type,r.bytesPerElement=s.accessor.BYTES_PER_ELEMENT*(o?2:1),r.stride=th(r)}else if(i.value){this._checkExternalBuffer(i);let s=i.value;n.externalBuffer=null,n.constant=!1,this.value=s,r.bytesPerElement=s.BYTES_PER_ELEMENT,r.stride=th(r);const{buffer:o,byteOffset:a}=this;this.doublePrecision&&s instanceof Float64Array&&(s=g0(s,r));const c=s.byteLength+a+r.stride*2;o.byteLength<c&&o.reallocate(c),o.setAccessor(null),o.subData({data:s,offset:a}),r.type=i.type||o.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:i=0,endOffset:r}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?g0(n,{size:this.size,startIndex:i,endIndex:r}):n.subarray(i,r),offset:i*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:i}=this,r=i.allocatedValue,s=Da.allocate(r,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=s;const{buffer:o,byteOffset:a}=this;return o.byteLength<s.byteLength+a&&(o.reallocate(s.byteLength+a),n&&r&&o.subData({data:r instanceof Float64Array?g0(r,this):r,offset:a})),i.allocatedValue=s,i.constant=!1,i.externalBuffer=null,i.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const i=this.settings.defaultType;let r=!1;if(this.doublePrecision&&(r=n.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof i)&&this.settings.normalized&&!("normalized"in e)&&Re.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,i){const{defaultValue:r,size:s}=this.settings;if(Number.isFinite(e))return n[i]=e,n;if(!e)return n[i]=r[0],n;switch(s){case 4:n[i+3]=Number.isFinite(e[3])?e[3]:r[3];case 3:n[i+2]=Number.isFinite(e[2])?e[2]:r[2];case 2:n[i+1]=Number.isFinite(e[1])?e[1]:r[1];case 1:n[i+0]=Number.isFinite(e[0])?e[0]:r[0];break;default:let o=s;for(;--o>=0;)n[i+o]=Number.isFinite(e[o])?e[o]:r[o]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:i}=this;for(let r=0;r<i;r++)if(e[r]!==n[r])return!1;return!0}}const W2=[],Q2=[];function ws(t,e=0,n=1/0){let i=W2;const r={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?i=t:t.length>0&&(Q2.length=t.length,i=Q2):i=W2,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function ax(t){return t&&t[Symbol.asyncIterator]}function Ax(t,e){const{size:n,stride:i,offset:r,startIndices:s,nested:o}=e,a=t.BYTES_PER_ELEMENT,c=i?i/a:n,f=r?r/a:0,p=Math.floor((t.length-f)/c);return(m,{index:v,target:w})=>{if(!s){const x=v*c+f;for(let P=0;P<n;P++)w[P]=t[x+P];return w}const C=s[v],S=s[v+1]||p;let R;if(o){R=new Array(S-C);for(let x=C;x<S;x++){const P=x*c+f;w=new Array(n);for(let I=0;I<n;I++)w[I]=t[P+I];R[x-C]=w}}else if(c===n)R=t.subarray(C*n+f,S*n+f);else{R=new t.constructor((S-C)*n);let x=0;for(let P=C;P<S;P++){const I=P*c+f;for(let F=0;F<n;F++)R[x++]=t[I+F]}}return R}}const I5=[],nh=[[0,1/0]];function B5(t,e){if(t===nh||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],i=t.length;let r=0;for(let s=0;s<i;s++){const o=t[s];o[1]<e[0]?(n.push(o),r=s+1):o[0]>e[1]?n.push(o):e=[Math.min(o[0],e[0]),Math.max(o[1],e[1])]}return n.splice(r,0,e),n}function y0(t){const{source:e,target:n,start:i=0,size:r,getData:s}=t,o=t.end||n.length,a=e.length,c=o-i;if(a>c){n.set(e.subarray(0,c),i);return}if(n.set(e,i),!s)return;let f=a;for(;f<c;){const p=s(f,e);for(let m=0;m<r;m++)n[i+f]=p[m]||0,f++}}function L5({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:s}){if(!Array.isArray(s))return y0({source:t,target:e,size:n,getData:i}),e;let o=0,a=0;const c=i&&((p,m)=>i(p+a,m)),f=Math.min(r.length,s.length);for(let p=1;p<f;p++){const m=r[p]*n,v=s[p]*n;y0({source:t.subarray(o,m),target:e,start:a,end:v,size:n,getData:c}),o=m,a=v}return a<e.length&&y0({source:[],target:e,start:a,size:n,getData:c}),e}const R5={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function lx(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...R5[n],...e,...t,type:n}}function cx(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function ux(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function hx(t){t.push(t.shift())}function b1(t,e){const{doublePrecision:n,settings:i,value:r,size:s}=t,o=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*s)*o}function fx({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:s=o=>o}){const o=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*o,c=n.byteOffset,f=n.startIndices,p=r&&f,m=b1(n,e),v=n.isConstant;if(!p&&i>=m)return;const w=v?n.value:n.getBuffer().getData({srcByteOffset:c});if(n.settings.normalized&&!v){const x=s;s=(P,I)=>n.normalizeConstant(x(P,I))}const C=v?(x,P)=>s(w,P):(x,P)=>s(w.subarray(x,x+a),P),S=t.getData({length:i}),R=new Float32Array(m);L5({source:S,target:R,sourceStartIndices:r,targetStartIndices:f,size:a,getData:C}),t.byteLength<R.byteLength+c&&t.reallocate(R.byteLength+c),t.subData({data:R,offset:c})}class S1 extends M5{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:nh}),T(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,i=this.settings.transition,r=Array.isArray(n)?e[n.find(s=>e[s])]:e[n];return lx(r,i)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:i=0,endRow:r=1/0}=n;this.state.updateRanges=B5(this.state.updateRanges,[i,r])}else this.state.updateRanges=nh}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=I5}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,n.updateRanges!==nh),!0):!1}updateBuffer({numInstances:e,data:n,props:i,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:s},settings:{update:o,noAlloc:a}}=this;let c=!0;if(o){for(const[f,p]of s)o.call(r,this,{data:n,startRow:f,endRow:p,props:i,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[f,p]of s){const m=Number.isFinite(f)?this.getVertexOffset(f):0,v=Number.isFinite(p)?this.getVertexOffset(p):a||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:m,endOffset:v})}this._checkAttributeArray()}else c=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),c}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:i,settings:r}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),r.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const o=e;tn(ArrayBuffer.isView(o.value),"invalid ".concat(r.accessor));const a=Boolean(o.size)&&o.size!==this.size;return i.binaryAccessor=Ax(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:n,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?n[e]:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const i in e)Object.assign(n,super.getShaderAttributes(i,e[i]));return n}_autoUpdater(e,{data:n,startRow:i,endRow:r,props:s,numInstances:o}){if(e.constant)return;const{settings:a,state:c,value:f,size:p,startIndices:m}=e,{accessor:v,transform:w}=a,C=c.binaryAccessor||(typeof v=="function"?v:s[v]);tn(typeof C=="function",'accessor "'.concat(v,'" is not a function'));let S=e.getVertexOffset(i);const{iterable:R,objectInfo:x}=ws(n,i,r);for(const P of R){x.index++;let I=C(P,x);if(w&&(I=w.call(this,I)),m){const F=(x.index<m.length-1?m[x.index+1]:o)-m[x.index];if(I&&Array.isArray(I[0])){let H=S;for(const Q of I)e._normalizeValue(Q,f,H),H+=p}else I&&I.length>p?f.set(I,S):(e._normalizeValue(I,x.target,0),tU({target:f,source:x.target,start:S,count:F}));S+=F*p}else e._normalizeValue(I,f,S),S+=p}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let i=!0;switch(n){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class O5{constructor({gl:e,attribute:n,timeline:i}){T(this,"gl",void 0),T(this,"type","interpolation"),T(this,"attributeInTransition",void 0),T(this,"settings",void 0),T(this,"attribute",void 0),T(this,"transition",void 0),T(this,"currentStartIndices",void 0),T(this,"currentLength",void 0),T(this,"transform",void 0),T(this,"buffers",void 0),this.gl=e,this.transition=new Ac(i),this.attribute=n,this.attributeInTransition=new S1(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=D5(e,n);const r={byteLength:0,usage:35050};this.buffers=[new ct(e,r),new ct(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:i,buffers:r,attribute:s}=this;hx(r);const o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)fx({buffer:a,...o});this.currentStartIndices=s.startIndices,this.currentLength=b1(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aFrom:r[0],aTo:cx(i,s)},feedbackBuffers:{vCurrent:r[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:i}=this.settings,{time:r}=this.transition;let s=r/n;i&&(s=i(s)),this.transform.run({uniforms:{time:s}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const F5=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function D5(t,e){const n=ux(e.size);return new _1(t,{vs:F5,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class k5{constructor({gl:e,attribute:n,timeline:i}){T(this,"gl",void 0),T(this,"type","spring"),T(this,"attributeInTransition",void 0),T(this,"settings",void 0),T(this,"attribute",void 0),T(this,"transition",void 0),T(this,"currentStartIndices",void 0),T(this,"currentLength",void 0),T(this,"texture",void 0),T(this,"framebuffer",void 0),T(this,"transform",void 0),T(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new Ac(i),this.attribute=n,this.attributeInTransition=new S1(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=U5(e),this.framebuffer=G5(e,this.texture),this.transform=N5(e,n,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new ct(e,r),new ct(e,r),new ct(e,r)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:i,buffers:r,attribute:s}=this,o={numInstances:n,attribute:s,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const a of r)fx({buffer:a,...o});this.settings=e,this.currentStartIndices=s.startIndices,this.currentLength=b1(s,n),this.attributeInTransition.setData({buffer:r[1],value:s.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/s.size),sourceBuffers:{aTo:cx(i,s)}})}update(){const{buffers:e,transform:n,framebuffer:i,transition:r}=this;if(!r.update())return!1;const o=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:i,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:o.stiffness,damping:o.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),hx(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),If(i)[0]>0||r.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function N5(t,e,n){const i=ux(e.size);return new _1(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}function U5(t){return new vn(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function G5(t,e){return new jt(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{[36064]:e}})}const z5={interpolation:O5,spring:k5};class V5{constructor(e,{id:n,timeline:i}){T(this,"id",void 0),T(this,"isSupported",void 0),T(this,"gl",void 0),T(this,"timeline",void 0),T(this,"transitions",void 0),T(this,"needsRedraw",void 0),T(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=_1.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:i}){this.numInstances=i||1;for(const r in e){const s=e[r],o=s.getTransitionSetting(n);!o||this._updateAttribute(r,s,o)}for(const r in this.transitions){const s=e[r];(!s||!s.getTransitionSetting(n))&&this._removeTransition(r)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const i=this.transitions[n];i.inProgress&&(e[n]=i.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,i){const r=this.transitions[e];let s=!r||r.type!==i.type;if(s){if(!this.isSupported){Re.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}r&&this._removeTransition(e);const o=z5[i.type];o?this.transitions[e]=new o({attribute:n,timeline:this.timeline,gl:this.gl}):(Re.error("unsupported transition type '".concat(i.type,"'"))(),s=!1)}(s||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const X2="attributeManager.invalidate",H5="attributeManager.updateStart",j5="attributeManager.updateEnd",W5="attribute.updateStart",Q5="attribute.allocate",X5="attribute.updateEnd";class J5{constructor(e,{id:n="attribute-manager",stats:i,timeline:r}={}){T(this,"id",void 0),T(this,"gl",void 0),T(this,"attributes",void 0),T(this,"updateTriggers",void 0),T(this,"needsRedraw",void 0),T(this,"userData",void 0),T(this,"stats",void 0),T(this,"attributeTransitionManager",void 0),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new V5(e,{id:"".concat(n,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const i=this._invalidateTrigger(e,n);dn(X2,this,e,i)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);dn(X2,this,"all")}update({data:e,numInstances:n,startIndices:i=null,transitions:r,props:s={},buffers:o={},context:a={}}){let c=!1;dn(H5,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const f in this.attributes){const p=this.attributes[f],m=p.settings.accessor;p.startIndices=i,p.numInstances=n,s[f]&&Re.removed("props.".concat(f),"data.attributes.".concat(f))(),p.setExternalBuffer(o[f])||p.setBinaryValue(typeof m=="string"?o[m]:void 0,e.startIndices)||typeof m=="string"&&!o[m]&&p.setConstantValue(s[m])||p.needsUpdate()&&(c=!0,this._updateAttribute({attribute:p,numInstances:n,data:e,props:s,context:a})),this.needsRedraw=this.needsRedraw||p.needsRedraw()}c&&dn(j5,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:r})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:i}=this,r={...i.getAttributes()};for(const s in n){const o=n[s];o.needsRedraw(e)&&!i.hasAttribute(s)&&(r[s]=o)}return r}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const i={};for(const r in e)n[r]||Object.assign(i,e[r].getShaderAttributes());return i}_add(e,n={}){for(const i in e){const r=e[i];this.attributes[i]=this._createAttribute(i,r,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,i){const r={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:i.instanced?1:n.divisor||0};return new S1(this.gl,r)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(r=>{e[r]||(e[r]=[]),e[r].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:i,updateTriggers:r}=this,s=r[e];return s&&s.forEach(o=>{const a=i[o];a&&a.setNeedsUpdate(a.id,n)}),s}_updateAttribute(e){const{attribute:n,numInstances:i}=e;if(dn(W5,n),n.constant){n.setConstantValue(n.value);return}n.allocate(i)&&dn(Q5,n,i),n.updateBuffer(e)&&(this.needsRedraw=!0,dn(X5,n,i))}}class Y5 extends Ac{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:i,duration:r,easing:s}}=this,o=s(e/r);this._value=ps(n,i,o)}}const J2=1e-5;function Y2(t,e,n,i,r){const s=e-t,a=(n-e)*r,c=-s*i;return a+c+s+e}function K5(t,e,n,i,r){if(Array.isArray(n)){const s=[];for(let o=0;o<n.length;o++)s[o]=Y2(t[o],e[o],n[o],i,r);return s}return Y2(t,e,n,i,r)}function K2(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}class Z5 extends Ac{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:i,stiffness:r}=this.settings,{_prevValue:s=e,_currValue:o=e}=this;let a=K5(s,o,n,i,r);const c=K2(a,n),f=K2(a,o);c<J2&&f<J2&&(a=n,this.end()),this._prevValue=o,this._currValue=a}}const q5={interpolation:Y5,spring:Z5};class $5{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,i,r){const{transitions:s}=this;if(s.has(e)){const c=s.get(e),{value:f=c.settings.fromValue}=c;n=f,this.remove(e)}if(r=lx(r),!r)return;const o=q5[r.type];if(!o){Re.error("unsupported transition type '".concat(r.type,"'"))();return}const a=new o(this.timeline);a.start({...r,fromValue:n,toValue:i}),s.set(e,a)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,i]of this.transitions)i.update(),e[n]=i.value,i.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function eG(t){const e=x1(t);for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function tG(t,e){const n=dx({newProps:t,oldProps:e,propTypes:x1(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=iG(t,e);let r=!1;return i||(r=rG(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:sG(t,e),transitionsChanged:nG(t,e)}}function nG(t,e){if(!t.transitions)return!1;const n={},i=x1(t);let r=!1;for(const s in t.transitions){const o=i[s],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&Cp(t[s],e[s],o)&&(n[s]=!0,r=!0)}return r?n:!1}function dx({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(r," changed shallowly");for(const s of Object.keys(t))if(!(s in n)){if(!(s in e))return"".concat(r,".").concat(s," added");const o=Cp(t[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}for(const s of Object.keys(e))if(!(s in n)){if(!(s in t))return"".concat(r,".").concat(s," dropped");if(!Object.hasOwnProperty.call(t,s)){const o=Cp(t[s],e[s],i[s]);if(o)return"".concat(r,".").concat(s," ").concat(o)}}return!1}function Cp(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)||!i&&(i=t&&e&&t.equals,i&&!i.call(t,e))?"changed deeply":!i&&e!==t?"changed shallowly":null}function iG(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}function rG(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&Z2(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)r!=="all"&&Z2(t,e,r)&&(n[r]=!0,i=!0);return i?n:!1}function sG(t,e){if(e===null)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i||i.length!==n.length)return!0;for(let r=0;r<i.length;r++)if(!i[r].equals(n[r]))return!0;return!1}function Z2(t,e,n){let i=t.updateTriggers[n];i=i==null?{}:i;let r=e.updateTriggers[n];return r=r==null?{}:r,dx({oldProps:r,newProps:i,triggerName:n})}function x1(t){const e=t[jh],n=e&&e.constructor;return n?n._propTypes:{}}const oG="count(): argument not an object",aG="count(): argument not a container";function AG(t){if(!cG(t))throw new Error(oG);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(lG(t))return Object.keys(t).length;throw new Error(aG)}function lG(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function cG(t){return t!==null&&typeof t=="object"}function uG(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=n.modules.findIndex(r=>r.name==="project32");i>=0&&n.modules.splice(i,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const i={...t.inject};for(const r in e.inject)i[r]=(i[r]||"")+e.inject[r];n.inject=i}return n}const hG={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071},bp={};function fG(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof vn)return e;e.constructor&&e.constructor.name!=="Object"&&(e={data:e});let i=null;e.compressed&&(i={[10241]:e.data.length>1?9985:9729});const r=new vn(n,{...e,parameters:{...hG,...i,...t.props.textureParameters}});return bp[r.id]=!0,r}function dG(t){!t||!(t instanceof vn)||bp[t.id]&&(t.delete(),delete bp[t.id])}const gG={boolean:{validate(t,e){return!0},equal(t,e,n){return Boolean(t)===Boolean(e)}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||Rl(t)&&(t.length===3||t.length===4)},equal(t,e,n){return v0(t,e)}},accessor:{validate(t,e){const n=Qh(t);return n==="function"||n===Qh(e.value)},equal(t,e,n){return typeof e=="function"?!0:v0(t,e)}},array:{validate(t,e){return e.optional&&!t||Rl(t)},equal(t,e,n){return n.compare?v0(t,e):t===e}},object:{equal(t,e,n){return n.compare?fo(t,e):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>fG(n,t),release:t=>{dG(t)}}};function v0(t,e){if(t===e)return!0;if(!Rl(t)||!Rl(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function pG(t){const e={},n={},i={};for(const[r,s]of Object.entries(t)){const o=s==null?void 0:s.deprecatedFor;if(o)i[r]=Array.isArray(o)?o:[o];else{const a=mG(r,s);e[r]=a,n[r]=a.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}function mG(t,e){switch(Qh(e)){case"object":return xA(t,e);case"array":return xA(t,{type:"array",value:e,compare:!1});case"boolean":return xA(t,{type:"boolean",value:e});case"number":return xA(t,{type:"number",value:e});case"function":return xA(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function xA(t,e){return"type"in e?{name:t,...gG[e.type],...e}:"value"in e?{name:t,type:Qh(e.value),...e}:{name:t,type:"object",value:e}}function Rl(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Qh(t){return Rl(t)?"array":t===null?"null":typeof t}function _G(t,e){const n=gx(t.constructor),i=Object.create(n);i[jh]=t,i[so]={},i[ns]={};for(let r=0;r<e.length;++r){const s=e[r];for(const o in s)i[o]=s[o]}return Object.freeze(i),i}function gx(t){const e=Xh(t,"_mergedDefaultProps");return e||(yG(t),t._mergedDefaultProps)}function yG(t){if(!t.prototype)return;const n=Object.getPrototypeOf(t),i=gx(n),r=Xh(t,"defaultProps")||{},s=pG(r),o=vG(s.defaultProps,i,t),a={...n._propTypes,...s.propTypes};wG(o,a);const c={...n._deprecatedProps,...s.deprecatedProps};EG(o,c),t._mergedDefaultProps=o,t._propTypes=a,t._deprecatedProps=c}function vG(t,e,n){const i=Object.create(null);Object.assign(i,e,t);const r=CG(n);return delete t.id,Object.defineProperties(i,{id:{writable:!0,value:r}}),i}function EG(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(i){const r="".concat(this.id,": ").concat(n);for(const s of e[n])px(this,s)||(this[s]=i);Re.deprecated(r,e[n].join("/"))()}})}function wG(t,e){const n={},i={};for(const r in e){const s=e[r],{name:o,value:a}=s;s.async&&(n[o]=a,i[o]=TG(o))}t[_a]=n,t[so]={},Object.defineProperties(t,i)}function TG(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||ax(e)?this[so][t]=e:this[ns][t]=e},get(){if(this[ns]){if(t in this[ns])return this[ns][t]||this[_a][t];if(t in this[so]){const e=this[jh]&&this[jh].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[_a][t]}}return this[_a][t]}}}function px(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Xh(t,e){return px(t,e)&&t[e]}function CG(t){const e=Xh(t,"layerName")||Xh(t,"componentName");return e||Re.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}let bG=0;class P1{constructor(...e){T(this,"id",void 0),T(this,"props",void 0),T(this,"count",void 0),this.props=_G(this,e),this.id=this.props.id,this.count=bG++}clone(e){const{props:n}=this,i={};for(const r in n[_a])r in n[ns]?i[r]=n[ns][r]:r in n[so]&&(i[r]=n[so][r]);return new this.constructor({...n,...i,...e})}}T(P1,"componentName","Component");T(P1,"defaultProps",{});const SG=Object.freeze({});class xG{constructor(e){T(this,"component",void 0),T(this,"onAsyncPropUpdated",void 0),T(this,"asyncProps",void 0),T(this,"oldProps",void 0),T(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps||SG}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return Boolean(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){const n=e[ns]||{},i=e[so]||e,r=e[_a]||{};for(const s in n){const o=n[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o),n[s]=this.getAsyncProp(s)}for(const s in i){const o=i[s];this._createAsyncPropData(s,r[s]),this._updateAsyncProp(s,o)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(!!this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(ax(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const i=this.asyncProps[e];return n===i.resolvedValue||n===i.lastValue?!1:(i.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(n=this._postProcessValue(i,n),i.resolvedValue=n,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,n,i){const r=this.asyncProps[e];r&&i>=r.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),r.resolvedValue=n,r.resolvedLoadCount=i,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const r=i.pendingLoadCount;n.then(s=>{s=this._postProcessValue(i,s),this._setAsyncPropValue(e,s,r),this._onResolve(e,s)}).catch(s=>{this._onError(e,s)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const r=i.pendingLoadCount;let s=[],o=0;for await(const a of n){const{dataTransform:c}=this.component.props;c?s=c(a,s):s=s.concat(a),Object.defineProperty(s,"__diff",{enumerable:!1,value:[{startRow:o,endRow:s.length}]}),o=s.length,this._setAsyncPropValue(e,s,r)}this._onResolve(e,s)}_postProcessValue(e,n){const i=e.type;return i&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(n,i,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const r=this.component&&this.component.constructor._propTypes;this.asyncProps[e]={type:r&&r[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class PG extends xG{constructor({attributeManager:e,layer:n}){super(n),T(this,"attributeManager",void 0),T(this,"needsRedraw",void 0),T(this,"needsUpdate",void 0),T(this,"subLayers",void 0),T(this,"usesPickingColorCache",void 0),T(this,"changeFlags",void 0),T(this,"viewport",void 0),T(this,"uniformTransitions",void 0),T(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(e){this.component=e}_fetch(e,n){const i=this.component.props.fetch;return i?i(n,{propName:e,layer:this.layer}):super._fetch(e,n)}_onResolve(e,n){const i=this.component.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:this.layer})}_onError(e,n){this.layer.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const MG="layer.changeFlag",IG="layer.initialize",BG="layer.update",LG="layer.finalize",RG="layer.matched",q2=2**24-1,OG=Object.freeze([]),FG=oc(({oldViewport:t,viewport:e})=>t.equals(e));let Xi=new Uint8ClampedArray(0);const DG={data:{type:"data",value:OG,async:!0},dataComparator:{type:"function",value:null,compare:!1,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:s})=>{const{resourceManager:o}=n.context;if(r=r||n.getLoadOptions(),i=i||n.props.loaders,s){var a;r={...r,fetch:{...(a=r)===null||a===void 0?void 0:a.fetch,signal:s}}}let c=o.contains(t);return!c&&!r&&(o.add({resourceId:t,data:Sr(t,i),persistent:!1}),c=!0),c?o.subscribe({resourceId:t,onChange:f=>{var p;return(p=n.internalState)===null||p===void 0?void 0:p.reloadAsyncProp(e,f)},consumerId:n.id,requestId:e}):Sr(t,i,r)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:sc.DRAW,onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:ze.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100],compare:!1},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Un extends P1{constructor(...e){super(...e),T(this,"internalState",null),T(this,"lifecycle",zo.NO_STATE),T(this,"context",void 0),T(this,"state",void 0),T(this,"parent",null)}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){tn(this.internalState);const n=this.internalState.viewport||this.context.viewport,i=XS(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,s,o]=HS(i,n.pixelProjectionMatrix);return e.length===2?[r,s]:[r,s,o]}unproject(e){return tn(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){tn(this.internalState);const i=this.internalState.viewport||this.context.viewport;return JS(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===ze.DEFAULT||e===ze.LNGLAT||e===ze.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){tn(e instanceof Uint8Array);const[n,i,r]=e;return n+i*256+r*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:AG(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;const n=this.getAttributeManager();if(!n)return null;const{positions:i,instancePositions:r}=n.attributes;return(e=i||r)===null||e===void 0?void 0:e.getBounds()}getShaders(e){for(const n of this.props.extensions)e=uG(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&n)if(Array.isArray(i))for(const c of i)n.invalidateAll(c);else n.invalidateAll();const{props:r,oldProps:s}=e,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable,a=Number.isInteger(r.highlightedObjectIndex)||r.pickable;if(o!==a&&n){const{pickingColors:c,instancePickingColors:f}=n.attributes,p=c||f;p&&(a&&p.constant&&(p.constant=!1,n.invalidate(p.id)),!p.value&&!a&&(p.constant=!0,p.value=[0,0,0]))}}finalizeState(e){for(const i of this.getModels())i.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:i}){const{index:r}=e;return r>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[r]),e}raiseError(e,n){var i,r;if(n&&(e.message="".concat(n,": ").concat(e.message)),!((i=(r=this.props).onError)!==null&&i!==void 0&&i.call(r,e))){var s,o;(s=this.context)===null||s===void 0||(o=s.onError)===null||o===void 0||o.call(s,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!FG({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();!n||(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,i=this.getNumInstances(),r=this.getStartIndices();e.update({data:n.data,numInstances:i,startIndices:r,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const s=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(s)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),i=Object.create(this.props);for(const r in n)Object.defineProperty(i,r,{value:n[r]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const i=Math.floor(Xi.length/3);if(this.internalState.usesPickingColorCache=!0,i<n){n>q2&&Re.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Xi=Da.allocate(Xi,n,{size:3,copy:!0,maxCount:Math.max(n,q2)});const r=Math.floor(Xi.length/3),s=[];for(let o=i;o<r;o++)this.encodePickingColor(o,s),Xi[o*3+0]=s[0],Xi[o*3+1]=s[1],Xi[o*3+2]=s[2]}e.value=Xi.subarray(0,n*3)}_setModelAttributes(e,n){const i=this.getAttributeManager(),r=e.userData.excludeAttributes||{},s=i.getShaderAttributes(n,r);e.setAttributes(s)}disablePickingIndex(e){this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:i}=this.getAttributeManager().attributes,r=n||i;if(!r)return;const s=r.getVertexOffset(e),o=r.getVertexOffset(e+1);r.buffer.subData({data:new Uint8Array(o-s),offset:s})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;!i||(this.internalState.usesPickingColorCache&&i.value.buffer!==Xi.buffer&&(i.value=Xi.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){tn(!this.internalState),tn(Number.isFinite(this.props.coordinateSystem)),dn(IG,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new PG({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Re.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.layer=this,this.internalState.uniformTransitions=new $5(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){dn(RG,this,this===e);const{state:n,internalState:i}=e;this!==e&&(this.internalState=i,this.internalState.layer=this,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(dn(BG,this,e),!e)return;const n=this.props,i=this.context,r=this.internalState,s=i.viewport,o=this._updateUniformTransition();r.propsInTransition=o,i.viewport=r.viewport||s,this.props=o;try{const a=this._getUpdateParams(),c=this.getModels();if(i.gl)this.updateState(a);else try{this.updateState(a)}catch{}for(const p of this.props.extensions)p.updateState.call(this,a,p);const f=this.getModels()[0]!==c[0];this._postUpdate(a,f)}finally{i.viewport=s,this.props=n,this._clearChangeFlags(),r.needsUpdate=!1,r.resetOldProps()}}_finalize(){dn(LG,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:i={}}){this._updateAttributeTransition();const r=this.props,s=this.context;this.props=this.internalState.propsInTransition||r;const o=this.props.opacity;n.opacity=Math.pow(o,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:a}=this.props,c=a&&a(n)||[0,0];xr(s.gl,{polygonOffset:c}),gi(s.gl,i,()=>{const f={moduleParameters:e,uniforms:n,parameters:i,context:s};for(const p of this.props.extensions)p.draw.call(this,f,p);this.draw(f)})}finally{this.props=r}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const r in e)if(e[r]){let s=!1;switch(r){case"dataChanged":const o=e[r],a=n[r];o&&Array.isArray(a)&&(n.dataChanged=Array.isArray(o)?a.concat(o):o,s=!0);default:n[r]||(n[r]=e[r],s=!0)}s&&dn(MG,this,r,e)}const i=Boolean(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=i,n.somethingChanged=i||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const i=tG(e,n);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged){var r;this.internalState.uniformTransitions.add(s,n[s],e[s],(r=e.transitions)===null||r===void 0?void 0:r[s])}return this.setChangeFlags(i)}validateProps(){eG(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(n.pickingHighlightColor=i(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new J5(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:i,oldProps:r}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:s}=this.state;s==null||s.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:a,highlightColor:c}=i;if(n||r.autoHighlight!==o||r.highlightedObjectIndex!==a||r.highlightColor!==c){const f={};o||(f.pickingSelectedColor=null),Array.isArray(c)&&(f.pickingHighlightColor=c),Number.isInteger(a)&&(f.pickingSelectedColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setModuleParameters(f)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags;const i=this.getAttributeManager(),r=i?i.getNeedsRedraw(e):!1;return n=n||r,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}T(Un,"defaultProps",DG);T(Un,"layerName","Layer");const kG="compositeLayer.renderLayers";class Rr extends Un{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||n}getSubLayerRow(e,n,i){return e.__source={parent:this,object:n,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(i,r)=>i&&i.__source?(n.index=i.__source.index,e(i.__source.object,n)):e(i,r)}return e}getSubLayerProps(e={}){var n;const{opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:f,highlightColor:p,coordinateSystem:m,coordinateOrigin:v,wrapLongitude:w,positionFormat:C,modelMatrix:S,extensions:R,fetch:x,operation:P,_subLayerProps:I}=this.props,F={id:"",updateTriggers:{},opacity:i,pickable:r,visible:s,parameters:o,getPolygonOffset:a,highlightedObjectIndex:c,autoHighlight:f,highlightColor:p,coordinateSystem:m,coordinateOrigin:v,wrapLongitude:w,positionFormat:C,modelMatrix:S,extensions:R,fetch:x,operation:P},H=I&&e.id&&I[e.id],Q=H&&H.updateTriggers,q=e.id||"sublayer";if(H){const ee=this.constructor._propTypes,X=e.type?e.type._propTypes:{};for(const V in H){const D=X[V]||ee[V];D&&D.type==="accessor"&&(H[V]=this.getSubLayerAccessor(H[V]))}}Object.assign(F,e,H),F.id="".concat(this.props.id,"-").concat(q),F.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...Q};for(const ee of R){const X=ee.getSubLayerProps.call(this,ee);X&&Object.assign(F,X,{updateTriggers:Object.assign(F.updateTriggers,X.updateTriggers)})}return F}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let i=this.internalState.subLayers;const r=!i||this.needsUpdate();if(r){const s=this.renderLayers();i=Of(s,Boolean),this.internalState.subLayers=i}dn(kG,this,r,i);for(const s of i)s.parent=this}}T(Rr,"layerName","CompositeLayer");const du=Math.PI/180,$2=180/Math.PI,ih=6370972,ia=256;function NG(){const t=ia/ih,e=Math.PI/180*ia;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class mx extends lr{constructor(e={}){const{latitude:n=0,longitude:i=0,zoom:r=0,nearZMultiplier:s=.1,farZMultiplier:o=2,resolution:a=10}=e;let{height:c,altitude:f=1.5}=e;c=c||1,f=Math.max(.75,f);const p=new De().lookAt({eye:[0,-f,0],up:[0,0,1]}),m=Math.pow(2,r);p.rotateX(n*du),p.rotateZ(-i*du),p.scale(m/c);const v=Math.atan(.5/f),w=ia*2*m/c;super({...e,height:c,viewMatrix:p,longitude:i,latitude:n,zoom:r,distanceScales:NG(),fovyRadians:v*2,focalDistance:f,near:s,far:Math.min(2,1/w+1)*f*o}),T(this,"longitude",void 0),T(this,"latitude",void 0),T(this,"resolution",void 0),this.latitude=n,this.longitude=i,this.resolution=a}get projectionMode(){return Li.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},i=this.unproject([0,this.height/2],n),r=this.unproject([this.width/2,0],n),s=this.unproject([this.width,this.height/2],n),o=this.unproject([this.width/2,this.height],n);return s[0]<this.longitude&&(s[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],s[0],r[0],o[0]),Math.min(i[1],s[1],r[1],o[1]),Math.max(i[0],s[0],r[0],o[0]),Math.max(i[1],s[1],r[1],o[1])]}unproject(e,{topLeft:n=!0,targetZ:i}={}){const[r,s,o]=e,a=n?s:this.height-s,{pixelUnprojectionMatrix:c}=this;let f;if(Number.isFinite(o))f=E0(c,[r,a,o,1]);else{const w=E0(c,[r,a,-1,1]),C=E0(c,[r,a,1,1]),S=((i||0)/ih+1)*ia,R=l0(TS([],w,C)),x=l0(w),P=l0(C),I=(4*x*P-(R-x-P)**2)/16,F=4*I/R,H=Math.sqrt(x-F),Q=Math.sqrt(Math.max(0,S*S-F)),q=(H-Q)/Math.sqrt(R);f=qk([],w,C,q)}const[p,m,v]=this.unprojectPosition(f);return Number.isFinite(o)?[p,m,v]:Number.isFinite(i)?[p,m,i]:[p,m]}projectPosition(e){const[n,i,r=0]=e,s=n*du,o=i*du,a=Math.cos(o),c=(r/ih+1)*ia;return[Math.sin(s)*a*c,-Math.cos(s)*a*c,Math.sin(o)*c]}unprojectPosition(e){const[n,i,r]=e,s=CS(e),o=Math.asin(r/s),c=Math.atan2(n,-i)*$2,f=o*$2,p=(s/ia-1)*ih;return[c,f,p]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const i=this.unproject(n);return{longitude:e[0]-i[0]+this.longitude,latitude:e[1]-i[1]+this.latitude}}}function E0(t,e){const n=ja([],e,t);return d1(n,n,1/n[3]),n}const w0=Math.PI/180;function UG({height:t,focalDistance:e,orbitAxis:n,rotationX:i,rotationOrbit:r,zoom:s}){const o=n==="Z"?[0,0,1]:[0,1,0],a=n==="Z"?[0,-e,0]:[0,0,e],c=new De().lookAt({eye:a,up:o});c.rotateX(i*w0),n==="Z"?c.rotateZ(r*w0):c.rotateY(r*w0);const f=Math.pow(2,s)/t;return c.scale(f),c}class GG extends lr{constructor(e){const{height:n,projectionMatrix:i,fovy:r=50,orbitAxis:s="Z",target:o=[0,0,0],rotationX:a=0,rotationOrbit:c=0,zoom:f=0}=e,p=i?i[5]/2:E1(r);super({...e,longitude:void 0,viewMatrix:UG({height:n||1,focalDistance:p,orbitAxis:s,rotationX:a,rotationOrbit:c,zoom:f}),fovy:r,focalDistance:p,position:o,zoom:f}),T(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:n=!0}={}){const[i,r,s=this.projectedCenter[2]]=e,o=n?r:this.height-r,[a,c,f]=ac([i,o,s],this.pixelUnprojectionMatrix);return[a,c,f]}panByPosition(e,n){const i=this.project(e),r=[this.width/2+i[0]-n[0],this.height/2+i[1]-n[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}class zG extends lr{constructor(e){const{longitude:n,latitude:i,modelMatrix:r,bearing:s=0,pitch:o=0,up:a=[0,0,1]}=e,f=new Lf({bearing:s,pitch:o===-90?1e-4:90+o}).toVector3().normalize(),p=r?new De(r).transformAsVector(f):f,m=Number.isFinite(i)?zS({latitude:i}):0,v=Math.pow(2,m),w=new De().lookAt({eye:[0,0,0],center:p,up:a}).scale(v);super({...e,zoom:m,viewMatrix:w}),T(this,"longitude",void 0),T(this,"latitude",void 0),this.latitude=i,this.longitude=n}}const PA=20;class M1 extends T1{constructor(e){const{width:n,height:i,position:r=[0,0,0],bearing:s=0,pitch:o=0,longitude:a=null,latitude:c=null,maxPitch:f=90,minPitch:p=-90,startRotatePos:m,startBearing:v,startPitch:w,startZoomPosition:C}=e;super({width:n,height:i,position:r,bearing:s,pitch:o,longitude:a,latitude:c,maxPitch:f,minPitch:p},{startRotatePos:m,startBearing:v,startPitch:w,startZoomPosition:C})}panStart(){return this}pan(){return this}panEnd(){return this}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:i=0}){const{startRotatePos:r,startBearing:s,startPitch:o}=this.getState(),{width:a,height:c}=this.getViewportProps();if(!r||s===void 0||o===void 0)return this;let f;if(e){const p=(e[0]-r[0])/a,m=(e[1]-r[1])/c;f={bearing:s-p*180,pitch:o-m*90}}else f={bearing:s-n,pitch:o-i};return this._getUpdatedState(f)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this.getViewportProps().position})}zoom({scale:e}){let{startZoomPosition:n}=this.getState();n||(n=this.getViewportProps().position);const i=this.getDirection();return this._move(i,Math.log2(e)*PA,n)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null})}moveLeft(e=PA){const n=this.getDirection(!0);return this._move(n.rotateZ({radians:Math.PI/2}),e)}moveRight(e=PA){const n=this.getDirection(!0);return this._move(n.rotateZ({radians:-Math.PI/2}),e)}moveUp(e=PA){const n=this.getDirection(!0);return this._move(n,e)}moveDown(e=PA){const n=this.getDirection(!0);return this._move(n.negate(),e)}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}zoomIn(e=2){return this.zoom({scale:e})}zoomOut(e=2){return this.zoom({scale:1/e})}shortestPathFrom(e){const n=e.getViewportProps(),i={...this.getViewportProps()},{bearing:r,longitude:s}=i;return Math.abs(r-n.bearing)>180&&(i.bearing=r<0?r+360:r-360),s!==null&&n.longitude!==null&&Math.abs(s-n.longitude)>180&&(i.longitude=s<0?s+360:s-360),i}_move(e,n,i=this.getViewportProps().position){const r=e.scale(n);return this._getUpdatedState({position:new K(i).add(r)})}getDirection(e=!1){return new Lf({bearing:this.getViewportProps().bearing,pitch:e?90:90+this.getViewportProps().pitch}).toVector3().normalize()}_getUpdatedState(e){return new M1({...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{pitch:n,maxPitch:i,minPitch:r,longitude:s,bearing:o}=e;return e.pitch=kt(n,r,i),s!==null&&(s<-180||s>180)&&(e.longitude=Hh(s+180,360)-180),(o<-180||o>180)&&(e.bearing=Hh(o+180,360)-180),e}}class VG extends lc{constructor(...e){super(...e),T(this,"ControllerState",M1),T(this,"transition",{transitionDuration:300,transitionInterpolator:new Wa(["position","pitch","bearing"])})}}class HG extends or{get ViewportType(){return zG}get ControllerType(){return VG}}T(HG,"displayName","FirstPersonView");class jG extends or{constructor(e={}){super(e),this.props.orbitAxis=e.orbitAxis||"Z"}get ViewportType(){return GG}get ControllerType(){return wU}}T(jG,"displayName","OrbitView");class WG extends KS{applyConstraints(e){const{maxZoom:n,minZoom:i,zoom:r}=e;e.zoom=kt(r,i,n);const{longitude:s,latitude:o}=e;return(s<-180||s>180)&&(e.longitude=Hh(s+180,360)-180),e.latitude=kt(o,-89,89),e}}class QG extends lc{constructor(...e){super(...e),T(this,"ControllerState",WG),T(this,"transition",{transitionDuration:300,transitionInterpolator:new Wa(["longitude","latitude","zoom"])}),T(this,"dragMode","pan")}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class XG extends or{get ViewportType(){return mx}get ControllerType(){return QG}}T(XG,"displayName","GlobeView");class _x{constructor(e){T(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&fo(this.opts,e.opts)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,i={updateTriggers:{}};for(const r in n)if(r in this.props){const s=n[r],o=this.props[r];i[r]=o,s&&s.type==="accessor"&&(i.updateTriggers[r]=this.props.updateTriggers[r],typeof o=="function"&&(i[r]=this.getSubLayerAccessor(o)))}return i}initializeState(e,n){}updateState(e,n){}draw(e,n){}finalizeState(e,n){}}T(_x,"defaultProps",{});class yx{constructor(e){T(this,"opts",void 0),T(this,"typedArrayManager",void 0),T(this,"indexStarts",[0]),T(this,"vertexStarts",[0]),T(this,"vertexCount",0),T(this,"instanceCount",0),T(this,"attributes",void 0),T(this,"_attributeDefs",void 0),T(this,"data",void 0),T(this,"getGeometry",void 0),T(this,"geometryBuffer",void 0),T(this,"buffers",void 0),T(this,"positionSize",void 0),T(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=Da,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:i={},getGeometry:r,geometryBuffer:s,positionFormat:o,dataChanged:a,normalize:c=!0}=this.opts;if(this.data=n,this.getGeometry=r,this.positionSize=s&&s.size||(o==="XY"?2:3),this.buffers=i,this.normalize=c,s&&(tn(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(s),c||(i.positions=s)),this.geometryBuffer=i.positions,Array.isArray(a))for(const f of a)this._rebuildGeometry(f);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?Ax(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:i,buffers:r,_attributeDefs:s,typedArrayManager:o}=this;for(const a in s)if(a in r)o.release(i[a]),i[a]=null;else{const c=s[a];c.copy=n,i[a]=o.allocate(i[a],e,c)}}_forEachGeometry(e,n,i){const{data:r,getGeometry:s}=this,{iterable:o,objectInfo:a}=ws(r,n,i);for(const c of o){a.index++;const f=s?s(c,a):null;e(f,a.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:i,instanceCount:r}=this;const{data:s,geometryBuffer:o}=this,{startRow:a=0,endRow:c=1/0}=e||{},f={};if(e||(n=[0],i=[0]),this.normalize||!o)this._forEachGeometry((m,v)=>{const w=m&&this.normalizeGeometry(m);f[v]=w,i[v+1]=i[v]+(w?this.getGeometrySize(w):0)},a,c),r=i[i.length-1];else if(i=s.startIndices,r=i[s.length]||0,ArrayBuffer.isView(o))r=r||o.length/this.positionSize;else if(o instanceof ct){const m=o.accessor.stride||this.positionSize*4;r=r||o.byteLength/m}else if(o.buffer){const m=o.stride||this.positionSize*4;r=r||o.buffer.byteLength/m}else if(o.value){const m=o.value,v=o.stride/m.BYTES_PER_ELEMENT||this.positionSize;r=r||m.length/v}this._allocate(r,Boolean(e)),this.indexStarts=n,this.vertexStarts=i,this.instanceCount=r;const p={};this._forEachGeometry((m,v)=>{const w=f[v]||m;p.vertexStart=i[v],p.indexStart=n[v];const C=v<i.length-1?i[v+1]:r;p.geometrySize=C-i[v],p.geometryIndex=v,this.updateGeometryAttributes(w,p)},a,c),this.vertexCount=n[n.length-1]}}const JG=typeof window<"u"?Te.exports.useLayoutEffect:Te.exports.useEffect;function Jh(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const YG={position:"absolute",zIndex:-1};function vx(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>vx(n,e));if(kf(t)){if(KG(t))return e.style=YG,Te.exports.cloneElement(t,e);if(ZG(t))return Te.exports.cloneElement(t,e)}return t}function kf(t){return t&&typeof t=="object"&&"type"in t||!1}function KG(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}function ZG(t){const e=t.type;return e&&e.deckGLViewProps}function Sp(t){if(typeof t=="function")return Te.exports.createElement(or,{},t);if(Array.isArray(t))return t.map(Sp);if(kf(t)){if(t.type===Te.exports.Fragment)return Sp(t.props.children);if(Jh(t.type,or))return t}return t}function qG({children:t,layers:e=[],views:n=null}){const i=[],r=[],s={};return Te.exports.Children.forEach(Sp(t),o=>{if(kf(o)){const a=o.type;if(Jh(a,Un)){const c=$G(a,o.props);r.push(c)}else i.push(o);if(Jh(a,or)&&a!==or&&o.props.id){const c=new a(o.props);s[c.id]=c}}else o&&i.push(o)}),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach(o=>{s[o.id]=o}):n&&(s[n.id]=n),n=Object.values(s)),e=r.length>0?[...r,...e]:e,{layers:e,children:i,views:n}}function $G(t,e){const n={},i=t.defaultProps||{};for(const r in e)i[r]!==e[r]&&(n[r]=e[r]);return new t(n)}function ez({children:t,deck:e,ContextProvider:n}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const r={},s=i.views[0].id;for(const o of t){let a=s,c=o;kf(o)&&Jh(o.type,or)&&(a=o.props.id||s,c=o.props.children);const f=i.getViewport(a),p=i.getViewState(a);if(f){const{x:m,y:v,width:w,height:C}=f;c=vx(c,{x:m,y:v,width:w,height:C,viewport:f,viewState:p}),r[a]||(r[a]={viewport:f,children:[]}),r[a].children.push(c)}}return Object.keys(r).map(o=>{const{viewport:a,children:c}=r[o],{x:f,y:p,width:m,height:v}=a,w={position:"absolute",left:f,top:p,width:m,height:v},C="view-".concat(o),S=Te.exports.createElement("div",{key:C,id:C,style:w},...c);if(n){const R={viewport:a,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:x=>{x.viewId=o,e._onViewStateChange(x)}};return Te.exports.createElement(n,{key:C,value:R},S)}return S})}const tz={mixBlendMode:null};function nz({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const s in n)s in tz?r[s]=n[s]:i[s]=n[s];return{containerStyle:i,canvasStyle:r}}function iz(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function Ex(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function rz(t,e,n){const i=new e({...n,_customRender:r=>{t.redrawReason=r;const s=i.getViewports();t.lastRenderedViewports!==s?t.forceUpdate():Ex(t)}});return i}const wx=Te.exports.forwardRef((t,e)=>{const[n,i]=Te.exports.useState(0),s=Te.exports.useRef({control:null,version:n,forceUpdate:()=>i(H=>H+1)}).current,o=Te.exports.useRef(null),a=Te.exports.useRef(null),c=Te.exports.useMemo(()=>qG(t),[t.layers,t.views,t.children]);let f=!0;const p=H=>{var Q;return f&&t.viewState?(s.viewStateUpdateRequested=H,null):(s.viewStateUpdateRequested=null,(Q=t.onViewStateChange)===null||Q===void 0?void 0:Q.call(t,H))},m=H=>{if(f)s.interactionStateUpdateRequested=H;else{var Q;s.interactionStateUpdateRequested=null,(Q=t.onInteractionStateChange)===null||Q===void 0||Q.call(t,H)}},v=Te.exports.useMemo(()=>{const H={...t,style:null,width:"100%",height:"100%",parent:o.current,canvas:a.current,layers:c.layers,views:c.views,onViewStateChange:p,onInteractionStateChange:m};return delete H._customRender,s.deck&&s.deck.setProps(H),H},[t]);Te.exports.useEffect(()=>{const H=t.Deck||Df;return s.deck=rz(s,H,{...v,parent:o.current,canvas:a.current}),()=>{var Q;return(Q=s.deck)===null||Q===void 0?void 0:Q.finalize()}},[]),JG(()=>{Ex(s);const{viewStateUpdateRequested:H,interactionStateUpdateRequested:Q}=s;H&&p(H),Q&&m(Q)}),Te.exports.useImperativeHandle(e,()=>iz(s),[]);const w=s.deck&&s.deck.isInitialized?s.deck.getViewports():void 0,{ContextProvider:C,width:S,height:R,id:x,style:P}=t,{containerStyle:I,canvasStyle:F}=Te.exports.useMemo(()=>nz({width:S,height:R,style:P}),[S,R,P]);if(!s.viewStateUpdateRequested&&s.lastRenderedViewports===w||s.version!==n){s.lastRenderedViewports=w,s.version=n;const H=ez({children:c.children,deck:s.deck,ContextProvider:C}),Q=Te.exports.createElement("canvas",{key:"canvas",id:x||"deckgl-overlay",ref:a,style:F});s.control=Te.exports.createElement("div",{id:"".concat(x||"deckgl","-wrapper"),ref:o,style:I},[Q,H])}return f=!1,s.control});wx.defaultProps=Df.defaultProps;const sz=`#define SHADER_NAME arc-layer-vertex-shader

attribute vec3 positions;
attribute vec4 instanceSourceColors;
attribute vec4 instanceTargetColors;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceTargetPositions64Low;
attribute vec3 instancePickingColors;
attribute float instanceWidths;
attribute float instanceHeights;
attribute float instanceTilts;

uniform bool greatCircle;
uniform bool useShortestPath;
uniform float numSegments;
uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;
varying float isValid;

float paraboloid(float distance, float sourceZ, float targetZ, float ratio) {
  // d: distance on the xy plane
  // r: ratio of the current point
  // p: ratio of the peak of the arc
  // h: height multiplier
  // z = f(r) = sqrt(r * (p * 2 - r)) * d * h
  // f(0) = 0
  // f(1) = dz

  float deltaZ = targetZ - sourceZ;
  float dh = distance * instanceHeights;
  if (dh == 0.0) {
    return sourceZ + deltaZ * ratio;
  }
  float unitZ = deltaZ / dh;
  float p2 = unitZ * unitZ + 1.0;

  // sqrt does not deal with negative values, manually flip source and target if delta.z < 0
  float dir = step(deltaZ, 0.0);
  float z0 = mix(sourceZ, targetZ, dir);
  float r = mix(ratio, 1.0 - ratio, dir);
  return sqrt(r * (p2 - r)) * dh + z0;
}

// offset vector by strokeWidth pixels
// offset_direction is -1 (left) or 1 (right)
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));
}

vec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {
  float distance = length(source.xy - target.xy);
  float z = paraboloid(distance, source.z, target.z, segmentRatio);

  float tiltAngle = radians(instanceTilts);
  vec2 tiltDirection = normalize(target.xy - source.xy);
  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);

  return vec3(
    mix(source.xy, target.xy, segmentRatio) + tilt,
    z * cos(tiltAngle)
  );
}

/* Great circle interpolation
 * http://www.movable-type.co.uk/scripts/latlong.html
 */
float getAngularDist (vec2 source, vec2 target) {
  vec2 sourceRadians = radians(source);
  vec2 targetRadians = radians(target);
  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);
  vec2 shd_sq = sin_half_delta * sin_half_delta;

  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;
  return 2.0 * asin(sqrt(a));
}

vec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {
  vec2 lngLat;

  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  if(abs(angularDist - PI) < 0.001) {
    lngLat = (1.0 - t) * source.xy + t * target.xy;
  } else {
    float a = sin((1.0 - t) * angularDist);
    float b = sin(t * angularDist);
    vec3 p = source3D.yxz * a + target3D.yxz * b;
    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));
  }

  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);

  return vec3(lngLat, z);
}

/* END GREAT CIRCLE */

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  float segmentIndex = positions.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));
  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));

  // if it's the first point, use next - current as direction
  // otherwise use current - prev
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  isValid = 1.0;

  uv = vec2(segmentRatio, positions.y);
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;

  vec4 curr;
  vec4 next;
  vec3 source;
  vec3 target;

  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));
    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));
    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);

    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);
    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);
    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);

    if (abs(currPos.x - prevPos.x) > 180.0) {
      indexDir = -1.0;
      isValid = 0.0;
    } else if (abs(currPos.x - nextPos.x) > 180.0) {
      indexDir = 1.0;
      isValid = 0.0;
    }
    nextPos = indexDir < 0.0 ? prevPos : nextPos;
    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;

    if (isValid == 0.0) {
      // split at the 180th meridian
      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;
      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);
      currPos = mix(currPos, nextPos, t);
      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);
    }

    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);
    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);
  
    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);
    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));
  
  } else {
    vec3 source_world = instanceSourcePositions;
    vec3 target_world = instanceTargetPositions;
    if (useShortestPath) {
      source_world.x = mod(source_world.x + 180., 360.0) - 180.;
      target_world.x = mod(target_world.x + 180., 360.0) - 180.;

      float deltaLng = target_world.x - source_world.x;
      if (deltaLng > 180.) target_world.x -= 360.;
      if (deltaLng < -180.) source_world.x -= 360.;
    }
    source = project_position(source_world, instanceSourcePositions64Low);
    target = project_position(target_world, instanceTargetPositions64Low);

    // common x at longitude=-180
    float antiMeridianX = 0.0;

    if (useShortestPath) {
      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;
      }
      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);

      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {
        isValid = 0.0;
        indexDir = sign(segmentRatio - thresholdRatio);
        segmentRatio = thresholdRatio;
      }
    }

    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
    vec3 currPos = interpolateFlat(source, target, segmentRatio);
    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);

    if (useShortestPath) {
      if (nextPos.x < antiMeridianX) {
        currPos.x += TILE_SIZE;
        nextPos.x += TILE_SIZE;
      }
    }

    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));
    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));
    geometry.position = vec4(currPos, 1.0);
  }

  // Multiply out width and clamp to limits
  // mercator pixels are interpreted as screen pixels
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );

  // extrude
  vec3 offset = vec3(
    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);
  vColor = vec4(color.rgb, color.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,oz=`#define SHADER_NAME arc-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;
varying float isValid;

void main(void) {
  if (isValid == 0.0) {
    discard;
  }

  gl_FragColor = vColor;
  geometry.uv = uv;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Yh=[0,0,0,255],az={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:Yh},getTargetColor:{type:"accessor",value:Yh},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class I1 extends Un{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:sz,fs:oz,modules:[ar,Ar]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:Yh},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:Yh},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:i}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:i,widthMinPixels:r,widthMaxPixels:s,greatCircle:o,wrapLongitude:a}=this.props;this.state.model.setUniforms(e).setUniforms({greatCircle:o,widthUnits:Gi[n],widthScale:i,widthMinPixels:r,widthMaxPixels:s,useShortestPath:a}).draw()}_getModel(e){let n=[];for(let s=0;s<50;s++)n=n.concat([s,1,0,s,-1,0]);const r=new Nn(e,{...this.getShaders(),id:this.props.id,geometry:new pi({drawMode:5,attributes:{positions:new Float32Array(n)}}),isInstanced:!0});return r.setUniforms({numSegments:50}),r}}T(I1,"layerName","ArcLayer");T(I1,"defaultProps",az);const Az=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  // convert size in meters to pixels, then scaled and clamp
 
  // project meters to pixels and clamp to limits 
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );

  // scale icon height to match instanceSize
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;

  // scale and rotate vertex in "pixel" value and convert back to fraction in clipspace
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,lz=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);

  // if colorMode == 0, use pixel color from the texture
  // if colorMode == 1 or rendering picking buffer, use texture as transparency mask
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  // Take the global opacity and the alpha from vColor into account for the alpha component
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,cz=1024,uz=4,eE=()=>{},hz={[10241]:9987,[10240]:9729,[10242]:33071,[10243]:33071};function fz(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function dz(t,e,n,i){return n===e.width&&i===e.height?e:(t.canvas.height=i,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,i),t.canvas)}function Ol(t){return t&&(t.id||t.url)}function gz(t,e,n){const i=t.width,r=t.height,s=qb(t,{width:e,height:n});return mD(t,s,{targetY:0,width:i,height:r}),t.delete(),s}function tE(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:s}=e[i],o=Ol(r);t[o]={...r,x:s,y:n}}}function pz({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:s=0,canvasWidth:o}){let a=[];for(let c=0;c<t.length;c++){const f=t[c],p=Ol(f);if(!n[p]){const{height:m,width:v}=f;i+v+e>o&&(tE(n,a,r),i=0,r=s+r+e,s=0,a=[]),a.push({icon:f,xOffset:i}),i=i+v+e,s=Math.max(s,m)}}return a.length>0&&tE(n,a,r),{mapping:n,rowHeight:s,xOffset:i,yOffset:r,canvasWidth:o,canvasHeight:fz(s+r+e)}}function mz(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:s}=ws(t);for(const o of r){s.index++;const a=e(o,s),c=Ol(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[c]&&(!n[c]||a.url!==n[c].url)&&(i[c]={...a,source:o,sourceIndex:s.index})}return i}class _z{constructor(e,{onUpdate:n=eE,onError:i=eE}){T(this,"gl",void 0),T(this,"onUpdate",void 0),T(this,"onError",void 0),T(this,"_loadOptions",null),T(this,"_texture",null),T(this,"_externalTexture",null),T(this,"_mapping",{}),T(this,"_textureParameters",null),T(this,"_pendingCount",0),T(this,"_autoPacking",!1),T(this,"_xOffset",0),T(this,"_yOffset",0),T(this,"_rowHeight",0),T(this,"_buffer",uz),T(this,"_canvasWidth",cz),T(this,"_canvasHeight",0),T(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=i}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?Ol(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:i,iconMapping:r,textureParameters:s}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),r&&(this._mapping=r),i){var o;(o=this._texture)===null||o===void 0||o.delete(),this._texture=null,this._externalTexture=i}s&&(this._textureParameters=s)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(mz(e,n,this._mapping)||{});if(i.length>0){const{mapping:r,xOffset:s,yOffset:o,rowHeight:a,canvasHeight:c}=pz({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=r,this._xOffset=s,this._yOffset=o,this._canvasHeight=c,this._texture||(this._texture=new vn(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||hz})),this._texture.height!==this._canvasHeight&&(this._texture=gz(this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const n=this._canvas.getContext("2d");for(const i of e)this._pendingCount++,Sr(i.url,Ym,this._loadOptions).then(r=>{const s=Ol(i),{x:o,y:a,width:c,height:f}=this._mapping[s],p=dz(n,r,c,f);this._texture.setSubImageData({data:p,x:o,y:a,width:c,height:f}),this._texture.generateMipmap(),this.onUpdate()}).catch(r=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:r})}).finally(()=>{this._pendingCount--})}}const Tx=[0,0,0,255],yz={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:Tx},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class Nf extends Un{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:Az,fs:lz,modules:[ar,Ar]})}initializeState(){this.state={iconManager:new _z(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Tx},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:c,getIcon:f,textureParameters:p}=n,{iconManager:m}=this.state,v=o||this.internalState.isAsyncPropLoading("iconAtlas");if(m.setProps({loadOptions:n.loadOptions,autoPacking:!v,iconAtlas:o,iconMapping:v?a:null,textureParameters:p}),v?i.iconMapping!==n.iconMapping&&s.invalidate("getIcon"):(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getIcon))&&m.packIcons(c,f),r.extensionsChanged){var w;const{gl:C}=this.context;(w=this.state.model)===null||w===void 0||w.delete(),this.state.model=this._getModel(C),s.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,sizeUnits:s,billboard:o,alphaCutoff:a}=this.props,{iconManager:c}=this.state,f=c.getTexture();f&&this.state.model.setUniforms(e).setUniforms({iconsTexture:f,iconsTextureDim:[f.width,f.height],sizeUnits:Gi[s],sizeScale:n,sizeMinPixels:i,sizeMaxPixels:r,billboard:o,alphaCutoff:a}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Nn(e,{...this.getShaders(),id:this.props.id,geometry:new pi({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const i=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;i?i(e):Re.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:i,anchorX:r=n/2,anchorY:s=i/2}=this.state.iconManager.getIconMapping(e);return[n/2-r,i/2-s]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:i,width:r,height:s}=this.state.iconManager.getIconMapping(e);return[n,i,r,s]}}T(Nf,"defaultProps",yz);T(Nf,"layerName","IconLayer");const vz=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);

  // position on the containing square in [-1, 1] space
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  // Find the center of the point and add the current vertex
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply lighting
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);

  // Apply opacity to instance color, or return instance picking color
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Ez=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Cx=[0,0,0,255],bx=[0,0,1],wz={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:bx},getColor:{type:"accessor",value:Cx},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function Tz(t){const{header:e,attributes:n}=t;!e||!n||(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}class B1 extends Un{getShaders(){return super.getShaders({vs:vz,fs:Ez,modules:[ar,p1,Ar]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:bx},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:Cx}})}updateState(e){const{changeFlags:n,props:i}=e;if(super.updateState(e),n.extensionsChanged){var r;const{gl:s}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}n.dataChanged&&Tz(i.data)}draw({uniforms:e}){const{pointSize:n,sizeUnits:i}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:Gi[i],radiusPixels:n}).draw()}_getModel(e){const n=[];for(let i=0;i<3;i++){const r=i/3*Math.PI*2;n.push(Math.cos(r)*2,Math.sin(r)*2,0)}return new Nn(e,{...this.getShaders(),id:this.props.id,geometry:new pi({drawMode:4,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}T(B1,"layerName","PointCloudLayer");T(B1,"defaultProps",wz);const Cz=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  
  // Multiply out line width and clamp to limits
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;

  // Expand geometry to accomodate edge smoothing
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;

  // position on the containing square in [-1, 1] space
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
  }

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply opacity to instance color, or return instance picking color
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,bz=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (filled) {
    gl_FragColor = vFillColor;
  } else {
    discard;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,nE=[0,0,0,255],Sz={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:nE},getLineColor:{type:"accessor",value:nE},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class L1 extends Un{getShaders(){return super.getShaders({vs:Cz,fs:bz,modules:[ar,Ar]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:i}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,stroked:o,filled:a,billboard:c,antialiasing:f,lineWidthUnits:p,lineWidthScale:m,lineWidthMinPixels:v,lineWidthMaxPixels:w}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:o?1:0,filled:a,billboard:c,antialiasing:f,radiusUnits:Gi[n],radiusScale:i,radiusMinPixels:r,radiusMaxPixels:s,lineWidthUnits:Gi[p],lineWidthScale:m,lineWidthMinPixels:v,lineWidthMaxPixels:w}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Nn(e,{...this.getShaders(),id:this.props.id,geometry:new pi({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}T(L1,"defaultProps",Sz);T(L1,"layerName","ScatterplotLayer");const R1={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function O1(t,e,n={}){return xz(t,n)!==e?(Pz(t,n),!0):!1}function xz(t,e={}){return Math.sign(Kh(t,e))}function Kh(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let s=0;for(let o=n,a=i-r;o<i;o+=r)s+=(t[o]-t[a])*(t[o+1]+t[a+1]),a=o;return s/2}function Pz(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,s=(i-n)/r,o=Math.floor(s/2);for(let a=0;a<o;++a){const c=n+a*r,f=n+(s-1-a)*r;for(let p=0;p<r;++p){const m=t[c+p];t[c+p]=t[f+p],t[f+p]=m}}}function Mz(t,e,n=2,i){const r=e&&e.length,s=r?e[0]*n:t.length;let o=Sx(t,0,s,n,!0,i&&i[0]);const a=[];if(!o||o.next===o.prev)return a;let c,f,p,m,v,w,C;if(r&&(o=Oz(t,e,o,n,i)),t.length>80*n){m=f=t[0],v=p=t[1];for(let S=n;S<s;S+=n)w=t[S],C=t[S+1],w<m&&(m=w),C<v&&(v=C),w>f&&(f=w),C>p&&(p=C);c=Math.max(f-m,p-v),c=c!==0?1/c:0}return Fl(o,a,n,m,v,c),a}function Sx(t,e,n,i,r,s){let o,a;if(s===void 0&&(s=Kh(t,{start:e,end:n,size:i})),r===s<0)for(o=e;o<n;o+=i)a=iE(o,t[o],t[o+1],a);else for(o=n-i;o>=e;o-=i)a=iE(o,t[o],t[o+1],a);return a&&Uf(a,a.next)&&(kl(a),a=a.next),a}function _s(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(Uf(n,n.next)||xt(n.prev,n,n.next)===0)){if(kl(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Fl(t,e,n,i,r,s,o){if(!t)return;!o&&s&&Uz(t,i,r,s);let a=t,c,f;for(;t.prev!==t.next;){if(c=t.prev,f=t.next,s?Bz(t,i,r,s):Iz(t)){e.push(c.i/n),e.push(t.i/n),e.push(f.i/n),kl(t),t=f.next,a=f.next;continue}if(t=f,t===a){o?o===1?(t=Lz(_s(t),e,n),Fl(t,e,n,i,r,s,2)):o===2&&Rz(t,e,n,i,r,s):Fl(_s(t),e,n,i,r,s,1);break}}}function Iz(t){const e=t.prev,n=t,i=t.next;if(xt(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(ra(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&xt(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Bz(t,e,n,i){const r=t.prev,s=t,o=t.next;if(xt(r,s,o)>=0)return!1;const a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,c=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,f=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,p=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,m=xp(a,c,e,n,i),v=xp(f,p,e,n,i);let w=t.prevZ,C=t.nextZ;for(;w&&w.z>=m&&C&&C.z<=v;){if(w!==t.prev&&w!==t.next&&ra(r.x,r.y,s.x,s.y,o.x,o.y,w.x,w.y)&&xt(w.prev,w,w.next)>=0||(w=w.prevZ,C!==t.prev&&C!==t.next&&ra(r.x,r.y,s.x,s.y,o.x,o.y,C.x,C.y)&&xt(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;w&&w.z>=m;){if(w!==t.prev&&w!==t.next&&ra(r.x,r.y,s.x,s.y,o.x,o.y,w.x,w.y)&&xt(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;C&&C.z<=v;){if(C!==t.prev&&C!==t.next&&ra(r.x,r.y,s.x,s.y,o.x,o.y,C.x,C.y)&&xt(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Lz(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!Uf(r,s)&&xx(r,i,i.next,s)&&Dl(r,s)&&Dl(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),kl(i),kl(i.next),i=t=s),i=i.next}while(i!==t);return _s(i)}function Rz(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Vz(o,a)){let c=Px(o,a);o=_s(o,o.next),c=_s(c,c.next),Fl(o,e,n,i,r,s),Fl(c,e,n,i,r,s);return}a=a.next}o=o.next}while(o!==t)}function Oz(t,e,n,i,r){const s=[];let o,a,c,f,p;for(o=0,a=e.length;o<a;o++)c=e[o]*i,f=o<a-1?e[o+1]*i:t.length,p=Sx(t,c,f,i,!1,r&&r[o+1]),p===p.next&&(p.steiner=!0),s.push(zz(p));for(s.sort(Fz),o=0;o<s.length;o++)Dz(s[o],n),n=_s(n,n.next);return n}function Fz(t,e){return t.x-e.x}function Dz(t,e){if(e=kz(t,e),e){const n=Px(e,t);_s(e,e.next),_s(n,n.next)}}function kz(t,e){let n=e;const i=t.x,r=t.y;let s=-1/0,o;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const v=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(v<=i&&v>s){if(s=v,v===i){if(r===n.y)return n;if(r===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(i===s)return o;const a=o,c=o.x,f=o.y;let p=1/0,m;n=o;do i>=n.x&&n.x>=c&&i!==n.x&&ra(r<f?i:s,r,c,f,r<f?s:i,r,n.x,n.y)&&(m=Math.abs(r-n.y)/(i-n.x),Dl(n,t)&&(m<p||m===p&&(n.x>o.x||n.x===o.x&&Nz(o,n)))&&(o=n,p=m)),n=n.next;while(n!==a);return o}function Nz(t,e){return xt(t.prev,t,e.prev)<0&&xt(e.next,t,t.next)<0}function Uz(t,e,n,i){let r=t;do r.z===null&&(r.z=xp(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,Gz(r)}function Gz(t){let e,n,i=1,r,s,o,a,c,f;do{for(s=t,t=null,f=null,r=0;s;){for(r++,a=s,o=0,n=0;n<i&&(o++,a=a.nextZ,!!a);n++);for(c=i;o>0||c>0&&a;)o!==0&&(c===0||!a||s.z<=a.z)?(e=s,s=s.nextZ,o--):(e=a,a=a.nextZ,c--),f?f.nextZ=e:t=e,e.prevZ=f,f=e;s=a}f.nextZ=null,i*=2}while(r>1);return t}function xp(t,e,n,i,r){return t=32767*(t-n)*r,e=32767*(e-i)*r,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function zz(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function ra(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function Vz(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Hz(t,e)&&(Dl(t,e)&&Dl(e,t)&&jz(t,e)&&(xt(t.prev,t,e.prev)||xt(t,e.prev,e))||Uf(t,e)&&xt(t.prev,t,t.next)>0&&xt(e.prev,e,e.next)>0)}function xt(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Uf(t,e){return t.x===e.x&&t.y===e.y}function xx(t,e,n,i){const r=pu(xt(t,e,n)),s=pu(xt(t,e,i)),o=pu(xt(n,i,t)),a=pu(xt(n,i,e));return!!(r!==s&&o!==a||r===0&&gu(t,n,e)||s===0&&gu(t,i,e)||o===0&&gu(n,t,i)||a===0&&gu(n,e,i))}function gu(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function pu(t){return t>0?1:t<0?-1:0}function Hz(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&xx(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Dl(t,e){return xt(t.prev,t,t.next)<0?xt(t,e,t.next)>=0&&xt(t,t.prev,e)>=0:xt(t,e,t.prev)<0||xt(t,t.next,e)<0}function jz(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function Px(t,e){const n=new Pp(t.i,t.x,t.y),i=new Pp(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function iE(t,e,n,i){const r=new Pp(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function kl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Pp(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Oi(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let s=0;s<n;s++)if(t[i-n+s]!==e[s]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function Mp(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function Nl(t,e,n,i,r=[]){const s=i+e*n;for(let o=0;o<n;o++)r[o]=t[s+o];return r}function Ip(t,e,n,i,r=[]){let s,o;if(n&8)s=(i[3]-t[1])/(e[1]-t[1]),o=3;else if(n&4)s=(i[1]-t[1])/(e[1]-t[1]),o=1;else if(n&2)s=(i[2]-t[0])/(e[0]-t[0]),o=2;else if(n&1)s=(i[0]-t[0])/(e[0]-t[0]),o=0;else return null;for(let a=0;a<t.length;a++)r[a]=(o&1)===a?i[o]:s*(e[a]-t[a])+t[a];return r}function rh(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function Mx(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:s=[0,0],startIndex:o=0,endIndex:a=t.length}=e||{},c=(a-o)/n;let f=[];const p=[f],m=Nl(t,0,n,o);let v,w;const C=Bx(m,r,s,[]),S=[];Oi(f,m);for(let R=1;R<c;R++){for(v=Nl(t,R,n,o,v),w=rh(v,C);w;){Ip(m,v,w,C,S);const x=rh(S,C);x&&(Ip(m,S,x,C,S),w=x),Oi(f,S),Mp(m,S),Qz(C,r,w),i&&f.length>n&&(f=[],p.push(f),Oi(f,m)),w=rh(v,C)}Oi(f,v),Mp(m,v)}return i?p:p[0]}const rE=0,Wz=1;function mu(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function Ix(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:s=[0,0],edgeTypes:o=!1}=n||{},a=[],c=[{pos:t,types:o?new Array(t.length/i).fill(Wz):null,holes:e||[]}],f=[[],[]];let p=[];for(;c.length;){const{pos:m,types:v,holes:w}=c.shift();Xz(m,i,w[0]||m.length,f),p=Bx(f[0],r,s,p);const C=rh(f[1],p);if(C){let S=sE(m,v,i,0,w[0]||m.length,p,C);const R={pos:S[0].pos,types:S[0].types,holes:[]},x={pos:S[1].pos,types:S[1].types,holes:[]};c.push(R,x);for(let P=0;P<w.length;P++)S=sE(m,v,i,w[P],w[P+1]||m.length,p,C),S[0]&&(R.holes.push(R.pos.length),R.pos=mu(R.pos,S[0].pos),o&&(R.types=mu(R.types,S[0].types))),S[1]&&(x.holes.push(x.pos.length),x.pos=mu(x.pos,S[1].pos),o&&(x.types=mu(x.types,S[1].types)))}else{const S={positions:m};o&&(S.edgeTypes=v),w.length&&(S.holeIndices=w),a.push(S)}}return a}function sE(t,e,n,i,r,s,o){const a=(r-i)/n,c=[],f=[],p=[],m=[],v=[];let w,C,S;const R=Nl(t,a-1,n,i);let x=Math.sign(o&8?R[1]-s[3]:R[0]-s[2]),P=e&&e[a-1],I=0,F=0;for(let H=0;H<a;H++)w=Nl(t,H,n,i,w),C=Math.sign(o&8?w[1]-s[3]:w[0]-s[2]),S=e&&e[i/n+H],C&&x&&x!==C&&(Ip(R,w,o,s,v),Oi(c,v)&&p.push(P),Oi(f,v)&&m.push(P)),C<=0?(Oi(c,w)&&p.push(S),I-=C):p.length&&(p[p.length-1]=rE),C>=0?(Oi(f,w)&&m.push(S),F+=C):m.length&&(m[m.length-1]=rE),Mp(R,w),x=C,P=S;return[I?{pos:c,types:e&&p}:null,F?{pos:f,types:e&&m}:null]}function Bx(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],s=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=s,i[2]=r+e,i[3]=s+e,i}function Qz(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function Xz(t,e,n,i){let r=1/0,s=-1/0,o=1/0,a=-1/0;for(let c=0;c<n;c+=e){const f=t[c],p=t[c+1];r=f<r?f:r,s=f>s?f:s,o=p<o?p:o,a=p>a?p:a}return i[0][0]=r,i[0][1]=o,i[1][0]=s,i[1][1]=a,i}const Jz=85.051129;function Yz(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:s=!0}=e||{},o=t.slice(i,r);Lx(o,n,0,r-i);const a=Mx(o,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(s)for(const c of a)Rx(c,n);return a}function Kz(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:s=!1}=n||{};e=e||[];const o=[],a=[];let c=0,f=0;for(let m=0;m<=e.length;m++){const v=e[m]||t.length,w=f,C=Zz(t,i,c,v);for(let S=C;S<v;S++)o[f++]=t[S];for(let S=c;S<C;S++)o[f++]=t[S];Lx(o,i,w,f),qz(o,i,w,f,n==null?void 0:n.maxLatitude),c=v,a[m]=f}a.pop();const p=Ix(o,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:s});if(r)for(const m of p)Rx(m.positions,i);return p}function Zz(t,e,n,i){let r=-1,s=-1;for(let o=n+1;o<i;o+=e){const a=Math.abs(t[o]);a>r&&(r=a,s=o-1)}return s}function qz(t,e,n,i,r=Jz){const s=t[n],o=t[i-e];if(Math.abs(s-o)>180){const a=Nl(t,0,e,n);a[0]+=Math.round((o-s)/360)*360,Oi(t,a),a[1]=Math.sign(a[1])*r,Oi(t,a),a[0]=s,Oi(t,a)}}function Lx(t,e,n,i){let r=t[0],s;for(let o=n;o<i;o+=e){s=t[o];const a=s-r;(a>180||a<-180)&&(s-=Math.round(a/360)*360),t[o]=r=s}}function Rx(t,e){let n;const i=t.length/e;for(let s=0;s<i&&(n=t[s*e],(n+180)%360===0);s++);const r=-Math.round(n/360)*360;if(r!==0)for(let s=0;s<i;s++)t[s*e]+=r}class $z extends pi{constructor(e){const{id:n=rr("column-geometry")}=e,{indices:i,attributes:r}=e9(e);super({...e,id:n,indices:i,attributes:r})}}function e9(t){const{radius:e,height:n=1,nradial:i=10}=t;let{vertices:r}=t;r&&(Re.assert(r.length>=i),r=r.flatMap(w=>[w[0],w[1]]),O1(r,R1.COUNTER_CLOCKWISE));const s=n>0,o=i+1,a=s?o*3+1:i,c=Math.PI*2/i,f=new Uint16Array(s?i*3*2:0),p=new Float32Array(a*3),m=new Float32Array(a*3);let v=0;if(s){for(let w=0;w<o;w++){const C=w*c,S=w%i,R=Math.sin(C),x=Math.cos(C);for(let P=0;P<2;P++)p[v+0]=r?r[S*2]:x*e,p[v+1]=r?r[S*2+1]:R*e,p[v+2]=(1/2-P)*n,m[v+0]=r?r[S*2]:x,m[v+1]=r?r[S*2+1]:R,v+=3}p[v+0]=p[v-3],p[v+1]=p[v-2],p[v+2]=p[v-1],v+=3}for(let w=s?0:1;w<o;w++){const C=Math.floor(w/2)*Math.sign(.5-w%2),S=C*c,R=(C+i)%i,x=Math.sin(S),P=Math.cos(S);p[v+0]=r?r[R*2]:P*e,p[v+1]=r?r[R*2+1]:x*e,p[v+2]=n/2,m[v+2]=1,v+=3}if(s){let w=0;for(let C=0;C<i;C++)f[w++]=C*2+0,f[w++]=C*2+2,f[w++]=C*2+0,f[w++]=C*2+1,f[w++]=C*2+1,f[w++]=C*2+3}return{indices:f,attributes:{POSITION:{size:3,value:p},NORMAL:{size:3,value:m}}}}const t9=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;

// Custom uniforms
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;

// Result
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  // rotate primitive position and normal
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));

  // calculate elevation, if 3d not enabled set to 0
  // cylindar gemoetry height are between -1.0 to 1.0, transform it to between 0, 1
  float elevation = 0.0;
  // calculate stroke offset
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }

  // if alpha == 0.0 or z < 0.0, do not render element
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;

  // project center of column
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Light calculations
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,n9=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Zh=[0,0,0,255],i9={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:Zh},getLineColor:{type:"accessor",value:Zh},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class F1 extends Un{getShaders(){const{gl:e}=this.context,n=!We(e),i={},r=this.props.flatShading&&Bf(e,ft.GLSL_DERIVATIVES);return r&&(i.FLAT_SHADING=1),super.getShaders({vs:t9,fs:n9,defines:i,transpileToGLSL100:n,modules:[ar,r?OS:p1,Ar]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:Zh},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:Zh},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e,s=r.extensionsChanged||n.flatShading!==i.flatShading;if(s){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}(s||n.diskResolution!==i.diskResolution||n.vertices!==i.vertices||(n.extruded||n.stroked)!==(i.extruded||i.stroked))&&this._updateGeometry(n)}getGeometry(e,n,i){const r=new $z({radius:1,height:i?2:0,vertices:n,nradial:e});let s=0;if(n)for(let o=0;o<e;o++){const a=n[o];s+=Math.sqrt(a[0]*a[0]+a[1]*a[1])/e}else s=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*s}),r}_getModel(e){return new Nn(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:i,stroked:r}){const s=this.getGeometry(e,n,i||r);this.setState({fillVertexCount:s.attributes.POSITION.value.length/3,wireframeVertexCount:s.indices.value.length}),this.state.model.setProps({geometry:s})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:i,lineWidthMinPixels:r,lineWidthMaxPixels:s,radiusUnits:o,elevationScale:a,extruded:c,filled:f,stroked:p,wireframe:m,offset:v,coverage:w,radius:C,angle:S}=this.props,{model:R,fillVertexCount:x,wireframeVertexCount:P,edgeDistance:I}=this.state;R.setUniforms(e).setUniforms({radius:C,angle:S/180*Math.PI,offset:v,extruded:c,stroked:p,coverage:w,elevationScale:a,edgeDistance:I,radiusUnits:Gi[o],widthUnits:Gi[n],widthScale:i,widthMinPixels:r,widthMaxPixels:s}),c&&m&&(R.setProps({isIndexed:!0}),R.setVertexCount(P).setDrawMode(1).setUniforms({isStroke:!0}).draw()),f&&(R.setProps({isIndexed:!1}),R.setVertexCount(x).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!c&&p&&(R.setProps({isIndexed:!1}),R.setVertexCount(x*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}T(F1,"layerName","ColumnLayer");T(F1,"defaultProps",i9);function r9(t,e,n,i){let r;if(Array.isArray(t[0])){const s=t.length*e;r=new Array(s);for(let o=0;o<t.length;o++)for(let a=0;a<e;a++)r[o*e+a]=t[o][a]||0}else r=t;return n?Mx(r,{size:e,gridResolution:n}):i?Yz(r,{size:e}):r}const s9=1,o9=2,T0=4;class a9 extends yx{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?r9(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(oE(e)){let i=0;for(const r of e)i+=this.getGeometrySize(r);return i}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&oE(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const i=this.attributes.segmentTypes,r=e?this.isClosed(e):!1,{vertexStart:s,geometrySize:o}=n;i.fill(0,s,s+o),r?(i[s]=T0,i[s+o-2]=T0):(i[s]+=s9,i[s+o-2]+=o9),i[s+o-1]=T0}_updatePositions(e,n){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:r,geometrySize:s}=n,o=new Array(3);for(let a=r,c=0;c<s;a++,c++)this.getPointOnPath(e,c,o),i[a*3]=o[0],i[a*3+1]=o[1],i[a*3+2]=o[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,i=[]){const{positionSize:r}=this;n*r>=e.length&&(n+=1-e.length/r);const s=n*r;return i[0]=e[s],i[1]=e[s+1],i[2]=r===3&&e[s+2]||0,i}isClosed(e){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:n}=this,i=e.length-n;return e[0]===e[i]&&e[1]===e[i+1]&&(n===2||e[2]===e[i+2])}}function oE(t){return Array.isArray(t[0])}const A9=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}

// calculate line join positions
vec3 lineJoin(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  // side of the segment - -1: left, 0: center, 1: right
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);

  // tangent of the corner
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  // direction of the corner
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  // direction of the segment
  vec2 dir = isEnd ? dirA : dirB;
  // direction of the extrusion
  vec2 perp = isEnd ? perpA : perpB;
  // length of the segment
  float L = isEnd ? lenA : lenB;

  // A = angle of the corner
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));

  // -1: right, 1: left
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);

  // relative position to the corner:
  // -1: inside (smaller side of the angle)
  // 0: center
  // 1: outside (bigger side of the angle)
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  // trim if inside corner extends further than the line segment
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);

  // special treatment for start cap and end cap
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;

  // extend out a triangle to envelope the round cap
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }

  // Generate variables for fragment shader
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return currPoint + offset;
}

// In clipspace extrusion, if a line extends behind the camera, clip it to avoid visual artifacts
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    // Extrude in clipspace
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 pos = lineJoin(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);
  } else {
    // Extrude in commonspace
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec4 pos = vec4(
      lineJoin(prevPosition, currPosition, nextPosition, width.xy),
      1.0);
    geometry.position = pos;
    gl_Position = project_common_position_to_clipspace(pos);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,l9=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
/*
 * vPathPosition represents the relative coordinates of the current fragment on the path segment.
 * vPathPosition.x - position along the width of the path, between [-1, 1]. 0 is the center line.
 * vPathPosition.y - position along the length of the path, between [0, L / width].
 */
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    // if joint is rounded, test distance from the corner
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    // trim miter
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Ox=[0,0,0,255],c9={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:Ox},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},C0={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class cc extends Un{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:A9,fs:l9,modules:[ar,Ar]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:C0,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:C0,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:C0,defaultValue:Ox},instancePickingColors:{size:3,type:5121,accessor:(i,{index:r,target:s})=>this.encodePickingColor(i&&i.__source?i.__source.index:r,s)}}),this.setState({pathTesselator:new a9({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:i}=e,r=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:a}=this.state,c=n.data.attributes||{};a.updateGeometry({data:n.data,geometryBuffer:c.getPath,buffers:c,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:a.instanceCount,startIndices:a.vertexStarts}),i.dataChanged||r.invalidateAll()}if(i.extensionsChanged){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),r.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(s=>s.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else this._disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:i,billboard:r,miterLimit:s,widthUnits:o,widthScale:a,widthMinPixels:c,widthMaxPixels:f}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(i),billboard:r,widthUnits:Gi[o],widthScale:a,miterLimit:s,widthMinPixels:c,widthMaxPixels:f}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],i=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Nn(e,{...this.getShaders(),id:this.props.id,geometry:new pi({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(i),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}T(cc,"defaultProps",c9);T(cc,"layerName","PathLayer");var D1={exports:{}};D1.exports=Gf;D1.exports.default=Gf;function Gf(t,e,n){n=n||2;var i=e&&e.length,r=i?e[0]*n:t.length,s=Fx(t,0,r,n,!0),o=[];if(!s||s.next===s.prev)return o;var a,c,f,p,m,v,w;if(i&&(s=g9(t,e,s,n)),t.length>80*n){a=f=t[0],c=p=t[1];for(var C=n;C<r;C+=n)m=t[C],v=t[C+1],m<a&&(a=m),v<c&&(c=v),m>f&&(f=m),v>p&&(p=v);w=Math.max(f-a,p-c),w=w!==0?32767/w:0}return Ul(s,o,n,a,c,w,0),o}function Fx(t,e,n,i,r){var s,o;if(r===Rp(t,e,n,i)>0)for(s=e;s<n;s+=i)o=aE(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=aE(s,t[s],t[s+1],o);return o&&zf(o,o.next)&&(zl(o),o=o.next),o}function oo(t,e){if(!t)return t;e||(e=t);var n=t,i;do if(i=!1,!n.steiner&&(zf(n,n.next)||Pt(n.prev,n,n.next)===0)){if(zl(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Ul(t,e,n,i,r,s,o){if(!!t){!o&&s&&v9(t,i,r,s);for(var a=t,c,f;t.prev!==t.next;){if(c=t.prev,f=t.next,s?h9(t,i,r,s):u9(t)){e.push(c.i/n|0),e.push(t.i/n|0),e.push(f.i/n|0),zl(t),t=f.next,a=f.next;continue}if(t=f,t===a){o?o===1?(t=f9(oo(t),e,n),Ul(t,e,n,i,r,s,2)):o===2&&d9(t,e,n,i,r,s):Ul(oo(t),e,n,i,r,s,1);break}}}}function u9(t){var e=t.prev,n=t,i=t.next;if(Pt(e,n,i)>=0)return!1;for(var r=e.x,s=n.x,o=i.x,a=e.y,c=n.y,f=i.y,p=r<s?r<o?r:o:s<o?s:o,m=a<c?a<f?a:f:c<f?c:f,v=r>s?r>o?r:o:s>o?s:o,w=a>c?a>f?a:f:c>f?c:f,C=i.next;C!==e;){if(C.x>=p&&C.x<=v&&C.y>=m&&C.y<=w&&sa(r,a,s,c,o,f,C.x,C.y)&&Pt(C.prev,C,C.next)>=0)return!1;C=C.next}return!0}function h9(t,e,n,i){var r=t.prev,s=t,o=t.next;if(Pt(r,s,o)>=0)return!1;for(var a=r.x,c=s.x,f=o.x,p=r.y,m=s.y,v=o.y,w=a<c?a<f?a:f:c<f?c:f,C=p<m?p<v?p:v:m<v?m:v,S=a>c?a>f?a:f:c>f?c:f,R=p>m?p>v?p:v:m>v?m:v,x=Bp(w,C,e,n,i),P=Bp(S,R,e,n,i),I=t.prevZ,F=t.nextZ;I&&I.z>=x&&F&&F.z<=P;){if(I.x>=w&&I.x<=S&&I.y>=C&&I.y<=R&&I!==r&&I!==o&&sa(a,p,c,m,f,v,I.x,I.y)&&Pt(I.prev,I,I.next)>=0||(I=I.prevZ,F.x>=w&&F.x<=S&&F.y>=C&&F.y<=R&&F!==r&&F!==o&&sa(a,p,c,m,f,v,F.x,F.y)&&Pt(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;I&&I.z>=x;){if(I.x>=w&&I.x<=S&&I.y>=C&&I.y<=R&&I!==r&&I!==o&&sa(a,p,c,m,f,v,I.x,I.y)&&Pt(I.prev,I,I.next)>=0)return!1;I=I.prevZ}for(;F&&F.z<=P;){if(F.x>=w&&F.x<=S&&F.y>=C&&F.y<=R&&F!==r&&F!==o&&sa(a,p,c,m,f,v,F.x,F.y)&&Pt(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function f9(t,e,n){var i=t;do{var r=i.prev,s=i.next.next;!zf(r,s)&&Dx(r,i,i.next,s)&&Gl(r,s)&&Gl(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),zl(i),zl(i.next),i=t=s),i=i.next}while(i!==t);return oo(i)}function d9(t,e,n,i,r,s){var o=t;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&T9(o,a)){var c=kx(o,a);o=oo(o,o.next),c=oo(c,c.next),Ul(o,e,n,i,r,s,0),Ul(c,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function g9(t,e,n,i){var r=[],s,o,a,c,f;for(s=0,o=e.length;s<o;s++)a=e[s]*i,c=s<o-1?e[s+1]*i:t.length,f=Fx(t,a,c,i,!1),f===f.next&&(f.steiner=!0),r.push(w9(f));for(r.sort(p9),s=0;s<r.length;s++)n=m9(r[s],n);return n}function p9(t,e){return t.x-e.x}function m9(t,e){var n=_9(t,e);if(!n)return e;var i=kx(n,t);return oo(i,i.next),oo(n,n.next)}function _9(t,e){var n=e,i=t.x,r=t.y,s=-1/0,o;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var a=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s&&(s=a,o=n.x<n.next.x?n:n.next,a===i))return o}n=n.next}while(n!==e);if(!o)return null;var c=o,f=o.x,p=o.y,m=1/0,v;n=o;do i>=n.x&&n.x>=f&&i!==n.x&&sa(r<p?i:s,r,f,p,r<p?s:i,r,n.x,n.y)&&(v=Math.abs(r-n.y)/(i-n.x),Gl(n,t)&&(v<m||v===m&&(n.x>o.x||n.x===o.x&&y9(o,n)))&&(o=n,m=v)),n=n.next;while(n!==c);return o}function y9(t,e){return Pt(t.prev,t,e.prev)<0&&Pt(e.next,t,t.next)<0}function v9(t,e,n,i){var r=t;do r.z===0&&(r.z=Bp(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,E9(r)}function E9(t){var e,n,i,r,s,o,a,c,f=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<f&&(a++,i=i.nextZ,!!i);e++);for(c=f;a>0||c>0&&i;)a!==0&&(c===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,f*=2}while(o>1);return t}function Bp(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function w9(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function sa(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function T9(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!C9(t,e)&&(Gl(t,e)&&Gl(e,t)&&b9(t,e)&&(Pt(t.prev,t,e.prev)||Pt(t,e.prev,e))||zf(t,e)&&Pt(t.prev,t,t.next)>0&&Pt(e.prev,e,e.next)>0)}function Pt(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function zf(t,e){return t.x===e.x&&t.y===e.y}function Dx(t,e,n,i){var r=yu(Pt(t,e,n)),s=yu(Pt(t,e,i)),o=yu(Pt(n,i,t)),a=yu(Pt(n,i,e));return!!(r!==s&&o!==a||r===0&&_u(t,n,e)||s===0&&_u(t,i,e)||o===0&&_u(n,t,i)||a===0&&_u(n,e,i))}function _u(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function yu(t){return t>0?1:t<0?-1:0}function C9(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Dx(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Gl(t,e){return Pt(t.prev,t,t.next)<0?Pt(t,e,t.next)>=0&&Pt(t,t.prev,e)>=0:Pt(t,e,t.prev)<0||Pt(t,t.next,e)<0}function b9(t,e){var n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function kx(t,e){var n=new Lp(t.i,t.x,t.y),i=new Lp(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function aE(t,e,n,i){var r=new Lp(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function zl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Lp(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Gf.deviation=function(t,e,n,i){var r=e&&e.length,s=r?e[0]*n:t.length,o=Math.abs(Rp(t,0,s,n));if(r)for(var a=0,c=e.length;a<c;a++){var f=e[a]*n,p=a<c-1?e[a+1]*n:t.length;o-=Math.abs(Rp(t,f,p,n))}var m=0;for(a=0;a<i.length;a+=3){var v=i[a]*n,w=i[a+1]*n,C=i[a+2]*n;m+=Math.abs((t[v]-t[C])*(t[w+1]-t[v+1])-(t[v]-t[w])*(t[C+1]-t[v+1]))}return o===0&&m===0?0:Math.abs((m-o)/o)};function Rp(t,e,n,i){for(var r=0,s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}Gf.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var s=0;s<t[r].length;s++)for(var o=0;o<e;o++)n.vertices.push(t[r][s][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n};const vu=R1.CLOCKWISE,AE=R1.COUNTER_CLOCKWISE,is={isClosed:!0};function S9(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function jA(t){return"positions"in t?t.positions:t}function sh(t){return"holeIndices"in t?t.holeIndices:null}function x9(t){return Array.isArray(t[0])}function P9(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function M9(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function I9(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}function lE(t,e,n,i,r){let s=e;const o=n.length;for(let a=0;a<o;a++)for(let c=0;c<i;c++)t[s++]=n[a][c]||0;if(!M9(n))for(let a=0;a<i;a++)t[s++]=n[0][a]||0;return is.start=e,is.end=s,is.size=i,O1(t,r,is),s}function cE(t,e,n,i,r=0,s,o){s=s||n.length;const a=s-r;if(a<=0)return e;let c=e;for(let f=0;f<a;f++)t[c++]=n[r+f];if(!I9(n,i,r,s))for(let f=0;f<i;f++)t[c++]=n[r+f];return is.start=e,is.end=c,is.size=i,O1(t,o,is),c}function Nx(t,e){S9(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:s}=t;if(s){let o=0;for(let a=0;a<=s.length;a++)o=cE(n,o,r,e,s[a-1],s[a],a===0?vu:AE),i.push(o);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!x9(t))return cE(n,0,t,e,0,n.length,vu),n;if(!P9(t)){let r=0;for(const[s,o]of t.entries())r=lE(n,r,o,e,s===0?vu:AE),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return lE(n,0,t,e,vu),n}function B9(t,e,n){let i=sh(t);i&&(i=i.map(s=>s/e));let r=jA(t);if(n){const s=r.length;r=r.slice();const o=[];for(let a=0;a<s;a+=e){o[0]=r[a],o[1]=r[a+1];const c=n(o);r[a]=c[0],r[a+1]=c[1]}}return D1.exports(r,i,e)}class L9 extends yx{constructor(e){const{fp64:n,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=Nx(e,this.positionSize);return this.opts.resolution?Ix(jA(n),sh(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Kz(jA(n),sh(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(uE(e)){let n=0;for(const i of e)n+=this.getGeometrySize(i);return n}return jA(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&uE(e))for(const i of e){const r=this.getGeometrySize(i);n.geometrySize=r,this.updateGeometryAttributes(i,n),n.vertexStart+=r,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:i,indexStart:r}){const{attributes:s,indexStarts:o,typedArrayManager:a}=this;let c=s.indices;if(!c||!e)return;let f=r;const p=B9(e,this.positionSize,this.opts.preproject);c=a.allocate(c,r+p.length,{copy:!0});for(let m=0;m<p.length;m++)c[f++]=p[m]+i;o[n+1]=r+p.length,s.indices=c}_updatePositions(e,{vertexStart:n,geometrySize:i}){const{attributes:{positions:r},positionSize:s}=this;if(!r||!e)return;const o=jA(e);for(let a=n,c=0;c<i;a++,c++){const f=o[c*s],p=o[c*s+1],m=s>2?o[c*s+2]:0;r[a*3]=f,r[a*3+1]=p,r[a*3+2]=m}}_updateVertexValid(e,{vertexStart:n,geometrySize:i}){const{positionSize:r}=this,s=this.attributes.vertexValid,o=e&&sh(e);if(e&&e.edgeTypes?s.set(e.edgeTypes,n):s.fill(1,n,n+i),o)for(let a=0;a<o.length;a++)s[n+o[a]/r-1]=0;s[n+i-1]=0}}function uE(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const Ux=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,R9=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(Ux,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),O9=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(Ux,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),F9=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,qh=[0,0,0,255],D9={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:qh},getLineColor:{type:"accessor",value:qh},material:!0},Eu={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class Vf extends Un{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?R9:O9,fs:F9,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[ar,p1,Ar]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:i}=this.props;n.isGeospatial&&i===ze.DEFAULT&&(i=ze.LNGLAT),this.setState({numInstances:0,polygonTesselator:new L9({preproject:i===ze.LNGLAT&&n.projectFlat.bind(n),fp64:this.use64bitPositions(),IndexType:!e||t1(e,ft.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const r=this.getAttributeManager(),s=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:Eu,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:Eu,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Eu,accessor:"getFillColor",defaultValue:qh,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:Eu,accessor:"getLineColor",defaultValue:qh,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(o,{index:a,target:c})=>this.encodePickingColor(o&&o.__source?o.__source.index:a,c),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i}=n,{data:r}=this.props;return r[0]&&r[0].__source&&(n.object=r.find(s=>s.__source.index===i)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let i=0;i<n.length;i++)n[i].__source.index===e&&this._disablePickingIndex(i);else this._disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:i,wireframe:r,elevationScale:s}=this.props,{topModel:o,sideModel:a,polygonTesselator:c}=this.state,f={...e,extruded:Boolean(n),elevationScale:s};a&&(a.setInstanceCount(c.instanceCount-1),a.setUniforms(f),r&&(a.setDrawMode(3),a.setUniforms({isWireframe:!0}).draw()),i&&(a.setDrawMode(6),a.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(c.vertexCount),o.setUniforms(f).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:i,changeFlags:r}=e,s=this.getAttributeManager();if(r.extensionsChanged||n.filled!==i.filled||n.extruded!==i.extruded){var a;(a=this.state.models)===null||a===void 0||a.forEach(c=>c.delete()),this.setState(this._getModels(this.context.gl)),s.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:s}=this.state,o=e.data.attributes||{};s.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:i,extruded:r}=this.props;let s,o;if(i){const a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1,s=new Nn(e,{...a,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(o=new Nn(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new pi({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,s].filter(Boolean),topModel:s,sideModel:o}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}T(Vf,"defaultProps",D9);T(Vf,"layerName","SolidPolygonLayer");function Gx({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:s=1/0}=n,o=t.length;let a=o,c=o;for(let v=0;v<o;v++){const w=e(t[v]);if(a>v&&w>=r&&(a=v),w>=s){c=v;break}}let f=a;const m=c-a!==i.length?t.slice(c):void 0;for(let v=0;v<i.length;v++)t[f++]=i[v];if(m){for(let v=0;v<m.length;v++)t[f++]=m[v];t.length=f}return{startRow:a,endRow:a+i.length}}const zx=[0,0,0,255],k9=[0,0,0,255],N9={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:k9},getLineColor:{type:"accessor",value:zx},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class Xa extends Rr{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&Re.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const i=this.state.paths.slice(),r=e.dataChanged.map(s=>Gx({data:i,getIndex:o=>o.__source.index,dataRange:s,replace:this._getPaths(s)}));this.setState({paths:i,pathsDiff:r})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:i,positionFormat:r,_normalize:s}=this.props,o=[],a=r==="XY"?2:3,{startRow:c,endRow:f}=e,{iterable:p,objectInfo:m}=ws(n,c,f);for(const v of p){m.index++;let w=i(v,m);s&&(w=Nx(w,a));const{holeIndices:C}=w,S=w.positions||w;if(C)for(let R=0;R<=C.length;R++){const x=S.slice(C[R-1]||0,C[R]||S.length);o.push(this.getSubLayerRow({path:x},v,m.index))}else o.push(this.getSubLayerRow({path:S},v,m.index))}return o}renderLayers(){const{data:e,_dataDiff:n,stroked:i,filled:r,extruded:s,wireframe:o,_normalize:a,_windingOrder:c,elevationScale:f,transitions:p,positionFormat:m}=this.props,{lineWidthUnits:v,lineWidthScale:w,lineWidthMinPixels:C,lineWidthMaxPixels:S,lineJointRounded:R,lineMiterLimit:x,lineDashJustified:P}=this.props,{getFillColor:I,getLineColor:F,getLineWidth:H,getLineDashArray:Q,getElevation:q,getPolygon:ee,updateTriggers:X,material:V}=this.props,{paths:D,pathsDiff:re}=this.state,Ae=this.getSubLayerClass("fill",Vf),ge=this.getSubLayerClass("stroke",cc),Be=this.shouldRenderSubLayer("fill",D)&&new Ae({_dataDiff:n,extruded:s,elevationScale:f,filled:r,wireframe:o,_normalize:a,_windingOrder:c,getElevation:q,getFillColor:I,getLineColor:s&&o?F:zx,material:V,transitions:p},this.getSubLayerProps({id:"fill",updateTriggers:X&&{getPolygon:X.getPolygon,getElevation:X.getElevation,getFillColor:X.getFillColor,lineColors:s&&o,getLineColor:X.getLineColor}}),{data:e,positionFormat:m,getPolygon:ee}),Ye=!s&&i&&this.shouldRenderSubLayer("stroke",D)&&new ge({_dataDiff:re&&(()=>re),widthUnits:v,widthScale:w,widthMinPixels:C,widthMaxPixels:S,jointRounded:R,miterLimit:x,dashJustified:P,_pathType:"loop",transitions:p&&{getWidth:p.getLineWidth,getColor:p.getLineColor,getPath:p.getPolygon},getColor:this.getSubLayerAccessor(F),getWidth:this.getSubLayerAccessor(H),getDashArray:this.getSubLayerAccessor(Q)},this.getSubLayerProps({id:"stroke",updateTriggers:X&&{getWidth:X.getLineWidth,getColor:X.getLineColor,getDashArray:X.getLineDashArray}}),{data:D,positionFormat:m,getPath:Qe=>Qe.path});return[!s&&Be,Ye,s&&Be]}}T(Xa,"layerName","PolygonLayer");T(Xa,"defaultProps",N9);function U9(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return n!==-1?G9(t,i,n):null}function G9(t,e,n){const i={properties:{...t.properties[e]}};for(const r in t.numericProps)i.properties[r]=t.numericProps[r].value[n];return i}function z9(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(r.length*3);const s=[];for(let o=0;o<r.length;o++)e(r[o],s),n[i][o*3+0]=s[0],n[i][o*3+1]=s[1],n[i][o*3+2]=s[2]}return n}const V9=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float buffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;

    // if enable sdf (signed distance fields)
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }

    // Take the global opacity and the alpha from color into account for the alpha component
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,hE=192/256,fE=[],H9={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class k1 extends Nf{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:V9}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:i,target:r})=>this.encodePickingColor(i,r)}})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;let{outlineColor:r}=n;r!==i.outlineColor&&(r=r.map(s=>s/255),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!n.sdf&&n.outlineWidth&&Re.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:i,outlineWidth:r}=this.props,{outlineColor:s}=this.state;e.uniforms={...e.uniforms,buffer:hE,outlineBuffer:r?Math.max(i,hE*(1-r)):-1,gamma:i,sdf:Boolean(n),outlineColor:s},super.draw(e)}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):fE}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):fE}}T(k1,"defaultProps",H9);T(k1,"layerName","MultiIconLayer");var N1={exports:{}};N1.exports=uc;N1.exports.default=uc;var ya=1e20;function uc(t,e,n,i,r,s){this.fontSize=t||24,this.buffer=e===void 0?3:e,this.cutoff=i||.25,this.fontFamily=r||"sans-serif",this.fontWeight=s||"normal",this.radius=n||8;var o=this.size=this.fontSize+this.buffer*2,a=o+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=o,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(o/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function j9(t,e,n,i,r,s,o){s.fill(ya,0,e*n),o.fill(0,0,e*n);for(var a=(e-i)/2,c=0;c<r;c++)for(var f=0;f<i;f++){var p=(c+a)*e+f+a,m=t.data[4*(c*i+f)+3]/255;if(m===1)s[p]=0,o[p]=ya;else if(m===0)s[p]=ya,o[p]=0;else{var v=Math.max(0,.5-m),w=Math.max(0,m-.5);s[p]=v*v,o[p]=w*w}}}function W9(t,e,n,i,r,s,o){for(var a=0;a<e*n;a++){var c=Math.sqrt(i[a])-Math.sqrt(r[a]);t[a]=Math.round(255-255*(c/s+o))}}uc.prototype._draw=function(t,e){var n=this.ctx.measureText(t),i=n.width,r=2*this.buffer,s,o,a,c,f,p,m,v;e&&this.useMetrics?(f=Math.floor(n.actualBoundingBoxAscent),v=this.buffer+Math.ceil(n.actualBoundingBoxAscent),p=this.buffer,m=this.buffer,o=Math.min(this.size,Math.ceil(n.actualBoundingBoxRight-n.actualBoundingBoxLeft)),c=Math.min(this.size-p,Math.ceil(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)),s=o+r,a=c+r,this.ctx.textBaseline="alphabetic"):(s=o=this.size,a=c=this.size,f=19*this.fontSize/24,p=m=0,v=this.middle,this.ctx.textBaseline="middle");var w;o&&c&&(this.ctx.clearRect(m,p,o,c),this.ctx.fillText(t,this.buffer,v),w=this.ctx.getImageData(m,p,o,c));var C=new Uint8ClampedArray(s*a);return j9(w,s,a,o,c,this.gridOuter,this.gridInner),dE(this.gridOuter,s,a,this.f,this.v,this.z),dE(this.gridInner,s,a,this.f,this.v,this.z),W9(C,s,a,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:C,metrics:{width:o,height:c,sdfWidth:s,sdfHeight:a,top:f,left:0,advance:i}}};uc.prototype.draw=function(t){return this._draw(t,!1).data};uc.prototype.drawWithMetrics=function(t){return this._draw(t,!0)};function dE(t,e,n,i,r,s){for(var o=0;o<e;o++)gE(t,o,e,n,i,r,s);for(var a=0;a<n;a++)gE(t,a*e,1,e,i,r,s)}function gE(t,e,n,i,r,s,o){var a,c,f,p;for(s[0]=0,o[0]=-ya,o[1]=ya,a=0;a<i;a++)r[a]=t[e+a*n];for(a=1,c=0,f=0;a<i;a++){do p=s[c],f=(r[a]-r[p]+a*a-p*p)/(a-p)/2;while(f<=o[c]&&--c>-1);c++,s[c]=a,o[c]=f,o[c+1]=ya}for(a=0,c=0;a<i;a++){for(;o[c+1]<a;)c++;p=s[c],t[e+a*n]=r[p]+(a-p)*(a-p)}}const Q9=32,X9=[];function J9(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Y9({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:s={},xOffset:o=0,yOffset:a=0}){let c=0,f=o;for(const m of t)if(!s[m]){const v=e(m);f+v+i*2>r&&(f=0,c++),s[m]={x:f+i,y:a+c*(n+i*2)+i,width:v,height:n},f+=v+i*2}const p=n+i*2;return{mapping:s,xOffset:f,yOffset:a+c*p,canvasHeight:J9(a+(c+1)*p)}}function Vx(t,e,n,i){let r=0;for(let o=e;o<n;o++){var s;const a=t[o];r+=((s=i[a])===null||s===void 0?void 0:s.width)||0}return r}function Hx(t,e,n,i,r,s){let o=e,a=0;for(let c=e;c<n;c++){const f=Vx(t,c,c+1,r);a+f>i&&(o<c&&s.push(c),o=c,a=0),a+=f}return a}function K9(t,e,n,i,r,s){let o=e,a=e,c=e,f=0;for(let p=e;p<n;p++)if((t[p]===" "||t[p+1]===" "||p+1===n)&&(c=p+1),c>a){let m=Vx(t,a,c,r);f+m>i&&(o<a&&(s.push(a),o=a,f=0),m>i&&(m=Hx(t,a,c,i,r,s),o=s[s.length-1])),a=c,f+=m}return f}function Z9(t,e,n,i,r=0,s){s===void 0&&(s=t.length);const o=[];return e==="break-all"?Hx(t,r,s,n,i,o):K9(t,r,s,n,i,o),o}function q9(t,e,n,i,r,s){let o=0,a=0;for(let c=e;c<n;c++){const f=t[c],p=i[f];p?(a||(a=p.height),r[c]=o+p.width/2,o+=p.width):(Re.warn("Missing character: ".concat(f," (").concat(f.codePointAt(0),")"))(),r[c]=o,o+=Q9)}s[0]=o,s[1]=a}function pE(t,e,n,i,r){const s=Array.from(t),o=s.length,a=new Array(o),c=new Array(o),f=new Array(o),p=(n==="break-word"||n==="break-all")&&isFinite(i)&&i>0,m=[0,0],v=[0,0];let w=0,C=0,S=0;for(let R=0;R<=o;R++){const x=s[R];if((x===`
`||R===o)&&(S=R),S>C){const P=p?Z9(s,n,i,r,C,S):X9;for(let I=0;I<=P.length;I++){const F=I===0?C:P[I-1],H=I<P.length?P[I]:S;q9(s,F,H,r,a,v);for(let Q=F;Q<H;Q++)c[Q]=w+v[1]/2,f[Q]=v[0];w=w+v[1]*e,m[0]=Math.max(m[0],v[0])}C=S}x===`
`&&(a[C]=0,c[C]=0,f[C]=0,C++)}return m[1]=w,{x:a,y:c,rowWidth:f,size:m}}function $9({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:s}){const o=t.BYTES_PER_ELEMENT,a=n?n/o:1,c=i?i/o:0,f=r[e]||Math.ceil((t.length-c)/a),p=s&&new Set,m=new Array(e);let v=t;if(a>1||c>0){const w=t.constructor;v=new w(f);for(let C=0;C<f;C++)v[C]=t[C*a+c]}for(let w=0;w<e;w++){const C=r[w],S=r[w+1]||f,R=v.subarray(C,S);m[w]=String.fromCodePoint.apply(null,R),p&&R.forEach(p.add,p)}if(p)for(const w of p)s.add(String.fromCodePoint(w));return{texts:m,characterCount:f}}class jx{constructor(e=5){T(this,"limit",void 0),T(this,"_cache",{}),T(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function eV(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const Al={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:eV(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},mE=1024,tV=.9,_E=1.2,Wx=3;let $h=new jx(Wx);function nV(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const i=$h.get(t);if(!i)return n;for(const r in i.mapping)n.has(r)&&n.delete(r);return n}function iV(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function yE(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function rV(t){Re.assert(Number.isFinite(t)&&t>=Wx,"Invalid cache limit"),$h=new jx(t)}class sV{constructor(){T(this,"props",{...Al}),T(this,"_key",void 0),T(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return _E}setProps(e={}){Object.assign(this.props,e);const n=this._key;this._key=this._getKey();const i=nV(this._key,this.props.characterSet),r=$h.get(this._key);if(r&&i.size===0){this._key!==n&&(this._atlas=r);return}const s=this._generateFontAtlas(this._key,i,r);this._atlas=s,$h.set(this._key,s)}_generateFontAtlas(e,n,i){const{fontFamily:r,fontWeight:s,fontSize:o,buffer:a,sdf:c,radius:f,cutoff:p}=this.props;let m=i&&i.data;m||(m=document.createElement("canvas"),m.width=mE);const v=m.getContext("2d");yE(v,r,o,s);const{mapping:w,canvasHeight:C,xOffset:S,yOffset:R}=Y9({getFontWidth:x=>v.measureText(x).width,fontHeight:o*_E,buffer:a,characterSet:n,maxCanvasWidth:mE,...i&&{mapping:i.mapping,xOffset:i.xOffset,yOffset:i.yOffset}});if(m.height!==C){const x=v.getImageData(0,0,m.width,m.height);m.height=C,v.putImageData(x,0,0)}if(yE(v,r,o,s),c){const x=new N1.exports(o,a,f,p,r,s),P=v.getImageData(0,0,x.size,x.size);for(const I of n)iV(x.draw(I),P),v.putImageData(P,w[I].x-a,w[I].y+a)}else for(const x of n)v.fillText(x,w[x].x,w[x].y+o*tV);return{xOffset:S,yOffset:R,mapping:w,data:m,width:m.width,height:m.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:i,buffer:r,sdf:s,radius:o,cutoff:a}=this.props;return s?"".concat(e," ").concat(n," ").concat(i," ").concat(r," ").concat(o," ").concat(a):"".concat(e," ").concat(n," ").concat(i," ").concat(r)}}const oV=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;

  // convert size in meters to pixels, then scaled and clamp

  // project meters to pixels and clamp to limits
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  // Apply opacity to instance color, or return instance picking color
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,aV=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,AV={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class U1 extends Un{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){return super.getShaders({vs:oV,fs:aV,modules:[ar,Ar]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var i;const{gl:r}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:i,sizeUnits:r,sizeMinPixels:s,sizeMaxPixels:o,getLineWidth:a}=this.props;let{padding:c}=this.props;c.length<4&&(c=[c[0],c[1],c[0],c[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:Boolean(a),padding:c,sizeUnits:Gi[r],sizeScale:i,sizeMinPixels:s,sizeMaxPixels:o}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Nn(e,{...this.getShaders(),id:this.props.id,geometry:new pi({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}T(U1,"defaultProps",AV);T(U1,"layerName","TextBackgroundLayer");const vE={start:1,middle:0,end:-1},EE={top:1,center:0,bottom:-1},b0=[0,0,0,255],lV=1,cV={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:b0},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Al.characterSet},fontFamily:Al.fontFamily,fontWeight:Al.fontWeight,lineHeight:lV,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:b0},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:b0},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class G1 extends Rr{constructor(...e){super(...e),T(this,"state",void 0),T(this,"getBoundingRect",(n,i)=>{const r=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:f,getAlignmentBaseline:p}=this.props,m=s(n,i)||"",{size:[v,w]}=pE(m,c,o,a,r),C=vE[typeof f=="function"?f(n,i):f],S=EE[typeof p=="function"?p(n,i):p];return[(C-1)*v/2,(S-1)*w/2,v,w]}),T(this,"getIconOffsets",(n,i)=>{const r=this.state.fontAtlasManager.mapping,s=this.state.getText,{wordBreak:o,maxWidth:a,lineHeight:c,getTextAnchor:f,getAlignmentBaseline:p}=this.props,m=s(n,i)||"",{x:v,y:w,rowWidth:C,size:[S,R]}=pE(m,c,o,a,r),x=vE[typeof f=="function"?f(n,i):f],P=EE[typeof p=="function"?p(n,i):p],I=v.length,F=new Array(I*2);let H=0;for(let Q=0;Q<I;Q++){const q=(1-x)*(S-C[Q])/2;F[H++]=(x-1)*S/2+q+v[Q],F[H++]=(P-1)*R/2+w[Q]}return F})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new sV}}updateState(e){const{props:n,oldProps:i,changeFlags:r}=e;(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==i.lineHeight||n.wordBreak!==i.wordBreak||n.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:i}=this.props,{fontAtlasManager:r,characterSet:s}=this.state,o={...e,characterSet:s,fontFamily:n,fontWeight:i};if(!r.mapping)return r.setProps(o),!0;for(const a in o)if(o[a]!==r.props[a])return r.setProps(o),!0;return!1}_updateText(){var e;const{data:n,characterSet:i}=this.props,r=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:s}=this.props,o=n.startIndices,a;const c=i==="auto"&&new Set;if(r&&o){const{texts:f,characterCount:p}=$9({...ArrayBuffer.isView(r)?{value:r}:r,length:n.length,startIndices:o,characterSet:c});a=p,s=(m,{index:v})=>f[v]}else{const{iterable:f,objectInfo:p}=ws(n);o=[0],a=0;for(const m of f){p.index++;const v=Array.from(s(m,p)||"");c&&v.forEach(c.add,c),a+=v.length,o.push(a)}}this.setState({getText:s,startIndices:o,numInstances:a,characterSet:c||i})}renderLayers(){const{startIndices:e,numInstances:n,getText:i,fontAtlasManager:{scale:r,texture:s,mapping:o},styleVersion:a}=this.state,{data:c,_dataDiff:f,getPosition:p,getColor:m,getSize:v,getAngle:w,getPixelOffset:C,getBackgroundColor:S,getBorderColor:R,getBorderWidth:x,backgroundPadding:P,background:I,billboard:F,fontSettings:H,outlineWidth:Q,outlineColor:q,sizeScale:ee,sizeUnits:X,sizeMinPixels:V,sizeMaxPixels:D,transitions:re,updateTriggers:Ae}=this.props,ge=this.getSubLayerClass("characters",k1),Be=this.getSubLayerClass("background",U1);return[I&&new Be({getFillColor:S,getLineColor:R,getLineWidth:x,padding:P,getPosition:p,getSize:v,getAngle:w,getPixelOffset:C,billboard:F,sizeScale:ee/this.state.fontAtlasManager.props.fontSize,sizeUnits:X,sizeMinPixels:V,sizeMaxPixels:D,transitions:re&&{getPosition:re.getPosition,getAngle:re.getAngle,getSize:re.getSize,getFillColor:re.getBackgroundColor,getLineColor:re.getBorderColor,getLineWidth:re.getBorderWidth,getPixelOffset:re.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Ae.getPosition,getAngle:Ae.getAngle,getSize:Ae.getSize,getFillColor:Ae.getBackgroundColor,getLineColor:Ae.getBorderColor,getLineWidth:Ae.getBorderWidth,getPixelOffset:Ae.getPixelOffset,getBoundingRect:{getText:Ae.getText,getTextAnchor:Ae.getTextAnchor,getAlignmentBaseline:Ae.getAlignmentBaseline,styleVersion:a}}}),{data:c.attributes&&c.attributes.background?{length:c.length,attributes:c.attributes.background}:c,_dataDiff:f,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new ge({sdf:H.sdf,smoothing:Number.isFinite(H.smoothing)?H.smoothing:Al.smoothing,outlineWidth:Q,outlineColor:q,iconAtlas:s,iconMapping:o,getPosition:p,getColor:m,getSize:v,getAngle:w,getPixelOffset:C,billboard:F,sizeScale:ee*r,sizeUnits:X,sizeMinPixels:V*r,sizeMaxPixels:D*r,transitions:re&&{getPosition:re.getPosition,getAngle:re.getAngle,getColor:re.getColor,getSize:re.getSize,getPixelOffset:re.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:Ae.getText,getPosition:Ae.getPosition,getAngle:Ae.getAngle,getColor:Ae.getColor,getSize:Ae.getSize,getPixelOffset:Ae.getPixelOffset,getIconOffsets:{getText:Ae.getText,getTextAnchor:Ae.getTextAnchor,getAlignmentBaseline:Ae.getAlignmentBaseline,styleVersion:a}}}),{data:c,_dataDiff:f,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){rV(e)}}T(G1,"defaultProps",cV);T(G1,"layerName","TextLayer");const oh={circle:{type:L1,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Nf,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:G1,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},ah={type:cc,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Op={type:Vf,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function MA({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function S0(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const s in e){const o=e[s];let a=t.props[s];s.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[o]=i[s],n&&(r.transitions[o]=n[s])),r[o]=a}return r}function uV(t){if(Array.isArray(t))return t;switch(Re.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Re.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function wE(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:s=t.length}=n;for(let o=r;o<s;o++){const a=t[o];Re.assert(a&&a.geometry,"GeoJSON does not have geometry");const{geometry:c}=a;if(c.type==="GeometryCollection"){Re.assert(Array.isArray(c.geometries),"GeoJSON does not have geometries array");const{geometries:f}=c;for(let p=0;p<f.length;p++){const m=f[p];TE(m,i,e,a,o)}}else TE(c,i,e,a,o)}return i}function TE(t,e,n,i,r){const{type:s,coordinates:o}=t,{pointFeatures:a,lineFeatures:c,polygonFeatures:f,polygonOutlineFeatures:p}=e;if(!fV(s,o)){Re.warn("".concat(s," coordinates are malformed"))();return}switch(s){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":o.forEach(m=>{a.push(n({geometry:{type:"Point",coordinates:m}},i,r))});break;case"LineString":c.push(n({geometry:t},i,r));break;case"MultiLineString":o.forEach(m=>{c.push(n({geometry:{type:"LineString",coordinates:m}},i,r))});break;case"Polygon":f.push(n({geometry:t},i,r)),o.forEach(m=>{p.push(n({geometry:{type:"LineString",coordinates:m}},i,r))});break;case"MultiPolygon":o.forEach(m=>{f.push(n({geometry:{type:"Polygon",coordinates:m}},i,r)),m.forEach(v=>{p.push(n({geometry:{type:"LineString",coordinates:v}},i,r))})});break}}const hV={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function fV(t,e){let n=hV[t];for(Re.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function Qx(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function wu(t){return t.geometry.coordinates}function dV(t,e){const n=Qx(),{pointFeatures:i,lineFeatures:r,polygonFeatures:s,polygonOutlineFeatures:o}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=wu,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=wu,n.polygons.data=s,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=wu,n.polygonsOutline.data=o,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=wu,n}function gV(t,e){const n=Qx(),{points:i,lines:r,polygons:s}=t,o=z9(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:o.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:o.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:s.polygonIndices.value.length-1,startIndices:s.polygonIndices.value,attributes:{...s.attributes,getPolygon:s.positions,pickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygons._normalize=!1,s.triangles&&(n.polygons.data.attributes.indices=s.triangles.value),n.polygonsOutline.data={length:s.primitivePolygonIndices.value.length-1,startIndices:s.primitivePolygonIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.polygons}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},n.polygonsOutline._pathType="open",n}const pV=["points","linestrings","polygons"],mV={...MA(oh.circle),...MA(oh.icon),...MA(oh.text),...MA(ah),...MA(Op),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class hc extends Rr{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:i}=this.props,r=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:r}),r?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const i=gV(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:n}){const i=uV(e.data),r=this.getSubLayerRow.bind(this);let s={};const o={};if(Array.isArray(n.dataChanged)){const c=this.state.features;for(const f in c)s[f]=c[f].slice(),o[f]=[];for(const f of n.dataChanged){const p=wE(i,r,f);for(const m in c)o[m].push(Gx({data:s[m],getIndex:v=>v.__source.index,dataRange:f,replace:p[m]}))}}else s=wE(i,r);const a=dV(s,o);this.setState({features:s,featuresDiff:o,layerProps:a})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:i,sourceLayer:r}=n;return n.featureType=pV.find(s=>r.id.startsWith("".concat(this.id,"-").concat(s,"-"))),i>=0&&r.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[i]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),i=e.featureType==="points";for(const r of this.getSubLayers())r.id.startsWith(n)===i&&r.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:i}=this.state,r="polygons-fill",s=this.shouldRenderSubLayer(r,i.polygons.data)&&this.getSubLayerClass(r,Op.type);if(s){const o=S0(this,Op.props),a=e&&n;return a||delete o.getLineColor,o.updateTriggers.lineColors=a,new s(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),i.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:i}=this.state,r="polygons-stroke",s="linestrings",o=!e&&n&&this.shouldRenderSubLayer(r,i.polygonsOutline.data)&&this.getSubLayerClass(r,ah.type),a=this.shouldRenderSubLayer(s,i.lines.data)&&this.getSubLayerClass(s,ah.type);if(o||a){const c=S0(this,ah.props);return[o&&new o(c,this.getSubLayerProps({id:r,updateTriggers:c.updateTriggers}),i.polygonsOutline),a&&new a(c,this.getSubLayerProps({id:s,updateTriggers:c.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:i}=this.state;let{highlightedObjectIndex:r}=this.props;!i&&Number.isFinite(r)&&(r=n.points.data.findIndex(a=>a.__source.index===r));const s=new Set(e.split("+")),o=[];for(const a of s){const c="points-".concat(a),f=oh[a],p=f&&this.shouldRenderSubLayer(c,n.points.data)&&this.getSubLayerClass(c,f.type);if(p){const m=S0(this,f.props);let v=n.points;if(a==="text"&&i){const{instancePickingColors:w,...C}=v.data.attributes;v={...v,data:{...v.data,attributes:C}}}o.push(new p(m,this.getSubLayerProps({id:c,updateTriggers:m.updateTriggers,highlightedObjectIndex:r}),v))}}return o}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),i=this._renderLineLayers(),r=this._renderPointLayers();return[!e&&n,i,r,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(i,r)=>{const{data:s,index:o}=r,a=U9(s,o);return e(a,r)}}}T(hc,"layerName","GeoJsonLayer");T(hc,"defaultProps",mV);const _V={getHeight:{type:"accessor",value:0},greatCircle:!0};class Xx extends I1{}T(Xx,"layerName","GreatCircleLayer");T(Xx,"defaultProps",_V);const yV={...Xa.defaultProps};class Ja extends Rr{indexToBounds(){return null}renderLayers(){const{elevationScale:e,extruded:n,wireframe:i,filled:r,stroked:s,lineWidthUnits:o,lineWidthScale:a,lineWidthMinPixels:c,lineWidthMaxPixels:f,lineJointRounded:p,lineMiterLimit:m,lineDashJustified:v,getElevation:w,getFillColor:C,getLineColor:S,getLineWidth:R}=this.props,{updateTriggers:x,material:P,transitions:I}=this.props,F=this.getSubLayerClass("cell",Xa);return new F({filled:r,wireframe:i,extruded:n,elevationScale:e,stroked:s,lineWidthUnits:o,lineWidthScale:a,lineWidthMinPixels:c,lineWidthMaxPixels:f,lineJointRounded:p,lineMiterLimit:m,lineDashJustified:v,material:P,transitions:I,getElevation:w,getFillColor:C,getLineColor:S,getLineWidth:R},this.getSubLayerProps({id:"cell",updateTriggers:x&&{getElevation:x.getElevation,getFillColor:x.getFillColor,getLineColor:x.getLineColor,getLineWidth:x.getLineWidth}}),this.indexToBounds())}}T(Ja,"layerName","GeoCellLayer");T(Ja,"defaultProps",yV);function vV(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Jx={exports:{}};(function(t){/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */(function(e,n){typeof vV=="function"&&!0&&t&&t.exports?t.exports=n():(e.dcodeIO=e.dcodeIO||{}).Long=n()})(MM,function(){function e(V,D,re){this.low=V|0,this.high=D|0,this.unsigned=!!re}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function n(V){return(V&&V.__isLong__)===!0}e.isLong=n;var i={},r={};function s(V,D){var re,Ae,ge;return D?(V>>>=0,(ge=0<=V&&V<256)&&(Ae=r[V],Ae)?Ae:(re=a(V,(V|0)<0?-1:0,!0),ge&&(r[V]=re),re)):(V|=0,(ge=-128<=V&&V<128)&&(Ae=i[V],Ae)?Ae:(re=a(V,V<0?-1:0,!1),ge&&(i[V]=re),re))}e.fromInt=s;function o(V,D){if(isNaN(V)||!isFinite(V))return D?P:x;if(D){if(V<0)return P;if(V>=C)return q}else{if(V<=-S)return ee;if(V+1>=S)return Q}return V<0?o(-V,D).neg():a(V%w|0,V/w|0,D)}e.fromNumber=o;function a(V,D,re){return new e(V,D,re)}e.fromBits=a;var c=Math.pow;function f(V,D,re){if(V.length===0)throw Error("empty string");if(V==="NaN"||V==="Infinity"||V==="+Infinity"||V==="-Infinity")return x;if(typeof D=="number"?(re=D,D=!1):D=!!D,re=re||10,re<2||36<re)throw RangeError("radix");var Ae;if((Ae=V.indexOf("-"))>0)throw Error("interior hyphen");if(Ae===0)return f(V.substring(1),D,re).neg();for(var ge=o(c(re,8)),Be=x,Ye=0;Ye<V.length;Ye+=8){var Qe=Math.min(8,V.length-Ye),oe=parseInt(V.substring(Ye,Ye+Qe),re);if(Qe<8){var ve=o(c(re,Qe));Be=Be.mul(ve).add(o(oe))}else Be=Be.mul(ge),Be=Be.add(o(oe))}return Be.unsigned=D,Be}e.fromString=f;function p(V){return V instanceof e?V:typeof V=="number"?o(V):typeof V=="string"?f(V):a(V.low,V.high,V.unsigned)}e.fromValue=p;var m=1<<16,v=1<<24,w=m*m,C=w*w,S=C/2,R=s(v),x=s(0);e.ZERO=x;var P=s(0,!0);e.UZERO=P;var I=s(1);e.ONE=I;var F=s(1,!0);e.UONE=F;var H=s(-1);e.NEG_ONE=H;var Q=a(-1,2147483647,!1);e.MAX_VALUE=Q;var q=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=q;var ee=a(0,-2147483648,!1);e.MIN_VALUE=ee;var X=e.prototype;return X.toInt=function(){return this.unsigned?this.low>>>0:this.low},X.toNumber=function(){return this.unsigned?(this.high>>>0)*w+(this.low>>>0):this.high*w+(this.low>>>0)},X.toString=function(D){if(D=D||10,D<2||36<D)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ee)){var re=o(D),Ae=this.div(re),ge=Ae.mul(re).sub(this);return Ae.toString(D)+ge.toInt().toString(D)}else return"-"+this.neg().toString(D);for(var Be=o(c(D,6),this.unsigned),Ye=this,Qe="";;){var oe=Ye.div(Be),ve=Ye.sub(oe.mul(Be)).toInt()>>>0,xe=ve.toString(D);if(Ye=oe,Ye.isZero())return xe+Qe;for(;xe.length<6;)xe="0"+xe;Qe=""+xe+Qe}},X.getHighBits=function(){return this.high},X.getHighBitsUnsigned=function(){return this.high>>>0},X.getLowBits=function(){return this.low},X.getLowBitsUnsigned=function(){return this.low>>>0},X.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ee)?64:this.neg().getNumBitsAbs();for(var D=this.high!=0?this.high:this.low,re=31;re>0&&(D&1<<re)==0;re--);return this.high!=0?re+33:re+1},X.isZero=function(){return this.high===0&&this.low===0},X.isNegative=function(){return!this.unsigned&&this.high<0},X.isPositive=function(){return this.unsigned||this.high>=0},X.isOdd=function(){return(this.low&1)===1},X.isEven=function(){return(this.low&1)===0},X.equals=function(D){return n(D)||(D=p(D)),this.unsigned!==D.unsigned&&this.high>>>31===1&&D.high>>>31===1?!1:this.high===D.high&&this.low===D.low},X.eq=X.equals,X.notEquals=function(D){return!this.eq(D)},X.neq=X.notEquals,X.lessThan=function(D){return this.comp(D)<0},X.lt=X.lessThan,X.lessThanOrEqual=function(D){return this.comp(D)<=0},X.lte=X.lessThanOrEqual,X.greaterThan=function(D){return this.comp(D)>0},X.gt=X.greaterThan,X.greaterThanOrEqual=function(D){return this.comp(D)>=0},X.gte=X.greaterThanOrEqual,X.compare=function(D){if(n(D)||(D=p(D)),this.eq(D))return 0;var re=this.isNegative(),Ae=D.isNegative();return re&&!Ae?-1:!re&&Ae?1:this.unsigned?D.high>>>0>this.high>>>0||D.high===this.high&&D.low>>>0>this.low>>>0?-1:1:this.sub(D).isNegative()?-1:1},X.comp=X.compare,X.negate=function(){return!this.unsigned&&this.eq(ee)?ee:this.not().add(I)},X.neg=X.negate,X.add=function(D){n(D)||(D=p(D));var re=this.high>>>16,Ae=this.high&65535,ge=this.low>>>16,Be=this.low&65535,Ye=D.high>>>16,Qe=D.high&65535,oe=D.low>>>16,ve=D.low&65535,xe=0,Le=0,ke=0,Wt=0;return Wt+=Be+ve,ke+=Wt>>>16,Wt&=65535,ke+=ge+oe,Le+=ke>>>16,ke&=65535,Le+=Ae+Qe,xe+=Le>>>16,Le&=65535,xe+=re+Ye,xe&=65535,a(ke<<16|Wt,xe<<16|Le,this.unsigned)},X.subtract=function(D){return n(D)||(D=p(D)),this.add(D.neg())},X.sub=X.subtract,X.multiply=function(D){if(this.isZero()||(n(D)||(D=p(D)),D.isZero()))return x;if(this.eq(ee))return D.isOdd()?ee:x;if(D.eq(ee))return this.isOdd()?ee:x;if(this.isNegative())return D.isNegative()?this.neg().mul(D.neg()):this.neg().mul(D).neg();if(D.isNegative())return this.mul(D.neg()).neg();if(this.lt(R)&&D.lt(R))return o(this.toNumber()*D.toNumber(),this.unsigned);var re=this.high>>>16,Ae=this.high&65535,ge=this.low>>>16,Be=this.low&65535,Ye=D.high>>>16,Qe=D.high&65535,oe=D.low>>>16,ve=D.low&65535,xe=0,Le=0,ke=0,Wt=0;return Wt+=Be*ve,ke+=Wt>>>16,Wt&=65535,ke+=ge*ve,Le+=ke>>>16,ke&=65535,ke+=Be*oe,Le+=ke>>>16,ke&=65535,Le+=Ae*ve,xe+=Le>>>16,Le&=65535,Le+=ge*oe,xe+=Le>>>16,Le&=65535,Le+=Be*Qe,xe+=Le>>>16,Le&=65535,xe+=re*ve+Ae*oe+ge*Qe+Be*Ye,xe&=65535,a(ke<<16|Wt,xe<<16|Le,this.unsigned)},X.mul=X.multiply,X.divide=function(D){if(n(D)||(D=p(D)),D.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?P:x;var re,Ae,ge;if(this.unsigned){if(D.unsigned||(D=D.toUnsigned()),D.gt(this))return P;if(D.gt(this.shru(1)))return F;ge=P}else{if(this.eq(ee)){if(D.eq(I)||D.eq(H))return ee;if(D.eq(ee))return I;var Be=this.shr(1);return re=Be.div(D).shl(1),re.eq(x)?D.isNegative()?I:H:(Ae=this.sub(D.mul(re)),ge=re.add(Ae.div(D)),ge)}else if(D.eq(ee))return this.unsigned?P:x;if(this.isNegative())return D.isNegative()?this.neg().div(D.neg()):this.neg().div(D).neg();if(D.isNegative())return this.div(D.neg()).neg();ge=x}for(Ae=this;Ae.gte(D);){re=Math.max(1,Math.floor(Ae.toNumber()/D.toNumber()));for(var Ye=Math.ceil(Math.log(re)/Math.LN2),Qe=Ye<=48?1:c(2,Ye-48),oe=o(re),ve=oe.mul(D);ve.isNegative()||ve.gt(Ae);)re-=Qe,oe=o(re,this.unsigned),ve=oe.mul(D);oe.isZero()&&(oe=I),ge=ge.add(oe),Ae=Ae.sub(ve)}return ge},X.div=X.divide,X.modulo=function(D){return n(D)||(D=p(D)),this.sub(this.div(D).mul(D))},X.mod=X.modulo,X.not=function(){return a(~this.low,~this.high,this.unsigned)},X.and=function(D){return n(D)||(D=p(D)),a(this.low&D.low,this.high&D.high,this.unsigned)},X.or=function(D){return n(D)||(D=p(D)),a(this.low|D.low,this.high|D.high,this.unsigned)},X.xor=function(D){return n(D)||(D=p(D)),a(this.low^D.low,this.high^D.high,this.unsigned)},X.shiftLeft=function(D){return n(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?a(this.low<<D,this.high<<D|this.low>>>32-D,this.unsigned):a(0,this.low<<D-32,this.unsigned)},X.shl=X.shiftLeft,X.shiftRight=function(D){return n(D)&&(D=D.toInt()),(D&=63)===0?this:D<32?a(this.low>>>D|this.high<<32-D,this.high>>D,this.unsigned):a(this.high>>D-32,this.high>=0?0:-1,this.unsigned)},X.shr=X.shiftRight,X.shiftRightUnsigned=function(D){if(n(D)&&(D=D.toInt()),D&=63,D===0)return this;var re=this.high;if(D<32){var Ae=this.low;return a(Ae>>>D|re<<32-D,re>>>D,this.unsigned)}else return D===32?a(re,0,this.unsigned):a(re>>>D-32,0,this.unsigned)},X.shru=X.shiftRightUnsigned,X.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},X.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},X.toBytes=function(V){return V?this.toBytesLE():this.toBytesBE()},X.toBytesLE=function(){var V=this.high,D=this.low;return[D&255,D>>>8&255,D>>>16&255,D>>>24&255,V&255,V>>>8&255,V>>>16&255,V>>>24&255]},X.toBytesBE=function(){var V=this.high,D=this.low;return[V>>>24&255,V>>>16&255,V>>>8&255,V&255,D>>>24&255,D>>>16&255,D>>>8&255,D&255]},e})})(Jx);const Ah=Jx.exports,EV=3,wV=30,TV=2*wV+1,CE=180/Math.PI;function CV(t,e,n){const i=1<<e;return[(t[0]+n[0])/i,(t[1]+n[1])/i]}function bE(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function bV(t){return[bE(t[0]),bE(t[1])]}function SV(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function xV([t,e,n]){const i=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*CE,i*CE]}function PV(t){let e=Ah.fromString(t,!0,10).toString(2);for(;e.length<EV+TV;)e="0"+e;const n=e.lastIndexOf("1"),i=e.substring(0,3),r=e.substring(3,n),s=r.length/2,o=Ah.fromString(i,!0,2).toString(10);let a=Ah.fromString(r,!0,2).toString(4);for(;a.length<s;)a="0"+a;return"".concat(o,"/").concat(a)}function MV(t,e,n,i){if(i===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const r=e[0];e[0]=e[1],e[1]=r}}function IV(t){const e=t.split("/"),n=parseInt(e[0],10),i=e[1],r=i.length,s=[0,0];let o;for(let a=r-1;a>=0;a--){o=r-a;const c=i[a];let f=0,p=0;c==="1"?p=1:c==="2"?(f=1,p=1):c==="3"&&(f=1);const m=Math.pow(2,o-1);MV(m,s,f,p),s[0]+=m*f,s[1]+=m*p}if(n%2===1){const a=s[0];s[0]=s[1],s[1]=a}return{face:n,ij:s,level:o}}function BV(t){const e=t.padEnd(16,"0");return Ah.fromString(e,16)}const LV=100;function RV({face:t,ij:e,level:n}){const i=[[0,0],[0,1],[1,1],[1,0],[0,0]],r=Math.max(1,Math.ceil(LV*Math.pow(2,-n))),s=new Float64Array(4*r*2+2);let o=0,a=0;for(let c=0;c<4;c++){const f=i[c].slice(0),p=i[c+1],m=(p[0]-f[0])/r,v=(p[1]-f[1])/r;for(let w=0;w<r;w++){f[0]+=m,f[1]+=v;const C=CV(e,n,f),S=bV(C),R=SV(t,S),x=xV(R);Math.abs(x[1])>89.999&&(x[0]=a);const P=x[0]-a;x[0]+=P>180?-360:P<-180?360:0,s[o++]=x[0],s[o++]=x[1],a=x[0]}}return s[o++]=s[0],s[o++]=s[1],s}function OV(t){if(typeof t=="string"){if(t.indexOf("/")>0)return t;t=BV(t)}return PV(t.toString())}function FV(t){const e=OV(t),n=IV(e);return RV(n)}const DV={getS2Token:{type:"accessor",value:t=>t.token}};class Yx extends Ja{indexToBounds(){const{data:e,getS2Token:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(i,r)=>FV(n(i,r))}}}T(Yx,"layerName","S2Layer");T(Yx,"defaultProps",DV);const x0=512;function kV(t){let e=0,n=0,i=1<<t.length;const r=i/x0;for(let s=0;s<t.length;s++){i>>=1;const o=parseInt(t[s]);o%2&&(e|=i),o>1&&(n|=i)}return[[e/r,x0-n/r],[(e+.99)/r,x0-(n+.99)/r]]}function NV(t){const[e,n]=kV(t),[i,r]=ms(e),[s,o]=ms(n);return[s,r,s,o,i,o,i,r,s,r]}const UV={getQuadkey:{type:"accessor",value:t=>t.quadkey}};class Kx extends Ja{indexToBounds(){const{data:e,getQuadkey:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(i,r)=>NV(n(i,r))}}}T(Kx,"layerName","QuadkeyLayer");T(Kx,"defaultProps",UV);class GV{constructor(e){T(this,"index",void 0),T(this,"isVisible",void 0),T(this,"isSelected",void 0),T(this,"parent",void 0),T(this,"children",void 0),T(this,"content",void 0),T(this,"state",void 0),T(this,"layers",void 0),T(this,"id",void 0),T(this,"bbox",void 0),T(this,"zoom",void 0),T(this,"userData",void 0),T(this,"_abortController",void 0),T(this,"_loader",void 0),T(this,"_loaderId",void 0),T(this,"_isLoaded",void 0),T(this,"_isCancelled",void 0),T(this,"_needsReload",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||Re.error("byteLength not defined in tile data")(),e}async _loadData({getData:e,requestScheduler:n,onLoad:i,onError:r}){const{index:s,id:o,bbox:a,userData:c,zoom:f}=this,p=this._loaderId;this._abortController=new AbortController;const{signal:m}=this._abortController,v=await n.scheduleRequest(this,S=>S.isSelected?1:-1);if(!v){this._isCancelled=!0;return}if(this._isCancelled){v.done();return}let w=null,C;try{w=await e({index:s,id:o,bbox:a,userData:c,zoom:f,signal:m})}catch(S){C=S||!0}finally{v.done()}if(p===this._loaderId){if(this._loader=void 0,this.content=w,this._isCancelled&&!w){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,C?r(C,this):i(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const gn={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},SE=new K,zV=new K;class z1{constructor(e=[0,0,0],n=[0,0,0],i){T(this,"center",void 0),T(this,"halfDiagonal",void 0),T(this,"minimum",void 0),T(this,"maximum",void 0),i=i||SE.copy(e).add(n).scale(.5),this.center=new K(i),this.halfDiagonal=new K(n).subtract(this.center),this.minimum=new K(e),this.maximum=new K(n)}clone(){return new z1(this.minimum,this.maximum,this.center)}equals(e){return this===e||Boolean(e)&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,i=zV.from(e.normal),r=n.x*Math.abs(i.x)+n.y*Math.abs(i.y)+n.z*Math.abs(i.z),s=this.center.dot(i)+e.distance;return s-r>0?gn.INSIDE:s+r<0?gn.OUTSIDE:gn.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=SE.from(e).subtract(this.center),{halfDiagonal:i}=this;let r=0,s;return s=Math.abs(n.x)-i.x,s>0&&(r+=s*s),s=Math.abs(n.y)-i.y,s>0&&(r+=s*s),s=Math.abs(n.z)-i.z,s>0&&(r+=s*s),r}}const IA=new K,xE=new K;class fc{constructor(e=[0,0,0],n=0){T(this,"center",void 0),T(this,"radius",void 0),this.radius=-0,this.center=new K,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=IA.from(n),this.center=new K().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new fc(this.center,this.radius)}union(e){const n=this.center,i=this.radius,r=e.center,s=e.radius,o=IA.copy(r).subtract(n),a=o.magnitude();if(i>=a+s)return this.clone();if(s>=a+i)return e.clone();const c=(i+a+s)*.5;return xE.copy(o).scale((-i+c)/a).add(n),this.center.copy(xE),this.radius=c,this}expand(e){const i=IA.from(e).subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(e){this.center.transform(e);const n=_N(IA,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const i=IA.from(e).subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(e){const n=this.center,i=this.radius,s=e.normal.dot(n)+e.distance;return s<-i?gn.OUTSIDE:s<i?gn.INTERSECTING:gn.INSIDE}}const VV=new K,HV=new K,Tu=new K,Cu=new K,bu=new K,jV=new K,WV=new K,fr={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class dc{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){T(this,"center",void 0),T(this,"halfAxes",void 0),this.center=new K().from(e),this.halfAxes=new Zt(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new K(e).len(),new K(n).len(),new K(i).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),r=new K(e).normalize(),s=new K(n).normalize(),o=new K(i).normalize();return new Il().fromMatrix3(new Zt([...r,...s,...o]))}fromCenterHalfSizeQuaternion(e,n,i){const r=new Il(i),s=new Zt().fromQuaternion(r);return s[0]=s[0]*n[0],s[1]=s[1]*n[0],s[2]=s[2]*n[0],s[3]=s[3]*n[1],s[4]=s[4]*n[1],s[5]=s[5]*n[1],s[6]=s[6]*n[2],s[7]=s[7]*n[2],s[8]=s[8]*n[2],this.center=new K().from(e),this.halfAxes=s,this}clone(){return new dc(this.center,this.halfAxes)}equals(e){return this===e||Boolean(e)&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new fc){const n=this.halfAxes,i=n.getColumn(0,Tu),r=n.getColumn(1,Cu),s=n.getColumn(2,bu),o=VV.copy(i).add(r).add(s);return e.center.copy(this.center),e.radius=o.magnitude(),e}intersectPlane(e){const n=this.center,i=e.normal,r=this.halfAxes,s=i.x,o=i.y,a=i.z,c=Math.abs(s*r[fr.COLUMN0ROW0]+o*r[fr.COLUMN0ROW1]+a*r[fr.COLUMN0ROW2])+Math.abs(s*r[fr.COLUMN1ROW0]+o*r[fr.COLUMN1ROW1]+a*r[fr.COLUMN1ROW2])+Math.abs(s*r[fr.COLUMN2ROW0]+o*r[fr.COLUMN2ROW1]+a*r[fr.COLUMN2ROW2]),f=i.dot(n)+e.distance;return f<=-c?gn.OUTSIDE:f>=c?gn.INSIDE:gn.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=HV.from(e).subtract(this.center),i=this.halfAxes,r=i.getColumn(0,Tu),s=i.getColumn(1,Cu),o=i.getColumn(2,bu),a=r.magnitude(),c=s.magnitude(),f=o.magnitude();r.normalize(),s.normalize(),o.normalize();let p=0,m;return m=Math.abs(n.dot(r))-a,m>0&&(p+=m*m),m=Math.abs(n.dot(s))-c,m>0&&(p+=m*m),m=Math.abs(n.dot(o))-f,m>0&&(p+=m*m),p}computePlaneDistances(e,n,i=[-0,-0]){let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;const o=this.center,a=this.halfAxes,c=a.getColumn(0,Tu),f=a.getColumn(1,Cu),p=a.getColumn(2,bu),m=jV.copy(c).add(f).add(p).add(o),v=WV.copy(m).subtract(e);let w=n.dot(v);return r=Math.min(w,r),s=Math.max(w,s),m.copy(o).add(c).add(f).subtract(p),v.copy(m).subtract(e),w=n.dot(v),r=Math.min(w,r),s=Math.max(w,s),m.copy(o).add(c).subtract(f).add(p),v.copy(m).subtract(e),w=n.dot(v),r=Math.min(w,r),s=Math.max(w,s),m.copy(o).add(c).subtract(f).subtract(p),v.copy(m).subtract(e),w=n.dot(v),r=Math.min(w,r),s=Math.max(w,s),o.copy(m).subtract(c).add(f).add(p),v.copy(m).subtract(e),w=n.dot(v),r=Math.min(w,r),s=Math.max(w,s),o.copy(m).subtract(c).add(f).subtract(p),v.copy(m).subtract(e),w=n.dot(v),r=Math.min(w,r),s=Math.max(w,s),o.copy(m).subtract(c).subtract(f).add(p),v.copy(m).subtract(e),w=n.dot(v),r=Math.min(w,r),s=Math.max(w,s),o.copy(m).subtract(c).subtract(f).subtract(p),v.copy(m).subtract(e),w=n.dot(v),r=Math.min(w,r),s=Math.max(w,s),i[0]=r,i[1]=s,i}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,Tu);n.transformAsPoint(e);const i=this.halfAxes.getColumn(1,Cu);i.transformAsPoint(e);const r=this.halfAxes.getColumn(2,bu);return r.transformAsPoint(e),this.halfAxes=new Zt([...n,...i,...r]),this}getTransform(){throw new Error("not implemented")}}const PE=new K,ME=new K;class hi{constructor(e=[0,0,1],n=0){T(this,"normal",void 0),T(this,"distance",void 0),this.normal=new K,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return Bi(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=PE.from(e),this.normal.from(n).normalize();const i=-this.normal.dot(e);return this.distance=i,this}fromCoefficients(e,n,i,r){return this.normal.set(e,n,i),Bi(_n(this.normal.len(),1)),this.distance=r,this}clone(){return new hi(this.normal,this.distance)}equals(e){return _n(this.distance,e.distance)&&_n(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=ME.copy(this.normal).transformAsVector(e).normalize(),i=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(i,n)}projectPointOntoPlane(e,n=[0,0,0]){e=PE.from(e);const i=this.getPointDistance(e),r=ME.copy(this.normal).scale(i);return e.subtract(r).to(n)}}const IE=[new K([1,0,0]),new K([0,1,0]),new K([0,0,1])],BE=new K,QV=new K;new hi(new K(1,0,0),0);class Zn{constructor(e=[]){T(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*IE.length;const n=e.center,i=e.radius;let r=0;for(const s of IE){let o=this.planes[r],a=this.planes[r+1];o||(o=this.planes[r]=new hi),a||(a=this.planes[r+1]=new hi);const c=BE.copy(s).scale(-i).add(n);-s.dot(c),o.fromPointNormal(c,s);const f=BE.copy(s).scale(i).add(n),p=QV.copy(s).negate();-p.dot(f),a.fromPointNormal(f,p),r+=2}return this}computeVisibility(e){let n=gn.INSIDE;for(const i of this.planes)switch(e.intersectPlane(i)){case gn.OUTSIDE:return gn.OUTSIDE;case gn.INTERSECTING:n=gn.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(Bi(Number.isFinite(n),"parentPlaneMask is required."),n===Zn.MASK_OUTSIDE||n===Zn.MASK_INSIDE)return n;let i=Zn.MASK_INSIDE;const r=this.planes;for(let s=0;s<this.planes.length;++s){const o=s<31?1<<s:0;if(s<31&&(n&o)===0)continue;const a=r[s],c=e.intersectPlane(a);if(c===gn.OUTSIDE)return Zn.MASK_OUTSIDE;c===gn.INTERSECTING&&(i|=o)}return i}}T(Zn,"MASK_OUTSIDE",4294967295);T(Zn,"MASK_INSIDE",0);T(Zn,"MASK_INDETERMINATE",2147483647);new K;new K;new K;new K;new K;new K;new K;new K;new K;new K;new K;new K;new K;new K;new K;new K;new K;const Ji=new Zt,XV=new Zt,JV=new Zt,Su=new Zt,LE=new Zt;function YV(t,e={}){const n=Bl.EPSILON20,i=10;let r=0,s=0;const o=XV,a=JV;o.identity(),a.copy(t);const c=n*KV(a);for(;s<i&&ZV(a)>c;)qV(a,Su),LE.copy(Su).transpose(),a.multiplyRight(Su),a.multiplyLeft(LE),o.multiplyRight(Su),++r>2&&(++s,r=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=a.toTarget(e.diagonal),e}function KV(t){let e=0;for(let n=0;n<9;++n){const i=t[n];e+=i*i}return Math.sqrt(e)}const Fp=[1,0,0],Dp=[2,2,1];function ZV(t){let e=0;for(let n=0;n<3;++n){const i=t[Ji.getElementIndex(Dp[n],Fp[n])];e+=2*i*i}return Math.sqrt(e)}function qV(t,e){const n=Bl.EPSILON15;let i=0,r=1;for(let f=0;f<3;++f){const p=Math.abs(t[Ji.getElementIndex(Dp[f],Fp[f])]);p>i&&(r=f,i=p)}const s=Fp[r],o=Dp[r];let a=1,c=0;if(Math.abs(t[Ji.getElementIndex(o,s)])>n){const f=t[Ji.getElementIndex(o,o)],p=t[Ji.getElementIndex(s,s)],m=t[Ji.getElementIndex(o,s)],v=(f-p)/2/m;let w;v<0?w=-1/(-v+Math.sqrt(1+v*v)):w=1/(v+Math.sqrt(1+v*v)),a=1/Math.sqrt(1+w*w),c=w*a}return Zt.IDENTITY.to(e),e[Ji.getElementIndex(s,s)]=e[Ji.getElementIndex(o,o)]=a,e[Ji.getElementIndex(o,s)]=c,e[Ji.getElementIndex(s,o)]=-c,e}const Xr=new K,$V=new K,eH=new K,tH=new K,nH=new K,iH=new Zt,rH={diagonal:new Zt,unitary:new Zt};function sH(t,e=new dc){if(!t||t.length===0)return e.halfAxes=new Zt([0,0,0,0,0,0,0,0,0]),e.center=new K,e;const n=t.length,i=new K(0,0,0);for(const X of t)i.add(X);const r=1/n;i.multiplyByScalar(r);let s=0,o=0,a=0,c=0,f=0,p=0;for(const X of t){const V=Xr.copy(X).subtract(i);s+=V.x*V.x,o+=V.x*V.y,a+=V.x*V.z,c+=V.y*V.y,f+=V.y*V.z,p+=V.z*V.z}s*=r,o*=r,a*=r,c*=r,f*=r,p*=r;const m=iH;m[0]=s,m[1]=o,m[2]=a,m[3]=o,m[4]=c,m[5]=f,m[6]=a,m[7]=f,m[8]=p;const{unitary:v}=YV(m,rH),w=e.halfAxes.copy(v);let C=w.getColumn(0,eH),S=w.getColumn(1,tH),R=w.getColumn(2,nH),x=-Number.MAX_VALUE,P=-Number.MAX_VALUE,I=-Number.MAX_VALUE,F=Number.MAX_VALUE,H=Number.MAX_VALUE,Q=Number.MAX_VALUE;for(const X of t)Xr.copy(X),x=Math.max(Xr.dot(C),x),P=Math.max(Xr.dot(S),P),I=Math.max(Xr.dot(R),I),F=Math.min(Xr.dot(C),F),H=Math.min(Xr.dot(S),H),Q=Math.min(Xr.dot(R),Q);C=C.multiplyByScalar(.5*(F+x)),S=S.multiplyByScalar(.5*(H+P)),R=R.multiplyByScalar(.5*(Q+I)),e.center.copy(C).add(S).add(R);const q=$V.set(x-F,P-H,I-Q).multiplyByScalar(.5),ee=new Zt([q[0],0,0,0,q[1],0,0,0,q[2]]);return e.halfAxes.multiplyRight(ee),e}const oa=512,RE=3,Zx=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],qx=Zx.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),oH=qx.concat([[.25,.5],[.75,.5]]);class aa{constructor(e,n,i){T(this,"x",void 0),T(this,"y",void 0),T(this,"z",void 0),T(this,"childVisible",void 0),T(this,"selected",void 0),T(this,"_children",void 0),this.x=e,this.y=n,this.z=i}get children(){if(!this._children){const e=this.x*2,n=this.y*2,i=this.z+1;this._children=[new aa(e,n,i),new aa(e,n+1,i),new aa(e+1,n,i),new aa(e+1,n+1,i)]}return this._children}update(e){const{viewport:n,cullingVolume:i,elevationBounds:r,minZ:s,maxZ:o,bounds:a,offset:c,project:f}=e,p=this.getBoundingVolume(r,c,f);if(a&&!this.insideBounds(a)||i.computeVisibility(p)<0)return!1;if(!this.childVisible){let{z:v}=this;if(v<o&&v>=s){const w=p.distanceTo(n.cameraPosition)*n.scale/n.height;v+=Math.floor(Math.log2(w))}if(v>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const v of this.children)v.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,i,r]){const s=Math.pow(2,this.z),o=oa/s;return this.x*o<i&&this.y*o<r&&(this.x+1)*o>e&&(this.y+1)*o>n}getBoundingVolume(e,n,i){if(i){const c=this.z<1?oH:this.z<2?qx:Zx,f=[];for(const p of c){const m=Np(this.x+p[0],this.y+p[1],this.z);m[2]=e[0],f.push(i(m)),e[0]!==e[1]&&(m[2]=e[1],f.push(i(m)))}return sH(f)}const r=Math.pow(2,this.z),s=oa/r,o=this.x*s+n*oa,a=oa-(this.y+1)*s;return new z1([o,a,e[0]],[o+s,a+s,e[1]])}}function aH(t,e,n,i){const r=t instanceof mx&&t.resolution?t.projectPosition:null,s=Object.values(t.getFrustumPlanes()).map(({normal:w,distance:C})=>new hi(w.clone().negate(),C)),o=new Zn(s),a=t.distanceScales.unitsPerMeter[2],c=n&&n[0]*a||0,f=n&&n[1]*a||0,p=t instanceof sr&&t.pitch<=60?e:0;if(i){const[w,C,S,R]=i,x=Fa([w,R]),P=Fa([S,C]);i=[x[0],oa-x[1],P[0],oa-P[1]]}const m=new aa(0,0,0),v={viewport:t,project:r,cullingVolume:o,elevationBounds:[c,f],minZ:p,maxZ:e,bounds:i,offset:0};if(m.update(v),t instanceof sr&&t.subViewports&&t.subViewports.length>1){for(v.offset=-1;m.update(v)&&!(--v.offset<-RE););for(v.offset=1;m.update(v)&&!(++v.offset>RE););}return m.getSelected()}const Mr=512,AH=[-1/0,-1/0,1/0,1/0],kp={type:"url",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equals:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}};function $x(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(r=>r[0])),Math.min(...n.map(r=>r[1])),Math.max(...n.map(r=>r[0])),Math.max(...n.map(r=>r[1]))]}function lH(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function ef(t,e){if(!t||!t.length)return null;const{index:n,id:i}=e;if(Array.isArray(t)){const s=lH(i)%t.length;t=t[s]}let r=t;for(const s of Object.keys(n)){const o=new RegExp("{".concat(s,"}"),"g");r=r.replace(o,String(n[s]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(r=r.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),r}function cH(t,e,n){let i;if(e&&e.length===2){const[r,s]=e,o=t.getBounds({z:r}),a=t.getBounds({z:s});i=[Math.min(o[0],a[0]),Math.min(o[1],a[1]),Math.max(o[2],a[2]),Math.max(o[3],a[3])]}else i=t.getBounds();return t.isGeospatial?[Math.max(i[0],n[0]),Math.max(i[1],n[1]),Math.min(i[2],n[2]),Math.min(i[3],n[3])]:[Math.max(Math.min(i[0],n[2]),n[0]),Math.max(Math.min(i[1],n[3]),n[1]),Math.min(Math.max(i[2],n[0]),n[2]),Math.min(Math.max(i[3],n[1]),n[3])]}function tf({viewport:t,z:e,cullRect:n}){const i=n.x-t.x,r=n.y-t.y,{width:s,height:o}=n;if(!Array.isArray(e)){const f={targetZ:e||0},p=t.unproject([i,r],f),m=t.unproject([i+s,r],f),v=t.unproject([i,r+o],f),w=t.unproject([i+s,r+o],f);return[Math.min(p[0],m[0],v[0],w[0]),Math.min(p[1],m[1],v[1],w[1]),Math.max(p[0],m[0],v[0],w[0]),Math.max(p[1],m[1],v[1],w[1])]}const a=tf({viewport:t,z:e[0],cullRect:n}),c=tf({viewport:t,z:e[1],cullRect:n});return[Math.min(a[0],c[0]),Math.min(a[1],c[1]),Math.max(a[2],c[2]),Math.max(a[3],c[3])]}function uH(t,e,n){return n?$x(t,n).map(r=>r*e/Mr):t.map(i=>i*e/Mr)}function V1(t,e){return Math.pow(2,t)*Mr/e}function Np(t,e,n){const i=V1(n,Mr),r=t/i*360-180,s=Math.PI-2*Math.PI*e/i,o=180/Math.PI*Math.atan(.5*(Math.exp(s)-Math.exp(-s)));return[r,o]}function OE(t,e,n,i){const r=V1(n,i);return[t/r*Mr,e/r*Mr]}function hH(t,e,n,i,r=Mr){if(t.isGeospatial){const[f,p]=Np(e,n,i),[m,v]=Np(e+1,n+1,i);return{west:f,north:p,east:m,south:v}}const[s,o]=OE(e,n,i,r),[a,c]=OE(e+1,n+1,i,r);return{left:s,top:o,right:a,bottom:c}}function fH(t,e,n,i,r){const s=cH(t,null,i),o=V1(e,n),[a,c,f,p]=uH(s,o,r),m=[];for(let v=Math.floor(a);v<f;v++)for(let w=Math.floor(c);w<p;w++)m.push({x:v,y:w,z:e});return m}function dH({viewport:t,maxZoom:e,minZoom:n,zRange:i,extent:r,tileSize:s=Mr,modelMatrix:o,modelMatrixInverse:a,zoomOffset:c=0}){let f=t.isGeospatial?Math.round(t.zoom+Math.log2(Mr/s))+c:Math.ceil(t.zoom)+c;if(typeof n=="number"&&Number.isFinite(n)&&f<n){if(!r)return[];f=n}typeof e=="number"&&Number.isFinite(e)&&f>e&&(f=e);let p=r;return o&&a&&r&&!t.isGeospatial&&(p=$x(r,o)),t.isGeospatial?aH(t,f,i,r):fH(t,f,s,p||AH,a)}function gH(t){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t)}function pH(t){return Number.isFinite(t.west)&&Number.isFinite(t.north)&&Number.isFinite(t.east)&&Number.isFinite(t.south)}const FE=1,Hf=2,mH="never",_H="no-overlap",H1="best-available",yH=5,vH={[H1]:wH,[_H]:TH,[mH]:()=>{}};class EH{constructor(e){T(this,"opts",void 0),T(this,"_requestScheduler",void 0),T(this,"_cache",void 0),T(this,"_dirty",void 0),T(this,"_tiles",void 0),T(this,"_cacheByteSize",void 0),T(this,"_viewport",void 0),T(this,"_zRange",void 0),T(this,"_selectedTiles",void 0),T(this,"_frameNumber",void 0),T(this,"_modelMatrix",void 0),T(this,"_modelMatrixInverse",void 0),T(this,"_maxZoom",void 0),T(this,"_minZoom",void 0),T(this,"onTileLoad",void 0),T(this,"_getCullBounds",oc(tf)),this.opts=e,this.onTileLoad=n=>{this.opts.onTileLoad(n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new mb({maxRequests:e.maxRequests,throttleRequests:e.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new De,this._modelMatrixInverse=new De,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:i}={}){const r=new De(i),s=!r.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!_n(this._zRange,n)||s){s&&(this._modelMatrixInverse=r.clone().invert(),this._modelMatrix=r),this._viewport=e,this._zRange=n;const a=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(c=>this._getTile(c,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const[i,r,s,o]=tf({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:a}=e;if("west"in a)return a.west<s&&a.east>i&&a.south<o&&a.north>r;const c=Math.min(a.top,a.bottom),f=Math.max(a.top,a.bottom);return a.left<s&&a.right>i&&c<o&&f>r}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:i,zRange:r,modelMatrix:s,modelMatrixInverse:o}){const{tileSize:a,extent:c,zoomOffset:f}=this.opts;return dH({viewport:e,maxZoom:n,minZoom:i,zRange:r,tileSize:a,extent:c,modelMatrix:s,modelMatrixInverse:o,zoomOffset:f})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:hH(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),i=Math.floor(e.y/2),r=e.z-1;return{x:n,y:i,z:r}}updateTileStates(){const e=this.opts.refinementStrategy||H1,n=new Array(this._cache.size);let i=0;for(const r of this._cache.values())n[i++]=r.isVisible,r.isSelected=!1,r.isVisible=!1;for(const r of this._selectedTiles)r.isSelected=!0,r.isVisible=!0;(typeof e=="function"?e:vH[e])(Array.from(this._cache.values())),i=0;for(const r of this._cache.values())if(n[i++]!==r.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e}=this.opts,n=[];let i=0;for(const r of this._cache.values())r.isLoading&&(i++,!r.isSelected&&!r.isVisible&&n.push(r));for(;e>0&&i>e&&n.length>0;)n.shift().abort(),i--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const i=this._getNearestAncestor(n);n.parent=i,i!=null&&i.children&&i.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,i=n.maxCacheSize||(n.maxCacheByteSize?1/0:yH*this.selectedTiles.length),r=n.maxCacheByteSize||1/0;if(e.size>i||this._cacheByteSize>r){for(const[o,a]of e)if(a.isVisible||(this._cacheByteSize-=n.maxCacheByteSize?a.byteLength:0,e.delete(o),this.opts.onTileUnload(a)),e.size<=i&&this._cacheByteSize<=r)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((o,a)=>o.zoom-a.zoom),this._dirty=!1)}_getTile(e,n){const i=this.getTileId(e);let r=this._cache.get(i),s=!1;return!r&&n?(r=new GV(e),Object.assign(r,this.getTileMetadata(r.index)),Object.assign(r,{id:i,zoom:this.getTileZoom(r.index)}),s=!0,this._cache.set(i,r),this._dirty=!0):r&&r.needsReload&&(s=!0),r&&s&&r.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),r}_getNearestAncestor(e){const{_minZoom:n=0}=this;let i=e.index;for(;this.getTileZoom(i)>n;){i=this.getParentIndex(i);const r=this._getTile(i);if(r)return r}return null}}function wH(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!e3(e)&&j1(e);for(const e of t)e.isVisible=Boolean(e.state&Hf)}function TH(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&e3(n);const e=Array.from(t).sort((n,i)=>n.zoom-i.zoom);for(const n of e)if(n.isVisible=Boolean(n.state&Hf),n.children&&(n.isVisible||n.state&FE))for(const i of n.children)i.state=FE;else n.isSelected&&j1(n)}function e3(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=Hf,!0;e=e.parent}return!1}function j1(t){for(const e of t.children)e.isLoaded||e.content?e.state|=Hf:j1(e)}const CH={TilesetClass:EH,data:{type:"data",value:[]},dataComparator:kp.equals,renderSubLayers:{type:"function",value:t=>new hc(t),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:t=>console.error(t),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:H1,zRange:null,maxRequests:6,zoomOffset:0};class gc extends Rr{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0?void 0:n.selectedTiles.every(i=>i.isLoaded&&i.layers&&i.layers.every(r=>r.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const i=e.propsOrDataChanged||e.updateTriggersChanged,r=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?i&&(n.setOptions(this._getTilesetOptions()),r?n.reloadAll():this.state.tileset.tiles.forEach(s=>{s.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:i,refinementStrategy:r,extent:s,maxZoom:o,minZoom:a,maxRequests:c,zoomOffset:f}=this.props;return{maxCacheSize:n,maxCacheByteSize:i,maxZoom:o,minZoom:a,tileSize:e,refinementStrategy:r,extent:s,maxRequests:c,zoomOffset:f,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:i}=this.props,r=e.update(this.context.viewport,{zRange:n,modelMatrix:i}),{isLoaded:s}=e,o=this.state.isLoaded!==s,a=this.state.frameNumber!==r;s&&(o||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:r}),this.state.isLoaded=s}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:i,fetch:r}=this.props,{signal:s}=e;return e.url=typeof n=="string"||Array.isArray(n)?ef(n,e):null,i?i(e):r&&e.url?r(e.url,{propName:"data",layer:this,signal:s}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){return e.tile=n.props.tile,e}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(i=>e.layers[0].props[i]!==n[i])&&(e.layers=e.layers.map(i=>i.clone(n)));else{const i=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(e.id),data:e.content,_offset:0,tile:e});e.layers=Of(i,Boolean).map(r=>r.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:i}=e.props;return this.state.tileset.isTileVisible(i,n)}}T(gc,"defaultProps",CH);T(gc,"layerName","TileLayer");const bH={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}};class W1 extends cc{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:n,trailLength:i,currentTime:r}=this.props;e.uniforms={...e.uniforms,fadeTrail:n,trailLength:i,currentTime:r},super.draw(e)}}T(W1,"layerName","TripsLayer");T(W1,"defaultProps",bH);var bt=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},i;for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var r="";function s(Y){return e.locateFile?e.locateFile(Y,r):r+Y}var o;document.currentScript&&(r=document.currentScript.src),r.indexOf("blob:")!==0?r=r.substr(0,r.lastIndexOf("/")+1):r="",o=function(ie,fe,Ie){var u=new XMLHttpRequest;u.open("GET",ie,!0),u.responseType="arraybuffer",u.onload=function(){if(u.status==200||u.status==0&&u.response){fe(u.response);return}var Ze=tA(ie);if(Ze){fe(Ze.buffer);return}Ie()},u.onerror=Ie,u.send(null)};var a=e.print||console.log.bind(console),c=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments;var f=0,p=function(Y){f=Y},m=function(){return f},v=8;function w(Y,ie,fe,Ie){switch(fe=fe||"i8",fe.charAt(fe.length-1)==="*"&&(fe="i32"),fe){case"i1":re[Y>>0]=ie;break;case"i8":re[Y>>0]=ie;break;case"i16":ge[Y>>1]=ie;break;case"i32":Be[Y>>2]=ie;break;case"i64":qa=[ie>>>0,(Fr=ie,+bs(Fr)>=1?Fr>0?(si(+xs(Fr/4294967296),4294967295)|0)>>>0:~~+Ss((Fr-+(~~Fr>>>0))/4294967296)>>>0:0)],Be[Y>>2]=qa[0],Be[Y+4>>2]=qa[1];break;case"float":Ye[Y>>2]=ie;break;case"double":Qe[Y>>3]=ie;break;default:zi("invalid type for setValue: "+fe)}}function C(Y,ie,fe){switch(ie=ie||"i8",ie.charAt(ie.length-1)==="*"&&(ie="i32"),ie){case"i1":return re[Y>>0];case"i8":return re[Y>>0];case"i16":return ge[Y>>1];case"i32":return Be[Y>>2];case"i64":return Be[Y>>2];case"float":return Ye[Y>>2];case"double":return Qe[Y>>3];default:zi("invalid type for getValue: "+ie)}return null}var S=!1;function R(Y,ie){Y||zi("Assertion failed: "+ie)}function x(Y){var ie=e["_"+Y];return R(ie,"Cannot call unknown function "+Y+", make sure it is exported"),ie}function P(Y,ie,fe,Ie,u){var N={string:function(Ot){var Vi=0;if(Ot!=null&&Ot!==0){var Eo=(Ot.length<<2)+1;Vi=Tc(Eo),ee(Ot,Vi,Eo)}return Vi},array:function(Ot){var Vi=Tc(Ot.length);return X(Ot,Vi),Vi}};function Ze(Ot){return ie==="string"?Q(Ot):ie==="boolean"?Boolean(Ot):Ot}var et=x(Y),Ve=[],je=0;if(Ie)for(var _t=0;_t<Ie.length;_t++){var qe=N[fe[_t]];qe?(je===0&&(je=Cc()),Ve[_t]=qe(Ie[_t])):Ve[_t]=Ie[_t]}var Je=et.apply(null,Ve);return Je=Ze(Je),je!==0&&td(je),Je}function I(Y,ie,fe,Ie){fe=fe||[];var u=fe.every(function(Ze){return Ze==="number"}),N=ie!=="string";return N&&u&&!Ie?x(Y):function(){return P(Y,ie,fe,arguments)}}var F=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function H(Y,ie,fe){for(var Ie=ie+fe,u=ie;Y[u]&&!(u>=Ie);)++u;if(u-ie>16&&Y.subarray&&F)return F.decode(Y.subarray(ie,u));for(var N="";ie<u;){var Ze=Y[ie++];if(!(Ze&128)){N+=String.fromCharCode(Ze);continue}var et=Y[ie++]&63;if((Ze&224)==192){N+=String.fromCharCode((Ze&31)<<6|et);continue}var Ve=Y[ie++]&63;if((Ze&240)==224?Ze=(Ze&15)<<12|et<<6|Ve:Ze=(Ze&7)<<18|et<<12|Ve<<6|Y[ie++]&63,Ze<65536)N+=String.fromCharCode(Ze);else{var je=Ze-65536;N+=String.fromCharCode(55296|je>>10,56320|je&1023)}}return N}function Q(Y,ie){return Y?H(Ae,Y,ie):""}function q(Y,ie,fe,Ie){if(!(Ie>0))return 0;for(var u=fe,N=fe+Ie-1,Ze=0;Ze<Y.length;++Ze){var et=Y.charCodeAt(Ze);if(et>=55296&&et<=57343){var Ve=Y.charCodeAt(++Ze);et=65536+((et&1023)<<10)|Ve&1023}if(et<=127){if(fe>=N)break;ie[fe++]=et}else if(et<=2047){if(fe+1>=N)break;ie[fe++]=192|et>>6,ie[fe++]=128|et&63}else if(et<=65535){if(fe+2>=N)break;ie[fe++]=224|et>>12,ie[fe++]=128|et>>6&63,ie[fe++]=128|et&63}else{if(fe+3>=N)break;ie[fe++]=240|et>>18,ie[fe++]=128|et>>12&63,ie[fe++]=128|et>>6&63,ie[fe++]=128|et&63}}return ie[fe]=0,fe-u}function ee(Y,ie,fe){return q(Y,Ae,ie,fe)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function X(Y,ie){re.set(Y,ie)}function V(Y,ie){return Y%ie>0&&(Y+=ie-Y%ie),Y}var D,re,Ae,ge,Be,Ye,Qe;function oe(Y){D=Y,e.HEAP8=re=new Int8Array(Y),e.HEAP16=ge=new Int16Array(Y),e.HEAP32=Be=new Int32Array(Y),e.HEAPU8=Ae=new Uint8Array(Y),e.HEAPU16=new Uint16Array(Y),e.HEAPU32=new Uint32Array(Y),e.HEAPF32=Ye=new Float32Array(Y),e.HEAPF64=Qe=new Float64Array(Y)}var ve=5266928,xe=24016,Le=e.TOTAL_MEMORY||33554432;e.buffer?D=e.buffer:D=new ArrayBuffer(Le),Le=D.byteLength,oe(D),Be[xe>>2]=ve;function ke(Y){for(;Y.length>0;){var ie=Y.shift();if(typeof ie=="function"){ie();continue}var fe=ie.func;typeof fe=="number"?ie.arg===void 0?e.dynCall_v(fe):e.dynCall_vi(fe,ie.arg):fe(ie.arg===void 0?null:ie.arg)}}var Wt=[],Gn=[],Ts=[],ri=[];function Bt(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)go(e.preRun.shift());ke(Wt)}function cr(){ke(Gn)}function Lt(){ke(Ts)}function ln(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)Cs(e.postRun.shift());ke(ri)}function go(Y){Wt.unshift(Y)}function Cs(Y){ri.unshift(Y)}var bs=Math.abs,Ss=Math.ceil,xs=Math.floor,si=Math.min,En=0,Or=null;function pc(Y){En++,e.monitorRunDependencies&&e.monitorRunDependencies(En)}function po(Y){if(En--,e.monitorRunDependencies&&e.monitorRunDependencies(En),En==0&&Or){var ie=Or;Or=null,ie()}}e.preloadedImages={},e.preloadedAudios={};var Rt=null,Za="data:application/octet-stream;base64,";function mc(Y){return String.prototype.startsWith?Y.startsWith(Za):Y.indexOf(Za)===0}var Fr,qa;Rt="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Jf=24032;function _c(Y){return Y}function $a(Y){var ie=/\b__Z[\w\d_]+/g;return Y.replace(ie,function(fe){var Ie=fe;return fe===Ie?fe:Ie+" ["+fe+"]"})}function eA(){var Y=new Error;if(!Y.stack){try{throw new Error(0)}catch(ie){Y=ie}if(!Y.stack)return"(no stack trace available)"}return Y.stack.toString()}function yc(){var Y=eA();return e.extraStackTrace&&(Y+=`
`+e.extraStackTrace()),$a(Y)}function mo(Y,ie,fe,Ie){zi("Assertion failed: "+Q(Y)+", at: "+[ie?Q(ie):"unknown filename",fe,Ie?Q(Ie):"unknown function"])}function _o(){return re.length}function Yf(Y,ie,fe){Ae.set(Ae.subarray(ie,ie+fe),Y)}function Kf(Y){return e.___errno_location&&(Be[e.___errno_location()>>2]=Y),Y}function Zf(Y){zi("OOM")}function vc(Y){try{var ie=new ArrayBuffer(Y);return ie.byteLength!=Y?void 0:(new Int8Array(ie).set(re),ed(ie),oe(ie),1)}catch{}}function qf(Y){var ie=_o(),fe=16777216,Ie=2147483648-fe;if(Y>Ie)return!1;for(var u=16777216,N=Math.max(ie,u);N<Y;)N<=536870912?N=V(2*N,fe):N=Math.min(V((3*N+2147483648)/4,fe),Ie);var Ze=vc(N);return!!Ze}var yo=typeof atob=="function"?atob:function(Y){var ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",fe="",Ie,u,N,Ze,et,Ve,je,_t=0;Y=Y.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Ze=ie.indexOf(Y.charAt(_t++)),et=ie.indexOf(Y.charAt(_t++)),Ve=ie.indexOf(Y.charAt(_t++)),je=ie.indexOf(Y.charAt(_t++)),Ie=Ze<<2|et>>4,u=(et&15)<<4|Ve>>2,N=(Ve&3)<<6|je,fe=fe+String.fromCharCode(Ie),Ve!==64&&(fe=fe+String.fromCharCode(u)),je!==64&&(fe=fe+String.fromCharCode(N));while(_t<Y.length);return fe};function $f(Y){try{for(var ie=yo(Y),fe=new Uint8Array(ie.length),Ie=0;Ie<ie.length;++Ie)fe[Ie]=ie.charCodeAt(Ie);return fe}catch{throw new Error("Converting base64 string to bytes failed.")}}function tA(Y){if(!!mc(Y))return $f(Y.slice(Za.length))}var Ec={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},wc={a:zi,b:p,c:m,d:mo,e:Kf,f:_o,g:Yf,h:qf,i:Zf,j:_c,k:$a,l:vc,m:eA,n:yc,o:Jf,p:xe},he=function(Y,ie,fe){var Ie=new Y.Int8Array(fe),u=new Y.Int32Array(fe);new Y.Uint8Array(fe),new Y.Float32Array(fe);var N=new Y.Float64Array(fe),Ze=ie.p|0,et=Y.Math.floor,Ve=Y.Math.abs,je=Y.Math.sqrt,_t=Y.Math.pow,qe=Y.Math.cos,Je=Y.Math.sin,Ot=Y.Math.tan,Vi=Y.Math.acos,Eo=Y.Math.asin,Dr=Y.Math.atan,yt=Y.Math.atan2,vi=Y.Math.ceil,$t=Y.Math.imul,Ei=Y.Math.min,zn=Y.Math.clz32,Pe=ie.b,z=ie.c,tt=ie.d,rA=ie.e,wo=ie.f,Vn=ie.g,To=ie.h,sA=ie.i,k=24048;function oA(A){return Ie=new Int8Array(A),u=new Int32Array(A),N=new Float64Array(A),fe=A,!0}function aA(A){A=A|0;var l=0;return l=k,k=k+A|0,k=k+15&-16,l|0}function Co(){return k|0}function wi(A){A=A|0,k=A}function nd(A,l){A=A|0,k=A}function xc(A){return A=A|0,($t(A*3|0,A+1|0)|0)+1|0}function bo(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0;!(AA(A,l,h,d,0)|0)||(y=($t(h*3|0,h+1|0)|0)+1|0,Ci(d|0,0,y<<3|0)|0,g=Ti(y,4)|0,g&&(oi(A,l,h,d,g,y,0),Ge(g)))}function Pc(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0;if(!!(AA(A,l,h,d,g)|0)){if(y=($t(h*3|0,h+1|0)|0)+1|0,Ci(d|0,0,y<<3|0)|0,g|0){Ci(g|0,0,y<<2|0)|0,oi(A,l,h,d,g,y,0);return}g=Ti(y,4)|0,g&&(oi(A,l,h,d,g,y,0),Ge(g))}}function AA(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0;if(J=k,k=k+16|0,j=J,y=d,u[y>>2]=A,u[y+4>>2]=l,y=(g|0)!=0,y&&(u[g>>2]=0),Xt(A,l)|0)return j=1,k=J,j|0;u[j>>2]=0;e:do if((h|0)>=1)if(y)for(M=0,B=1,U=1,_=0,y=A;;){if(!(_|M)){if(y=L(y,l,4,j)|0,l=z()|0,(y|0)==0&(l|0)==0){y=2;break e}if(Xt(y,l)|0){y=1;break e}}if(y=L(y,l,u[16+(M<<2)>>2]|0,j)|0,l=z()|0,(y|0)==0&(l|0)==0){y=2;break e}if(A=d+(U<<3)|0,u[A>>2]=y,u[A+4>>2]=l,u[g+(U<<2)>>2]=B,_=_+1|0,A=(_|0)==(B|0),E=M+1|0,b=(E|0)==6,Xt(y,l)|0){y=1;break e}if(B=B+(b&A&1)|0,(B|0)>(h|0)){y=0;break}else M=A?b?0:E:M,U=U+1|0,_=A?0:_}else for(M=0,B=1,U=1,_=0,y=A;;){if(!(_|M)){if(y=L(y,l,4,j)|0,l=z()|0,(y|0)==0&(l|0)==0){y=2;break e}if(Xt(y,l)|0){y=1;break e}}if(y=L(y,l,u[16+(M<<2)>>2]|0,j)|0,l=z()|0,(y|0)==0&(l|0)==0){y=2;break e}if(A=d+(U<<3)|0,u[A>>2]=y,u[A+4>>2]=l,_=_+1|0,A=(_|0)==(B|0),E=M+1|0,b=(E|0)==6,Xt(y,l)|0){y=1;break e}if(B=B+(b&A&1)|0,(B|0)>(h|0)){y=0;break}else M=A?b?0:E:M,U=U+1|0,_=A?0:_}else y=0;while(0);return j=y,k=J,j|0}function oi(A,l,h,d,g,y,_){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0,y=y|0,_=_|0;var E=0,b=0,M=0,B=0,U=0,j=0,J=0;if(U=k,k=k+16|0,B=U,(A|0)==0&(l|0)==0){k=U;return}if(E=Ur(A|0,l|0,y|0,((y|0)<0)<<31>>31|0)|0,z()|0,b=d+(E<<3)|0,j=b,J=u[j>>2]|0,j=u[j+4>>2]|0,M=(J|0)==(A|0)&(j|0)==(l|0),!((J|0)==0&(j|0)==0|M))do E=(E+1|0)%(y|0)|0,b=d+(E<<3)|0,J=b,j=u[J>>2]|0,J=u[J+4>>2]|0,M=(j|0)==(A|0)&(J|0)==(l|0);while(!((j|0)==0&(J|0)==0|M));if(E=g+(E<<2)|0,M&&(u[E>>2]|0)<=(_|0)){k=U;return}if(J=b,u[J>>2]=A,u[J+4>>2]=l,u[E>>2]=_,(_|0)>=(h|0)){k=U;return}J=_+1|0,u[B>>2]=0,j=L(A,l,2,B)|0,oi(j,z()|0,h,d,g,y,J),u[B>>2]=0,j=L(A,l,3,B)|0,oi(j,z()|0,h,d,g,y,J),u[B>>2]=0,j=L(A,l,1,B)|0,oi(j,z()|0,h,d,g,y,J),u[B>>2]=0,j=L(A,l,5,B)|0,oi(j,z()|0,h,d,g,y,J),u[B>>2]=0,j=L(A,l,4,B)|0,oi(j,z()|0,h,d,g,y,J),u[B>>2]=0,j=L(A,l,6,B)|0,oi(j,z()|0,h,d,g,y,J),k=U}function L(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0;if((u[d>>2]|0)>0){g=0;do h=Bs(h)|0,g=g+1|0;while((g|0)<(u[d>>2]|0))}E=ce(A|0,l|0,45)|0,z()|0,b=E&127,y=Mn(A,l)|0,g=ce(A|0,l|0,52)|0,z()|0,g=g&15;e:do if(!g)_=6;else for(;;){if(U=(15-g|0)*3|0,j=ce(A|0,l|0,U|0)|0,z()|0,j=j&7,J=(ai(g)|0)==0,g=g+-1|0,B=_e(7,0,U|0)|0,l=l&~(z()|0),U=_e(u[(J?464:48)+(j*28|0)+(h<<2)>>2]|0,0,U|0)|0,M=z()|0,h=u[(J?672:256)+(j*28|0)+(h<<2)>>2]|0,A=U|A&~B,l=M|l,!h){h=0;break e}if(!g){_=6;break}}while(0);(_|0)==6&&(J=u[880+(b*28|0)+(h<<2)>>2]|0,j=_e(J|0,0,45)|0,A=j|A,l=z()|0|l&-1040385,h=u[4304+(b*28|0)+(h<<2)>>2]|0,(J&127|0)==127&&(J=_e(u[880+(b*28|0)+20>>2]|0,0,45)|0,l=z()|0|l&-1040385,h=u[4304+(b*28|0)+20>>2]|0,A=Nr(J|A,l)|0,l=z()|0,u[d>>2]=(u[d>>2]|0)+1)),_=ce(A|0,l|0,45)|0,z()|0,_=_&127;e:do if(Ue(_)|0){t:do if((Mn(A,l)|0)==1){if((b|0)!=(_|0))if(u_(_,u[7728+(b*28|0)>>2]|0)|0){A=ud(A,l)|0,y=1,l=z()|0;break}else{A=Nr(A,l)|0,y=1,l=z()|0;break}switch(y|0){case 5:{A=ud(A,l)|0,l=z()|0,u[d>>2]=(u[d>>2]|0)+5,y=0;break t}case 3:{A=Nr(A,l)|0,l=z()|0,u[d>>2]=(u[d>>2]|0)+1,y=0;break t}default:return j=0,J=0,Pe(j|0),J|0}}else y=0;while(0);if((h|0)>0){g=0;do A=cd(A,l)|0,l=z()|0,g=g+1|0;while((g|0)!=(h|0))}if((b|0)!=(_|0)){if(!(Qt(_)|0)){if((y|0)!=0|(Mn(A,l)|0)!=5)break;u[d>>2]=(u[d>>2]|0)+1;break}switch(E&127){case 8:case 118:break e}(Mn(A,l)|0)!=3&&(u[d>>2]=(u[d>>2]|0)+1)}}else if((h|0)>0){g=0;do A=Nr(A,l)|0,l=z()|0,g=g+1|0;while((g|0)!=(h|0))}while(0);return u[d>>2]=((u[d>>2]|0)+h|0)%6|0,j=l,J=A,Pe(j|0),J|0}function O(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0;if(U=k,k=k+16|0,B=U,!h)return B=d,u[B>>2]=A,u[B+4>>2]=l,B=0,k=U,B|0;u[B>>2]=0;e:do if(Xt(A,l)|0)A=1;else{if(y=(h|0)>0,y){g=0,M=A;do{if(M=L(M,l,4,B)|0,l=z()|0,(M|0)==0&(l|0)==0){A=2;break e}if(g=g+1|0,Xt(M,l)|0){A=1;break e}}while((g|0)<(h|0));if(b=d,u[b>>2]=M,u[b+4>>2]=l,b=h+-1|0,y){y=0,_=1,g=M,A=l;do{if(g=L(g,A,2,B)|0,A=z()|0,(g|0)==0&(A|0)==0){A=2;break e}if(E=d+(_<<3)|0,u[E>>2]=g,u[E+4>>2]=A,_=_+1|0,Xt(g,A)|0){A=1;break e}y=y+1|0}while((y|0)<(h|0));E=0,y=_;do{if(g=L(g,A,3,B)|0,A=z()|0,(g|0)==0&(A|0)==0){A=2;break e}if(_=d+(y<<3)|0,u[_>>2]=g,u[_+4>>2]=A,y=y+1|0,Xt(g,A)|0){A=1;break e}E=E+1|0}while((E|0)<(h|0));_=0;do{if(g=L(g,A,1,B)|0,A=z()|0,(g|0)==0&(A|0)==0){A=2;break e}if(E=d+(y<<3)|0,u[E>>2]=g,u[E+4>>2]=A,y=y+1|0,Xt(g,A)|0){A=1;break e}_=_+1|0}while((_|0)<(h|0));_=0;do{if(g=L(g,A,5,B)|0,A=z()|0,(g|0)==0&(A|0)==0){A=2;break e}if(E=d+(y<<3)|0,u[E>>2]=g,u[E+4>>2]=A,y=y+1|0,Xt(g,A)|0){A=1;break e}_=_+1|0}while((_|0)<(h|0));_=0;do{if(g=L(g,A,4,B)|0,A=z()|0,(g|0)==0&(A|0)==0){A=2;break e}if(E=d+(y<<3)|0,u[E>>2]=g,u[E+4>>2]=A,y=y+1|0,Xt(g,A)|0){A=1;break e}_=_+1|0}while((_|0)<(h|0));for(_=0;;){if(g=L(g,A,6,B)|0,A=z()|0,(g|0)==0&(A|0)==0){A=2;break e}if((_|0)!=(b|0))if(E=d+(y<<3)|0,u[E>>2]=g,u[E+4>>2]=A,!(Xt(g,A)|0))y=y+1|0;else{A=1;break e}if(_=_+1|0,(_|0)>=(h|0)){_=M,y=l;break}}}else _=M,g=M,y=l,A=l}else _=d,u[_>>2]=A,u[_+4>>2]=l,_=A,g=A,y=l,A=l;A=((_|0)!=(g|0)|(y|0)!=(A|0))&1}while(0);return B=A,k=U,B|0}function G(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0;if(y=k,k=k+48|0,g=y+8|0,d=y,E=A,_=u[E+4>>2]|0,h=d,u[h>>2]=u[E>>2],u[h+4>>2]=_,dd(d,g),g=sd(g,l)|0,l=u[d>>2]|0,d=u[A+8>>2]|0,(d|0)<=0)return E=l,_=(g|0)<(E|0),E=_?E:g,E=E+12|0,k=y,E|0;h=u[A+12>>2]|0,A=0;do l=(u[h+(A<<3)>>2]|0)+l|0,A=A+1|0;while((A|0)<(d|0));return E=(g|0)<(l|0),E=E?l:g,E=E+12|0,k=y,E|0}function Z(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0;if(E=k,k=k+48|0,d=E+8|0,g=E,!(se(A,l,h)|0)){k=E;return}if(b=A,y=u[b+4>>2]|0,_=g,u[_>>2]=u[b>>2],u[_+4>>2]=y,dd(g,d),_=sd(d,l)|0,l=u[g>>2]|0,y=u[A+8>>2]|0,(y|0)>0){g=u[A+12>>2]|0,d=0;do l=(u[g+(d<<3)>>2]|0)+l|0,d=d+1|0;while((d|0)!=(y|0))}if(l=(_|0)<(l|0)?l:_,(l|0)<=-12){k=E;return}b=l+11|0,Ci(h|0,0,(((b|0)>0?b:0)<<3)+8|0)|0,k=E}function se(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0,Ce=0,de=0,me=0,Ne=0,At=0,st=0,ht=0,nt=0,dt=0,gt=0,Oe=0;if(Oe=k,k=k+112|0,ht=Oe+80|0,b=Oe+72|0,nt=Oe,dt=Oe+56|0,M=A+8|0,gt=Hi((u[M>>2]<<5)+32|0)|0,gt||tt(22848,22448,800,22456),aM(A,gt),y=A,d=u[y+4>>2]|0,E=b,u[E>>2]=u[y>>2],u[E+4>>2]=d,dd(b,ht),E=sd(ht,l)|0,d=u[b>>2]|0,y=u[M>>2]|0,(y|0)>0){_=u[A+12>>2]|0,g=0;do d=(u[_+(g<<3)>>2]|0)+d|0,g=g+1|0;while((g|0)!=(y|0))}if(E=(E|0)<(d|0)?d:E,st=E+12|0,g=Ti(st,8)|0,B=Ti(st,8)|0,u[ht>>2]=0,Ne=A,At=u[Ne+4>>2]|0,d=b,u[d>>2]=u[Ne>>2],u[d+4>>2]=At,d=we(b,st,l,ht,g,B)|0,d|0)return Ge(g),Ge(B),Ge(gt),gt=d,k=Oe,gt|0;e:do if((u[M>>2]|0)>0){for(y=A+12|0,d=0;_=we((u[y>>2]|0)+(d<<3)|0,st,l,ht,g,B)|0,d=d+1|0,!(_|0);)if((d|0)>=(u[M>>2]|0))break e;return Ge(g),Ge(B),Ge(gt),gt=_,k=Oe,gt|0}while(0);(E|0)>-12&&Ci(B|0,0,((st|0)>1?st:1)<<3|0)|0;e:do if((u[ht>>2]|0)>0){At=((st|0)<0)<<31>>31,W=g,Ee=B,Ce=g,de=g,me=B,Ne=g,d=g,ue=g,ye=B,$=B,ae=B,g=B;t:for(;;){for(ne=u[ht>>2]|0,J=0,te=0,y=0;;){_=nt,E=_+56|0;do u[_>>2]=0,_=_+4|0;while((_|0)<(E|0));if(l=W+(J<<3)|0,b=u[l>>2]|0,l=u[l+4>>2]|0,AA(b,l,1,nt,0)|0){_=nt,E=_+56|0;do u[_>>2]=0,_=_+4|0;while((_|0)<(E|0));_=Ti(7,4)|0,_|0&&(oi(b,l,1,nt,_,7,0),Ge(_))}j=0;do{U=nt+(j<<3)|0,B=u[U>>2]|0,U=u[U+4>>2]|0;n:do if(!((B|0)==0&(U|0)==0)){if(b=Ur(B|0,U|0,st|0,At|0)|0,z()|0,_=h+(b<<3)|0,E=_,l=u[E>>2]|0,E=u[E+4>>2]|0,!((l|0)==0&(E|0)==0))for(M=0;;){if((M|0)>(st|0))break t;if((l|0)==(B|0)&(E|0)==(U|0))break n;if(b=(b+1|0)%(st|0)|0,_=h+(b<<3)|0,E=_,l=u[E>>2]|0,E=u[E+4>>2]|0,(l|0)==0&(E|0)==0)break;M=M+1|0}(B|0)==0&(U|0)==0||(Ls(B,U,dt),AM(A,gt,dt)|0&&(M=_,u[M>>2]=B,u[M+4>>2]=U,M=Ee+(y<<3)|0,u[M>>2]=B,u[M+4>>2]=U,y=y+1|0))}while(0);j=j+1|0}while(j>>>0<7);if(te=te+1|0,(te|0)>=(ne|0))break;J=J+1|0}if((ne|0)>0&&Ci(Ce|0,0,ne<<3|0)|0,u[ht>>2]=y,(y|0)>0)B=g,U=ae,j=Ne,J=$,te=ye,ne=Ee,g=ue,ae=d,$=de,ye=Ce,ue=B,d=U,Ne=me,me=j,de=J,Ce=te,Ee=W,W=ne;else break e}return Ge(de),Ge(me),Ge(gt),gt=-1,k=Oe,gt|0}else d=B;while(0);return Ge(gt),Ge(g),Ge(d),gt=0,k=Oe,gt|0}function we(A,l,h,d,g,y){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0,y=y|0;var _=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0,Ce=0,de=0,me=0,Ne=0,At=0,st=0,ht=0;if(At=k,k=k+48|0,Ce=At+32|0,de=At+16|0,me=At,_=u[A>>2]|0,(_|0)<=0)return Ne=0,k=At,Ne|0;ye=A+4|0,$=Ce+8|0,ae=de+8|0,W=me+8|0,Ee=((l|0)<0)<<31>>31,ue=0;e:for(;;){E=u[ye>>2]|0,te=E+(ue<<4)|0,u[Ce>>2]=u[te>>2],u[Ce+4>>2]=u[te+4>>2],u[Ce+8>>2]=u[te+8>>2],u[Ce+12>>2]=u[te+12>>2],(ue|0)==(_+-1|0)?(u[de>>2]=u[E>>2],u[de+4>>2]=u[E+4>>2],u[de+8>>2]=u[E+8>>2],u[de+12>>2]=u[E+12>>2]):(te=E+(ue+1<<4)|0,u[de>>2]=u[te>>2],u[de+4>>2]=u[te+4>>2],u[de+8>>2]=u[te+8>>2],u[de+12>>2]=u[te+12>>2]),te=uP(Ce,de,h)|0;t:do if((te|0)>0){ne=+(te|0),J=0;n:for(;;){ht=+(te-J|0),st=+(J|0),N[me>>3]=+N[Ce>>3]*ht/ne+ +N[de>>3]*st/ne,N[W>>3]=+N[$>>3]*ht/ne+ +N[ae>>3]*st/ne,U=x_(me,h)|0,j=z()|0,E=Ur(U|0,j|0,l|0,Ee|0)|0,z()|0,_=y+(E<<3)|0,b=_,M=u[b>>2]|0,b=u[b+4>>2]|0;i:do if((M|0)==0&(b|0)==0)Ne=14;else for(B=0;;){if((B|0)>(l|0)){_=1;break i}if((M|0)==(U|0)&(b|0)==(j|0)){_=7;break i}if(E=(E+1|0)%(l|0)|0,_=y+(E<<3)|0,b=_,M=u[b>>2]|0,b=u[b+4>>2]|0,(M|0)==0&(b|0)==0){Ne=14;break}else B=B+1|0}while(0);switch((Ne|0)==14&&(Ne=0,(U|0)==0&(j|0)==0?_=7:(u[_>>2]=U,u[_+4>>2]=j,_=u[d>>2]|0,B=g+(_<<3)|0,u[B>>2]=U,u[B+4>>2]=j,u[d>>2]=_+1,_=0)),_&7){case 7:case 0:break;default:break n}if(J=J+1|0,(te|0)<=(J|0)){Ne=8;break t}}if(_|0){_=-1,Ne=20;break e}}else Ne=8;while(0);if((Ne|0)==8&&(Ne=0),ue=ue+1|0,_=u[A>>2]|0,(ue|0)>=(_|0)){_=0,Ne=20;break}}return(Ne|0)==20?(k=At,_|0):0}function Xe(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0;if(M=k,k=k+176|0,b=M,(l|0)<1){D_(h,0,0),k=M;return}_=A,_=ce(u[_>>2]|0,u[_+4>>2]|0,52)|0,z()|0,D_(h,(l|0)>6?l:6,_&15),_=0;do{if(d=A+(_<<3)|0,Rs(u[d>>2]|0,u[d+4>>2]|0,b),d=u[b>>2]|0,(d|0)>0){E=0;do y=b+8+(E<<4)|0,E=E+1|0,d=b+8+(((E|0)%(d|0)|0)<<4)|0,g=EM(h,d,y)|0,g?U_(h,g)|0:vM(h,y,d)|0,d=u[b>>2]|0;while((E|0)<(d|0))}_=_+1|0}while((_|0)!=(l|0));k=M}function Ut(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0;if(y=k,k=k+32|0,d=y,g=y+16|0,Xe(A,l,g),u[h>>2]=0,u[h+4>>2]=0,u[h+8>>2]=0,A=N_(g)|0,!A){I_(h)|0,k_(g),k=y;return}do{l=$P(h)|0;do eM(l,A)|0,_=A+16|0,u[d>>2]=u[_>>2],u[d+4>>2]=u[_+4>>2],u[d+8>>2]=u[_+8>>2],u[d+12>>2]=u[_+12>>2],U_(g,A)|0,A=wM(g,d)|0;while((A|0)!=0);A=N_(g)|0}while((A|0)!=0);I_(h)|0,k_(g),k=y}function Ue(A){return A=A|0,u[7728+(A*28|0)+16>>2]|0}function Qt(A){return A=A|0,(A|0)==4|(A|0)==117|0}function Hn(A){return A=A|0,u[11152+((u[A>>2]|0)*216|0)+((u[A+4>>2]|0)*72|0)+((u[A+8>>2]|0)*24|0)+(u[A+12>>2]<<3)>>2]|0}function oP(A){return A=A|0,u[11152+((u[A>>2]|0)*216|0)+((u[A+4>>2]|0)*72|0)+((u[A+8>>2]|0)*24|0)+(u[A+12>>2]<<3)+4>>2]|0}function aP(A,l){A=A|0,l=l|0,A=7728+(A*28|0)|0,u[l>>2]=u[A>>2],u[l+4>>2]=u[A+4>>2],u[l+8>>2]=u[A+8>>2],u[l+12>>2]=u[A+12>>2]}function AP(A,l){A=A|0,l=l|0;var h=0,d=0;if(l>>>0>20)return l=-1,l|0;do if((u[11152+(l*216|0)>>2]|0)!=(A|0))if((u[11152+(l*216|0)+8>>2]|0)!=(A|0))if((u[11152+(l*216|0)+16>>2]|0)!=(A|0))if((u[11152+(l*216|0)+24>>2]|0)!=(A|0))if((u[11152+(l*216|0)+32>>2]|0)!=(A|0))if((u[11152+(l*216|0)+40>>2]|0)!=(A|0))if((u[11152+(l*216|0)+48>>2]|0)!=(A|0))if((u[11152+(l*216|0)+56>>2]|0)!=(A|0))if((u[11152+(l*216|0)+64>>2]|0)!=(A|0))if((u[11152+(l*216|0)+72>>2]|0)!=(A|0))if((u[11152+(l*216|0)+80>>2]|0)!=(A|0))if((u[11152+(l*216|0)+88>>2]|0)!=(A|0))if((u[11152+(l*216|0)+96>>2]|0)!=(A|0))if((u[11152+(l*216|0)+104>>2]|0)!=(A|0))if((u[11152+(l*216|0)+112>>2]|0)!=(A|0))if((u[11152+(l*216|0)+120>>2]|0)!=(A|0))if((u[11152+(l*216|0)+128>>2]|0)!=(A|0))if((u[11152+(l*216|0)+136>>2]|0)==(A|0))A=2,h=1,d=2;else{if((u[11152+(l*216|0)+144>>2]|0)==(A|0)){A=0,h=2,d=0;break}if((u[11152+(l*216|0)+152>>2]|0)==(A|0)){A=0,h=2,d=1;break}if((u[11152+(l*216|0)+160>>2]|0)==(A|0)){A=0,h=2,d=2;break}if((u[11152+(l*216|0)+168>>2]|0)==(A|0)){A=1,h=2,d=0;break}if((u[11152+(l*216|0)+176>>2]|0)==(A|0)){A=1,h=2,d=1;break}if((u[11152+(l*216|0)+184>>2]|0)==(A|0)){A=1,h=2,d=2;break}if((u[11152+(l*216|0)+192>>2]|0)==(A|0)){A=2,h=2,d=0;break}if((u[11152+(l*216|0)+200>>2]|0)==(A|0)){A=2,h=2,d=1;break}if((u[11152+(l*216|0)+208>>2]|0)==(A|0)){A=2,h=2,d=2;break}else A=-1;return A|0}else A=2,h=1,d=1;else A=2,h=1,d=0;else A=1,h=1,d=2;else A=1,h=1,d=1;else A=1,h=1,d=0;else A=0,h=1,d=2;else A=0,h=1,d=1;else A=0,h=1,d=0;else A=2,h=0,d=2;else A=2,h=0,d=1;else A=2,h=0,d=0;else A=1,h=0,d=2;else A=1,h=0,d=1;else A=1,h=0,d=0;else A=0,h=0,d=2;else A=0,h=0,d=1;else A=0,h=0,d=0;while(0);return l=u[11152+(l*216|0)+(h*72|0)+(A*24|0)+(d<<3)+4>>2]|0,l|0}function u_(A,l){return A=A|0,l=l|0,(u[7728+(A*28|0)+20>>2]|0)==(l|0)?(l=1,l|0):(l=(u[7728+(A*28|0)+24>>2]|0)==(l|0),l|0)}function id(A,l){return A=A|0,l=l|0,u[880+(A*28|0)+(l<<2)>>2]|0}function rd(A,l){return A=A|0,l=l|0,(u[880+(A*28|0)>>2]|0)==(l|0)?(l=0,l|0):(u[880+(A*28|0)+4>>2]|0)==(l|0)?(l=1,l|0):(u[880+(A*28|0)+8>>2]|0)==(l|0)?(l=2,l|0):(u[880+(A*28|0)+12>>2]|0)==(l|0)?(l=3,l|0):(u[880+(A*28|0)+16>>2]|0)==(l|0)?(l=4,l|0):(u[880+(A*28|0)+20>>2]|0)==(l|0)?(l=5,l|0):((u[880+(A*28|0)+24>>2]|0)==(l|0)?6:7)|0}function lP(){return 122}function cP(A){A=A|0;var l=0,h=0,d=0;l=0;do _e(l|0,0,45)|0,d=z()|0|134225919,h=A+(l<<3)|0,u[h>>2]=-1,u[h+4>>2]=d,l=l+1|0;while((l|0)!=122)}function h_(A){return A=A|0,+N[A+16>>3]<+N[A+24>>3]|0}function f_(A,l){A=A|0,l=l|0;var h=0,d=0,g=0;return h=+N[l>>3],!(h>=+N[A+8>>3])||!(h<=+N[A>>3])?(l=0,l|0):(d=+N[A+16>>3],h=+N[A+24>>3],g=+N[l+8>>3],l=g>=h,A=g<=d&1,d<h?l&&(A=1):l||(A=0),l=(A|0)!=0,l|0)}function sd(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0;_=k,k=k+288|0,h=_+264|0,d=_+96|0,g=_,y=g,E=y+96|0;do u[y>>2]=0,y=y+4|0;while((y|0)<(E|0));return fd(l,g),y=g,E=u[y>>2]|0,y=u[y+4>>2]|0,Ls(E,y,h),Rs(E,y,d),b=+uA(h,d+8|0),N[h>>3]=+N[A>>3],y=h+8|0,N[y>>3]=+N[A+16>>3],N[d>>3]=+N[A+8>>3],E=d+8|0,N[E>>3]=+N[A+24>>3],M=+uA(h,d),E=~~+vi(+(M*M/+z_(+ +Ve(+((+N[y>>3]-+N[E>>3])/(+N[h>>3]-+N[d>>3]))),3)/(b*(b*2.59807621135)*.8))),k=_,((E|0)==0?1:E)|0}function uP(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0;E=k,k=k+288|0,d=E+264|0,g=E+96|0,y=E,_=y,b=_+96|0;do u[_>>2]=0,_=_+4|0;while((_|0)<(b|0));return fd(h,y),b=y,_=u[b>>2]|0,b=u[b+4>>2]|0,Ls(_,b,d),Rs(_,b,g),M=+uA(d,g+8|0),b=~~+vi(+(+uA(A,l)/(M*2))),k=E,((b|0)==0?1:b)|0}function hP(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0,u[A>>2]=l,u[A+4>>2]=h,u[A+8>>2]=d}function fP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0;U=l+8|0,u[U>>2]=0,b=+N[A>>3],_=+Ve(+b),M=+N[A+8>>3],E=+Ve(+M)/.8660254037844386,_=_+E*.5,h=~~_,A=~~E,_=_-+(h|0),E=E-+(A|0);do if(_<.5)if(_<.3333333333333333)if(u[l>>2]=h,E<(_+1)*.5){u[l+4>>2]=A;break}else{A=A+1|0,u[l+4>>2]=A;break}else if(j=1-_,A=(!(E<j)&1)+A|0,u[l+4>>2]=A,j<=E&E<_*2){h=h+1|0,u[l>>2]=h;break}else{u[l>>2]=h;break}else{if(!(_<.6666666666666666))if(h=h+1|0,u[l>>2]=h,E<_*.5){u[l+4>>2]=A;break}else{A=A+1|0,u[l+4>>2]=A;break}if(E<1-_){if(u[l+4>>2]=A,_*2+-1<E){u[l>>2]=h;break}}else A=A+1|0,u[l+4>>2]=A;h=h+1|0,u[l>>2]=h}while(0);do if(b<0)if(A&1){B=(A+1|0)/2|0,B=fA(h|0,((h|0)<0)<<31>>31|0,B|0,((B|0)<0)<<31>>31|0)|0,h=~~(+(h|0)-((+(B>>>0)+4294967296*+(z()|0))*2+1)),u[l>>2]=h;break}else{B=(A|0)/2|0,B=fA(h|0,((h|0)<0)<<31>>31|0,B|0,((B|0)<0)<<31>>31|0)|0,h=~~(+(h|0)-(+(B>>>0)+4294967296*+(z()|0))*2),u[l>>2]=h;break}while(0);B=l+4|0,M<0&&(h=h-((A<<1|1|0)/2|0)|0,u[l>>2]=h,A=0-A|0,u[B>>2]=A),d=A-h|0,(h|0)<0?(g=0-h|0,u[B>>2]=d,u[U>>2]=g,u[l>>2]=0,A=d,h=0):g=0,(A|0)<0&&(h=h-A|0,u[l>>2]=h,g=g-A|0,u[U>>2]=g,u[B>>2]=0,A=0),y=h-g|0,d=A-g|0,(g|0)<0&&(u[l>>2]=y,u[B>>2]=d,u[U>>2]=0,A=d,h=y,g=0),d=(A|0)<(h|0)?A:h,d=(g|0)<(d|0)?g:d,!((d|0)<=0)&&(u[l>>2]=h-d,u[B>>2]=A-d,u[U>>2]=g-d)}function cn(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0;l=u[A>>2]|0,_=A+4|0,h=u[_>>2]|0,(l|0)<0&&(h=h-l|0,u[_>>2]=h,y=A+8|0,u[y>>2]=(u[y>>2]|0)-l,u[A>>2]=0,l=0),(h|0)<0?(l=l-h|0,u[A>>2]=l,y=A+8|0,g=(u[y>>2]|0)-h|0,u[y>>2]=g,u[_>>2]=0,h=0):(g=A+8|0,y=g,g=u[g>>2]|0),(g|0)<0&&(l=l-g|0,u[A>>2]=l,h=h-g|0,u[_>>2]=h,u[y>>2]=0,g=0),d=(h|0)<(l|0)?h:l,d=(g|0)<(d|0)?g:d,!((d|0)<=0)&&(u[A>>2]=l-d,u[_>>2]=h-d,u[y>>2]=g-d)}function Ms(A,l){A=A|0,l=l|0;var h=0,d=0;d=u[A+8>>2]|0,h=+((u[A+4>>2]|0)-d|0),N[l>>3]=+((u[A>>2]|0)-d|0)-h*.5,N[l+8>>3]=h*.8660254037844386}function wn(A,l,h){A=A|0,l=l|0,h=h|0,u[h>>2]=(u[l>>2]|0)+(u[A>>2]|0),u[h+4>>2]=(u[l+4>>2]|0)+(u[A+4>>2]|0),u[h+8>>2]=(u[l+8>>2]|0)+(u[A+8>>2]|0)}function od(A,l,h){A=A|0,l=l|0,h=h|0,u[h>>2]=(u[A>>2]|0)-(u[l>>2]|0),u[h+4>>2]=(u[A+4>>2]|0)-(u[l+4>>2]|0),u[h+8>>2]=(u[A+8>>2]|0)-(u[l+8>>2]|0)}function d_(A,l){A=A|0,l=l|0;var h=0,d=0;h=$t(u[A>>2]|0,l)|0,u[A>>2]=h,h=A+4|0,d=$t(u[h>>2]|0,l)|0,u[h>>2]=d,A=A+8|0,l=$t(u[A>>2]|0,l)|0,u[A>>2]=l}function Mc(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;_=u[A>>2]|0,E=(_|0)<0,d=(u[A+4>>2]|0)-(E?_:0)|0,y=(d|0)<0,g=(y?0-d|0:0)+((u[A+8>>2]|0)-(E?_:0))|0,h=(g|0)<0,A=h?0:g,l=(y?0:d)-(h?g:0)|0,g=(E?0:_)-(y?d:0)-(h?g:0)|0,h=(l|0)<(g|0)?l:g,h=(A|0)<(h|0)?A:h,d=(h|0)>0,A=A-(d?h:0)|0,l=l-(d?h:0)|0;e:do switch(g-(d?h:0)|0){case 0:switch(l|0){case 0:return E=(A|0)==0?0:(A|0)==1?1:7,E|0;case 1:return E=(A|0)==0?2:(A|0)==1?3:7,E|0;default:break e}case 1:switch(l|0){case 0:return E=(A|0)==0?4:(A|0)==1?5:7,E|0;case 1:{if(!A)A=6;else break e;return A|0}default:break e}}while(0);return E=7,E|0}function g_(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;_=A+8|0,h=u[_>>2]|0,l=(u[A>>2]|0)-h|0,E=A+4|0,h=(u[E>>2]|0)-h|0,d=Oc(+((l*3|0)-h|0)/7)|0,u[A>>2]=d,l=Oc(+((h<<1)+l|0)/7)|0,u[E>>2]=l,u[_>>2]=0,h=l-d|0,(d|0)<0?(y=0-d|0,u[E>>2]=h,u[_>>2]=y,u[A>>2]=0,l=h,d=0,h=y):h=0,(l|0)<0&&(d=d-l|0,u[A>>2]=d,h=h-l|0,u[_>>2]=h,u[E>>2]=0,l=0),y=d-h|0,g=l-h|0,(h|0)<0?(u[A>>2]=y,u[E>>2]=g,u[_>>2]=0,l=g,g=y,h=0):g=d,d=(l|0)<(g|0)?l:g,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(u[A>>2]=g-d,u[E>>2]=l-d,u[_>>2]=h-d)}function ad(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;_=A+8|0,h=u[_>>2]|0,l=(u[A>>2]|0)-h|0,E=A+4|0,h=(u[E>>2]|0)-h|0,d=Oc(+((l<<1)+h|0)/7)|0,u[A>>2]=d,l=Oc(+((h*3|0)-l|0)/7)|0,u[E>>2]=l,u[_>>2]=0,h=l-d|0,(d|0)<0?(y=0-d|0,u[E>>2]=h,u[_>>2]=y,u[A>>2]=0,l=h,d=0,h=y):h=0,(l|0)<0&&(d=d-l|0,u[A>>2]=d,h=h-l|0,u[_>>2]=h,u[E>>2]=0,l=0),y=d-h|0,g=l-h|0,(h|0)<0?(u[A>>2]=y,u[E>>2]=g,u[_>>2]=0,l=g,g=y,h=0):g=d,d=(l|0)<(g|0)?l:g,d=(h|0)<(d|0)?h:d,!((d|0)<=0)&&(u[A>>2]=g-d,u[E>>2]=l-d,u[_>>2]=h-d)}function Ic(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;l=u[A>>2]|0,_=A+4|0,h=u[_>>2]|0,E=A+8|0,d=u[E>>2]|0,g=h+(l*3|0)|0,u[A>>2]=g,h=d+(h*3|0)|0,u[_>>2]=h,l=(d*3|0)+l|0,u[E>>2]=l,d=h-g|0,(g|0)<0?(l=l-g|0,u[_>>2]=d,u[E>>2]=l,u[A>>2]=0,h=d,d=0):d=g,(h|0)<0&&(d=d-h|0,u[A>>2]=d,l=l-h|0,u[E>>2]=l,u[_>>2]=0,h=0),y=d-l|0,g=h-l|0,(l|0)<0?(u[A>>2]=y,u[_>>2]=g,u[E>>2]=0,d=y,l=0):g=h,h=(g|0)<(d|0)?g:d,h=(l|0)<(h|0)?l:h,!((h|0)<=0)&&(u[A>>2]=d-h,u[_>>2]=g-h,u[E>>2]=l-h)}function Is(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;g=u[A>>2]|0,_=A+4|0,l=u[_>>2]|0,E=A+8|0,h=u[E>>2]|0,d=(l*3|0)+g|0,g=h+(g*3|0)|0,u[A>>2]=g,u[_>>2]=d,l=(h*3|0)+l|0,u[E>>2]=l,h=d-g|0,(g|0)<0?(l=l-g|0,u[_>>2]=h,u[E>>2]=l,u[A>>2]=0,g=0):h=d,(h|0)<0&&(g=g-h|0,u[A>>2]=g,l=l-h|0,u[E>>2]=l,u[_>>2]=0,h=0),y=g-l|0,d=h-l|0,(l|0)<0?(u[A>>2]=y,u[_>>2]=d,u[E>>2]=0,g=y,l=0):d=h,h=(d|0)<(g|0)?d:g,h=(l|0)<(h|0)?l:h,!((h|0)<=0)&&(u[A>>2]=g-h,u[_>>2]=d-h,u[E>>2]=l-h)}function p_(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0;(l+-1|0)>>>0>=6||(g=(u[15472+(l*12|0)>>2]|0)+(u[A>>2]|0)|0,u[A>>2]=g,E=A+4|0,d=(u[15472+(l*12|0)+4>>2]|0)+(u[E>>2]|0)|0,u[E>>2]=d,_=A+8|0,l=(u[15472+(l*12|0)+8>>2]|0)+(u[_>>2]|0)|0,u[_>>2]=l,h=d-g|0,(g|0)<0?(l=l-g|0,u[E>>2]=h,u[_>>2]=l,u[A>>2]=0,d=0):(h=d,d=g),(h|0)<0&&(d=d-h|0,u[A>>2]=d,l=l-h|0,u[_>>2]=l,u[E>>2]=0,h=0),y=d-l|0,g=h-l|0,(l|0)<0?(u[A>>2]=y,u[E>>2]=g,u[_>>2]=0,d=y,l=0):g=h,h=(g|0)<(d|0)?g:d,h=(l|0)<(h|0)?l:h,!((h|0)<=0)&&(u[A>>2]=d-h,u[E>>2]=g-h,u[_>>2]=l-h))}function m_(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;g=u[A>>2]|0,_=A+4|0,l=u[_>>2]|0,E=A+8|0,h=u[E>>2]|0,d=l+g|0,g=h+g|0,u[A>>2]=g,u[_>>2]=d,l=h+l|0,u[E>>2]=l,h=d-g|0,(g|0)<0?(l=l-g|0,u[_>>2]=h,u[E>>2]=l,u[A>>2]=0,d=0):(h=d,d=g),(h|0)<0&&(d=d-h|0,u[A>>2]=d,l=l-h|0,u[E>>2]=l,u[_>>2]=0,h=0),y=d-l|0,g=h-l|0,(l|0)<0?(u[A>>2]=y,u[_>>2]=g,u[E>>2]=0,d=y,l=0):g=h,h=(g|0)<(d|0)?g:d,h=(l|0)<(h|0)?l:h,!((h|0)<=0)&&(u[A>>2]=d-h,u[_>>2]=g-h,u[E>>2]=l-h)}function Bc(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;l=u[A>>2]|0,_=A+4|0,d=u[_>>2]|0,E=A+8|0,h=u[E>>2]|0,g=d+l|0,u[A>>2]=g,d=h+d|0,u[_>>2]=d,l=h+l|0,u[E>>2]=l,h=d-g|0,(g|0)<0?(l=l-g|0,u[_>>2]=h,u[E>>2]=l,u[A>>2]=0,d=0):(h=d,d=g),(h|0)<0&&(d=d-h|0,u[A>>2]=d,l=l-h|0,u[E>>2]=l,u[_>>2]=0,h=0),y=d-l|0,g=h-l|0,(l|0)<0?(u[A>>2]=y,u[_>>2]=g,u[E>>2]=0,d=y,l=0):g=h,h=(g|0)<(d|0)?g:d,h=(l|0)<(h|0)?l:h,!((h|0)<=0)&&(u[A>>2]=d-h,u[_>>2]=g-h,u[E>>2]=l-h)}function Bs(A){switch(A=A|0,A|0){case 1:{A=5;break}case 5:{A=4;break}case 4:{A=6;break}case 6:{A=2;break}case 2:{A=3;break}case 3:{A=1;break}}return A|0}function kr(A){switch(A=A|0,A|0){case 1:{A=3;break}case 3:{A=2;break}case 2:{A=6;break}case 6:{A=4;break}case 4:{A=5;break}case 5:{A=1;break}}return A|0}function __(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;l=u[A>>2]|0,_=A+4|0,h=u[_>>2]|0,E=A+8|0,d=u[E>>2]|0,g=h+(l<<1)|0,u[A>>2]=g,h=d+(h<<1)|0,u[_>>2]=h,l=(d<<1)+l|0,u[E>>2]=l,d=h-g|0,(g|0)<0?(l=l-g|0,u[_>>2]=d,u[E>>2]=l,u[A>>2]=0,h=d,d=0):d=g,(h|0)<0&&(d=d-h|0,u[A>>2]=d,l=l-h|0,u[E>>2]=l,u[_>>2]=0,h=0),y=d-l|0,g=h-l|0,(l|0)<0?(u[A>>2]=y,u[_>>2]=g,u[E>>2]=0,d=y,l=0):g=h,h=(g|0)<(d|0)?g:d,h=(l|0)<(h|0)?l:h,!((h|0)<=0)&&(u[A>>2]=d-h,u[_>>2]=g-h,u[E>>2]=l-h)}function y_(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;g=u[A>>2]|0,_=A+4|0,l=u[_>>2]|0,E=A+8|0,h=u[E>>2]|0,d=(l<<1)+g|0,g=h+(g<<1)|0,u[A>>2]=g,u[_>>2]=d,l=(h<<1)+l|0,u[E>>2]=l,h=d-g|0,(g|0)<0?(l=l-g|0,u[_>>2]=h,u[E>>2]=l,u[A>>2]=0,g=0):h=d,(h|0)<0&&(g=g-h|0,u[A>>2]=g,l=l-h|0,u[E>>2]=l,u[_>>2]=0,h=0),y=g-l|0,d=h-l|0,(l|0)<0?(u[A>>2]=y,u[_>>2]=d,u[E>>2]=0,g=y,l=0):d=h,h=(d|0)<(g|0)?d:g,h=(l|0)<(h|0)?l:h,!((h|0)<=0)&&(u[A>>2]=g-h,u[_>>2]=d-h,u[E>>2]=l-h)}function Ad(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0;return _=(u[A>>2]|0)-(u[l>>2]|0)|0,E=(_|0)<0,d=(u[A+4>>2]|0)-(u[l+4>>2]|0)-(E?_:0)|0,y=(d|0)<0,g=(E?0-_|0:0)+(u[A+8>>2]|0)-(u[l+8>>2]|0)+(y?0-d|0:0)|0,A=(g|0)<0,l=A?0:g,h=(y?0:d)-(A?g:0)|0,g=(E?0:_)-(y?d:0)-(A?g:0)|0,A=(h|0)<(g|0)?h:g,A=(l|0)<(A|0)?l:A,d=(A|0)>0,l=l-(d?A:0)|0,h=h-(d?A:0)|0,A=g-(d?A:0)|0,A=(A|0)>-1?A:0-A|0,h=(h|0)>-1?h:0-h|0,l=(l|0)>-1?l:0-l|0,l=(h|0)>(l|0)?h:l,((A|0)>(l|0)?A:l)|0}function dP(A,l){A=A|0,l=l|0;var h=0;h=u[A+8>>2]|0,u[l>>2]=(u[A>>2]|0)-h,u[l+4>>2]=(u[A+4>>2]|0)-h}function gP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0;d=u[A>>2]|0,u[l>>2]=d,A=u[A+4>>2]|0,_=l+4|0,u[_>>2]=A,E=l+8|0,u[E>>2]=0,h=A-d|0,(d|0)<0?(A=0-d|0,u[_>>2]=h,u[E>>2]=A,u[l>>2]=0,d=0):(h=A,A=0),(h|0)<0&&(d=d-h|0,u[l>>2]=d,A=A-h|0,u[E>>2]=A,u[_>>2]=0,h=0),y=d-A|0,g=h-A|0,(A|0)<0?(u[l>>2]=y,u[_>>2]=g,u[E>>2]=0,h=g,g=y,A=0):g=d,d=(h|0)<(g|0)?h:g,d=(A|0)<(d|0)?A:d,!((d|0)<=0)&&(u[l>>2]=g-d,u[_>>2]=h-d,u[E>>2]=A-d)}function v_(A){A=A|0;var l=0,h=0,d=0,g=0;l=A+8|0,g=u[l>>2]|0,h=g-(u[A>>2]|0)|0,u[A>>2]=h,d=A+4|0,A=(u[d>>2]|0)-g|0,u[d>>2]=A,u[l>>2]=0-(A+h)}function pP(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;h=u[A>>2]|0,l=0-h|0,u[A>>2]=l,_=A+8|0,u[_>>2]=0,E=A+4|0,d=u[E>>2]|0,g=d+h|0,(h|0)>0?(u[E>>2]=g,u[_>>2]=h,u[A>>2]=0,l=0,d=g):h=0,(d|0)<0?(y=l-d|0,u[A>>2]=y,h=h-d|0,u[_>>2]=h,u[E>>2]=0,g=y-h|0,l=0-h|0,(h|0)<0?(u[A>>2]=g,u[E>>2]=l,u[_>>2]=0,d=l,h=0):(d=0,g=y)):g=l,l=(d|0)<(g|0)?d:g,l=(h|0)<(l|0)?h:l,!((l|0)<=0)&&(u[A>>2]=g-l,u[E>>2]=d-l,u[_>>2]=h-l)}function mP(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0;d=k,k=k+16|0,g=d,_P(A,l,h,g),fP(g,h+4|0),k=d}function _P(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0,E=0,b=0;if(b=k,k=k+32|0,y=b,mM(A,y),u[h>>2]=0,g=+Gt(15888,y),_=+Gt(15912,y),_<g&&(u[h>>2]=1,g=_),_=+Gt(15936,y),_<g&&(u[h>>2]=2,g=_),_=+Gt(15960,y),_<g&&(u[h>>2]=3,g=_),_=+Gt(15984,y),_<g&&(u[h>>2]=4,g=_),_=+Gt(16008,y),_<g&&(u[h>>2]=5,g=_),_=+Gt(16032,y),_<g&&(u[h>>2]=6,g=_),_=+Gt(16056,y),_<g&&(u[h>>2]=7,g=_),_=+Gt(16080,y),_<g&&(u[h>>2]=8,g=_),_=+Gt(16104,y),_<g&&(u[h>>2]=9,g=_),_=+Gt(16128,y),_<g&&(u[h>>2]=10,g=_),_=+Gt(16152,y),_<g&&(u[h>>2]=11,g=_),_=+Gt(16176,y),_<g&&(u[h>>2]=12,g=_),_=+Gt(16200,y),_<g&&(u[h>>2]=13,g=_),_=+Gt(16224,y),_<g&&(u[h>>2]=14,g=_),_=+Gt(16248,y),_<g&&(u[h>>2]=15,g=_),_=+Gt(16272,y),_<g&&(u[h>>2]=16,g=_),_=+Gt(16296,y),_<g&&(u[h>>2]=17,g=_),_=+Gt(16320,y),_<g&&(u[h>>2]=18,g=_),_=+Gt(16344,y),_<g&&(u[h>>2]=19,g=_),_=+Vi(+(1-g*.5)),_<1e-16){u[d>>2]=0,u[d+4>>2]=0,u[d+8>>2]=0,u[d+12>>2]=0,k=b;return}if(h=u[h>>2]|0,g=+N[16368+(h*24|0)>>3],g=+cA(g-+cA(+TP(15568+(h<<4)|0,A))),ai(l)|0?E=+cA(g+-.3334731722518321):E=g,g=+Ot(+_)/.381966011250105,(l|0)>0){y=0;do g=g*2.6457513110645907,y=y+1|0;while((y|0)!=(l|0))}_=+qe(+E)*g,N[d>>3]=_,E=+Je(+E)*g,N[d+8>>3]=E,k=b}function lA(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0;if(y=+pM(A),y<1e-16){l=15568+(l<<4)|0,u[g>>2]=u[l>>2],u[g+4>>2]=u[l+4>>2],u[g+8>>2]=u[l+8>>2],u[g+12>>2]=u[l+12>>2];return}if(_=+yt(+ +N[A+8>>3],+ +N[A>>3]),(h|0)>0){A=0;do y=y/2.6457513110645907,A=A+1|0;while((A|0)!=(h|0))}d?(y=y/3,h=(ai(h)|0)==0,y=+Dr(+((h?y:y/2.6457513110645907)*.381966011250105))):(y=+Dr(+(y*.381966011250105)),ai(h)|0&&(_=+cA(_+.3334731722518321))),CP(15568+(l<<4)|0,+cA(+N[16368+(l*24|0)>>3]-_),y,g)}function yP(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0;d=k,k=k+16|0,g=d,Ms(A+4|0,g),lA(g,u[A>>2]|0,l,0,h),k=d}function E_(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0,Ce=0,de=0,me=0,Ne=0,At=0,st=0,ht=0,nt=0,dt=0,gt=0,Oe=0;if(dt=k,k=k+272|0,y=dt+256|0,$=dt+240|0,st=dt,ht=dt+224|0,nt=dt+208|0,ae=dt+176|0,W=dt+160|0,Ee=dt+192|0,Ce=dt+144|0,de=dt+128|0,me=dt+112|0,Ne=dt+96|0,At=dt+80|0,u[y>>2]=l,u[$>>2]=u[A>>2],u[$+4>>2]=u[A+4>>2],u[$+8>>2]=u[A+8>>2],u[$+12>>2]=u[A+12>>2],w_($,y,st),u[g>>2]=0,$=d+h+((d|0)==5&1)|0,($|0)<=(h|0)){k=dt;return}b=u[y>>2]|0,M=ht+4|0,B=ae+4|0,U=h+5|0,j=16848+(b<<2)|0,J=16928+(b<<2)|0,te=de+8|0,ne=me+8|0,ue=Ne+8|0,ye=nt+4|0,E=h;e:for(;;){_=st+(((E|0)%5|0)<<4)|0,u[nt>>2]=u[_>>2],u[nt+4>>2]=u[_+4>>2],u[nt+8>>2]=u[_+8>>2],u[nt+12>>2]=u[_+12>>2];do;while((So(nt,b,0,1)|0)==2);if((E|0)>(h|0)&(ai(l)|0)!=0){if(u[ae>>2]=u[nt>>2],u[ae+4>>2]=u[nt+4>>2],u[ae+8>>2]=u[nt+8>>2],u[ae+12>>2]=u[nt+12>>2],Ms(M,W),d=u[ae>>2]|0,y=u[17008+(d*80|0)+(u[ht>>2]<<2)>>2]|0,u[ae>>2]=u[18608+(d*80|0)+(y*20|0)>>2],_=u[18608+(d*80|0)+(y*20|0)+16>>2]|0,(_|0)>0){A=0;do m_(B),A=A+1|0;while((A|0)<(_|0))}switch(_=18608+(d*80|0)+(y*20|0)+4|0,u[Ee>>2]=u[_>>2],u[Ee+4>>2]=u[_+4>>2],u[Ee+8>>2]=u[_+8>>2],d_(Ee,(u[j>>2]|0)*3|0),wn(B,Ee,B),cn(B),Ms(B,Ce),gt=+(u[J>>2]|0),N[de>>3]=gt*3,N[te>>3]=0,Oe=gt*-1.5,N[me>>3]=Oe,N[ne>>3]=gt*2.598076211353316,N[Ne>>3]=Oe,N[ue>>3]=gt*-2.598076211353316,u[17008+((u[ae>>2]|0)*80|0)+(u[nt>>2]<<2)>>2]|0){case 1:{A=me,d=de;break}case 3:{A=Ne,d=me;break}case 2:{A=de,d=Ne;break}default:{A=12;break e}}O_(W,Ce,d,A,At),lA(At,u[ae>>2]|0,b,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1}if((E|0)<(U|0)&&(Ms(ye,ae),lA(ae,u[nt>>2]|0,b,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1),u[ht>>2]=u[nt>>2],u[ht+4>>2]=u[nt+4>>2],u[ht+8>>2]=u[nt+8>>2],u[ht+12>>2]=u[nt+12>>2],E=E+1|0,(E|0)>=($|0)){A=3;break}}if((A|0)==3){k=dt;return}else(A|0)==12&&tt(22474,22521,581,22531)}function w_(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0;b=k,k=k+128|0,d=b+64|0,g=b,y=d,_=20208,E=y+60|0;do u[y>>2]=u[_>>2],y=y+4|0,_=_+4|0;while((y|0)<(E|0));y=g,_=20272,E=y+60|0;do u[y>>2]=u[_>>2],y=y+4|0,_=_+4|0;while((y|0)<(E|0));E=(ai(u[l>>2]|0)|0)==0,d=E?d:g,g=A+4|0,__(g),y_(g),ai(u[l>>2]|0)|0&&(Is(g),u[l>>2]=(u[l>>2]|0)+1),u[h>>2]=u[A>>2],l=h+4|0,wn(g,d,l),cn(l),u[h+16>>2]=u[A>>2],l=h+20|0,wn(g,d+12|0,l),cn(l),u[h+32>>2]=u[A>>2],l=h+36|0,wn(g,d+24|0,l),cn(l),u[h+48>>2]=u[A>>2],l=h+52|0,wn(g,d+36|0,l),cn(l),u[h+64>>2]=u[A>>2],h=h+68|0,wn(g,d+48|0,h),cn(h),k=b}function So(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0;if(te=k,k=k+32|0,j=te+12|0,E=te,J=A+4|0,U=u[16928+(l<<2)>>2]|0,B=(d|0)!=0,U=B?U*3|0:U,g=u[J>>2]|0,M=A+8|0,_=u[M>>2]|0,B){if(y=A+12|0,d=u[y>>2]|0,g=_+g+d|0,(g|0)==(U|0))return J=1,k=te,J|0;b=y}else b=A+12|0,d=u[b>>2]|0,g=_+g+d|0;if((g|0)<=(U|0))return J=0,k=te,J|0;do if((d|0)>0){if(d=u[A>>2]|0,(_|0)>0){y=18608+(d*80|0)+60|0,d=A;break}d=18608+(d*80|0)+40|0,h?(hP(j,U,0,0),od(J,j,E),Bc(E),wn(E,j,J),y=d,d=A):(y=d,d=A)}else y=18608+((u[A>>2]|0)*80|0)+20|0,d=A;while(0);if(u[d>>2]=u[y>>2],g=y+16|0,(u[g>>2]|0)>0){d=0;do m_(J),d=d+1|0;while((d|0)<(u[g>>2]|0))}return A=y+4|0,u[j>>2]=u[A>>2],u[j+4>>2]=u[A+4>>2],u[j+8>>2]=u[A+8>>2],l=u[16848+(l<<2)>>2]|0,d_(j,B?l*3|0:l),wn(J,j,J),cn(J),B?d=((u[M>>2]|0)+(u[J>>2]|0)+(u[b>>2]|0)|0)==(U|0)?1:2:d=2,J=d,k=te,J|0}function vP(A,l){A=A|0,l=l|0;var h=0;do h=So(A,l,0,1)|0;while((h|0)==2);return h|0}function T_(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0,Ce=0,de=0,me=0,Ne=0,At=0,st=0;if(Ne=k,k=k+240|0,y=Ne+224|0,Ee=Ne+208|0,Ce=Ne,de=Ne+192|0,me=Ne+176|0,ue=Ne+160|0,ye=Ne+144|0,$=Ne+128|0,ae=Ne+112|0,W=Ne+96|0,u[y>>2]=l,u[Ee>>2]=u[A>>2],u[Ee+4>>2]=u[A+4>>2],u[Ee+8>>2]=u[A+8>>2],u[Ee+12>>2]=u[A+12>>2],C_(Ee,y,Ce),u[g>>2]=0,ne=d+h+((d|0)==6&1)|0,(ne|0)<=(h|0)){k=Ne;return}b=u[y>>2]|0,M=h+6|0,B=16928+(b<<2)|0,U=ye+8|0,j=$+8|0,J=ae+8|0,te=de+4|0,_=0,E=h,d=-1;e:for(;;){if(y=(E|0)%6|0,A=Ce+(y<<4)|0,u[de>>2]=u[A>>2],u[de+4>>2]=u[A+4>>2],u[de+8>>2]=u[A+8>>2],u[de+12>>2]=u[A+12>>2],A=_,_=So(de,b,0,1)|0,(E|0)>(h|0)&(ai(l)|0)!=0&&(A|0)!=1&&(u[de>>2]|0)!=(d|0)){switch(Ms(Ce+(((y+5|0)%6|0)<<4)+4|0,me),Ms(Ce+(y<<4)+4|0,ue),At=+(u[B>>2]|0),N[ye>>3]=At*3,N[U>>3]=0,st=At*-1.5,N[$>>3]=st,N[j>>3]=At*2.598076211353316,N[ae>>3]=st,N[J>>3]=At*-2.598076211353316,y=u[Ee>>2]|0,u[17008+(y*80|0)+(((d|0)==(y|0)?u[de>>2]|0:d)<<2)>>2]|0){case 1:{A=$,d=ye;break}case 3:{A=ae,d=$;break}case 2:{A=ye,d=ae;break}default:{A=8;break e}}O_(me,ue,d,A,W),!(F_(me,W)|0)&&!(F_(ue,W)|0)&&(lA(W,u[Ee>>2]|0,b,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1)}if((E|0)<(M|0)&&(Ms(te,me),lA(me,u[de>>2]|0,b,1,g+8+(u[g>>2]<<4)|0),u[g>>2]=(u[g>>2]|0)+1),E=E+1|0,(E|0)>=(ne|0)){A=3;break}else d=u[de>>2]|0}if((A|0)==3){k=Ne;return}else(A|0)==8&&tt(22557,22521,746,22602)}function C_(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0;b=k,k=k+160|0,d=b+80|0,g=b,y=d,_=20336,E=y+72|0;do u[y>>2]=u[_>>2],y=y+4|0,_=_+4|0;while((y|0)<(E|0));y=g,_=20416,E=y+72|0;do u[y>>2]=u[_>>2],y=y+4|0,_=_+4|0;while((y|0)<(E|0));E=(ai(u[l>>2]|0)|0)==0,d=E?d:g,g=A+4|0,__(g),y_(g),ai(u[l>>2]|0)|0&&(Is(g),u[l>>2]=(u[l>>2]|0)+1),u[h>>2]=u[A>>2],l=h+4|0,wn(g,d,l),cn(l),u[h+16>>2]=u[A>>2],l=h+20|0,wn(g,d+12|0,l),cn(l),u[h+32>>2]=u[A>>2],l=h+36|0,wn(g,d+24|0,l),cn(l),u[h+48>>2]=u[A>>2],l=h+52|0,wn(g,d+36|0,l),cn(l),u[h+64>>2]=u[A>>2],l=h+68|0,wn(g,d+48|0,l),cn(l),u[h+80>>2]=u[A>>2],h=h+84|0,wn(g,d+60|0,h),cn(h),k=b}function cA(A){A=+A;var l=0;return l=A<0?A+6.283185307179586:A,+(A>=6.283185307179586?l+-6.283185307179586:l)}function xo(A,l){return A=A|0,l=l|0,+Ve(+(+N[A>>3]-+N[l>>3]))<17453292519943298e-27?(l=+Ve(+(+N[A+8>>3]-+N[l+8>>3]))<17453292519943298e-27,l|0):(l=0,l|0)}function EP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0;return g=+N[l>>3],d=+N[A>>3],y=+Je(+((g-d)*.5)),h=+Je(+((+N[l+8>>3]-+N[A+8>>3])*.5)),h=y*y+h*(+qe(+g)*+qe(+d)*h),+(+yt(+ +je(+h),+ +je(+(1-h)))*2)}function uA(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0;return g=+N[l>>3],d=+N[A>>3],y=+Je(+((g-d)*.5)),h=+Je(+((+N[l+8>>3]-+N[A+8>>3])*.5)),h=y*y+h*(+qe(+g)*+qe(+d)*h),+(+yt(+ +je(+h),+ +je(+(1-h)))*2*6371.007180918475)}function wP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0;return g=+N[l>>3],d=+N[A>>3],y=+Je(+((g-d)*.5)),h=+Je(+((+N[l+8>>3]-+N[A+8>>3])*.5)),h=y*y+h*(+qe(+g)*+qe(+d)*h),+(+yt(+ +je(+h),+ +je(+(1-h)))*2*6371.007180918475*1e3)}function TP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0;return y=+N[l>>3],d=+qe(+y),g=+N[l+8>>3]-+N[A+8>>3],_=d*+Je(+g),h=+N[A>>3],+ +yt(+_,+(+Je(+y)*+qe(+h)-+qe(+g)*(d*+Je(+h))))}function CP(A,l,h,d){A=A|0,l=+l,h=+h,d=d|0;var g=0,y=0,_=0,E=0;if(h<1e-16){u[d>>2]=u[A>>2],u[d+4>>2]=u[A+4>>2],u[d+8>>2]=u[A+8>>2],u[d+12>>2]=u[A+12>>2];return}y=l<0?l+6.283185307179586:l,y=l>=6.283185307179586?y+-6.283185307179586:y;do if(y<1e-16)l=+N[A>>3]+h,N[d>>3]=l,g=d;else{if(g=+Ve(+(y+-3.141592653589793))<1e-16,l=+N[A>>3],g){l=l-h,N[d>>3]=l,g=d;break}if(_=+qe(+h),h=+Je(+h),l=_*+Je(+l)+ +qe(+y)*(h*+qe(+l)),l=l>1?1:l,l=+Eo(+(l<-1?-1:l)),N[d>>3]=l,+Ve(+(l+-1.5707963267948966))<1e-16){N[d>>3]=1.5707963267948966,N[d+8>>3]=0;return}if(+Ve(+(l+1.5707963267948966))<1e-16){N[d>>3]=-1.5707963267948966,N[d+8>>3]=0;return}if(E=+qe(+l),y=h*+Je(+y)/E,h=+N[A>>3],l=(_-+Je(+l)*+Je(+h))/+qe(+h)/E,_=y>1?1:y,l=l>1?1:l,l=+N[A+8>>3]+ +yt(+(_<-1?-1:_),+(l<-1?-1:l)),l>3.141592653589793)do l=l+-6.283185307179586;while(l>3.141592653589793);if(l<-3.141592653589793)do l=l+6.283185307179586;while(l<-3.141592653589793);N[d+8>>3]=l;return}while(0);if(+Ve(+(l+-1.5707963267948966))<1e-16){N[g>>3]=1.5707963267948966,N[d+8>>3]=0;return}if(+Ve(+(l+1.5707963267948966))<1e-16){N[g>>3]=-1.5707963267948966,N[d+8>>3]=0;return}if(l=+N[A+8>>3],l>3.141592653589793)do l=l+-6.283185307179586;while(l>3.141592653589793);if(l<-3.141592653589793)do l=l+6.283185307179586;while(l<-3.141592653589793);N[d+8>>3]=l}function bP(A){return A=A|0,+ +N[20496+(A<<3)>>3]}function SP(A){return A=A|0,+ +N[20624+(A<<3)>>3]}function xP(A){return A=A|0,+ +N[20752+(A<<3)>>3]}function PP(A){return A=A|0,+ +N[20880+(A<<3)>>3]}function MP(A){A=A|0;var l=0;return l=21008+(A<<3)|0,A=u[l>>2]|0,Pe(u[l+4>>2]|0),A|0}function Po(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0;return j=+N[l>>3],B=+N[A>>3],b=+Je(+((j-B)*.5)),y=+N[l+8>>3],M=+N[A+8>>3],_=+Je(+((y-M)*.5)),E=+qe(+B),U=+qe(+j),_=b*b+_*(U*E*_),_=+yt(+ +je(+_),+ +je(+(1-_)))*2,b=+N[h>>3],j=+Je(+((b-j)*.5)),d=+N[h+8>>3],y=+Je(+((d-y)*.5)),g=+qe(+b),y=j*j+y*(U*g*y),y=+yt(+ +je(+y),+ +je(+(1-y)))*2,b=+Je(+((B-b)*.5)),d=+Je(+((M-d)*.5)),d=b*b+d*(E*g*d),d=+yt(+ +je(+d),+ +je(+(1-d)))*2,g=(_+y+d)*.5,+(+Dr(+ +je(+(+Ot(+(g*.5))*+Ot(+((g-_)*.5))*+Ot(+((g-y)*.5))*+Ot(+((g-d)*.5)))))*4)}function IP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0;if(y=k,k=k+192|0,d=y+168|0,g=y,Ls(A,l,d),Rs(A,l,g),l=u[g>>2]|0,(l|0)<=0)return h=0,k=y,+h;if(h=+Po(g+8|0,g+8+(((l|0)!=1&1)<<4)|0,d)+0,(l|0)==1)return k=y,+h;A=1;do _=A,A=A+1|0,h=h+ +Po(g+8+(_<<4)|0,g+8+(((A|0)%(l|0)|0)<<4)|0,d);while((A|0)<(l|0));return k=y,+h}function BP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0;if(y=k,k=k+192|0,d=y+168|0,g=y,Ls(A,l,d),Rs(A,l,g),l=u[g>>2]|0,(l|0)>0){if(h=+Po(g+8|0,g+8+(((l|0)!=1&1)<<4)|0,d)+0,(l|0)!=1){A=1;do _=A,A=A+1|0,h=h+ +Po(g+8+(_<<4)|0,g+8+(((A|0)%(l|0)|0)<<4)|0,d);while((A|0)<(l|0))}}else h=0;return k=y,+(h*6371.007180918475*6371.007180918475)}function LP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0;if(y=k,k=k+192|0,d=y+168|0,g=y,Ls(A,l,d),Rs(A,l,g),l=u[g>>2]|0,(l|0)>0){if(h=+Po(g+8|0,g+8+(((l|0)!=1&1)<<4)|0,d)+0,(l|0)!=1){A=1;do _=A,A=A+1|0,h=h+ +Po(g+8+(_<<4)|0,g+8+(((A|0)%(l|0)|0)<<4)|0,d);while((A|0)<(l|0))}}else h=0;return k=y,+(h*6371.007180918475*6371.007180918475*1e3*1e3)}function RP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0;if(_=k,k=k+176|0,y=_,Lc(A,l,y),A=u[y>>2]|0,(A|0)<=1)return g=0,k=_,+g;l=A+-1|0,A=0,h=0,d=+N[y+8>>3],g=+N[y+16>>3];do A=A+1|0,b=d,d=+N[y+8+(A<<4)>>3],M=+Je(+((d-b)*.5)),E=g,g=+N[y+8+(A<<4)+8>>3],E=+Je(+((g-E)*.5)),E=M*M+E*(+qe(+d)*+qe(+b)*E),h=h+ +yt(+ +je(+E),+ +je(+(1-E)))*2;while((A|0)<(l|0));return k=_,+h}function OP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0;if(_=k,k=k+176|0,y=_,Lc(A,l,y),A=u[y>>2]|0,(A|0)<=1)return g=0,k=_,+g;l=A+-1|0,A=0,h=0,d=+N[y+8>>3],g=+N[y+16>>3];do A=A+1|0,b=d,d=+N[y+8+(A<<4)>>3],M=+Je(+((d-b)*.5)),E=g,g=+N[y+8+(A<<4)+8>>3],E=+Je(+((g-E)*.5)),E=M*M+E*(+qe(+b)*+qe(+d)*E),h=h+ +yt(+ +je(+E),+ +je(+(1-E)))*2;while((A|0)!=(l|0));return M=h*6371.007180918475,k=_,+M}function FP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0;if(_=k,k=k+176|0,y=_,Lc(A,l,y),A=u[y>>2]|0,(A|0)<=1)return g=0,k=_,+g;l=A+-1|0,A=0,h=0,d=+N[y+8>>3],g=+N[y+16>>3];do A=A+1|0,b=d,d=+N[y+8+(A<<4)>>3],M=+Je(+((d-b)*.5)),E=g,g=+N[y+8+(A<<4)+8>>3],E=+Je(+((g-E)*.5)),E=M*M+E*(+qe(+b)*+qe(+d)*E),h=h+ +yt(+ +je(+E),+ +je(+(1-E)))*2;while((A|0)!=(l|0));return M=h*6371.007180918475*1e3,k=_,+M}function DP(A,l){return A=A|0,l=l|0,l=ce(A|0,l|0,52)|0,z()|0,l&15|0}function b_(A,l){return A=A|0,l=l|0,l=ce(A|0,l|0,45)|0,z()|0,l&127|0}function S_(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0;if(!(!0&(l&-16777216|0)==134217728)||(_=ce(A|0,l|0,45)|0,z()|0,_=_&127,_>>>0>121))return l=0,l|0;h=ce(A|0,l|0,52)|0,z()|0,h=h&15;do if(h|0){for(g=1,d=0;;){if(y=ce(A|0,l|0,(15-g|0)*3|0)|0,z()|0,y=y&7,(y|0)!=0&(d^1))if((y|0)==1&(Ue(_)|0)!=0){E=0,d=13;break}else d=1;if((y|0)==7){E=0,d=13;break}if(g>>>0<h>>>0)g=g+1|0;else{d=9;break}}if((d|0)==9){if((h|0)==15)E=1;else break;return E|0}else if((d|0)==13)return E|0}while(0);for(;;){if(E=ce(A|0,l|0,(14-h|0)*3|0)|0,z()|0,!((E&7|0)==7&!0)){E=0,d=13;break}if(h>>>0<14)h=h+1|0;else{E=1,d=13;break}}return(d|0)==13?E|0:0}function ld(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0;if(d=ce(A|0,l|0,52)|0,z()|0,d=d&15,(d|0)>=(h|0)){if((d|0)!=(h|0))if(h>>>0<=15){if(g=_e(h|0,0,52)|0,A=g|A,l=z()|0|l&-15728641,(d|0)>(h|0))do g=_e(7,0,(14-h|0)*3|0)|0,h=h+1|0,A=g|A,l=z()|0|l;while((h|0)<(d|0))}else l=0,A=0}else l=0,A=0;return Pe(l|0),A|0}function kP(A,l,h){return A=A|0,l=l|0,h=h|0,A=ce(A|0,l|0,52)|0,z()|0,A=A&15,(h|0)<16&(A|0)<=(h|0)?(h=Rc(7,h-A|0)|0,h|0):(h=0,h|0)}function Pn(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0,E=0,b=0,M=0,B=0;if(_=ce(A|0,l|0,52)|0,z()|0,_=_&15,!!((h|0)<16&(_|0)<=(h|0))){if((_|0)==(h|0)){h=d,u[h>>2]=A,u[h+4>>2]=l;return}if(b=Rc(7,h-_|0)|0,M=(b|0)/7|0,E=ce(A|0,l|0,45)|0,z()|0,!(Ue(E&127)|0))y=0;else{e:do if(!_)g=0;else for(y=1;;){if(g=ce(A|0,l|0,(15-y|0)*3|0)|0,z()|0,g=g&7,g|0)break e;if(y>>>0<_>>>0)y=y+1|0;else{g=0;break}}while(0);y=(g|0)==0}if(B=_e(_+1|0,0,52)|0,g=z()|0|l&-15728641,E=(14-_|0)*3|0,l=_e(7,0,E|0)|0,l=(B|A)&~l,_=g&~(z()|0),Pn(l,_,h,d),g=d+(M<<3)|0,!y){B=_e(1,0,E|0)|0,Pn(B|l,z()|0|_,h,g),B=g+(M<<3)|0,b=_e(2,0,E|0)|0,Pn(b|l,z()|0|_,h,B),B=B+(M<<3)|0,b=_e(3,0,E|0)|0,Pn(b|l,z()|0|_,h,B),B=B+(M<<3)|0,b=_e(4,0,E|0)|0,Pn(b|l,z()|0|_,h,B),B=B+(M<<3)|0,b=_e(5,0,E|0)|0,Pn(b|l,z()|0|_,h,B),b=_e(6,0,E|0)|0,Pn(b|l,z()|0|_,h,B+(M<<3)|0);return}y=g+(M<<3)|0,(b|0)>6&&(b=g+8|0,B=(y>>>0>b>>>0?y:b)+-1+(0-g)|0,Ci(g|0,0,B+8&-8|0)|0,g=b+(B>>>3<<3)|0),B=_e(2,0,E|0)|0,Pn(B|l,z()|0|_,h,g),B=g+(M<<3)|0,b=_e(3,0,E|0)|0,Pn(b|l,z()|0|_,h,B),B=B+(M<<3)|0,b=_e(4,0,E|0)|0,Pn(b|l,z()|0|_,h,B),B=B+(M<<3)|0,b=_e(5,0,E|0)|0,Pn(b|l,z()|0|_,h,B),b=_e(6,0,E|0)|0,Pn(b|l,z()|0|_,h,B+(M<<3)|0)}}function Xt(A,l){A=A|0,l=l|0;var h=0,d=0,g=0;if(g=ce(A|0,l|0,45)|0,z()|0,!(Ue(g&127)|0))return g=0,g|0;g=ce(A|0,l|0,52)|0,z()|0,g=g&15;e:do if(!g)h=0;else for(d=1;;){if(h=ce(A|0,l|0,(15-d|0)*3|0)|0,z()|0,h=h&7,h|0)break e;if(d>>>0<g>>>0)d=d+1|0;else{h=0;break}}while(0);return g=(h|0)==0&1,g|0}function NP(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0;if(d=ce(A|0,l|0,52)|0,z()|0,d=d&15,(h|0)<16&(d|0)<=(h|0)){if((d|0)!=(h|0)&&(g=_e(h|0,0,52)|0,A=g|A,l=z()|0|l&-15728641,(d|0)<(h|0)))do g=_e(7,0,(14-d|0)*3|0)|0,d=d+1|0,A=A&~g,l=l&~(z()|0);while((d|0)<(h|0))}else l=0,A=0;return Pe(l|0),A|0}function UP(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0,Ce=0,de=0,me=0;if(!h)return de=0,de|0;if(g=A,d=u[g>>2]|0,g=u[g+4>>2]|0,!0&(g&15728640|0)==0){if((h|0)<=0||(de=l,u[de>>2]=d,u[de+4>>2]=g,(h|0)==1))return de=0,de|0;d=1;do Ee=A+(d<<3)|0,Ce=u[Ee+4>>2]|0,de=l+(d<<3)|0,u[de>>2]=u[Ee>>2],u[de+4>>2]=Ce,d=d+1|0;while((d|0)!=(h|0));return d=0,d|0}if(Ee=h<<3,Ce=Hi(Ee)|0,!Ce)return de=-3,de|0;if(Dc(Ce|0,A|0,Ee|0)|0,W=Ti(h,8)|0,!W)return Ge(Ce),de=-3,de|0;d=h;e:for(;;){_=Ce,B=u[_>>2]|0,_=u[_+4>>2]|0,$=ce(B|0,_|0,52)|0,z()|0,$=$&15,ae=$+-1|0,ye=(d|0)>0;t:do if(ye){if(ue=((d|0)<0)<<31>>31,te=_e(ae|0,0,52)|0,ne=z()|0,ae>>>0>15)for(g=0,A=B,h=_;;){if(!((A|0)==0&(h|0)==0)){if(y=ce(A|0,h|0,52)|0,z()|0,y=y&15,E=(y|0)<(ae|0),y=(y|0)==(ae|0),M=E?0:y?A:0,A=E?0:y?h:0,h=Ur(M|0,A|0,d|0,ue|0)|0,z()|0,y=W+(h<<3)|0,E=y,b=u[E>>2]|0,E=u[E+4>>2]|0,(b|0)==0&(E|0)==0)h=M;else for(te=0,J=h,j=E,h=M;;){if((te|0)>(d|0)){de=41;break e}if((b|0)==(h|0)&(j&-117440513|0)==(A|0)){M=ce(b|0,j|0,56)|0,z()|0,M=M&7,U=M+1|0,ne=ce(b|0,j|0,45)|0,z()|0;n:do if(!(Ue(ne&127)|0))E=7;else{if(b=ce(b|0,j|0,52)|0,z()|0,b=b&15,!b){E=6;break}for(E=1;;){if(ne=_e(7,0,(15-E|0)*3|0)|0,!((ne&h|0)==0&((z()|0)&A|0)==0)){E=7;break n}if(E>>>0<b>>>0)E=E+1|0;else{E=6;break}}}while(0);if((M+2|0)>>>0>E>>>0){de=51;break e}ne=_e(U|0,0,56)|0,A=z()|0|A&-117440513,E=y,u[E>>2]=0,u[E+4>>2]=0,E=J,h=ne|h}else E=(J+1|0)%(d|0)|0;if(y=W+(E<<3)|0,j=y,b=u[j>>2]|0,j=u[j+4>>2]|0,(b|0)==0&(j|0)==0)break;te=te+1|0,J=E}ne=y,u[ne>>2]=h,u[ne+4>>2]=A}if(g=g+1|0,(g|0)>=(d|0))break t;h=Ce+(g<<3)|0,A=u[h>>2]|0,h=u[h+4>>2]|0}for(g=0,A=B,h=_;;){if(!((A|0)==0&(h|0)==0)){if(E=ce(A|0,h|0,52)|0,z()|0,E=E&15,(E|0)>=(ae|0)){if((E|0)!=(ae|0)&&(A=A|te,h=h&-15728641|ne,E>>>0>=$>>>0)){y=ae;do J=_e(7,0,(14-y|0)*3|0)|0,y=y+1|0,A=J|A,h=z()|0|h;while(y>>>0<E>>>0)}}else A=0,h=0;if(E=Ur(A|0,h|0,d|0,ue|0)|0,z()|0,y=W+(E<<3)|0,b=y,M=u[b>>2]|0,b=u[b+4>>2]|0,!((M|0)==0&(b|0)==0))for(J=0;;){if((J|0)>(d|0)){de=41;break e}if((M|0)==(A|0)&(b&-117440513|0)==(h|0)){U=ce(M|0,b|0,56)|0,z()|0,U=U&7,j=U+1|0,me=ce(M|0,b|0,45)|0,z()|0;n:do if(!(Ue(me&127)|0))b=7;else{if(M=ce(M|0,b|0,52)|0,z()|0,M=M&15,!M){b=6;break}for(b=1;;){if(me=_e(7,0,(15-b|0)*3|0)|0,!((me&A|0)==0&((z()|0)&h|0)==0)){b=7;break n}if(b>>>0<M>>>0)b=b+1|0;else{b=6;break}}}while(0);if((U+2|0)>>>0>b>>>0){de=51;break e}me=_e(j|0,0,56)|0,h=z()|0|h&-117440513,j=y,u[j>>2]=0,u[j+4>>2]=0,A=me|A}else E=(E+1|0)%(d|0)|0;if(y=W+(E<<3)|0,b=y,M=u[b>>2]|0,b=u[b+4>>2]|0,(M|0)==0&(b|0)==0)break;J=J+1|0}me=y,u[me>>2]=A,u[me+4>>2]=h}if(g=g+1|0,(g|0)>=(d|0))break t;h=Ce+(g<<3)|0,A=u[h>>2]|0,h=u[h+4>>2]|0}}while(0);if((d+5|0)>>>0<11){de=99;break}if(ne=Ti((d|0)/6|0,8)|0,!ne){de=58;break}t:do if(ye){J=0,j=0;do{if(E=W+(J<<3)|0,A=E,g=u[A>>2]|0,A=u[A+4>>2]|0,!((g|0)==0&(A|0)==0)){b=ce(g|0,A|0,56)|0,z()|0,b=b&7,h=b+1|0,M=A&-117440513,me=ce(g|0,A|0,45)|0,z()|0;n:do if(Ue(me&127)|0){if(U=ce(g|0,A|0,52)|0,z()|0,U=U&15,U|0)for(y=1;;){if(me=_e(7,0,(15-y|0)*3|0)|0,!((g&me|0)==0&(M&(z()|0)|0)==0))break n;if(y>>>0<U>>>0)y=y+1|0;else break}A=_e(h|0,0,56)|0,g=A|g,A=z()|0|M,h=E,u[h>>2]=g,u[h+4>>2]=A,h=b+2|0}while(0);(h|0)==7&&(me=ne+(j<<3)|0,u[me>>2]=g,u[me+4>>2]=A&-117440513,j=j+1|0)}J=J+1|0}while((J|0)!=(d|0));if(ye){if(te=((d|0)<0)<<31>>31,U=_e(ae|0,0,52)|0,J=z()|0,ae>>>0>15)for(A=0,g=0;;){do if(!((B|0)==0&(_|0)==0)){for(b=ce(B|0,_|0,52)|0,z()|0,b=b&15,y=(b|0)<(ae|0),b=(b|0)==(ae|0),E=y?0:b?B:0,b=y?0:b?_:0,y=Ur(E|0,b|0,d|0,te|0)|0,z()|0,h=0;;){if((h|0)>(d|0)){de=98;break e}if(me=W+(y<<3)|0,M=u[me+4>>2]|0,(M&-117440513|0)==(b|0)&&(u[me>>2]|0)==(E|0)){de=70;break}if(y=(y+1|0)%(d|0)|0,me=W+(y<<3)|0,(u[me>>2]|0)==(E|0)&&(u[me+4>>2]|0)==(b|0))break;h=h+1|0}if((de|0)==70&&(de=0,!0&(M&117440512|0)==100663296))break;me=l+(g<<3)|0,u[me>>2]=B,u[me+4>>2]=_,g=g+1|0}while(0);if(A=A+1|0,(A|0)>=(d|0)){d=j;break t}_=Ce+(A<<3)|0,B=u[_>>2]|0,_=u[_+4>>2]|0}for(A=0,g=0;;){do if(!((B|0)==0&(_|0)==0)){if(b=ce(B|0,_|0,52)|0,z()|0,b=b&15,(b|0)>=(ae|0))if((b|0)!=(ae|0))if(h=B|U,y=_&-15728641|J,b>>>0<$>>>0)b=y;else{E=ae;do me=_e(7,0,(14-E|0)*3|0)|0,E=E+1|0,h=me|h,y=z()|0|y;while(E>>>0<b>>>0);b=y}else h=B,b=_;else h=0,b=0;for(E=Ur(h|0,b|0,d|0,te|0)|0,z()|0,y=0;;){if((y|0)>(d|0)){de=98;break e}if(me=W+(E<<3)|0,M=u[me+4>>2]|0,(M&-117440513|0)==(b|0)&&(u[me>>2]|0)==(h|0)){de=93;break}if(E=(E+1|0)%(d|0)|0,me=W+(E<<3)|0,(u[me>>2]|0)==(h|0)&&(u[me+4>>2]|0)==(b|0))break;y=y+1|0}if((de|0)==93&&(de=0,!0&(M&117440512|0)==100663296))break;me=l+(g<<3)|0,u[me>>2]=B,u[me+4>>2]=_,g=g+1|0}while(0);if(A=A+1|0,(A|0)>=(d|0)){d=j;break t}_=Ce+(A<<3)|0,B=u[_>>2]|0,_=u[_+4>>2]|0}}else g=0,d=j}else g=0,d=0;while(0);if(Ci(W|0,0,Ee|0)|0,Dc(Ce|0,ne|0,d<<3|0)|0,Ge(ne),d)l=l+(g<<3)|0;else break}return(de|0)==41?(Ge(Ce),Ge(W),me=-1,me|0):(de|0)==51?(Ge(Ce),Ge(W),me=-2,me|0):(de|0)==58?(Ge(Ce),Ge(W),me=-3,me|0):(de|0)==98?(Ge(ne),Ge(Ce),Ge(W),me=-1,me|0):((de|0)==99&&Dc(l|0,Ce|0,d<<3|0)|0,Ge(Ce),Ge(W),me=0,me|0)}function GP(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0,E=0,b=0,M=0,B=0;if((l|0)<=0)return g=0,g|0;if((g|0)>=16){for(y=0;;){if(B=A+(y<<3)|0,!((u[B>>2]|0)==0&(u[B+4>>2]|0)==0)){y=14;break}if(y=y+1|0,(y|0)>=(l|0)){_=0,y=16;break}}if((y|0)==14)return((d|0)>0?-2:-1)|0;if((y|0)==16)return _|0}y=0,B=0;e:for(;;){M=A+(B<<3)|0,E=M,_=u[E>>2]|0,E=u[E+4>>2]|0;do if(!((_|0)==0&(E|0)==0)){if((y|0)>=(d|0)){_=-1,y=16;break e}if(b=ce(_|0,E|0,52)|0,z()|0,b=b&15,(b|0)>(g|0)){_=-2,y=16;break e}if((b|0)==(g|0)){M=h+(y<<3)|0,u[M>>2]=_,u[M+4>>2]=E,y=y+1|0;break}if(_=(Rc(7,g-b|0)|0)+y|0,(_|0)>(d|0)){_=-1,y=16;break e}Pn(u[M>>2]|0,u[M+4>>2]|0,g,h+(y<<3)|0),y=_}while(0);if(B=B+1|0,(B|0)>=(l|0)){_=0,y=16;break}}return(y|0)==16?_|0:0}function zP(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0;if((l|0)<=0)return h=0,h|0;if((h|0)>=16){for(d=0;;){if(_=A+(d<<3)|0,!((u[_>>2]|0)==0&(u[_+4>>2]|0)==0)){d=-1,g=13;break}if(d=d+1|0,(d|0)>=(l|0)){d=0,g=13;break}}if((g|0)==13)return d|0}d=0,_=0;e:for(;;){g=A+(_<<3)|0,y=u[g>>2]|0,g=u[g+4>>2]|0;do if(!((y|0)==0&(g|0)==0)){if(g=ce(y|0,g|0,52)|0,z()|0,g=g&15,(g|0)>(h|0)){d=-1,g=13;break e}if((g|0)==(h|0)){d=d+1|0;break}else{d=(Rc(7,h-g|0)|0)+d|0;break}}while(0);if(_=_+1|0,(_|0)>=(l|0)){g=13;break}}return(g|0)==13?d|0:0}function VP(A,l){return A=A|0,l=l|0,l=ce(A|0,l|0,52)|0,z()|0,l&1|0}function Mn(A,l){A=A|0,l=l|0;var h=0,d=0,g=0;if(g=ce(A|0,l|0,52)|0,z()|0,g=g&15,!g)return g=0,g|0;for(d=1;;){if(h=ce(A|0,l|0,(15-d|0)*3|0)|0,z()|0,h=h&7,h|0){d=5;break}if(d>>>0<g>>>0)d=d+1|0;else{h=0,d=5;break}}return(d|0)==5?h|0:0}function cd(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0;if(b=ce(A|0,l|0,52)|0,z()|0,b=b&15,!b)return E=l,b=A,Pe(E|0),b|0;for(E=1,h=0;;){y=(15-E|0)*3|0,d=_e(7,0,y|0)|0,g=z()|0,_=ce(A|0,l|0,y|0)|0,z()|0,y=_e(Bs(_&7)|0,0,y|0)|0,_=z()|0,A=y|A&~d,l=_|l&~g;e:do if(!h)if((y&d|0)==0&(_&g|0)==0)h=0;else if(d=ce(A|0,l|0,52)|0,z()|0,d=d&15,!d)h=1;else{h=1;t:for(;;){switch(_=ce(A|0,l|0,(15-h|0)*3|0)|0,z()|0,_&7){case 1:break t;case 0:break;default:{h=1;break e}}if(h>>>0<d>>>0)h=h+1|0;else{h=1;break e}}for(h=1;;)if(_=(15-h|0)*3|0,g=ce(A|0,l|0,_|0)|0,z()|0,y=_e(7,0,_|0)|0,l=l&~(z()|0),_=_e(Bs(g&7)|0,0,_|0)|0,A=A&~y|_,l=l|(z()|0),h>>>0<d>>>0)h=h+1|0;else{h=1;break}}while(0);if(E>>>0<b>>>0)E=E+1|0;else break}return Pe(l|0),A|0}function Nr(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0;if(d=ce(A|0,l|0,52)|0,z()|0,d=d&15,!d)return h=l,d=A,Pe(h|0),d|0;for(h=1;y=(15-h|0)*3|0,_=ce(A|0,l|0,y|0)|0,z()|0,g=_e(7,0,y|0)|0,l=l&~(z()|0),y=_e(Bs(_&7)|0,0,y|0)|0,A=y|A&~g,l=z()|0|l,h>>>0<d>>>0;)h=h+1|0;return Pe(l|0),A|0}function HP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0;if(b=ce(A|0,l|0,52)|0,z()|0,b=b&15,!b)return E=l,b=A,Pe(E|0),b|0;for(E=1,h=0;;){y=(15-E|0)*3|0,d=_e(7,0,y|0)|0,g=z()|0,_=ce(A|0,l|0,y|0)|0,z()|0,y=_e(kr(_&7)|0,0,y|0)|0,_=z()|0,A=y|A&~d,l=_|l&~g;e:do if(!h)if((y&d|0)==0&(_&g|0)==0)h=0;else if(d=ce(A|0,l|0,52)|0,z()|0,d=d&15,!d)h=1;else{h=1;t:for(;;){switch(_=ce(A|0,l|0,(15-h|0)*3|0)|0,z()|0,_&7){case 1:break t;case 0:break;default:{h=1;break e}}if(h>>>0<d>>>0)h=h+1|0;else{h=1;break e}}for(h=1;;)if(g=(15-h|0)*3|0,y=_e(7,0,g|0)|0,_=l&~(z()|0),l=ce(A|0,l|0,g|0)|0,z()|0,l=_e(kr(l&7)|0,0,g|0)|0,A=A&~y|l,l=_|(z()|0),h>>>0<d>>>0)h=h+1|0;else{h=1;break}}while(0);if(E>>>0<b>>>0)E=E+1|0;else break}return Pe(l|0),A|0}function ud(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0;if(d=ce(A|0,l|0,52)|0,z()|0,d=d&15,!d)return h=l,d=A,Pe(h|0),d|0;for(h=1;_=(15-h|0)*3|0,y=_e(7,0,_|0)|0,g=l&~(z()|0),l=ce(A|0,l|0,_|0)|0,z()|0,l=_e(kr(l&7)|0,0,_|0)|0,A=l|A&~y,l=z()|0|g,h>>>0<d>>>0;)h=h+1|0;return Pe(l|0),A|0}function jP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0;if(b=k,k=k+64|0,E=b+40|0,d=b+24|0,g=b+12|0,y=b,_e(l|0,0,52)|0,h=z()|0|134225919,!l)return(u[A+4>>2]|0)>2||(u[A+8>>2]|0)>2||(u[A+12>>2]|0)>2?(_=0,E=0,Pe(_|0),k=b,E|0):(_e(Hn(A)|0,0,45)|0,_=z()|0|h,E=-1,Pe(_|0),k=b,E|0);if(u[E>>2]=u[A>>2],u[E+4>>2]=u[A+4>>2],u[E+8>>2]=u[A+8>>2],u[E+12>>2]=u[A+12>>2],_=E+4|0,(l|0)>0)for(A=-1;u[d>>2]=u[_>>2],u[d+4>>2]=u[_+4>>2],u[d+8>>2]=u[_+8>>2],l&1?(g_(_),u[g>>2]=u[_>>2],u[g+4>>2]=u[_+4>>2],u[g+8>>2]=u[_+8>>2],Ic(g)):(ad(_),u[g>>2]=u[_>>2],u[g+4>>2]=u[_+4>>2],u[g+8>>2]=u[_+8>>2],Is(g)),od(d,g,y),cn(y),B=(15-l|0)*3|0,M=_e(7,0,B|0)|0,h=h&~(z()|0),B=_e(Mc(y)|0,0,B|0)|0,A=B|A&~M,h=z()|0|h,(l|0)>1;)l=l+-1|0;else A=-1;e:do if((u[_>>2]|0)<=2&&(u[E+8>>2]|0)<=2&&(u[E+12>>2]|0)<=2){if(d=Hn(E)|0,l=_e(d|0,0,45)|0,l=l|A,A=z()|0|h&-1040385,y=oP(E)|0,!(Ue(d)|0)){if((y|0)<=0)break;for(g=0;;){if(d=ce(l|0,A|0,52)|0,z()|0,d=d&15,d)for(h=1;B=(15-h|0)*3|0,E=ce(l|0,A|0,B|0)|0,z()|0,M=_e(7,0,B|0)|0,A=A&~(z()|0),B=_e(Bs(E&7)|0,0,B|0)|0,l=l&~M|B,A=A|(z()|0),h>>>0<d>>>0;)h=h+1|0;if(g=g+1|0,(g|0)==(y|0))break e}}g=ce(l|0,A|0,52)|0,z()|0,g=g&15;t:do if(g){h=1;n:for(;;){switch(B=ce(l|0,A|0,(15-h|0)*3|0)|0,z()|0,B&7){case 1:break n;case 0:break;default:break t}if(h>>>0<g>>>0)h=h+1|0;else break t}if(u_(d,u[E>>2]|0)|0)for(h=1;E=(15-h|0)*3|0,M=_e(7,0,E|0)|0,B=A&~(z()|0),A=ce(l|0,A|0,E|0)|0,z()|0,A=_e(kr(A&7)|0,0,E|0)|0,l=l&~M|A,A=B|(z()|0),h>>>0<g>>>0;)h=h+1|0;else for(h=1;B=(15-h|0)*3|0,E=ce(l|0,A|0,B|0)|0,z()|0,M=_e(7,0,B|0)|0,A=A&~(z()|0),B=_e(Bs(E&7)|0,0,B|0)|0,l=l&~M|B,A=A|(z()|0),h>>>0<g>>>0;)h=h+1|0}while(0);if((y|0)>0){h=0;do l=cd(l,A)|0,A=z()|0,h=h+1|0;while((h|0)!=(y|0))}}else l=0,A=0;while(0);return M=A,B=l,Pe(M|0),k=b,B|0}function ai(A){return A=A|0,(A|0)%2|0|0}function x_(A,l){A=A|0,l=l|0;var h=0,d=0;return d=k,k=k+16|0,h=d,l>>>0<=15&&(u[A+4>>2]&2146435072|0)!=2146435072&&(u[A+8+4>>2]&2146435072|0)!=2146435072?(mP(A,l,h),l=jP(h,l)|0,A=z()|0):(A=0,l=0),Pe(A|0),k=d,l|0}function hd(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0;if(g=h+4|0,y=ce(A|0,l|0,52)|0,z()|0,y=y&15,_=ce(A|0,l|0,45)|0,z()|0,d=(y|0)==0,Ue(_&127)|0){if(d)return _=1,_|0;d=1}else{if(d)return _=0,_|0;(u[g>>2]|0)==0&&(u[h+8>>2]|0)==0?d=(u[h+12>>2]|0)!=0&1:d=1}for(h=1;h&1?Ic(g):Is(g),_=ce(A|0,l|0,(15-h|0)*3|0)|0,z()|0,p_(g,_&7),h>>>0<y>>>0;)h=h+1|0;return d|0}function hA(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0;B=k,k=k+16|0,b=B,M=ce(A|0,l|0,45)|0,z()|0,M=M&127;e:do if((Ue(M)|0)!=0&&(y=ce(A|0,l|0,52)|0,z()|0,y=y&15,(y|0)!=0)){d=1;t:for(;;){switch(E=ce(A|0,l|0,(15-d|0)*3|0)|0,z()|0,E&7){case 5:break t;case 0:break;default:{d=l;break e}}if(d>>>0<y>>>0)d=d+1|0;else{d=l;break e}}for(g=1,d=l;l=(15-g|0)*3|0,_=_e(7,0,l|0)|0,E=d&~(z()|0),d=ce(A|0,d|0,l|0)|0,z()|0,d=_e(kr(d&7)|0,0,l|0)|0,A=A&~_|d,d=E|(z()|0),g>>>0<y>>>0;)g=g+1|0}else d=l;while(0);if(E=7728+(M*28|0)|0,u[h>>2]=u[E>>2],u[h+4>>2]=u[E+4>>2],u[h+8>>2]=u[E+8>>2],u[h+12>>2]=u[E+12>>2],!(hd(A,d,h)|0)){k=B;return}if(_=h+4|0,u[b>>2]=u[_>>2],u[b+4>>2]=u[_+4>>2],u[b+8>>2]=u[_+8>>2],y=ce(A|0,d|0,52)|0,z()|0,E=y&15,y&1?(Is(_),y=E+1|0):y=E,!(Ue(M)|0))d=0;else{e:do if(!E)d=0;else for(l=1;;){if(g=ce(A|0,d|0,(15-l|0)*3|0)|0,z()|0,g=g&7,g|0){d=g;break e}if(l>>>0<E>>>0)l=l+1|0;else{d=0;break}}while(0);d=(d|0)==4&1}if(!(So(h,y,d,0)|0))(y|0)!=(E|0)&&(u[_>>2]=u[b>>2],u[_+4>>2]=u[b+4>>2],u[_+8>>2]=u[b+8>>2]);else{if(Ue(M)|0)do;while((So(h,y,0,0)|0)!=0);(y|0)!=(E|0)&&ad(_)}k=B}function Ls(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0;d=k,k=k+16|0,g=d,hA(A,l,g),l=ce(A|0,l|0,52)|0,z()|0,yP(g,l&15,h),k=d}function Rs(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0;_=k,k=k+16|0,y=_,hA(A,l,y),d=ce(A|0,l|0,45)|0,z()|0,d=(Ue(d&127)|0)==0,g=ce(A|0,l|0,52)|0,z()|0,g=g&15;e:do if(!d){if(g|0)for(d=1;;){if(E=_e(7,0,(15-d|0)*3|0)|0,!((E&A|0)==0&((z()|0)&l|0)==0))break e;if(d>>>0<g>>>0)d=d+1|0;else break}E_(y,g,0,5,h),k=_;return}while(0);T_(y,g,0,6,h),k=_}function WP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0;if(d=ce(A|0,l|0,45)|0,z()|0,!(Ue(d&127)|0))return d=2,d|0;if(d=ce(A|0,l|0,52)|0,z()|0,d=d&15,!d)return d=5,d|0;for(h=1;;){if(g=_e(7,0,(15-h|0)*3|0)|0,!((g&A|0)==0&((z()|0)&l|0)==0)){h=2,A=6;break}if(h>>>0<d>>>0)h=h+1|0;else{h=5,A=6;break}}return(A|0)==6?h|0:0}function P_(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0;U=k,k=k+128|0,M=U+112|0,y=U+96|0,B=U,g=ce(A|0,l|0,52)|0,z()|0,E=g&15,u[M>>2]=E,_=ce(A|0,l|0,45)|0,z()|0,_=_&127;e:do if(Ue(_)|0){if(E|0)for(d=1;;){if(b=_e(7,0,(15-d|0)*3|0)|0,!((b&A|0)==0&((z()|0)&l|0)==0)){g=0;break e}if(d>>>0<E>>>0)d=d+1|0;else break}if(g&1)g=1;else{b=_e(E+1|0,0,52)|0,B=z()|0|l&-15728641,M=_e(7,0,(14-E|0)*3|0)|0,P_((b|A)&~M,B&~(z()|0),h),k=U;return}}else g=0;while(0);hA(A,l,y),g?(w_(y,M,B),b=5):(C_(y,M,B),b=6);e:do if(Ue(_)|0)if(!E)d=20;else for(d=1;;){if(_=_e(7,0,(15-d|0)*3|0)|0,!((_&A|0)==0&((z()|0)&l|0)==0)){d=8;break e}if(d>>>0<E>>>0)d=d+1|0;else{d=20;break}}else d=8;while(0);if(Ci(h|0,-1,d|0)|0,g){g=0;do{for(y=B+(g<<4)|0,vP(y,u[M>>2]|0)|0,y=u[y>>2]|0,d=0;_=h+(d<<2)|0,E=u[_>>2]|0,!((E|0)==-1|(E|0)==(y|0));)d=d+1|0;u[_>>2]=y,g=g+1|0}while((g|0)!=(b|0))}else{g=0;do{for(y=B+(g<<4)|0,So(y,u[M>>2]|0,0,1)|0,y=u[y>>2]|0,d=0;_=h+(d<<2)|0,E=u[_>>2]|0,!((E|0)==-1|(E|0)==(y|0));)d=d+1|0;u[_>>2]=y,g=g+1|0}while((g|0)!=(b|0))}k=U}function QP(){return 12}function fd(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0;if(_e(A|0,0,52)|0,E=z()|0|134225919,(A|0)<1){d=0,h=0;do Ue(d)|0&&(_e(d|0,0,45)|0,_=E|(z()|0),A=l+(h<<3)|0,u[A>>2]=-1,u[A+4>>2]=_,h=h+1|0),d=d+1|0;while((d|0)!=122);return}_=0,h=0;do{if(Ue(_)|0){for(_e(_|0,0,45)|0,d=1,g=-1,y=E|(z()|0);b=_e(7,0,(15-d|0)*3|0)|0,g=g&~b,y=y&~(z()|0),(d|0)!=(A|0);)d=d+1|0;b=l+(h<<3)|0,u[b>>2]=g,u[b+4>>2]=y,h=h+1|0}_=_+1|0}while((_|0)!=122)}function M_(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0,E=0,b=0,M=0;if(E=k,k=k+64|0,_=E,(A|0)==(h|0)&(l|0)==(d|0)|(!1|(l&2013265920|0)!=134217728|(!1|(d&2013265920|0)!=134217728))||(g=ce(A|0,l|0,52)|0,z()|0,g=g&15,y=ce(h|0,d|0,52)|0,z()|0,(g|0)!=(y&15|0)))return _=0,k=E,_|0;if(y=g+-1|0,g>>>0>1&&(M=ld(A,l,y)|0,b=z()|0,y=ld(h,d,y)|0,(M|0)==(y|0)&(b|0)==(z()|0))&&(y=(g^15)*3|0,g=ce(A|0,l|0,y|0)|0,z()|0,g=g&7,y=ce(h|0,d|0,y|0)|0,z()|0,y=y&7,(g|0)==0|(y|0)==0||(u[21136+(g<<2)>>2]|0)==(y|0)||(u[21168+(g<<2)>>2]|0)==(y|0)))return M=1,k=E,M|0;g=_,y=g+56|0;do u[g>>2]=0,g=g+4|0;while((g|0)<(y|0));return bo(A,l,1,_),M=_,!((u[M>>2]|0)==(h|0)&&(u[M+4>>2]|0)==(d|0))&&(M=_+8|0,!((u[M>>2]|0)==(h|0)&&(u[M+4>>2]|0)==(d|0)))&&(M=_+16|0,!((u[M>>2]|0)==(h|0)&&(u[M+4>>2]|0)==(d|0)))&&(M=_+24|0,!((u[M>>2]|0)==(h|0)&&(u[M+4>>2]|0)==(d|0)))&&(M=_+32|0,!((u[M>>2]|0)==(h|0)&&(u[M+4>>2]|0)==(d|0)))&&(M=_+40|0,!((u[M>>2]|0)==(h|0)&&(u[M+4>>2]|0)==(d|0)))?(g=_+48|0,g=((u[g>>2]|0)==(h|0)?(u[g+4>>2]|0)==(d|0):0)&1):g=1,M=g,k=E,M|0}function XP(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0,E=0,b=0,M=0,B=0;if(M=k,k=k+16|0,_=M,!(M_(A,l,h,d)|0))return E=0,b=0,Pe(E|0),k=M,b|0;for(E=l&-2130706433,g=(Xt(A,l)|0)==0,g=g?1:2;u[_>>2]=0,B=L(A,l,g,_)|0,y=g+1|0,!((B|0)==(h|0)&(z()|0)==(d|0));)if(y>>>0<7)g=y;else{g=0,A=0,b=6;break}return(b|0)==6?(Pe(g|0),k=M,A|0):(B=_e(g|0,0,56)|0,b=E|(z()|0)|268435456,B=A|B,Pe(b|0),k=M,B|0)}function JP(A,l){A=A|0,l=l|0;var h=0;return h=!0&(l&2013265920|0)==268435456,Pe((h?l&-2130706433|134217728:0)|0),(h?A:0)|0}function YP(A,l){A=A|0,l=l|0;var h=0,d=0,g=0;return d=k,k=k+16|0,h=d,!0&(l&2013265920|0)==268435456?(g=ce(A|0,l|0,56)|0,z()|0,u[h>>2]=0,h=L(A,l&-2130706433|134217728,g&7,h)|0,l=z()|0,Pe(l|0),k=d,h|0):(l=0,h=0,Pe(l|0),k=d,h|0)}function KP(A,l){A=A|0,l=l|0;var h=0;if(!(!0&(l&2013265920|0)==268435456))return h=0,h|0;switch(h=ce(A|0,l|0,56)|0,z()|0,h&7){case 0:case 7:return h=0,h|0}return h=l&-2130706433|134217728,!0&(l&117440512|0)==16777216&(Xt(A,h)|0)!=0?(h=0,h|0):(h=S_(A,h)|0,h|0)}function ZP(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0;y=k,k=k+16|0,d=y,_=!0&(l&2013265920|0)==268435456,g=l&-2130706433|134217728,E=h,u[E>>2]=_?A:0,u[E+4>>2]=_?g:0,_?(l=ce(A|0,l|0,56)|0,z()|0,u[d>>2]=0,A=L(A,g,l&7,d)|0,l=z()|0):(A=0,l=0),E=h+8|0,u[E>>2]=A,u[E+4>>2]=l,k=y}function qP(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0;g=(Xt(A,l)|0)==0,l=l&-2130706433,d=h,u[d>>2]=g?A:0,u[d+4>>2]=g?l|285212672:0,d=h+8|0,u[d>>2]=A,u[d+4>>2]=l|301989888,d=h+16|0,u[d>>2]=A,u[d+4>>2]=l|318767104,d=h+24|0,u[d>>2]=A,u[d+4>>2]=l|335544320,d=h+32|0,u[d>>2]=A,u[d+4>>2]=l|352321536,h=h+40|0,u[h>>2]=A,u[h+4>>2]=l|369098752}function Lc(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0;if(_=k,k=k+16|0,y=_,d=ce(A|0,l|0,56)|0,z()|0,E=!0&(l&2013265920|0)==268435456,g=E?A:0,A=E?l&-2130706433|134217728:0,l=yM(g,A,d&7)|0,(l|0)==-1){u[h>>2]=0,k=_;return}hA(g,A,y),d=ce(g|0,A|0,52)|0,z()|0,d=d&15,Xt(g,A)|0?E_(y,d,l,2,h):T_(y,d,l,2,h),k=_}function $P(A){A=A|0;var l=0,h=0,d=0;return l=Ti(1,12)|0,l||tt(22691,22646,49,22704),h=A+4|0,d=u[h>>2]|0,d|0?(d=d+8|0,u[d>>2]=l,u[h>>2]=l,l|0):(u[A>>2]|0&&tt(22721,22646,61,22744),d=A,u[d>>2]=l,u[h>>2]=l,l|0)}function eM(A,l){A=A|0,l=l|0;var h=0,d=0;return d=Hi(24)|0,d||tt(22758,22646,78,22772),u[d>>2]=u[l>>2],u[d+4>>2]=u[l+4>>2],u[d+8>>2]=u[l+8>>2],u[d+12>>2]=u[l+12>>2],u[d+16>>2]=0,l=A+4|0,h=u[l>>2]|0,h|0?(u[h+16>>2]=d,u[l>>2]=d,d|0):(u[A>>2]|0&&tt(22787,22646,82,22772),u[A>>2]=d,u[l>>2]=d,d|0)}function tM(A){A=A|0;var l=0,h=0,d=0,g=0;if(!!A)for(d=1;;){if(l=u[A>>2]|0,l|0)do{if(h=u[l>>2]|0,h|0)do g=h,h=u[h+16>>2]|0,Ge(g);while((h|0)!=0);g=l,l=u[l+8>>2]|0,Ge(g)}while((l|0)!=0);if(l=A,A=u[A+8>>2]|0,d||Ge(l),A)d=0;else break}}function I_(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0,Ce=0,de=0,me=0,Ne=0,At=0,st=0,ht=0,nt=0,dt=0,gt=0,Oe=0;if(g=A+8|0,u[g>>2]|0)return Oe=1,Oe|0;if(d=u[A>>2]|0,!d)return Oe=0,Oe|0;l=d,h=0;do h=h+1|0,l=u[l+8>>2]|0;while((l|0)!=0);if(h>>>0<2)return Oe=0,Oe|0;dt=Hi(h<<2)|0,dt||tt(22807,22646,317,22826),nt=Hi(h<<5)|0,nt||tt(22848,22646,321,22826),u[A>>2]=0,Ce=A+4|0,u[Ce>>2]=0,u[g>>2]=0,h=0,ht=0,Ee=0,U=0;e:for(;;){if(B=u[d>>2]|0,B){y=0,_=B;do{if(b=+N[_+8>>3],l=_,_=u[_+16>>2]|0,M=(_|0)==0,g=M?B:_,E=+N[g+8>>3],+Ve(+(b-E))>3.141592653589793){Oe=14;break}y=y+(E-b)*(+N[l>>3]+ +N[g>>3])}while(!M);if((Oe|0)==14){Oe=0,y=0,l=B;do W=+N[l+8>>3],st=l+16|0,At=u[st>>2]|0,At=(At|0)==0?B:At,ae=+N[At+8>>3],y=y+(+N[l>>3]+ +N[At>>3])*((ae<0?ae+6.283185307179586:ae)-(W<0?W+6.283185307179586:W)),l=u[((l|0)==0?d:st)>>2]|0;while((l|0)!=0)}y>0?(u[dt+(ht<<2)>>2]=d,ht=ht+1|0,g=Ee,l=U):Oe=19}else Oe=19;if((Oe|0)==19){Oe=0;do if(h){if(l=h+8|0,u[l>>2]|0){Oe=21;break e}if(h=Ti(1,12)|0,!h){Oe=23;break e}u[l>>2]=h,g=h+4|0,_=h,l=U}else if(U){g=Ce,_=U+8|0,l=d,h=A;break}else if(u[A>>2]|0){Oe=27;break e}else{g=Ce,_=A,l=d,h=A;break}while(0);if(u[_>>2]=d,u[g>>2]=d,_=nt+(Ee<<5)|0,M=u[d>>2]|0,M){for(B=nt+(Ee<<5)+8|0,N[B>>3]=17976931348623157e292,U=nt+(Ee<<5)+24|0,N[U>>3]=17976931348623157e292,N[_>>3]=-17976931348623157e292,j=nt+(Ee<<5)+16|0,N[j>>3]=-17976931348623157e292,ye=17976931348623157e292,$=-17976931348623157e292,g=0,J=M,b=17976931348623157e292,ne=17976931348623157e292,ue=-17976931348623157e292,E=-17976931348623157e292;y=+N[J>>3],W=+N[J+8>>3],J=u[J+16>>2]|0,te=(J|0)==0,ae=+N[(te?M:J)+8>>3],y<b&&(N[B>>3]=y,b=y),W<ne&&(N[U>>3]=W,ne=W),y>ue?N[_>>3]=y:y=ue,W>E&&(N[j>>3]=W,E=W),ye=W>0&W<ye?W:ye,$=W<0&W>$?W:$,g=g|+Ve(+(W-ae))>3.141592653589793,!te;)ue=y;g&&(N[j>>3]=$,N[U>>3]=ye)}else u[_>>2]=0,u[_+4>>2]=0,u[_+8>>2]=0,u[_+12>>2]=0,u[_+16>>2]=0,u[_+20>>2]=0,u[_+24>>2]=0,u[_+28>>2]=0;g=Ee+1|0}if(st=d+8|0,d=u[st>>2]|0,u[st>>2]=0,d)Ee=g,U=l;else{Oe=45;break}}if((Oe|0)==21)tt(22624,22646,35,22658);else if((Oe|0)==23)tt(22678,22646,37,22658);else if((Oe|0)==27)tt(22721,22646,61,22744);else if((Oe|0)==45){e:do if((ht|0)>0){for(st=(g|0)==0,Ne=g<<2,At=(A|0)==0,me=0,l=0;;){if(de=u[dt+(me<<2)>>2]|0,st)Oe=73;else{if(Ee=Hi(Ne)|0,!Ee){Oe=50;break}if(Ce=Hi(Ne)|0,!Ce){Oe=52;break}t:do if(At)h=0;else{for(g=0,h=0,_=A;d=nt+(g<<5)|0,B_(u[_>>2]|0,d,u[de>>2]|0)|0?(u[Ee+(h<<2)>>2]=_,u[Ce+(h<<2)>>2]=d,te=h+1|0):te=h,_=u[_+8>>2]|0,_;)g=g+1|0,h=te;if((te|0)>0)if(d=u[Ee>>2]|0,(te|0)==1)h=d;else for(j=0,J=-1,h=d,U=d;;){for(M=u[U>>2]|0,d=0,_=0;g=u[u[Ee+(_<<2)>>2]>>2]|0,(g|0)==(M|0)?B=d:B=d+((B_(g,u[Ce+(_<<2)>>2]|0,u[M>>2]|0)|0)&1)|0,_=_+1|0,(_|0)!=(te|0);)d=B;if(g=(B|0)>(J|0),h=g?U:h,d=j+1|0,(d|0)==(te|0))break t;j=d,J=g?B:J,U=u[Ee+(d<<2)>>2]|0}else h=0}while(0);if(Ge(Ee),Ge(Ce),h){if(g=h+4|0,d=u[g>>2]|0,d)h=d+8|0;else if(u[h>>2]|0){Oe=70;break}u[h>>2]=de,u[g>>2]=de}else Oe=73}if((Oe|0)==73){if(Oe=0,l=u[de>>2]|0,l|0)do Ce=l,l=u[l+16>>2]|0,Ge(Ce);while((l|0)!=0);Ge(de),l=2}if(me=me+1|0,(me|0)>=(ht|0)){gt=l;break e}}(Oe|0)==50?tt(22863,22646,249,22882):(Oe|0)==52?tt(22901,22646,252,22882):(Oe|0)==70&&tt(22721,22646,61,22744)}else gt=0;while(0);return Ge(dt),Ge(nt),Oe=gt,Oe|0}return 0}function B_(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0;if(!(f_(l,h)|0)||(l=h_(l)|0,M=+N[h>>3],d=+N[h+8>>3],d=l&d<0?d+6.283185307179586:d,A=u[A>>2]|0,!A))return A=0,A|0;if(l){l=0,h=A;e:for(;;){for(;_=+N[h>>3],b=+N[h+8>>3],h=h+16|0,B=u[h>>2]|0,B=(B|0)==0?A:B,y=+N[B>>3],g=+N[B+8>>3],_>y?(E=_,_=b):(E=y,y=_,_=g,g=b),!!(M<y|M>E);)if(h=u[h>>2]|0,!h){h=22;break e}if(b=g<0?g+6.283185307179586:g,_=_<0?_+6.283185307179586:_,d=_==d|b==d?d+-2220446049250313e-31:d,b=b+(M-y)/(E-y)*(_-b),(b<0?b+6.283185307179586:b)>d&&(l=l^1),h=u[h>>2]|0,!h){h=22;break}}if((h|0)==22)return l|0}else{l=0,h=A;e:for(;;){for(;_=+N[h>>3],b=+N[h+8>>3],h=h+16|0,B=u[h>>2]|0,B=(B|0)==0?A:B,y=+N[B>>3],g=+N[B+8>>3],_>y?(E=_,_=b):(E=y,y=_,_=g,g=b),!!(M<y|M>E);)if(h=u[h>>2]|0,!h){h=22;break e}if(d=_==d|g==d?d+-2220446049250313e-31:d,g+(M-y)/(E-y)*(_-g)>d&&(l=l^1),h=u[h>>2]|0,!h){h=22;break}}if((h|0)==22)return l|0}return 0}function ur(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0;if($=k,k=k+32|0,ye=$+16|0,ue=$,y=ce(A|0,l|0,52)|0,z()|0,y=y&15,J=ce(h|0,d|0,52)|0,z()|0,(y|0)!=(J&15|0))return ye=1,k=$,ye|0;if(M=ce(A|0,l|0,45)|0,z()|0,M=M&127,B=ce(h|0,d|0,45)|0,z()|0,B=B&127,J=(M|0)!=(B|0),J){if(E=rd(M,B)|0,(E|0)==7)return ye=2,k=$,ye|0;b=rd(B,M)|0,(b|0)==7?tt(22925,22949,151,22959):(te=E,_=b)}else te=0,_=0;U=Ue(M)|0,j=Ue(B)|0,u[ye>>2]=0,u[ye+4>>2]=0,u[ye+8>>2]=0,u[ye+12>>2]=0;do if(te){if(B=u[4304+(M*28|0)+(te<<2)>>2]|0,E=(B|0)>0,j)if(E){M=0,b=h,E=d;do b=HP(b,E)|0,E=z()|0,_=kr(_)|0,(_|0)==1&&(_=kr(1)|0),M=M+1|0;while((M|0)!=(B|0));B=_,M=b,b=E}else B=_,M=h,b=d;else if(E){M=0,b=h,E=d;do b=ud(b,E)|0,E=z()|0,_=kr(_)|0,M=M+1|0;while((M|0)!=(B|0));B=_,M=b,b=E}else B=_,M=h,b=d;if(hd(M,b,ye)|0,J||tt(22972,22949,181,22959),E=(U|0)!=0,_=(j|0)!=0,E&_&&tt(22999,22949,182,22959),E){if(_=Mn(A,l)|0,Ie[22032+(_*7|0)+te>>0]|0){y=3;break}b=u[21200+(_*28|0)+(te<<2)>>2]|0,M=b,ne=26}else if(_){if(_=Mn(M,b)|0,Ie[22032+(_*7|0)+B>>0]|0){y=4;break}M=0,b=u[21200+(B*28|0)+(_<<2)>>2]|0,ne=26}else _=0;if((ne|0)==26)if((b|0)<=-1&&tt(23030,22949,212,22959),(M|0)<=-1&&tt(23053,22949,213,22959),(b|0)>0){E=ye+4|0,_=0;do Bc(E),_=_+1|0;while((_|0)!=(b|0));_=M}else _=M;if(u[ue>>2]=0,u[ue+4>>2]=0,u[ue+8>>2]=0,p_(ue,te),y|0)for(;ai(y)|0?Ic(ue):Is(ue),(y|0)>1;)y=y+-1|0;if((_|0)>0){y=0;do Bc(ue),y=y+1|0;while((y|0)!=(_|0))}ne=ye+4|0,wn(ne,ue,ne),cn(ne),ne=50}else if(hd(h,d,ye)|0,(U|0)!=0&(j|0)!=0)if((B|0)!=(M|0)&&tt(23077,22949,243,22959),_=Mn(A,l)|0,y=Mn(h,d)|0,Ie[22032+(_*7|0)+y>>0]|0)y=5;else if(_=u[21200+(_*28|0)+(y<<2)>>2]|0,(_|0)>0){E=ye+4|0,y=0;do Bc(E),y=y+1|0;while((y|0)!=(_|0));ne=50}else ne=50;else ne=50;while(0);return(ne|0)==50&&(y=ye+4|0,u[g>>2]=u[y>>2],u[g+4>>2]=u[y+4>>2],u[g+8>>2]=u[y+8>>2],y=0),ye=y,k=$,ye|0}function L_(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0;if(te=k,k=k+48|0,_=te+36|0,E=te+24|0,b=te+12|0,M=te,y=ce(A|0,l|0,52)|0,z()|0,y=y&15,j=ce(A|0,l|0,45)|0,z()|0,j=j&127,B=Ue(j)|0,_e(y|0,0,52)|0,ue=z()|0|134225919,ne=d,u[ne>>2]=-1,u[ne+4>>2]=ue,!y)return(u[h>>2]|0)>1||(u[h+4>>2]|0)>1||(u[h+8>>2]|0)>1||(g=id(j,Mc(h)|0)|0,(g|0)==127)?(ue=1,k=te,ue|0):(J=_e(g|0,0,45)|0,ne=z()|0,j=d,ne=u[j+4>>2]&-1040385|ne,ue=d,u[ue>>2]=u[j>>2]|J,u[ue+4>>2]=ne,ue=0,k=te,ue|0);for(u[_>>2]=u[h>>2],u[_+4>>2]=u[h+4>>2],u[_+8>>2]=u[h+8>>2];u[E>>2]=u[_>>2],u[E+4>>2]=u[_+4>>2],u[E+8>>2]=u[_+8>>2],ai(y)|0?(g_(_),u[b>>2]=u[_>>2],u[b+4>>2]=u[_+4>>2],u[b+8>>2]=u[_+8>>2],Ic(b)):(ad(_),u[b>>2]=u[_>>2],u[b+4>>2]=u[_+4>>2],u[b+8>>2]=u[_+8>>2],Is(b)),od(E,b,M),cn(M),ne=d,ye=u[ne>>2]|0,ne=u[ne+4>>2]|0,$=(15-y|0)*3|0,h=_e(7,0,$|0)|0,ne=ne&~(z()|0),$=_e(Mc(M)|0,0,$|0)|0,ne=z()|0|ne,ue=d,u[ue>>2]=$|ye&~h,u[ue+4>>2]=ne,(y|0)>1;)y=y+-1|0;e:do if((u[_>>2]|0)<=1&&(u[_+4>>2]|0)<=1&&(u[_+8>>2]|0)<=1){y=Mc(_)|0,E=id(j,y)|0,(E|0)==127?M=0:M=Ue(E)|0;t:do if(y){if(B){if(_=21408+((Mn(A,l)|0)*28|0)+(y<<2)|0,_=u[_>>2]|0,(_|0)>0){h=0;do y=Bs(y)|0,h=h+1|0;while((h|0)!=(_|0))}if((y|0)==1){g=3;break e}h=id(j,y)|0,(h|0)==127&&tt(23104,22949,376,23134),Ue(h)|0?tt(23147,22949,377,23134):(J=_,U=y,g=h)}else J=0,U=y,g=E;if(b=u[4304+(j*28|0)+(U<<2)>>2]|0,(b|0)<=-1&&tt(23178,22949,384,23134),!M){if((J|0)<=-1&&tt(23030,22949,417,23134),J|0){_=d,y=0,h=u[_>>2]|0,_=u[_+4>>2]|0;do h=Nr(h,_)|0,_=z()|0,$=d,u[$>>2]=h,u[$+4>>2]=_,y=y+1|0;while((y|0)<(J|0))}if((b|0)<=0){y=54;break}for(_=d,y=0,h=u[_>>2]|0,_=u[_+4>>2]|0;;)if(h=Nr(h,_)|0,_=z()|0,$=d,u[$>>2]=h,u[$+4>>2]=_,y=y+1|0,(y|0)==(b|0)){y=54;break t}}if(E=rd(g,j)|0,(E|0)==7&&tt(22925,22949,393,23134),y=d,h=u[y>>2]|0,y=u[y+4>>2]|0,(b|0)>0){_=0;do h=Nr(h,y)|0,y=z()|0,$=d,u[$>>2]=h,u[$+4>>2]=y,_=_+1|0;while((_|0)!=(b|0))}if(h=Mn(h,y)|0,$=Qt(g)|0,h=u[($?21824:21616)+(E*28|0)+(h<<2)>>2]|0,(h|0)<=-1&&tt(23030,22949,412,23134),!h)y=54;else{E=d,y=0,_=u[E>>2]|0,E=u[E+4>>2]|0;do _=cd(_,E)|0,E=z()|0,$=d,u[$>>2]=_,u[$+4>>2]=E,y=y+1|0;while((y|0)<(h|0));y=54}}else if((B|0)!=0&(M|0)!=0)if($=Mn(A,l)|0,y=d,y=21408+($*28|0)+((Mn(u[y>>2]|0,u[y+4>>2]|0)|0)<<2)|0,y=u[y>>2]|0,(y|0)<=-1&&tt(23201,22949,433,23134),!y)g=E,y=55;else{_=d,g=0,h=u[_>>2]|0,_=u[_+4>>2]|0;do h=Nr(h,_)|0,_=z()|0,$=d,u[$>>2]=h,u[$+4>>2]=_,g=g+1|0;while((g|0)<(y|0));g=E,y=54}else g=E,y=54;while(0);if((y|0)==54&&M&&(y=55),(y|0)==55&&($=d,(Mn(u[$>>2]|0,u[$+4>>2]|0)|0)==1)){g=4;break}$=d,ue=u[$>>2]|0,$=u[$+4>>2]&-1040385,ye=_e(g|0,0,45)|0,$=$|(z()|0),g=d,u[g>>2]=ue|ye,u[g+4>>2]=$,g=0}else g=2;while(0);return $=g,k=te,$|0}function nM(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0;return _=k,k=k+16|0,y=_,A=ur(A,l,h,d,y)|0,A||(dP(y,g),A=0),k=_,A|0}function iM(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0;return g=k,k=k+16|0,y=g,gP(h,y),d=L_(A,l,y,d)|0,k=g,d|0}function rM(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0;return _=k,k=k+32|0,g=_+12|0,y=_,(ur(A,l,A,l,g)|0)==0&&(ur(A,l,h,d,y)|0)==0?A=Ad(g,y)|0:A=-1,k=_,A|0}function sM(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0,_=0;return _=k,k=k+32|0,g=_+12|0,y=_,(ur(A,l,A,l,g)|0)==0&&(ur(A,l,h,d,y)|0)==0?A=Ad(g,y)|0:A=-1,k=_,(A>>>31^1)+A|0}function oM(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0,Ce=0;if(Ee=k,k=k+48|0,y=Ee+24|0,_=Ee+12|0,W=Ee,(ur(A,l,A,l,y)|0)==0&&(ur(A,l,h,d,_)|0)==0){if(ae=Ad(y,_)|0,(ae|0)<0)return W=ae,k=Ee,W|0;for(u[y>>2]=0,u[y+4>>2]=0,u[y+8>>2]=0,u[_>>2]=0,u[_+4>>2]=0,u[_+8>>2]=0,ur(A,l,A,l,y)|0,ur(A,l,h,d,_)|0,v_(y),v_(_),ae?(B=u[y>>2]|0,J=+(ae|0),ue=y+4|0,U=u[ue>>2]|0,ye=y+8|0,j=u[ye>>2]|0,$=y,h=B,d=U,y=j,te=+((u[_>>2]|0)-B|0)/J,ne=+((u[_+4>>2]|0)-U|0)/J,J=+((u[_+8>>2]|0)-j|0)/J):(d=y+4|0,j=y+8|0,ue=d,ye=j,$=y,h=u[y>>2]|0,d=u[d>>2]|0,y=u[j>>2]|0,te=0,ne=0,J=0),u[W>>2]=h,j=W+4|0,u[j>>2]=d,U=W+8|0,u[U>>2]=y,B=0;;){b=+(B|0),Ce=te*b+ +(h|0),E=ne*b+ +(u[ue>>2]|0),b=J*b+ +(u[ye>>2]|0),d=~~+Fc(+Ce),_=~~+Fc(+E),h=~~+Fc(+b),Ce=+Ve(+(+(d|0)-Ce)),E=+Ve(+(+(_|0)-E)),b=+Ve(+(+(h|0)-b));do if(Ce>E&Ce>b)d=0-(_+h)|0,y=_;else if(M=0-d|0,E>b){y=M-h|0;break}else{y=_,h=M-_|0;break}while(0);if(u[W>>2]=d,u[j>>2]=y,u[U>>2]=h,pP(W),L_(A,l,W,g+(B<<3)|0)|0,(B|0)==(ae|0))break;B=B+1|0,h=u[$>>2]|0}return W=0,k=Ee,W|0}return W=-1,k=Ee,W|0}function Rc(A,l){A=A|0,l=l|0;var h=0;if(!l)return h=1,h|0;h=A,A=1;do A=$t((l&1|0)==0?1:h,A)|0,l=l>>1,h=$t(h,h)|0;while((l|0)!=0);return A|0}function R_(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0;if(!(f_(l,h)|0)||(l=h_(l)|0,j=+N[h>>3],d=+N[h+8>>3],d=l&d<0?d+6.283185307179586:d,U=u[A>>2]|0,(U|0)<=0))return U=0,U|0;if(B=u[A+4>>2]|0,l){l=0,h=-1,A=0;e:for(;;){for(M=A;_=+N[B+(M<<4)>>3],b=+N[B+(M<<4)+8>>3],A=(h+2|0)%(U|0)|0,y=+N[B+(A<<4)>>3],g=+N[B+(A<<4)+8>>3],_>y?(E=_,_=b):(E=y,y=_,_=g,g=b),!!(j<y|j>E);)if(h=M+1|0,(h|0)<(U|0))A=M,M=h,h=A;else{h=22;break e}if(b=g<0?g+6.283185307179586:g,_=_<0?_+6.283185307179586:_,d=_==d|b==d?d+-2220446049250313e-31:d,b=b+(j-y)/(E-y)*(_-b),(b<0?b+6.283185307179586:b)>d&&(l=l^1),A=M+1|0,(A|0)>=(U|0)){h=22;break}else h=M}if((h|0)==22)return l|0}else{l=0,h=-1,A=0;e:for(;;){for(M=A;_=+N[B+(M<<4)>>3],b=+N[B+(M<<4)+8>>3],A=(h+2|0)%(U|0)|0,y=+N[B+(A<<4)>>3],g=+N[B+(A<<4)+8>>3],_>y?(E=_,_=b):(E=y,y=_,_=g,g=b),!!(j<y|j>E);)if(h=M+1|0,(h|0)<(U|0))A=M,M=h,h=A;else{h=22;break e}if(d=_==d|g==d?d+-2220446049250313e-31:d,g+(j-y)/(E-y)*(_-g)>d&&(l=l^1),A=M+1|0,(A|0)>=(U|0)){h=22;break}else h=M}if((h|0)==22)return l|0}return 0}function dd(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0;if(te=u[A>>2]|0,!te){u[l>>2]=0,u[l+4>>2]=0,u[l+8>>2]=0,u[l+12>>2]=0,u[l+16>>2]=0,u[l+20>>2]=0,u[l+24>>2]=0,u[l+28>>2]=0;return}if(ne=l+8|0,N[ne>>3]=17976931348623157e292,ue=l+24|0,N[ue>>3]=17976931348623157e292,N[l>>3]=-17976931348623157e292,ye=l+16|0,N[ye>>3]=-17976931348623157e292,!((te|0)<=0)){for(j=u[A+4>>2]|0,M=17976931348623157e292,B=-17976931348623157e292,U=0,A=-1,y=17976931348623157e292,_=17976931348623157e292,b=-17976931348623157e292,d=-17976931348623157e292,J=0;h=+N[j+(J<<4)>>3],E=+N[j+(J<<4)+8>>3],A=A+2|0,g=+N[j+(((A|0)==(te|0)?0:A)<<4)+8>>3],h<y&&(N[ne>>3]=h,y=h),E<_&&(N[ue>>3]=E,_=E),h>b?N[l>>3]=h:h=b,E>d&&(N[ye>>3]=E,d=E),M=E>0&E<M?E:M,B=E<0&E>B?E:B,U=U|+Ve(+(E-g))>3.141592653589793,A=J+1|0,(A|0)!=(te|0);)$=J,b=h,J=A,A=$;!U||(N[ye>>3]=B,N[ue>>3]=M)}}function aM(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0,Ce=0,de=0;if(te=u[A>>2]|0,te){if(ne=l+8|0,N[ne>>3]=17976931348623157e292,ue=l+24|0,N[ue>>3]=17976931348623157e292,N[l>>3]=-17976931348623157e292,ye=l+16|0,N[ye>>3]=-17976931348623157e292,(te|0)>0){for(g=u[A+4>>2]|0,j=17976931348623157e292,J=-17976931348623157e292,d=0,h=-1,b=17976931348623157e292,M=17976931348623157e292,U=-17976931348623157e292,_=-17976931348623157e292,$=0;y=+N[g+($<<4)>>3],B=+N[g+($<<4)+8>>3],Ce=h+2|0,E=+N[g+(((Ce|0)==(te|0)?0:Ce)<<4)+8>>3],y<b&&(N[ne>>3]=y,b=y),B<M&&(N[ue>>3]=B,M=B),y>U?N[l>>3]=y:y=U,B>_&&(N[ye>>3]=B,_=B),j=B>0&B<j?B:j,J=B<0&B>J?B:J,d=d|+Ve(+(B-E))>3.141592653589793,h=$+1|0,(h|0)!=(te|0);)Ce=$,U=y,$=h,h=Ce;d&&(N[ye>>3]=J,N[ue>>3]=j)}}else u[l>>2]=0,u[l+4>>2]=0,u[l+8>>2]=0,u[l+12>>2]=0,u[l+16>>2]=0,u[l+20>>2]=0,u[l+24>>2]=0,u[l+28>>2]=0;if(Ce=A+8|0,h=u[Ce>>2]|0,!((h|0)<=0)){Ee=A+12|0,W=0;do if(g=u[Ee>>2]|0,d=W,W=W+1|0,ue=l+(W<<5)|0,ye=u[g+(d<<3)>>2]|0,ye){if($=l+(W<<5)+8|0,N[$>>3]=17976931348623157e292,A=l+(W<<5)+24|0,N[A>>3]=17976931348623157e292,N[ue>>3]=-17976931348623157e292,ae=l+(W<<5)+16|0,N[ae>>3]=-17976931348623157e292,(ye|0)>0){for(te=u[g+(d<<3)+4>>2]|0,j=17976931348623157e292,J=-17976931348623157e292,g=0,d=-1,ne=0,b=17976931348623157e292,M=17976931348623157e292,B=-17976931348623157e292,_=-17976931348623157e292;y=+N[te+(ne<<4)>>3],U=+N[te+(ne<<4)+8>>3],d=d+2|0,E=+N[te+(((d|0)==(ye|0)?0:d)<<4)+8>>3],y<b&&(N[$>>3]=y,b=y),U<M&&(N[A>>3]=U,M=U),y>B?N[ue>>3]=y:y=B,U>_&&(N[ae>>3]=U,_=U),j=U>0&U<j?U:j,J=U<0&U>J?U:J,g=g|+Ve(+(U-E))>3.141592653589793,d=ne+1|0,(d|0)!=(ye|0);)de=ne,ne=d,B=y,d=de;g&&(N[ae>>3]=J,N[A>>3]=j)}}else u[ue>>2]=0,u[ue+4>>2]=0,u[ue+8>>2]=0,u[ue+12>>2]=0,u[ue+16>>2]=0,u[ue+20>>2]=0,u[ue+24>>2]=0,u[ue+28>>2]=0,h=u[Ce>>2]|0;while((W|0)<(h|0))}}function AM(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0;if(!(R_(A,l,h)|0))return g=0,g|0;if(g=A+8|0,(u[g>>2]|0)<=0)return g=1,g|0;for(d=A+12|0,A=0;;){if(y=A,A=A+1|0,R_((u[d>>2]|0)+(y<<3)|0,l+(A<<5)|0,h)|0){A=0,d=6;break}if((A|0)>=(u[g>>2]|0)){A=1,d=6;break}}return(d|0)==6?A|0:0}function lM(){return 8}function cM(){return 16}function uM(){return 168}function hM(){return 8}function fM(){return 16}function dM(){return 12}function gM(){return 8}function pM(A){A=A|0;var l=0,h=0;return h=+N[A>>3],l=+N[A+8>>3],+ +je(+(h*h+l*l))}function O_(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0;M=+N[A>>3],b=+N[l>>3]-M,E=+N[A+8>>3],_=+N[l+8>>3]-E,U=+N[h>>3],y=+N[d>>3]-U,j=+N[h+8>>3],B=+N[d+8>>3]-j,y=(y*(E-j)-(M-U)*B)/(b*B-_*y),N[g>>3]=M+b*y,N[g+8>>3]=E+_*y}function F_(A,l){return A=A|0,l=l|0,+N[A>>3]!=+N[l>>3]?(l=0,l|0):(l=+N[A+8>>3]==+N[l+8>>3],l|0)}function Gt(A,l){A=A|0,l=l|0;var h=0,d=0,g=0;return g=+N[A>>3]-+N[l>>3],d=+N[A+8>>3]-+N[l+8>>3],h=+N[A+16>>3]-+N[l+16>>3],+(g*g+d*d+h*h)}function mM(A,l){A=A|0,l=l|0;var h=0,d=0,g=0;h=+N[A>>3],d=+qe(+h),h=+Je(+h),N[l+16>>3]=h,h=+N[A+8>>3],g=d*+qe(+h),N[l>>3]=g,h=d*+Je(+h),N[l+8>>3]=h}function _M(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0;if(M=k,k=k+32|0,g=M+16|0,y=M,hA(A,l,g),_=b_(A,l)|0,b=Mn(A,l)|0,aP(_,y),l=AP(_,u[g>>2]|0)|0,!(Ue(_)|0))return b=l,k=M,b|0;do switch(_|0){case 4:{A=0,h=14;break}case 14:{A=1,h=14;break}case 24:{A=2,h=14;break}case 38:{A=3,h=14;break}case 49:{A=4,h=14;break}case 58:{A=5,h=14;break}case 63:{A=6,h=14;break}case 72:{A=7,h=14;break}case 83:{A=8,h=14;break}case 97:{A=9,h=14;break}case 107:{A=10,h=14;break}case 117:{A=11,h=14;break}default:E=0,d=0}while(0);return(h|0)==14&&(E=u[22096+(A*24|0)+8>>2]|0,d=u[22096+(A*24|0)+16>>2]|0),A=u[g>>2]|0,(A|0)!=(u[y>>2]|0)&&(_=Qt(_)|0,A=u[g>>2]|0,_|(A|0)==(d|0)&&(l=(l+1|0)%6|0)),(b|0)==3&(A|0)==(d|0)?(b=(l+5|0)%6|0,k=M,b|0):(b|0)==5&(A|0)==(E|0)?(b=(l+1|0)%6|0,k=M,b|0):(b=l,k=M,b|0)}function yM(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0;return d=Xt(A,l)|0,(h+-1|0)>>>0>5||(g=(d|0)!=0,(h|0)==1&g)?(h=-1,h|0):(d=_M(A,l)|0,g?(h=(5-d+(u[22384+(h<<2)>>2]|0)|0)%5|0,h|0):(h=(6-d+(u[22416+(h<<2)>>2]|0)|0)%6|0,h|0))}function D_(A,l,h){A=A|0,l=l|0,h=h|0;var d=0;(l|0)>0?(d=Ti(l,4)|0,u[A>>2]=d,d||tt(23230,23253,40,23267)):u[A>>2]=0,u[A+4>>2]=l,u[A+8>>2]=0,u[A+12>>2]=h}function k_(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0;g=A+4|0,y=A+12|0,_=A+8|0;e:for(;;){for(h=u[g>>2]|0,l=0;;){if((l|0)>=(h|0))break e;if(d=u[A>>2]|0,E=u[d+(l<<2)>>2]|0,!E)l=l+1|0;else break}l=d+(~~(+Ve(+(+_t(10,+ +(15-(u[y>>2]|0)|0))*(+N[E>>3]+ +N[E+8>>3])))%+(h|0))>>>0<<2)|0,h=u[l>>2]|0;t:do if(h|0){if(d=E+32|0,(h|0)==(E|0))u[l>>2]=u[d>>2];else{if(h=h+32|0,l=u[h>>2]|0,!l)break;for(;(l|0)!=(E|0);)if(h=l+32|0,l=u[h>>2]|0,!l)break t;u[h>>2]=u[d>>2]}Ge(E),u[_>>2]=(u[_>>2]|0)+-1}while(0)}Ge(u[A>>2]|0)}function N_(A){A=A|0;var l=0,h=0,d=0;for(d=u[A+4>>2]|0,h=0;;){if((h|0)>=(d|0)){l=0,h=4;break}if(l=u[(u[A>>2]|0)+(h<<2)>>2]|0,!l)h=h+1|0;else{h=4;break}}return(h|0)==4?l|0:0}function U_(A,l){A=A|0,l=l|0;var h=0,d=0,g=0,y=0;if(h=~~(+Ve(+(+_t(10,+ +(15-(u[A+12>>2]|0)|0))*(+N[l>>3]+ +N[l+8>>3])))%+(u[A+4>>2]|0))>>>0,h=(u[A>>2]|0)+(h<<2)|0,d=u[h>>2]|0,!d)return y=1,y|0;y=l+32|0;do if((d|0)!=(l|0)){if(h=u[d+32>>2]|0,!h)return y=1,y|0;for(g=h;;){if((g|0)==(l|0)){g=8;break}if(h=u[g+32>>2]|0,h)d=g,g=h;else{h=1,g=10;break}}if((g|0)==8){u[d+32>>2]=u[y>>2];break}else if((g|0)==10)return h|0}else u[h>>2]=u[y>>2];while(0);return Ge(l),y=A+8|0,u[y>>2]=(u[y>>2]|0)+-1,y=0,y|0}function vM(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0;y=Hi(40)|0,y||tt(23283,23253,98,23296),u[y>>2]=u[l>>2],u[y+4>>2]=u[l+4>>2],u[y+8>>2]=u[l+8>>2],u[y+12>>2]=u[l+12>>2],g=y+16|0,u[g>>2]=u[h>>2],u[g+4>>2]=u[h+4>>2],u[g+8>>2]=u[h+8>>2],u[g+12>>2]=u[h+12>>2],u[y+32>>2]=0,g=~~(+Ve(+(+_t(10,+ +(15-(u[A+12>>2]|0)|0))*(+N[l>>3]+ +N[l+8>>3])))%+(u[A+4>>2]|0))>>>0,g=(u[A>>2]|0)+(g<<2)|0,d=u[g>>2]|0;do if(!d)u[g>>2]=y;else{for(;!(xo(d,l)|0&&xo(d+16|0,h)|0);)if(g=u[d+32>>2]|0,d=(g|0)==0?d:g,!(u[d+32>>2]|0)){_=10;break}if((_|0)==10){u[d+32>>2]=y;break}return Ge(y),_=d,_|0}while(0);return _=A+8|0,u[_>>2]=(u[_>>2]|0)+1,_=y,_|0}function EM(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0;if(g=~~(+Ve(+(+_t(10,+ +(15-(u[A+12>>2]|0)|0))*(+N[l>>3]+ +N[l+8>>3])))%+(u[A+4>>2]|0))>>>0,g=u[(u[A>>2]|0)+(g<<2)>>2]|0,!g)return h=0,h|0;if(!h){for(A=g;;){if(xo(A,l)|0){d=10;break}if(A=u[A+32>>2]|0,!A){A=0,d=10;break}}if((d|0)==10)return A|0}for(A=g;;){if(xo(A,l)|0&&xo(A+16|0,h)|0){d=10;break}if(A=u[A+32>>2]|0,!A){A=0,d=10;break}}return(d|0)==10?A|0:0}function wM(A,l){A=A|0,l=l|0;var h=0;if(h=~~(+Ve(+(+_t(10,+ +(15-(u[A+12>>2]|0)|0))*(+N[l>>3]+ +N[l+8>>3])))%+(u[A+4>>2]|0))>>>0,A=u[(u[A>>2]|0)+(h<<2)>>2]|0,!A)return h=0,h|0;for(;;){if(xo(A,l)|0){l=5;break}if(A=u[A+32>>2]|0,!A){A=0,l=5;break}}return(l|0)==5?A|0:0}function TM(){return 23312}function CM(A){return A=+A,+ +V_(+A)}function Oc(A){return A=+A,~~+CM(A)|0}function Hi(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0,ne=0,ue=0,ye=0,$=0,ae=0,W=0,Ee=0;Ee=k,k=k+16|0,j=Ee;do if(A>>>0<245){if(M=A>>>0<11?16:A+11&-8,A=M>>>3,U=u[5829]|0,h=U>>>A,h&3|0)return l=(h&1^1)+A|0,A=23356+(l<<1<<2)|0,h=A+8|0,d=u[h>>2]|0,g=d+8|0,y=u[g>>2]|0,(y|0)==(A|0)?u[5829]=U&~(1<<l):(u[y+12>>2]=A,u[h>>2]=y),W=l<<3,u[d+4>>2]=W|3,W=d+W+4|0,u[W>>2]=u[W>>2]|1,W=g,k=Ee,W|0;if(B=u[5831]|0,M>>>0>B>>>0){if(h|0)return l=2<<A,l=h<<A&(l|0-l),l=(l&0-l)+-1|0,E=l>>>12&16,l=l>>>E,h=l>>>5&8,l=l>>>h,y=l>>>2&4,l=l>>>y,A=l>>>1&2,l=l>>>A,d=l>>>1&1,d=(h|E|y|A|d)+(l>>>d)|0,l=23356+(d<<1<<2)|0,A=l+8|0,y=u[A>>2]|0,E=y+8|0,h=u[E>>2]|0,(h|0)==(l|0)?(A=U&~(1<<d),u[5829]=A):(u[h+12>>2]=l,u[A>>2]=h,A=U),W=d<<3,_=W-M|0,u[y+4>>2]=M|3,g=y+M|0,u[g+4>>2]=_|1,u[y+W>>2]=_,B|0&&(d=u[5834]|0,l=B>>>3,h=23356+(l<<1<<2)|0,l=1<<l,A&l?(A=h+8|0,l=u[A>>2]|0):(u[5829]=A|l,l=h,A=h+8|0),u[A>>2]=d,u[l+12>>2]=d,u[d+8>>2]=l,u[d+12>>2]=h),u[5831]=_,u[5834]=g,W=E,k=Ee,W|0;if(y=u[5830]|0,y){for(h=(y&0-y)+-1|0,g=h>>>12&16,h=h>>>g,d=h>>>5&8,h=h>>>d,_=h>>>2&4,h=h>>>_,E=h>>>1&2,h=h>>>E,b=h>>>1&1,b=u[23620+((d|g|_|E|b)+(h>>>b)<<2)>>2]|0,h=b,E=b,b=(u[b+4>>2]&-8)-M|0;A=u[h+16>>2]|0,!(!A&&(A=u[h+20>>2]|0,!A));)_=(u[A+4>>2]&-8)-M|0,g=_>>>0<b>>>0,h=A,E=g?A:E,b=g?_:b;if(_=E+M|0,_>>>0>E>>>0){g=u[E+24>>2]|0,l=u[E+12>>2]|0;do if((l|0)==(E|0)){if(A=E+20|0,l=u[A>>2]|0,!l&&(A=E+16|0,l=u[A>>2]|0,!l)){h=0;break}for(;;)if(d=l+20|0,h=u[d>>2]|0,h)l=h,A=d;else if(d=l+16|0,h=u[d>>2]|0,h)l=h,A=d;else break;u[A>>2]=0,h=l}else h=u[E+8>>2]|0,u[h+12>>2]=l,u[l+8>>2]=h,h=l;while(0);do if(g|0){if(l=u[E+28>>2]|0,A=23620+(l<<2)|0,(E|0)==(u[A>>2]|0)){if(u[A>>2]=h,!h){u[5830]=y&~(1<<l);break}}else if(W=g+16|0,u[((u[W>>2]|0)==(E|0)?W:g+20|0)>>2]=h,!h)break;u[h+24>>2]=g,l=u[E+16>>2]|0,l|0&&(u[h+16>>2]=l,u[l+24>>2]=h),l=u[E+20>>2]|0,l|0&&(u[h+20>>2]=l,u[l+24>>2]=h)}while(0);return b>>>0<16?(W=b+M|0,u[E+4>>2]=W|3,W=E+W+4|0,u[W>>2]=u[W>>2]|1):(u[E+4>>2]=M|3,u[_+4>>2]=b|1,u[_+b>>2]=b,B|0&&(d=u[5834]|0,l=B>>>3,h=23356+(l<<1<<2)|0,l=1<<l,l&U?(A=h+8|0,l=u[A>>2]|0):(u[5829]=l|U,l=h,A=h+8|0),u[A>>2]=d,u[l+12>>2]=d,u[d+8>>2]=l,u[d+12>>2]=h),u[5831]=b,u[5834]=_),W=E+8|0,k=Ee,W|0}else U=M}else U=M}else U=M}else if(A>>>0<=4294967231)if(A=A+11|0,M=A&-8,d=u[5830]|0,d){g=0-M|0,A=A>>>8,A?M>>>0>16777215?b=31:(U=(A+1048320|0)>>>16&8,ne=A<<U,E=(ne+520192|0)>>>16&4,ne=ne<<E,b=(ne+245760|0)>>>16&2,b=14-(E|U|b)+(ne<<b>>>15)|0,b=M>>>(b+7|0)&1|b<<1):b=0,h=u[23620+(b<<2)>>2]|0;e:do if(!h)h=0,A=0,ne=61;else for(A=0,E=M<<((b|0)==31?0:25-(b>>>1)|0),y=0;;){if(_=(u[h+4>>2]&-8)-M|0,_>>>0<g>>>0)if(_)A=h,g=_;else{A=h,g=0,ne=65;break e}if(ne=u[h+20>>2]|0,h=u[h+16+(E>>>31<<2)>>2]|0,y=(ne|0)==0|(ne|0)==(h|0)?y:ne,h)E=E<<1;else{h=y,ne=61;break}}while(0);if((ne|0)==61){if((h|0)==0&(A|0)==0){if(A=2<<b,A=(A|0-A)&d,!A){U=M;break}U=(A&0-A)+-1|0,_=U>>>12&16,U=U>>>_,y=U>>>5&8,U=U>>>y,E=U>>>2&4,U=U>>>E,b=U>>>1&2,U=U>>>b,h=U>>>1&1,A=0,h=u[23620+((y|_|E|b|h)+(U>>>h)<<2)>>2]|0}h?ne=65:(E=A,_=g)}if((ne|0)==65)for(y=h;;)if(U=(u[y+4>>2]&-8)-M|0,h=U>>>0<g>>>0,g=h?U:g,A=h?y:A,h=u[y+16>>2]|0,h||(h=u[y+20>>2]|0),h)y=h;else{E=A,_=g;break}if((E|0)!=0&&_>>>0<((u[5831]|0)-M|0)>>>0&&(B=E+M|0,B>>>0>E>>>0)){y=u[E+24>>2]|0,l=u[E+12>>2]|0;do if((l|0)==(E|0)){if(A=E+20|0,l=u[A>>2]|0,!l&&(A=E+16|0,l=u[A>>2]|0,!l)){l=0;break}for(;;)if(g=l+20|0,h=u[g>>2]|0,h)l=h,A=g;else if(g=l+16|0,h=u[g>>2]|0,h)l=h,A=g;else break;u[A>>2]=0}else W=u[E+8>>2]|0,u[W+12>>2]=l,u[l+8>>2]=W;while(0);do if(y){if(A=u[E+28>>2]|0,h=23620+(A<<2)|0,(E|0)==(u[h>>2]|0)){if(u[h>>2]=l,!l){d=d&~(1<<A),u[5830]=d;break}}else if(W=y+16|0,u[((u[W>>2]|0)==(E|0)?W:y+20|0)>>2]=l,!l)break;u[l+24>>2]=y,A=u[E+16>>2]|0,A|0&&(u[l+16>>2]=A,u[A+24>>2]=l),A=u[E+20>>2]|0,A&&(u[l+20>>2]=A,u[A+24>>2]=l)}while(0);e:do if(_>>>0<16)W=_+M|0,u[E+4>>2]=W|3,W=E+W+4|0,u[W>>2]=u[W>>2]|1;else{if(u[E+4>>2]=M|3,u[B+4>>2]=_|1,u[B+_>>2]=_,l=_>>>3,_>>>0<256){h=23356+(l<<1<<2)|0,A=u[5829]|0,l=1<<l,A&l?(A=h+8|0,l=u[A>>2]|0):(u[5829]=A|l,l=h,A=h+8|0),u[A>>2]=B,u[l+12>>2]=B,u[B+8>>2]=l,u[B+12>>2]=h;break}if(l=_>>>8,l?_>>>0>16777215?h=31:(ae=(l+1048320|0)>>>16&8,W=l<<ae,$=(W+520192|0)>>>16&4,W=W<<$,h=(W+245760|0)>>>16&2,h=14-($|ae|h)+(W<<h>>>15)|0,h=_>>>(h+7|0)&1|h<<1):h=0,l=23620+(h<<2)|0,u[B+28>>2]=h,A=B+16|0,u[A+4>>2]=0,u[A>>2]=0,A=1<<h,!(d&A)){u[5830]=d|A,u[l>>2]=B,u[B+24>>2]=l,u[B+12>>2]=B,u[B+8>>2]=B;break}l=u[l>>2]|0;t:do if((u[l+4>>2]&-8|0)!=(_|0)){for(d=_<<((h|0)==31?0:25-(h>>>1)|0);h=l+16+(d>>>31<<2)|0,A=u[h>>2]|0,!!A;)if((u[A+4>>2]&-8|0)==(_|0)){l=A;break t}else d=d<<1,l=A;u[h>>2]=B,u[B+24>>2]=l,u[B+12>>2]=B,u[B+8>>2]=B;break e}while(0);ae=l+8|0,W=u[ae>>2]|0,u[W+12>>2]=B,u[ae>>2]=B,u[B+8>>2]=W,u[B+12>>2]=l,u[B+24>>2]=0}while(0);return W=E+8|0,k=Ee,W|0}else U=M}else U=M;else U=-1;while(0);if(h=u[5831]|0,h>>>0>=U>>>0)return l=h-U|0,A=u[5834]|0,l>>>0>15?(W=A+U|0,u[5834]=W,u[5831]=l,u[W+4>>2]=l|1,u[A+h>>2]=l,u[A+4>>2]=U|3):(u[5831]=0,u[5834]=0,u[A+4>>2]=h|3,W=A+h+4|0,u[W>>2]=u[W>>2]|1),W=A+8|0,k=Ee,W|0;if(_=u[5832]|0,_>>>0>U>>>0)return $=_-U|0,u[5832]=$,W=u[5835]|0,ae=W+U|0,u[5835]=ae,u[ae+4>>2]=$|1,u[W+4>>2]=U|3,W=W+8|0,k=Ee,W|0;if(u[5947]|0?A=u[5949]|0:(u[5949]=4096,u[5948]=4096,u[5950]=-1,u[5951]=-1,u[5952]=0,u[5940]=0,u[5947]=j&-16^1431655768,A=4096),E=U+48|0,b=U+47|0,y=A+b|0,g=0-A|0,M=y&g,M>>>0<=U>>>0||(A=u[5939]|0,A|0&&(B=u[5937]|0,j=B+M|0,j>>>0<=B>>>0|j>>>0>A>>>0)))return W=0,k=Ee,W|0;e:do if(u[5940]&4)l=0,ne=143;else{h=u[5835]|0;t:do if(h){for(d=23764;j=u[d>>2]|0,!(j>>>0<=h>>>0&&(j+(u[d+4>>2]|0)|0)>>>0>h>>>0);)if(A=u[d+8>>2]|0,A)d=A;else{ne=128;break t}if(l=y-_&g,l>>>0<2147483647)if(A=Gr(l|0)|0,(A|0)==((u[d>>2]|0)+(u[d+4>>2]|0)|0)){if((A|0)!=-1){_=l,y=A,ne=145;break e}}else d=A,ne=136;else l=0}else ne=128;while(0);do if((ne|0)==128)if(h=Gr(0)|0,(h|0)!=-1&&(l=h,J=u[5948]|0,te=J+-1|0,l=((te&l|0)==0?0:(te+l&0-J)-l|0)+M|0,J=u[5937]|0,te=l+J|0,l>>>0>U>>>0&l>>>0<2147483647)){if(j=u[5939]|0,j|0&&te>>>0<=J>>>0|te>>>0>j>>>0){l=0;break}if(A=Gr(l|0)|0,(A|0)==(h|0)){_=l,y=h,ne=145;break e}else d=A,ne=136}else l=0;while(0);do if((ne|0)==136){if(h=0-l|0,!(E>>>0>l>>>0&(l>>>0<2147483647&(d|0)!=-1)))if((d|0)==-1){l=0;break}else{_=l,y=d,ne=145;break e}if(A=u[5949]|0,A=b-l+A&0-A,A>>>0>=2147483647){_=l,y=d,ne=145;break e}if((Gr(A|0)|0)==-1){Gr(h|0)|0,l=0;break}else{_=A+l|0,y=d,ne=145;break e}}while(0);u[5940]=u[5940]|4,ne=143}while(0);if((ne|0)==143&&M>>>0<2147483647&&($=Gr(M|0)|0,te=Gr(0)|0,ue=te-$|0,ye=ue>>>0>(U+40|0)>>>0,!(($|0)==-1|ye^1|$>>>0<te>>>0&(($|0)!=-1&(te|0)!=-1)^1))&&(_=ye?ue:l,y=$,ne=145),(ne|0)==145){l=(u[5937]|0)+_|0,u[5937]=l,l>>>0>(u[5938]|0)>>>0&&(u[5938]=l),b=u[5835]|0;e:do if(b){for(l=23764;;){if(A=u[l>>2]|0,h=u[l+4>>2]|0,(y|0)==(A+h|0)){ne=154;break}if(d=u[l+8>>2]|0,d)l=d;else break}if((ne|0)==154&&(ae=l+4|0,(u[l+12>>2]&8|0)==0)&&y>>>0>b>>>0&A>>>0<=b>>>0){u[ae>>2]=h+_,W=(u[5832]|0)+_|0,$=b+8|0,$=($&7|0)==0?0:0-$&7,ae=b+$|0,$=W-$|0,u[5835]=ae,u[5832]=$,u[ae+4>>2]=$|1,u[b+W+4>>2]=40,u[5836]=u[5951];break}for(y>>>0<(u[5833]|0)>>>0&&(u[5833]=y),h=y+_|0,l=23764;;){if((u[l>>2]|0)==(h|0)){ne=162;break}if(A=u[l+8>>2]|0,A)l=A;else break}if((ne|0)==162&&(u[l+12>>2]&8|0)==0){u[l>>2]=y,B=l+4|0,u[B>>2]=(u[B>>2]|0)+_,B=y+8|0,B=y+((B&7|0)==0?0:0-B&7)|0,l=h+8|0,l=h+((l&7|0)==0?0:0-l&7)|0,M=B+U|0,E=l-B-U|0,u[B+4>>2]=U|3;t:do if((b|0)==(l|0))W=(u[5832]|0)+E|0,u[5832]=W,u[5835]=M,u[M+4>>2]=W|1;else{if((u[5834]|0)==(l|0)){W=(u[5831]|0)+E|0,u[5831]=W,u[5834]=M,u[M+4>>2]=W|1,u[M+W>>2]=W;break}if(A=u[l+4>>2]|0,(A&3|0)==1){_=A&-8,d=A>>>3;n:do if(A>>>0<256)if(A=u[l+8>>2]|0,h=u[l+12>>2]|0,(h|0)==(A|0)){u[5829]=u[5829]&~(1<<d);break}else{u[A+12>>2]=h,u[h+8>>2]=A;break}else{y=u[l+24>>2]|0,A=u[l+12>>2]|0;do if((A|0)==(l|0)){if(h=l+16|0,d=h+4|0,A=u[d>>2]|0,A)h=d;else if(A=u[h>>2]|0,!A){A=0;break}for(;;)if(g=A+20|0,d=u[g>>2]|0,d)A=d,h=g;else if(g=A+16|0,d=u[g>>2]|0,d)A=d,h=g;else break;u[h>>2]=0}else W=u[l+8>>2]|0,u[W+12>>2]=A,u[A+8>>2]=W;while(0);if(!y)break;h=u[l+28>>2]|0,d=23620+(h<<2)|0;do if((u[d>>2]|0)!=(l|0)){if(W=y+16|0,u[((u[W>>2]|0)==(l|0)?W:y+20|0)>>2]=A,!A)break n}else{if(u[d>>2]=A,A|0)break;u[5830]=u[5830]&~(1<<h);break n}while(0);if(u[A+24>>2]=y,h=l+16|0,d=u[h>>2]|0,d|0&&(u[A+16>>2]=d,u[d+24>>2]=A),h=u[h+4>>2]|0,!h)break;u[A+20>>2]=h,u[h+24>>2]=A}while(0);l=l+_|0,g=_+E|0}else g=E;if(l=l+4|0,u[l>>2]=u[l>>2]&-2,u[M+4>>2]=g|1,u[M+g>>2]=g,l=g>>>3,g>>>0<256){h=23356+(l<<1<<2)|0,A=u[5829]|0,l=1<<l,A&l?(A=h+8|0,l=u[A>>2]|0):(u[5829]=A|l,l=h,A=h+8|0),u[A>>2]=M,u[l+12>>2]=M,u[M+8>>2]=l,u[M+12>>2]=h;break}l=g>>>8;do if(!l)d=0;else{if(g>>>0>16777215){d=31;break}ae=(l+1048320|0)>>>16&8,W=l<<ae,$=(W+520192|0)>>>16&4,W=W<<$,d=(W+245760|0)>>>16&2,d=14-($|ae|d)+(W<<d>>>15)|0,d=g>>>(d+7|0)&1|d<<1}while(0);if(l=23620+(d<<2)|0,u[M+28>>2]=d,A=M+16|0,u[A+4>>2]=0,u[A>>2]=0,A=u[5830]|0,h=1<<d,!(A&h)){u[5830]=A|h,u[l>>2]=M,u[M+24>>2]=l,u[M+12>>2]=M,u[M+8>>2]=M;break}l=u[l>>2]|0;n:do if((u[l+4>>2]&-8|0)!=(g|0)){for(d=g<<((d|0)==31?0:25-(d>>>1)|0);h=l+16+(d>>>31<<2)|0,A=u[h>>2]|0,!!A;)if((u[A+4>>2]&-8|0)==(g|0)){l=A;break n}else d=d<<1,l=A;u[h>>2]=M,u[M+24>>2]=l,u[M+12>>2]=M,u[M+8>>2]=M;break t}while(0);ae=l+8|0,W=u[ae>>2]|0,u[W+12>>2]=M,u[ae>>2]=M,u[M+8>>2]=W,u[M+12>>2]=l,u[M+24>>2]=0}while(0);return W=B+8|0,k=Ee,W|0}for(l=23764;A=u[l>>2]|0,!(A>>>0<=b>>>0&&(W=A+(u[l+4>>2]|0)|0,W>>>0>b>>>0));)l=u[l+8>>2]|0;g=W+-47|0,A=g+8|0,A=g+((A&7|0)==0?0:0-A&7)|0,g=b+16|0,A=A>>>0<g>>>0?b:A,l=A+8|0,h=_+-40|0,$=y+8|0,$=($&7|0)==0?0:0-$&7,ae=y+$|0,$=h-$|0,u[5835]=ae,u[5832]=$,u[ae+4>>2]=$|1,u[y+h+4>>2]=40,u[5836]=u[5951],h=A+4|0,u[h>>2]=27,u[l>>2]=u[5941],u[l+4>>2]=u[5942],u[l+8>>2]=u[5943],u[l+12>>2]=u[5944],u[5941]=y,u[5942]=_,u[5944]=0,u[5943]=l,l=A+24|0;do ae=l,l=l+4|0,u[l>>2]=7;while((ae+8|0)>>>0<W>>>0);if((A|0)!=(b|0)){if(y=A-b|0,u[h>>2]=u[h>>2]&-2,u[b+4>>2]=y|1,u[A>>2]=y,l=y>>>3,y>>>0<256){h=23356+(l<<1<<2)|0,A=u[5829]|0,l=1<<l,A&l?(A=h+8|0,l=u[A>>2]|0):(u[5829]=A|l,l=h,A=h+8|0),u[A>>2]=b,u[l+12>>2]=b,u[b+8>>2]=l,u[b+12>>2]=h;break}if(l=y>>>8,l?y>>>0>16777215?d=31:(ae=(l+1048320|0)>>>16&8,W=l<<ae,$=(W+520192|0)>>>16&4,W=W<<$,d=(W+245760|0)>>>16&2,d=14-($|ae|d)+(W<<d>>>15)|0,d=y>>>(d+7|0)&1|d<<1):d=0,h=23620+(d<<2)|0,u[b+28>>2]=d,u[b+20>>2]=0,u[g>>2]=0,l=u[5830]|0,A=1<<d,!(l&A)){u[5830]=l|A,u[h>>2]=b,u[b+24>>2]=h,u[b+12>>2]=b,u[b+8>>2]=b;break}l=u[h>>2]|0;t:do if((u[l+4>>2]&-8|0)!=(y|0)){for(d=y<<((d|0)==31?0:25-(d>>>1)|0);h=l+16+(d>>>31<<2)|0,A=u[h>>2]|0,!!A;)if((u[A+4>>2]&-8|0)==(y|0)){l=A;break t}else d=d<<1,l=A;u[h>>2]=b,u[b+24>>2]=l,u[b+12>>2]=b,u[b+8>>2]=b;break e}while(0);ae=l+8|0,W=u[ae>>2]|0,u[W+12>>2]=b,u[ae>>2]=b,u[b+8>>2]=W,u[b+12>>2]=l,u[b+24>>2]=0}}else W=u[5833]|0,(W|0)==0|y>>>0<W>>>0&&(u[5833]=y),u[5941]=y,u[5942]=_,u[5944]=0,u[5838]=u[5947],u[5837]=-1,u[5842]=23356,u[5841]=23356,u[5844]=23364,u[5843]=23364,u[5846]=23372,u[5845]=23372,u[5848]=23380,u[5847]=23380,u[5850]=23388,u[5849]=23388,u[5852]=23396,u[5851]=23396,u[5854]=23404,u[5853]=23404,u[5856]=23412,u[5855]=23412,u[5858]=23420,u[5857]=23420,u[5860]=23428,u[5859]=23428,u[5862]=23436,u[5861]=23436,u[5864]=23444,u[5863]=23444,u[5866]=23452,u[5865]=23452,u[5868]=23460,u[5867]=23460,u[5870]=23468,u[5869]=23468,u[5872]=23476,u[5871]=23476,u[5874]=23484,u[5873]=23484,u[5876]=23492,u[5875]=23492,u[5878]=23500,u[5877]=23500,u[5880]=23508,u[5879]=23508,u[5882]=23516,u[5881]=23516,u[5884]=23524,u[5883]=23524,u[5886]=23532,u[5885]=23532,u[5888]=23540,u[5887]=23540,u[5890]=23548,u[5889]=23548,u[5892]=23556,u[5891]=23556,u[5894]=23564,u[5893]=23564,u[5896]=23572,u[5895]=23572,u[5898]=23580,u[5897]=23580,u[5900]=23588,u[5899]=23588,u[5902]=23596,u[5901]=23596,u[5904]=23604,u[5903]=23604,W=_+-40|0,$=y+8|0,$=($&7|0)==0?0:0-$&7,ae=y+$|0,$=W-$|0,u[5835]=ae,u[5832]=$,u[ae+4>>2]=$|1,u[y+W+4>>2]=40,u[5836]=u[5951];while(0);if(l=u[5832]|0,l>>>0>U>>>0)return $=l-U|0,u[5832]=$,W=u[5835]|0,ae=W+U|0,u[5835]=ae,u[ae+4>>2]=$|1,u[W+4>>2]=U|3,W=W+8|0,k=Ee,W|0}return W=TM()|0,u[W>>2]=12,W=0,k=Ee,W|0}function Ge(A){A=A|0;var l=0,h=0,d=0,g=0,y=0,_=0,E=0,b=0;if(!A)return;h=A+-8|0,g=u[5833]|0,A=u[A+-4>>2]|0,l=A&-8,b=h+l|0;do if(A&1)E=h,_=h;else{if(d=u[h>>2]|0,!(A&3)||(_=h+(0-d)|0,y=d+l|0,_>>>0<g>>>0))return;if((u[5834]|0)==(_|0)){if(A=b+4|0,l=u[A>>2]|0,(l&3|0)!=3){E=_,l=y;break}u[5831]=y,u[A>>2]=l&-2,u[_+4>>2]=y|1,u[_+y>>2]=y;return}if(h=d>>>3,d>>>0<256)if(A=u[_+8>>2]|0,l=u[_+12>>2]|0,(l|0)==(A|0)){u[5829]=u[5829]&~(1<<h),E=_,l=y;break}else{u[A+12>>2]=l,u[l+8>>2]=A,E=_,l=y;break}g=u[_+24>>2]|0,A=u[_+12>>2]|0;do if((A|0)==(_|0)){if(l=_+16|0,h=l+4|0,A=u[h>>2]|0,A)l=h;else if(A=u[l>>2]|0,!A){A=0;break}for(;;)if(d=A+20|0,h=u[d>>2]|0,h)A=h,l=d;else if(d=A+16|0,h=u[d>>2]|0,h)A=h,l=d;else break;u[l>>2]=0}else E=u[_+8>>2]|0,u[E+12>>2]=A,u[A+8>>2]=E;while(0);if(g){if(l=u[_+28>>2]|0,h=23620+(l<<2)|0,(u[h>>2]|0)==(_|0)){if(u[h>>2]=A,!A){u[5830]=u[5830]&~(1<<l),E=_,l=y;break}}else if(E=g+16|0,u[((u[E>>2]|0)==(_|0)?E:g+20|0)>>2]=A,!A){E=_,l=y;break}u[A+24>>2]=g,l=_+16|0,h=u[l>>2]|0,h|0&&(u[A+16>>2]=h,u[h+24>>2]=A),l=u[l+4>>2]|0,l?(u[A+20>>2]=l,u[l+24>>2]=A,E=_,l=y):(E=_,l=y)}else E=_,l=y}while(0);if(_>>>0>=b>>>0||(A=b+4|0,d=u[A>>2]|0,!(d&1)))return;if(d&2)u[A>>2]=d&-2,u[E+4>>2]=l|1,u[_+l>>2]=l,g=l;else{if((u[5835]|0)==(b|0)){if(b=(u[5832]|0)+l|0,u[5832]=b,u[5835]=E,u[E+4>>2]=b|1,(E|0)!=(u[5834]|0))return;u[5834]=0,u[5831]=0;return}if((u[5834]|0)==(b|0)){b=(u[5831]|0)+l|0,u[5831]=b,u[5834]=_,u[E+4>>2]=b|1,u[_+b>>2]=b;return}g=(d&-8)+l|0,h=d>>>3;do if(d>>>0<256)if(l=u[b+8>>2]|0,A=u[b+12>>2]|0,(A|0)==(l|0)){u[5829]=u[5829]&~(1<<h);break}else{u[l+12>>2]=A,u[A+8>>2]=l;break}else{y=u[b+24>>2]|0,A=u[b+12>>2]|0;do if((A|0)==(b|0)){if(l=b+16|0,h=l+4|0,A=u[h>>2]|0,A)l=h;else if(A=u[l>>2]|0,!A){h=0;break}for(;;)if(d=A+20|0,h=u[d>>2]|0,h)A=h,l=d;else if(d=A+16|0,h=u[d>>2]|0,h)A=h,l=d;else break;u[l>>2]=0,h=A}else h=u[b+8>>2]|0,u[h+12>>2]=A,u[A+8>>2]=h,h=A;while(0);if(y|0){if(A=u[b+28>>2]|0,l=23620+(A<<2)|0,(u[l>>2]|0)==(b|0)){if(u[l>>2]=h,!h){u[5830]=u[5830]&~(1<<A);break}}else if(d=y+16|0,u[((u[d>>2]|0)==(b|0)?d:y+20|0)>>2]=h,!h)break;u[h+24>>2]=y,A=b+16|0,l=u[A>>2]|0,l|0&&(u[h+16>>2]=l,u[l+24>>2]=h),A=u[A+4>>2]|0,A|0&&(u[h+20>>2]=A,u[A+24>>2]=h)}}while(0);if(u[E+4>>2]=g|1,u[_+g>>2]=g,(E|0)==(u[5834]|0)){u[5831]=g;return}}if(A=g>>>3,g>>>0<256){h=23356+(A<<1<<2)|0,l=u[5829]|0,A=1<<A,l&A?(l=h+8|0,A=u[l>>2]|0):(u[5829]=l|A,A=h,l=h+8|0),u[l>>2]=E,u[A+12>>2]=E,u[E+8>>2]=A,u[E+12>>2]=h;return}A=g>>>8,A?g>>>0>16777215?d=31:(_=(A+1048320|0)>>>16&8,b=A<<_,y=(b+520192|0)>>>16&4,b=b<<y,d=(b+245760|0)>>>16&2,d=14-(y|_|d)+(b<<d>>>15)|0,d=g>>>(d+7|0)&1|d<<1):d=0,A=23620+(d<<2)|0,u[E+28>>2]=d,u[E+20>>2]=0,u[E+16>>2]=0,l=u[5830]|0,h=1<<d;e:do if(!(l&h))u[5830]=l|h,u[A>>2]=E,u[E+24>>2]=A,u[E+12>>2]=E,u[E+8>>2]=E;else{A=u[A>>2]|0;t:do if((u[A+4>>2]&-8|0)!=(g|0)){for(d=g<<((d|0)==31?0:25-(d>>>1)|0);h=A+16+(d>>>31<<2)|0,l=u[h>>2]|0,!!l;)if((u[l+4>>2]&-8|0)==(g|0)){A=l;break t}else d=d<<1,A=l;u[h>>2]=E,u[E+24>>2]=A,u[E+12>>2]=E,u[E+8>>2]=E;break e}while(0);_=A+8|0,b=u[_>>2]|0,u[b+12>>2]=E,u[_>>2]=E,u[E+8>>2]=b,u[E+12>>2]=A,u[E+24>>2]=0}while(0);if(b=(u[5837]|0)+-1|0,u[5837]=b,!(b|0)){for(A=23772;A=u[A>>2]|0,A;)A=A+8|0;u[5837]=-1}}function Ti(A,l){A=A|0,l=l|0;var h=0;return A?(h=$t(l,A)|0,(l|A)>>>0>65535&&(h=((h>>>0)/(A>>>0)|0|0)==(l|0)?h:-1)):h=0,A=Hi(h)|0,!A||!(u[A+-4>>2]&3)||Ci(A|0,0,h|0)|0,A|0}function bM(A,l,h,d){return A=A|0,l=l|0,h=h|0,d=d|0,h=A+h>>>0,Pe(l+d+(h>>>0<A>>>0|0)>>>0|0),h|0|0}function fA(A,l,h,d){return A=A|0,l=l|0,h=h|0,d=d|0,d=l-d-(h>>>0>A>>>0|0)>>>0,Pe(d|0),A-h>>>0|0|0}function G_(A){return A=A|0,(A?31-(zn(A^A-1)|0)|0:32)|0}function SM(A,l,h,d,g){A=A|0,l=l|0,h=h|0,d=d|0,g=g|0;var y=0,_=0,E=0,b=0,M=0,B=0,U=0,j=0,J=0,te=0;if(B=A,b=l,M=b,_=h,j=d,E=j,!M)return y=(g|0)!=0,E?y?(u[g>>2]=A|0,u[g+4>>2]=l&0,j=0,g=0,Pe(j|0),g|0):(j=0,g=0,Pe(j|0),g|0):(y&&(u[g>>2]=(B>>>0)%(_>>>0),u[g+4>>2]=0),j=0,g=(B>>>0)/(_>>>0)>>>0,Pe(j|0),g|0);y=(E|0)==0;do if(_){if(!y){if(y=(zn(E|0)|0)-(zn(M|0)|0)|0,y>>>0<=31){U=y+1|0,E=31-y|0,l=y-31>>31,_=U,A=B>>>(U>>>0)&l|M<<E,l=M>>>(U>>>0)&l,y=0,E=B<<E;break}return g?(u[g>>2]=A|0,u[g+4>>2]=b|l&0,j=0,g=0,Pe(j|0),g|0):(j=0,g=0,Pe(j|0),g|0)}if(y=_-1|0,y&_|0){E=(zn(_|0)|0)+33-(zn(M|0)|0)|0,te=64-E|0,U=32-E|0,b=U>>31,J=E-32|0,l=J>>31,_=E,A=U-1>>31&M>>>(J>>>0)|(M<<U|B>>>(E>>>0))&l,l=l&M>>>(E>>>0),y=B<<te&b,E=(M<<te|B>>>(J>>>0))&b|B<<U&E-33>>31;break}return g|0&&(u[g>>2]=y&B,u[g+4>>2]=0),(_|0)==1?(J=b|l&0,te=A|0|0,Pe(J|0),te|0):(te=G_(_|0)|0,J=M>>>(te>>>0)|0,te=M<<32-te|B>>>(te>>>0)|0,Pe(J|0),te|0)}else{if(y)return g|0&&(u[g>>2]=(M>>>0)%(_>>>0),u[g+4>>2]=0),J=0,te=(M>>>0)/(_>>>0)>>>0,Pe(J|0),te|0;if(!B)return g|0&&(u[g>>2]=0,u[g+4>>2]=(M>>>0)%(E>>>0)),J=0,te=(M>>>0)/(E>>>0)>>>0,Pe(J|0),te|0;if(y=E-1|0,!(y&E))return g|0&&(u[g>>2]=A|0,u[g+4>>2]=y&M|l&0),J=0,te=M>>>((G_(E|0)|0)>>>0),Pe(J|0),te|0;if(y=(zn(E|0)|0)-(zn(M|0)|0)|0,y>>>0<=30){l=y+1|0,E=31-y|0,_=l,A=M<<E|B>>>(l>>>0),l=M>>>(l>>>0),y=0,E=B<<E;break}return g?(u[g>>2]=A|0,u[g+4>>2]=b|l&0,J=0,te=0,Pe(J|0),te|0):(J=0,te=0,Pe(J|0),te|0)}while(0);if(!_)M=E,b=0,E=0;else{U=h|0|0,B=j|d&0,M=bM(U|0,B|0,-1,-1)|0,h=z()|0,b=E,E=0;do d=b,b=y>>>31|b<<1,y=E|y<<1,d=A<<1|d>>>31|0,j=A>>>31|l<<1|0,fA(M|0,h|0,d|0,j|0)|0,te=z()|0,J=te>>31|((te|0)<0?-1:0)<<1,E=J&1,A=fA(d|0,j|0,J&U|0,(((te|0)<0?-1:0)>>31|((te|0)<0?-1:0)<<1)&B|0)|0,l=z()|0,_=_-1|0;while((_|0)!=0);M=b,b=0}return _=0,g|0&&(u[g>>2]=A,u[g+4>>2]=l),J=(y|0)>>>31|(M|_)<<1|(_<<1|y>>>31)&0|b,te=(y<<1|0>>>31)&-2|E,Pe(J|0),te|0}function Ur(A,l,h,d){A=A|0,l=l|0,h=h|0,d=d|0;var g=0,y=0;return y=k,k=k+16|0,g=y|0,SM(A,l,h,d,g)|0,k=y,Pe(u[g+4>>2]|0),u[g>>2]|0|0}function ce(A,l,h){return A=A|0,l=l|0,h=h|0,(h|0)<32?(Pe(l>>>h|0),A>>>h|(l&(1<<h)-1)<<32-h):(Pe(0),l>>>h-32|0)}function _e(A,l,h){return A=A|0,l=l|0,h=h|0,(h|0)<32?(Pe(l<<h|(A&(1<<h)-1<<32-h)>>>32-h|0),A<<h):(Pe(A<<h-32|0),0)}function z_(A,l){return A=+A,l=+l,A!=A?+l:l!=l?+A:+Ei(+A,+l)}function Fc(A){return A=+A,A>=0?+et(A+.5):+vi(A-.5)}function Dc(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0;if((h|0)>=8192)return Vn(A|0,l|0,h|0)|0,A|0;if(y=A|0,g=A+h|0,(A&3)==(l&3)){for(;A&3;){if(!h)return y|0;Ie[A>>0]=Ie[l>>0]|0,A=A+1|0,l=l+1|0,h=h-1|0}for(h=g&-4|0,d=h-64|0;(A|0)<=(d|0);)u[A>>2]=u[l>>2],u[A+4>>2]=u[l+4>>2],u[A+8>>2]=u[l+8>>2],u[A+12>>2]=u[l+12>>2],u[A+16>>2]=u[l+16>>2],u[A+20>>2]=u[l+20>>2],u[A+24>>2]=u[l+24>>2],u[A+28>>2]=u[l+28>>2],u[A+32>>2]=u[l+32>>2],u[A+36>>2]=u[l+36>>2],u[A+40>>2]=u[l+40>>2],u[A+44>>2]=u[l+44>>2],u[A+48>>2]=u[l+48>>2],u[A+52>>2]=u[l+52>>2],u[A+56>>2]=u[l+56>>2],u[A+60>>2]=u[l+60>>2],A=A+64|0,l=l+64|0;for(;(A|0)<(h|0);)u[A>>2]=u[l>>2],A=A+4|0,l=l+4|0}else for(h=g-4|0;(A|0)<(h|0);)Ie[A>>0]=Ie[l>>0]|0,Ie[A+1>>0]=Ie[l+1>>0]|0,Ie[A+2>>0]=Ie[l+2>>0]|0,Ie[A+3>>0]=Ie[l+3>>0]|0,A=A+4|0,l=l+4|0;for(;(A|0)<(g|0);)Ie[A>>0]=Ie[l>>0]|0,A=A+1|0,l=l+1|0;return y|0}function Ci(A,l,h){A=A|0,l=l|0,h=h|0;var d=0,g=0,y=0,_=0;if(y=A+h|0,l=l&255,(h|0)>=67){for(;A&3;)Ie[A>>0]=l,A=A+1|0;for(d=y&-4|0,_=l|l<<8|l<<16|l<<24,g=d-64|0;(A|0)<=(g|0);)u[A>>2]=_,u[A+4>>2]=_,u[A+8>>2]=_,u[A+12>>2]=_,u[A+16>>2]=_,u[A+20>>2]=_,u[A+24>>2]=_,u[A+28>>2]=_,u[A+32>>2]=_,u[A+36>>2]=_,u[A+40>>2]=_,u[A+44>>2]=_,u[A+48>>2]=_,u[A+52>>2]=_,u[A+56>>2]=_,u[A+60>>2]=_,A=A+64|0;for(;(A|0)<(d|0);)u[A>>2]=_,A=A+4|0}for(;(A|0)<(y|0);)Ie[A>>0]=l,A=A+1|0;return y-h|0}function V_(A){return A=+A,A>=0?+et(A+.5):+vi(A-.5)}function Gr(A){A=A|0;var l=0,h=0,d=0;return d=wo()|0,h=u[Ze>>2]|0,l=h+A|0,(A|0)>0&(l|0)<(h|0)|(l|0)<0?(sA(l|0)|0,rA(12),-1):(l|0)>(d|0)&&!(To(l|0)|0)?(rA(12),-1):(u[Ze>>2]=l,h|0)}return{___uremdi3:Ur,_bitshift64Lshr:ce,_bitshift64Shl:_e,_calloc:Ti,_cellAreaKm2:BP,_cellAreaM2:LP,_cellAreaRads2:IP,_compact:UP,_destroyLinkedPolygon:tM,_edgeLengthKm:xP,_edgeLengthM:PP,_emscripten_replace_memory:oA,_exactEdgeLengthKm:OP,_exactEdgeLengthM:FP,_exactEdgeLengthRads:RP,_experimentalH3ToLocalIj:nM,_experimentalLocalIjToH3:iM,_free:Ge,_geoToH3:x_,_getDestinationH3IndexFromUnidirectionalEdge:YP,_getH3IndexesFromUnidirectionalEdge:ZP,_getH3UnidirectionalEdge:XP,_getH3UnidirectionalEdgeBoundary:Lc,_getH3UnidirectionalEdgesFromHexagon:qP,_getOriginH3IndexFromUnidirectionalEdge:JP,_getPentagonIndexes:fd,_getRes0Indexes:cP,_h3Distance:rM,_h3GetBaseCell:b_,_h3GetFaces:P_,_h3GetResolution:DP,_h3IndexesAreNeighbors:M_,_h3IsPentagon:Xt,_h3IsResClassIII:VP,_h3IsValid:S_,_h3Line:oM,_h3LineSize:sM,_h3SetToLinkedGeo:Ut,_h3ToCenterChild:NP,_h3ToChildren:Pn,_h3ToGeo:Ls,_h3ToGeoBoundary:Rs,_h3ToParent:ld,_h3UnidirectionalEdgeIsValid:KP,_hexAreaKm2:bP,_hexAreaM2:SP,_hexRing:O,_i64Subtract:fA,_kRing:bo,_kRingDistances:Pc,_llvm_minnum_f64:z_,_llvm_round_f64:Fc,_malloc:Hi,_maxFaceCount:WP,_maxH3ToChildrenSize:kP,_maxKringSize:xc,_maxPolyfillSize:G,_maxUncompactSize:zP,_memcpy:Dc,_memset:Ci,_numHexagons:MP,_pentagonIndexCount:QP,_pointDistKm:uA,_pointDistM:wP,_pointDistRads:EP,_polyfill:Z,_res0IndexCount:lP,_round:V_,_sbrk:Gr,_sizeOfCoordIJ:gM,_sizeOfGeoBoundary:uM,_sizeOfGeoCoord:cM,_sizeOfGeoPolygon:fM,_sizeOfGeofence:hM,_sizeOfH3Index:lM,_sizeOfLinkedGeoPolygon:dM,_uncompact:GP,establishStackSpace:nd,stackAlloc:aA,stackRestore:wi,stackSave:Co}}(Ec,wc,D);e.___uremdi3=he.___uremdi3,e._bitshift64Lshr=he._bitshift64Lshr,e._bitshift64Shl=he._bitshift64Shl,e._calloc=he._calloc,e._cellAreaKm2=he._cellAreaKm2,e._cellAreaM2=he._cellAreaM2,e._cellAreaRads2=he._cellAreaRads2,e._compact=he._compact,e._destroyLinkedPolygon=he._destroyLinkedPolygon,e._edgeLengthKm=he._edgeLengthKm,e._edgeLengthM=he._edgeLengthM;var ed=e._emscripten_replace_memory=he._emscripten_replace_memory;e._exactEdgeLengthKm=he._exactEdgeLengthKm,e._exactEdgeLengthM=he._exactEdgeLengthM,e._exactEdgeLengthRads=he._exactEdgeLengthRads,e._experimentalH3ToLocalIj=he._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=he._experimentalLocalIjToH3,e._free=he._free,e._geoToH3=he._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=he._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=he._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=he._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=he._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=he._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=he._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=he._getPentagonIndexes,e._getRes0Indexes=he._getRes0Indexes,e._h3Distance=he._h3Distance,e._h3GetBaseCell=he._h3GetBaseCell,e._h3GetFaces=he._h3GetFaces,e._h3GetResolution=he._h3GetResolution,e._h3IndexesAreNeighbors=he._h3IndexesAreNeighbors,e._h3IsPentagon=he._h3IsPentagon,e._h3IsResClassIII=he._h3IsResClassIII,e._h3IsValid=he._h3IsValid,e._h3Line=he._h3Line,e._h3LineSize=he._h3LineSize,e._h3SetToLinkedGeo=he._h3SetToLinkedGeo,e._h3ToCenterChild=he._h3ToCenterChild,e._h3ToChildren=he._h3ToChildren,e._h3ToGeo=he._h3ToGeo,e._h3ToGeoBoundary=he._h3ToGeoBoundary,e._h3ToParent=he._h3ToParent,e._h3UnidirectionalEdgeIsValid=he._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=he._hexAreaKm2,e._hexAreaM2=he._hexAreaM2,e._hexRing=he._hexRing,e._i64Subtract=he._i64Subtract,e._kRing=he._kRing,e._kRingDistances=he._kRingDistances,e._llvm_minnum_f64=he._llvm_minnum_f64,e._llvm_round_f64=he._llvm_round_f64,e._malloc=he._malloc,e._maxFaceCount=he._maxFaceCount,e._maxH3ToChildrenSize=he._maxH3ToChildrenSize,e._maxKringSize=he._maxKringSize,e._maxPolyfillSize=he._maxPolyfillSize,e._maxUncompactSize=he._maxUncompactSize,e._memcpy=he._memcpy,e._memset=he._memset,e._numHexagons=he._numHexagons,e._pentagonIndexCount=he._pentagonIndexCount,e._pointDistKm=he._pointDistKm,e._pointDistM=he._pointDistM,e._pointDistRads=he._pointDistRads,e._polyfill=he._polyfill,e._res0IndexCount=he._res0IndexCount,e._round=he._round,e._sbrk=he._sbrk,e._sizeOfCoordIJ=he._sizeOfCoordIJ,e._sizeOfGeoBoundary=he._sizeOfGeoBoundary,e._sizeOfGeoCoord=he._sizeOfGeoCoord,e._sizeOfGeoPolygon=he._sizeOfGeoPolygon,e._sizeOfGeofence=he._sizeOfGeofence,e._sizeOfH3Index=he._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=he._sizeOfLinkedGeoPolygon,e._uncompact=he._uncompact,e.establishStackSpace=he.establishStackSpace;var Tc=e.stackAlloc=he.stackAlloc,td=e.stackRestore=he.stackRestore,Cc=e.stackSave=he.stackSave;if(e.asm=he,e.cwrap=I,e.setValue=w,e.getValue=C,e.getTempRet0=m,Rt){mc(Rt)||(Rt=s(Rt));{pc();var nA=function(Y){Y.byteLength&&(Y=new Uint8Array(Y)),Ae.set(Y,v),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,po()},bc=function(){o(Rt,nA,function(){throw"could not load memory initializer "+Rt})},Sc=tA(Rt);if(Sc)nA(Sc.buffer);else if(e.memoryInitializerRequest){var Ps=function(){var Y=e.memoryInitializerRequest,ie=Y.response;if(Y.status!==200&&Y.status!==0){var fe=tA(e.memoryInitializerRequestURL);if(fe)ie=fe.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+Y.status+", retrying "+Rt),bc();return}}nA(ie)};e.memoryInitializerRequest.response?setTimeout(Ps,0):e.memoryInitializerRequest.addEventListener("load",Ps)}else bc()}}var vo;Or=function Y(){vo||iA(),vo||(Or=Y)};function iA(Y){if(En>0||(Bt(),En>0))return;function ie(){vo||(vo=!0,!S&&(cr(),Lt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),ln()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),ie()},1)):ie()}e.run=iA;function zi(Y){throw e.onAbort&&e.onAbort(Y),Y+="",a(Y),c(Y),S=!0,"abort("+Y+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=zi,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return iA(),t}(typeof bt=="object"?bt:{}),Me="number",BA=Me,Fe=Me,He=Me,In=Me,$e=Me,SH=[["sizeOfH3Index",Me],["sizeOfGeoCoord",Me],["sizeOfGeoBoundary",Me],["sizeOfGeoPolygon",Me],["sizeOfGeofence",Me],["sizeOfLinkedGeoPolygon",Me],["sizeOfCoordIJ",Me],["h3IsValid",BA,[Fe,He]],["geoToH3",Fe,[Me,Me,In]],["h3ToGeo",null,[Fe,He,$e]],["h3ToGeoBoundary",null,[Fe,He,$e]],["maxKringSize",Me,[Me]],["kRing",null,[Fe,He,Me,$e]],["kRingDistances",null,[Fe,He,Me,$e,$e]],["hexRing",null,[Fe,He,Me,$e]],["maxPolyfillSize",Me,[$e,In]],["polyfill",null,[$e,In,$e]],["h3SetToLinkedGeo",null,[$e,Me,$e]],["destroyLinkedPolygon",null,[$e]],["compact",Me,[$e,$e,Me]],["uncompact",Me,[$e,Me,$e,Me,In]],["maxUncompactSize",Me,[$e,Me,In]],["h3IsPentagon",BA,[Fe,He]],["h3IsResClassIII",BA,[Fe,He]],["h3GetBaseCell",Me,[Fe,He]],["h3GetResolution",Me,[Fe,He]],["maxFaceCount",Me,[Fe,He]],["h3GetFaces",null,[Fe,He,$e]],["h3ToParent",Fe,[Fe,He,In]],["h3ToChildren",null,[Fe,He,In,$e]],["h3ToCenterChild",Fe,[Fe,He,In]],["maxH3ToChildrenSize",Me,[Fe,He,In]],["h3IndexesAreNeighbors",BA,[Fe,He,Fe,He]],["getH3UnidirectionalEdge",Fe,[Fe,He,Fe,He]],["getOriginH3IndexFromUnidirectionalEdge",Fe,[Fe,He]],["getDestinationH3IndexFromUnidirectionalEdge",Fe,[Fe,He]],["h3UnidirectionalEdgeIsValid",BA,[Fe,He]],["getH3IndexesFromUnidirectionalEdge",null,[Fe,He,$e]],["getH3UnidirectionalEdgesFromHexagon",null,[Fe,He,$e]],["getH3UnidirectionalEdgeBoundary",null,[Fe,He,$e]],["h3Distance",Me,[Fe,He,Fe,He]],["h3Line",Me,[Fe,He,Fe,He,$e]],["h3LineSize",Me,[Fe,He,Fe,He]],["experimentalH3ToLocalIj",Me,[Fe,He,Fe,He,$e]],["experimentalLocalIjToH3",Me,[Fe,He,$e,$e]],["hexAreaM2",Me,[In]],["hexAreaKm2",Me,[In]],["edgeLengthM",Me,[In]],["edgeLengthKm",Me,[In]],["pointDistM",Me,[$e,$e]],["pointDistKm",Me,[$e,$e]],["pointDistRads",Me,[$e,$e]],["cellAreaM2",Me,[Fe,He]],["cellAreaKm2",Me,[Fe,He]],["cellAreaRads2",Me,[Fe,He]],["exactEdgeLengthM",Me,[Fe,He]],["exactEdgeLengthKm",Me,[Fe,He]],["exactEdgeLengthRads",Me,[Fe,He]],["numHexagons",Me,[In]],["getRes0Indexes",null,[$e]],["res0IndexCount",Me],["getPentagonIndexes",null,[Me,$e]],["pentagonIndexCount",Me]],qt={};SH.forEach(function(e){qt[e[0]]=bt.cwrap.apply(bt,e)});var Aa=16,xH=4,DE=4,ka=8,PH=qt.sizeOfH3Index(),t3=qt.sizeOfGeoCoord(),MH=qt.sizeOfGeoBoundary();qt.sizeOfGeoPolygon();qt.sizeOfGeofence();var IH=qt.sizeOfLinkedGeoPolygon();qt.sizeOfCoordIJ();var kE={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function BH(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var LH=/[^0-9a-fA-F]/;function ao(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||LH.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),Aa),n=parseInt(t.substring(t.length-8),Aa);return[n,e]}function NE(t){if(t>=0)return t.toString(Aa);t=t&2147483647;var e=n3(8,t.toString(Aa)),n=(parseInt(e[0],Aa)+8).toString(Aa);return e=n+e.substring(1),e}function RH(t,e){return NE(e)+n3(8,NE(t))}function n3(t,e){for(var n=t-e.length,i="",r=0;r<n;r++)i+="0";return i=i+e,i}function OH(t){var e=bt.getTempRet0();return[t,e]}function FH(t){var e=OH(t),n=e[0],i=e[1];return i?RH(n,i):null}function DH(t,e,n){bt.HEAPU32.set(ao(t),e/xH+2*n)}function kH(t,e){for(var n=e.length,i=0;i<n;i++)DH(e[i],t,i)}function nf(t){return JH(bt.getValue(t,"double"))}function Q1(t){return[nf(t),nf(t+ka)]}function i3(t){return[nf(t+ka),nf(t)]}function NH(t,e,n){for(var i=bt.getValue(t,"i32"),r=t+ka,s=[],o=e?i3:Q1,a=0;a<i*2;a+=2)s.push(o(r+ka*a));return n&&s.push(s[0]),s}function UH(t,e){for(var n=[],i=e?i3:Q1,r,s,o,a;t;){for(n.push(r=[]),s=bt.getValue(t,"i8*");s;){for(r.push(o=[]),a=bt.getValue(s,"i8*");a;)o.push(i(a)),a=bt.getValue(a+ka*2,"i8*");e&&o.push(o[0]),s=bt.getValue(s+DE*2,"i8*")}t=bt.getValue(t+DE*2,"i8*")}return n}function GH(t){var e=ao(t),n=e[0],i=e[1];return Boolean(qt.h3IsPentagon(n,i))}function zH(t){var e=ao(t),n=e[0],i=e[1];return qt.h3IsValid(n,i)?qt.h3GetResolution(n,i):-1}function VH(t,e,n){var i=bt._malloc(t3);bt.HEAPF64.set([t,e].map(XH),i/ka);var r=FH(qt.geoToH3(i,n));return bt._free(i),r}function X1(t){var e=bt._malloc(t3),n=ao(t),i=n[0],r=n[1];qt.h3ToGeo(i,r,e);var s=Q1(e);return bt._free(e),s}function HH(t,e){var n=bt._malloc(MH),i=ao(t),r=i[0],s=i[1];qt.h3ToGeoBoundary(r,s,n);var o=NH(n,e,e);return bt._free(n),o}function jH(t,e){if(!t||!t.length)return[];var n=t.length,i=bt._calloc(n,PH);kH(i,t);var r=bt._calloc(IH),s=r;qt.h3SetToLinkedGeo(i,n,r);var o=UH(r,e);return qt.destroyLinkedPolygon(s),bt._free(s),bt._free(i),o}function WH(t,e){var n=ao(t),i=n[0],r=n[1],s=ao(e),o=s[0],a=s[1];return qt.h3Distance(i,r,o,a)}function QH(t,e){switch(BH(t),e){case kE.m:return qt.edgeLengthM(t);case kE.km:return qt.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function XH(t){return t*Math.PI/180}function JH(t){return t*180/Math.PI}const YH={getHexagons:{type:"accessor",value:t=>t.hexagons}};class r3 extends Ja{initializeState(){Ya._checkH3Lib()}updateState({props:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagons){const{data:i,getHexagons:r}=e,s=[],{iterable:o,objectInfo:a}=ws(i);for(const c of o){a.index++;const f=r(c,a),p=jH(f,!0);for(const m of p)s.push(this.getSubLayerRow({polygon:m},c,a.index))}this.setState({polygons:s})}}indexToBounds(){return{data:this.state.polygons,getPolygon:e=>e.polygon}}}T(r3,"layerName","H3ClusterLayer");T(r3,"defaultProps",YH);const KH=10;function s3(t,e){e=e===void 0?t[0][0]:e;for(const n of t){const i=n[0]-e;i>180?n[0]-=360:i<-180&&(n[0]+=360)}}function ZH(t,e,n){const[i,r]=X1(t),s=e.length;s3(e,r);const o=e[0]===e[s-1]?s-1:s;for(let a=0;a<o;a++)e[a][0]=ps(r,e[a][0],n),e[a][1]=ps(i,e[a][1],n)}function qH(t,e,n){const i=t(e,n),[r,s]=X1(i);return[s,r]}function UE(t,e=1){const n=HH(t,!0);return e!==1?ZH(t,n,e):s3(n),n}function $H(t){const e=new Float64Array(t.length*2);let n=0;for(const i of t)e[n++]=i[0],e[n++]=i[1];return e}function ej(t,e){let n;return t==null?n=e:typeof t=="object"?n={...t,coverage:e}:n={getHexagon:t,coverage:e},n}const tj={...Xa.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class Ya extends Rr{constructor(...e){super(...e),T(this,"state",void 0)}initializeState(){Ya._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:e}){return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}updateState({props:e,changeFlags:n}){if(e.highPrecision!==!0&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){const i=this._calculateH3DataProps();this.setState(i)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,n=!1,i=!1;const{iterable:r,objectInfo:s}=ws(this.props.data);for(const o of r){s.index++;const a=this.props.getHexagon(o,s),c=zH(a);if(e<0){if(e=c,!this.props.highPrecision)break}else if(e!==c){i=!0;break}if(GH(a)){n=!0;break}}return{resolution:e,edgeLengthKM:e>=0?QH(e,"km"):0,hasMultipleRes:i,hasPentagon:n}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){const{resolution:e,hasPentagon:n,hasMultipleRes:i}=this.state,{viewport:r}=this.context;return Boolean(r==null?void 0:r.resolution)||i||n||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;const{resolution:n,edgeLengthKM:i,centerHex:r}=this.state;if(n<0)return;const s=this.props.centerHexagon||VH(e.latitude,e.longitude,n);if(r===s)return;if(r){const v=WH(r,s);if(v>=0&&v*i<KH)return}const{unitsPerMeter:o}=e.distanceScales;let a=UE(s);const[c,f]=X1(s),[p,m]=e.projectFlat([f,c]);a=a.map(v=>{const w=e.projectFlat(v);return[(w[0]-p)/o[0],(w[1]-m)/o[1]]}),this.setState({centerHex:s,vertices:a})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:e,material:n,coverage:i,extruded:r,wireframe:s,stroked:o,filled:a,lineWidthUnits:c,lineWidthScale:f,lineWidthMinPixels:p,lineWidthMaxPixels:m,getFillColor:v,getElevation:w,getLineColor:C,getLineWidth:S,transitions:R,updateTriggers:x}=this.props;return{elevationScale:e,extruded:r,coverage:i,wireframe:s,stroked:o,filled:a,lineWidthUnits:c,lineWidthScale:f,lineWidthMinPixels:p,lineWidthMaxPixels:m,material:n,getElevation:w,getFillColor:v,getLineColor:C,getLineWidth:S,transitions:R,updateTriggers:{getFillColor:x.getFillColor,getElevation:x.getElevation,getLineColor:x.getLineColor,getLineWidth:x.getLineWidth}}}_renderPolygonLayer(){const{data:e,getHexagon:n,updateTriggers:i,coverage:r}=this.props,s=this.getSubLayerClass("hexagon-cell-hifi",Xa),o=this._getForwardProps();return o.updateTriggers.getPolygon=ej(i.getHexagon,r),new s(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(a,c)=>{const f=n(a,c);return $H(UE(f,r))}})}_renderColumnLayer(){const{data:e,getHexagon:n,updateTriggers:i}=this.props,r=this.getSubLayerClass("hexagon-cell",F1),s=this._getForwardProps();return s.updateTriggers.getPosition=i.getHexagon,new r(s,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:s.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:qH.bind(null,n)})}}T(Ya,"defaultProps",tj);T(Ya,"layerName","H3HexagonLayer");T(Ya,"_checkH3Lib",()=>{});const P0=Math.PI/180,xu=new Float32Array(16),GE=new Float32Array(12);function zE(t,e,n){const i=e[0]*P0,r=e[1]*P0,s=e[2]*P0,o=Math.sin(s),a=Math.sin(i),c=Math.sin(r),f=Math.cos(s),p=Math.cos(i),m=Math.cos(r),v=n[0],w=n[1],C=n[2];t[0]=v*m*p,t[1]=v*c*p,t[2]=v*-a,t[3]=w*(-c*f+m*a*o),t[4]=w*(m*f+c*a*o),t[5]=w*p*o,t[6]=C*(c*o+m*a*f),t[7]=C*(-m*o+c*a*f),t[8]=C*p*f}function VE(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const o3={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:i,getOrientation:r,getScale:s,getTranslation:o,getTransformMatrix:a}=this.props,c=Array.isArray(a),f=c&&a.length===16,p=Array.isArray(s),m=Array.isArray(r),v=Array.isArray(o),w=f||!c&&Boolean(a(i[0]));w?t.constant=f:t.constant=m&&p&&v;const C=t.value;if(t.constant){let S;w?(xu.set(a),S=VE(xu)):(S=GE,zE(S,r,s),S.set(o,9)),t.value=new Float32Array(S)}else{let S=e*t.size;const{iterable:R,objectInfo:x}=ws(i,e,n);for(const P of R){x.index++;let I;if(w)xu.set(f?a:a(P,x)),I=VE(xu);else{I=GE;const F=m?r:r(P,x),H=p?s:s(P,x);zE(I,F,H),I.set(v?o:o(P,x),9)}C[S++]=I[0],C[S++]=I[1],C[S++]=I[2],C[S++]=I[3],C[S++]=I[4],C[S++]=I[5],C[S++]=I[6],C[S++]=I[7],C[S++]=I[8],C[S++]=I[9],C[S++]=I[10],C[S++]=I[11]}}}};function a3(t,e){return e===ze.CARTESIAN||e===ze.METER_OFFSETS||e===ze.DEFAULT&&!t.isGeospatial}const nj=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs

// Scale the model
uniform float sizeScale;
uniform bool composeModelMatrix;

// Primitive attributes
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;

// Instance attributes
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;

// Outputs to fragment shader
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    // using instancePositions as world coordinates
    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth
    // call project_normal before setting position to avoid rotation
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,ij=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {

// NOTE(Tarek): This is necessary because
// headless.gl reports the extension as
// available but does not support it in
// the shader.
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function HE(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),Re.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function rj(t,e){if(t.attributes)return HE(t.attributes,e),t instanceof pi?t:new pi(t);if(t.positions||t.POSITION)return HE(t,e),new pi({attributes:t});throw Error("Invalid mesh")}const sj=[0,0,0,255],oj={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:sj},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};class Vl extends Un{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){const e=!We(this.context.gl),n={};return Bf(this.context.gl,ft.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:nj,fs:ij,modules:[ar,OS,Ar],transpileToGLSL100:e,defines:n})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:o3}),this.setState({emptyTexture:new vn(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:i,changeFlags:r}=e;if(n.mesh!==i.mesh||r.extensionsChanged){var s;if((s=this.state.model)===null||s===void 0||s.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const o=n.mesh.attributes||n.mesh;this.setState({hasNormals:Boolean(o.NORMAL||o.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==i.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:i,coordinateSystem:r,_instanced:s}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:i,composeModelMatrix:!s||a3(n,r),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new Nn(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:rj(e,this.props._useMeshColors),isInstanced:!0}),{texture:i}=this.props,{emptyTexture:r}=this.state;return n.setUniforms({sampler:i||r,hasTexture:Boolean(i)}),n}setTexture(e){const{emptyTexture:n,model:i}=this.state;i&&i.setUniforms({sampler:e||n,hasTexture:Boolean(e)})}}T(Vl,"defaultProps",oj);T(Vl,"layerName","SimpleMeshLayer");class va{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n}=e;this.id=n||rr(this.constructor.name),this.display=!0,this.position=new K,this.rotation=new K,this.scale=new K(1,1,1),this.matrix=new De,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}setPosition(e){return pe(e.length===3,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return pe(e.length===3,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return pe(e.length===3,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:n,rotation:i,scale:r,update:s=!0}=e;return n&&this.setPosition(n),i&&this.setRotation(i),r&&this.setScale(r),s&&this.updateMatrix(),this}updateMatrix(){const e=this.position,n=this.rotation,i=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(i),this}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:n,rotation:i,scale:r}=e;return n&&this.setPosition(n),i&&this.setRotation(i),r&&this.setScale(r),this.updateMatrix(),this}getCoordinateUniforms(e,n){pe(e),n=n||this.matrix;const i=new De(e).multiplyRight(n),r=i.invert(),s=r.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:i,worldInverseMatrix:r,worldInverseTransposeMatrix:s}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class ll extends va{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:n=[]}=e;Se.assert(n.every(i=>i instanceof va),"every child must an instance of ScenegraphNode"),super(e),this.children=n}add(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];for(const r of n)Array.isArray(r)?this.add(...r):this.children.push(r);return this}remove(e){const n=this.children,i=n.indexOf(e);return i>-1&&n.splice(i,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}traverse(e){let{worldMatrix:n=new De}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=new De(n).multiplyRight(this.matrix);for(const r of this.children)r instanceof ll?r.traverse(e,{worldMatrix:i}):e(r,{worldMatrix:i})}}const aj={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Aj={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function jE(t){if(!t._animation){const e=Aj[t.componentType],n=aj[t.type],i=n*t.count,{buffer:r,byteOffset:s}=t.bufferView.data,o=new e(r,s+(t.byteOffset||0),i);if(n===1)t._animation=Array.from(o);else{const a=[];for(let c=0;c<o.length;c+=n)a.push(Array.from(o.slice(c,c+n)));t._animation=a}}return t._animation}const lj=new De;function cj(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=lj.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}const M0=new Il;function uj(t,e,n,i,r){if(e==="rotation"){M0.slerp({start:n,target:i,ratio:r});for(let s=0;s<M0.length;s++)t[e][s]=M0[s]}else for(let s=0;s<n.length;s++)t[e][s]=r*i[s]+(1-r)*n[s]}function hj(t,e,n){let{p0:i,outTangent0:r,inTangent1:s,p1:o,tDiff:a,ratio:c}=n;for(let f=0;f<t[e].length;f++){const p=r[f]*a,m=s[f]*a;t[e][f]=(2*Math.pow(c,3)-3*Math.pow(c,2)+1)*i[f]+(Math.pow(c,3)-2*Math.pow(c,2)+c)*p+(-2*Math.pow(c,3)+3*Math.pow(c,2))*o[f]+(Math.pow(c,3)-Math.pow(c,2))*m}}function fj(t,e,n){for(let i=0;i<n.length;i++)t[e][i]=n[i]}function dj(t,e,n,i){let{input:r,interpolation:s,output:o}=e;const a=r[r.length-1],c=t%a,f=r.findIndex(w=>w>=c),p=Math.max(0,f-1);if(!Array.isArray(n[i]))switch(i){case"translation":n[i]=[0,0,0];break;case"rotation":n[i]=[0,0,0,1];break;case"scale":n[i]=[1,1,1];break;default:Se.warn("Bad animation path ".concat(i))()}pe(n[i].length===o[p].length);const m=r[p],v=r[f];switch(s){case"STEP":fj(n,i,o[p]);break;case"LINEAR":if(v>m){const w=(c-m)/(v-m);uj(n,i,o[p],o[f],w)}break;case"CUBICSPLINE":if(v>m){const w=(c-m)/(v-m),C=v-m,S=o[3*p+1],R=o[3*p+2],x=o[3*f+0],P=o[3*f+1];hj(n,i,{p0:S,outTangent0:R,inTangent1:x,p1:P,tDiff:C,ratio:w})}break;default:Se.warn("Interpolation ".concat(s," not supported"))();break}}class gj{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const i=(e/1e3-this.startTime)*this.speed;this.channels.forEach(r=>{let{sampler:s,target:o,path:a}=r;dj(i,s,o,a),cj(o,o._node)})}}class pj{constructor(e){this.animations=e.animations.map((n,i)=>{const r=n.name||"Animation-".concat(i),s=n.samplers.map(a=>{let{input:c,interpolation:f="LINEAR",output:p}=a;return{input:jE(e.accessors[c]),interpolation:f,output:jE(e.accessors[p])}}),o=n.channels.map(a=>{let{sampler:c,target:f}=a;return{sampler:s[c],target:e.nodes[f.node],path:f.path}});return new gj({name:r,channels:o})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(n=>n.animate(e))}getAnimations(){return this.animations}}class mj extends va{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(n),this.onBeforeRender=null,this.AfterRender=null,e instanceof Nn?(this.model=e,this._setModelNodeProps(n)):this.model=new Nn(e,n),this.managedResources=n.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class A3{constructor(e,n){let{attributes:i,material:r,pbrDebug:s,imageBasedLightingEnvironment:o,lights:a,useTangents:c}=n;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},Bf(e,ft.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],o&&(this.uniforms.u_DiffuseEnvSampler=o.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=o.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=o.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),s&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(i.NORMAL,"HAS_NORMALS"),this.defineIfPresent(i.TANGENT&&c,"HAS_TANGENTS"),this.defineIfPresent(i.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(o,"USE_IBL"),this.defineIfPresent(a,"USE_LIGHTS"),this.defineIfPresent(s,"PBR_DEBUG"),r&&this.parseMaterial(r)}defineIfPresent(e,n){e&&(this.defines[n]=1)}parseTexture(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const r=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},s=e.texture.source.image;let o,a={};s.compressed?(o=s,a={[this.gl.TEXTURE_MIN_FILTER]:s.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):o={data:s};const c=new vn(this.gl,{id:e.name||e.id,parameters:{...r,...a},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...o});this.uniforms[n]=c,this.defineIfPresent(i,i),this.generatedTextures.push(c)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:n=1,roughnessFactor:i=1}=e;this.uniforms.u_MetallicRoughnessValues=[n,i]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=Boolean(e.unlit),e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:n=1}=e.normalTexture;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:n=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=n}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode==="MASK"){const{alphaCutoff:n=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=n}else e.alphaMode==="BLEND"&&(Se.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}const _j=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,yj=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function WE(t,e){return We(t)?`#version 300 es
`.concat(e):e}function vj(t,e){const{id:n,drawMode:i,vertexCount:r,attributes:s,modelOptions:o}=e,a=new A3(t,e);Se.info(4,"createGLTFModel defines: ",a.defines)();const c=[];c.push(...a.generatedTextures),c.push(...Object.values(s).map(p=>p.buffer));const f=new mj(t,Object.assign({id:n,drawMode:i,vertexCount:r,modules:[m1],defines:a.defines,parameters:a.parameters,vs:WE(t,_j),fs:WE(t,yj),managedResources:c},o));return f.setProps({attributes:s}),f.setUniforms(a.uniforms),f}const Ej={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},wj={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Tj{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.options=Object.assign({},wj,n)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(i=>this.createScene(i))}createAnimator(){return Array.isArray(this.gltf.animations)?new pj(this.gltf):null}createScene(e){const i=(e.nodes||[]).map(s=>this.createNode(s));return new ll({id:e.name||e.id,children:i})}createNode(e){if(!e._node){const i=(e.children||[]).map(s=>this.createNode(s));e.mesh&&i.push(this.createMesh(e.mesh));const r=new ll({id:e.name||e.id,children:i});if(e.matrix)r.setMatrix(e.matrix);else{if(r.matrix.identity(),e.translation&&r.matrix.translate(e.translation),e.rotation){const s=new De().fromQuaternion(e.rotation);r.matrix.multiplyRight(s)}e.scale&&r.matrix.scale(e.scale)}e._node=r}return e._node}createMesh(e){if(!e._mesh){const i=(e.primitives||[]).map((s,o)=>this.createPrimitive(s,o,e)),r=new ll({id:e.name||e.id,children:i});e._mesh=r}return e._mesh}getVertexCount(e){Se.warn("getVertexCount() not found")()}createPrimitive(e,n,i){return vj(this.gl,Object.assign({id:e.name||"".concat(i.name||i.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options))}createAttributes(e,n){const i={};return Object.keys(e).forEach(r=>{i[r]=this.createAccessor(e[r],this.createBuffer(e[r],this.gl.ARRAY_BUFFER))}),n&&(i.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),Se.info(4,"glTF Attributes",{attributes:e,indices:n,generated:i})(),i}createBuffer(e,n){e.bufferView||(e.bufferView={});const{bufferView:i}=e;return i.lumaBuffers||(i.lumaBuffers={}),i.lumaBuffers[n]||(i.lumaBuffers[n]=new ct(this.gl,{id:"from-".concat(i.id),data:i.data||e.value,target:n})),i.lumaBuffers[n]}createAccessor(e,n){return new Rn({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:Ej[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function Cj(t,e,n){const i=new Tj(t,n),r=i.instantiate(e),s=i.createAnimator();return{scenes:r,animator:s}}const bj="3.2.6",Sj="3.2.6",l3="3.2.6",xj="https://unpkg.com/@loaders.gl/textures@".concat(l3,"/dist/libs/basis_encoder.wasm"),Pj="https://unpkg.com/@loaders.gl/textures@".concat(l3,"/dist/libs/basis_encoder.js");let I0;async function QE(t){const e=t.modules||{};return e.basis?e.basis:(I0=I0||Mj(t),await I0)}async function Mj(t){let e=null,n=null;return[e,n]=await Promise.all([await Zs("basis_transcoder.js","textures",t),await Zs("basis_transcoder.wasm","textures",t)]),e=e||globalThis.BASIS,await Ij(e,n)}function Ij(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(i=>{t(n).then(r=>{const{BasisFile:s,initializeBasis:o}=r;o(),i({BasisFile:s})})})}let B0;async function XE(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(B0=B0||Bj(t),await B0)}async function Bj(t){let e=null,n=null;return[e,n]=await Promise.all([await Zs(Pj,"textures",t),await Zs(xj,"textures",t)]),e=e||globalThis.BASIS,await Lj(e,n)}function Lj(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(i=>{t(n).then(r=>{const{BasisFile:s,KTX2File:o,initializeBasis:a,BasisEncoder:c}=r;a(),i({BasisFile:s,KTX2File:o,BasisEncoder:c})})})}const Do={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},Rj=["","WEBKIT_","MOZ_"],JE={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let Pu=null;function Oj(t){if(!Pu){t=t||Fj()||void 0,Pu=new Set;for(const e of Rj)for(const n in JE)if(t&&t.getExtension("".concat(e).concat(n))){const i=JE[n];Pu.add(i)}}return Pu}function Fj(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var YE,KE,ZE,qE,$E,ew,tw,nw;(function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"})(YE||(YE={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(KE||(KE={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(ZE||(ZE={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}(qE||(qE={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}($E||($E={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(ew||(ew={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(tw||(tw={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(nw||(nw={}));const Qn=[171,75,84,88,32,50,48,187,13,10,26,10];function Dj(t){const e=new Uint8Array(t);return!(e.byteLength<Qn.length||e[0]!==Qn[0]||e[1]!==Qn[1]||e[2]!==Qn[2]||e[3]!==Qn[3]||e[4]!==Qn[4]||e[5]!==Qn[5]||e[6]!==Qn[6]||e[7]!==Qn[7]||e[8]!==Qn[8]||e[9]!==Qn[9]||e[10]!==Qn[10]||e[11]!==Qn[11])}const kj={etc1:{basisFormat:0,compressed:!0,format:Do.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Do.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Do.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Do.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Do.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Do.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function Nj(t,e){if(e.basis.containerFormat==="auto"){if(Dj(t)){const i=await XE(e);return iw(i.KTX2File,t,e)}const{BasisFile:n}=await QE(e);return L0(n,t,e)}switch(e.basis.module){case"encoder":const n=await XE(e);switch(e.basis.containerFormat){case"ktx2":return iw(n.KTX2File,t,e);case"basis":default:return L0(n.BasisFile,t,e)}case"transcoder":default:const{BasisFile:i}=await QE(e);return L0(i,t,e)}}function L0(t,e,n){const i=new t(new Uint8Array(e));try{if(!i.startTranscoding())throw new Error("Failed to start basis transcoding");const r=i.getNumImages(),s=[];for(let o=0;o<r;o++){const a=i.getNumLevels(o),c=[];for(let f=0;f<a;f++)c.push(Uj(i,o,f,n));s.push(c)}return s}finally{i.close(),i.delete()}}function Uj(t,e,n,i){const r=t.getImageWidth(e,n),s=t.getImageHeight(e,n),o=t.getHasAlpha(),{compressed:a,format:c,basisFormat:f}=c3(i,o),p=t.getImageTranscodedSizeInBytes(e,n,f),m=new Uint8Array(p);if(!t.transcodeImage(m,e,n,f,0,0))throw new Error("failed to start Basis transcoding");return{width:r,height:s,data:m,compressed:a,format:c,hasAlpha:o}}function iw(t,e,n){const i=new t(new Uint8Array(e));try{if(!i.startTranscoding())throw new Error("failed to start KTX2 transcoding");const r=i.getLevels(),s=[];for(let o=0;o<r;o++){s.push(Gj(i,o,n));break}return[s]}finally{i.close(),i.delete()}}function Gj(t,e,n){const{alphaFlag:i,height:r,width:s}=t.getImageLevelInfo(e,0,0),{compressed:o,format:a,basisFormat:c}=c3(n,i),f=t.getImageTranscodedSizeInBytes(e,0,0,c),p=new Uint8Array(f);if(!t.transcodeImage(p,e,0,0,c,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:s,height:r,data:p,compressed:o,hasAlpha:i,format:a}}function c3(t,e){let n=t&&t.basis&&t.basis.format;return n==="auto"&&(n=u3()),typeof n=="object"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),kj[n]}function u3(){const t=Oj();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const zj={name:"Basis",id:"basis",module:"textures",version:Sj,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},Vj={...zj,parse:Nj};function qn(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function h3(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const i=e.baseUri||e.uri;if(!i)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return i.substr(0,i.lastIndexOf("/")+1)+t}function Hj(t,e,n){const i=t.bufferViews[n];qn(i);const r=i.buffer,s=e[r];qn(s);const o=(i.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,o,i.byteLength)}const rw=["SCALAR","VEC2","VEC3","VEC4"],jj=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Wj=new Map(jj),Qj={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Xj={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Jj={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function f3(t){return rw[t-1]||rw[0]}function d3(t){const e=Wj.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function g3(t,e){const n=Jj[t.componentType],i=Qj[t.type],r=Xj[t.componentType],s=t.count*i,o=t.count*i*r;return qn(o>=0&&o<=e.byteLength),{ArrayType:n,length:s,byteLength:o}}const Yj={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class yi{constructor(e){T(this,"gltf",void 0),T(this,"sourceBuffers",void 0),T(this,"byteLength",void 0),this.gltf=e||{json:{...Yj},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){const n=this.getUsedExtensions().find(r=>r===e),i=this.json.extensions||{};return n?i[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(i=>i===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if(typeof n=="object")return n;const i=this.json[e]&&this.json[e][n];if(!i)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(n,"]"));return i}getTypedArrayForBufferView(e){e=this.getBufferView(e);const n=e.buffer,i=this.gltf.buffers[n];qn(i);const r=(e.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,r,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),r=this.getBuffer(n.buffer).data,{ArrayType:s,length:o}=g3(e,n),a=n.byteOffset+e.byteOffset;return new s(r,a,o)}getTypedArrayForImageData(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),r=this.getBuffer(n.buffer).data,s=n.byteOffset||0;return new Uint8Array(r,s,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,i){return e.extensions=e.extensions||{},e.extensions[n]=i,this.registerUsedExtension(n),this}setObjectExtension(e,n,i){const r=e.extensions||{};r[n]=i}removeObjectExtension(e,n){const i=e.extensions||{},r=i[n];return delete i[n],r}addExtension(e,n={}){return qn(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e,n={}){return qn(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e]}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){const{meshIndex:n,matrix:i}=e;this.json.nodes=this.json.nodes||[];const r={mesh:n};return i&&(r.matrix=i),this.json.nodes.push(r),this.json.nodes.length-1}addMesh(e){const{attributes:n,indices:i,material:r,mode:s=4}=e,a={primitives:[{attributes:this._addAttributes(n),mode:s}]};if(i){const c=this._addIndices(i);a.primitives[0].indices=c}return Number.isFinite(r)&&(a.primitives[0].material=r),this.json.meshes=this.json.meshes||[],this.json.meshes.push(a),this.json.meshes.length-1}addPointCloud(e){const i={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(i),this.json.meshes.length-1}addImage(e,n){const i=Jm(e),r=n||(i==null?void 0:i.mimeType),o={bufferView:this.addBufferView(e),mimeType:r};return this.json.images=this.json.images||[],this.json.images.push(o),this.json.images.length-1}addBufferView(e){const n=e.byteLength;qn(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const i={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=Zl(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(i),this.json.bufferViews.length-1}addAccessor(e,n){const i={bufferView:e,type:f3(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(i),this.json.accessors.length-1}addBinaryBuffer(e,n={size:3}){const i=this.addBufferView(e);let r={min:n.min,max:n.max};(!r.min||!r.max)&&(r=this._getAccessorMinMax(e,n.size));const s={size:n.size,componentType:d3(e),count:Math.round(e.length/n.size),min:r.min,max:r.max};return this.addAccessor(i,Object.assign(s,n))}addTexture(e){const{imageIndex:n}=e,i={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(i),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];const i=this.byteLength,r=new ArrayBuffer(i),s=new Uint8Array(r);let o=0;for(const a of this.sourceBuffers||[])o=eR(a,s,o);(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=i:this.json.buffers=[{byteLength:i}],this.gltf.binary=r,this.sourceBuffers=[r]}_removeStringFromArray(e,n){let i=!0;for(;i;){const r=e.indexOf(n);r>-1?e.splice(r,1):i=!1}}_addAttributes(e={}){const n={};for(const i in e){const r=e[i],s=this._getGltfAttributeName(i),o=this.addBinaryBuffer(r.value,r);n[s]=o}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){const i={min:null,max:null};if(e.length<n)return i;i.min=[],i.max=[];const r=e.subarray(0,n);for(const s of r)i.min.push(s),i.max.push(s);for(let s=n;s<e.length;s+=n)for(let o=0;o<n;o++)i.min[0+o]=Math.min(i.min[0+o],e[s+o]),i.max[0+o]=Math.max(i.max[0+o],e[s+o]);return i}}const Kj="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",Zj="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",qj=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),$j=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),e7={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},t7={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function n7(t,e,n,i,r,s="NONE"){const o=await i7();o7(o,o.exports[t7[r]],t,e,n,i,o.exports[e7[s||"NONE"]])}let R0;async function i7(){return R0||(R0=r7()),R0}async function r7(){let t=Kj;WebAssembly.validate(qj)&&(t=Zj,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(s7(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function s7(t){const e=new Uint8Array(t.length);for(let i=0;i<t.length;++i){const r=t.charCodeAt(i);e[i]=r>96?r-71:r>64?r-65:r>47?r+4:r>46?63:62}let n=0;for(let i=0;i<t.length;++i)e[n++]=e[i]<60?$j[e[i]]:(e[i]-60)*64+e[++i];return e.buffer.slice(0,n)}function o7(t,e,n,i,r,s,o){const a=t.exports.sbrk,c=i+3&-4,f=a(c*r),p=a(s.length),m=new Uint8Array(t.exports.memory.buffer);m.set(s,p);const v=e(f,i,r,p,s.length);if(v===0&&o&&o(f,c,r),n.set(m.subarray(f,f+i*r)),a(f-a(0)),v!==0)throw new Error("Malformed buffer data: ".concat(v))}const J1="EXT_meshopt_compression",a7=J1;async function A7(t,e){var n;const i=new yi(t);if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const r=[];for(const s of t.json.bufferViews||[])r.push(l7(i,s));await Promise.all(r),i.removeExtension(J1)}async function l7(t,e){const n=t.getObjectExtension(e,J1);if(n){const{byteOffset:i=0,byteLength:r=0,byteStride:s,count:o,mode:a,filter:c="NONE",buffer:f}=n,p=t.gltf.buffers[f],m=new Uint8Array(p.arrayBuffer,p.byteOffset+i,r),v=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return await n7(v,o,s,m,a,c),v}return null}const c7=Object.freeze(Object.defineProperty({__proto__:null,name:a7,decode:A7},Symbol.toStringTag,{value:"Module"})),Vo="EXT_texture_webp",u7=Vo;function h7(t,e){const n=new yi(t);if(!WO("image/webp")){if(n.getRequiredExtensions().includes(Vo))throw new Error("gltf: Required extension ".concat(Vo," not supported by browser"));return}const{json:i}=n;for(const r of i.textures||[]){const s=n.getObjectExtension(r,Vo);s&&(r.source=s.source),n.removeObjectExtension(r,Vo)}n.removeExtension(Vo)}const f7=Object.freeze(Object.defineProperty({__proto__:null,name:u7,preprocess:h7},Symbol.toStringTag,{value:"Module"})),lh="KHR_texture_basisu",d7=lh;function g7(t,e){const n=new yi(t),{json:i}=n;for(const r of i.textures||[]){const s=n.getObjectExtension(r,lh);s&&(r.source=s.source),n.removeObjectExtension(r,lh)}n.removeExtension(lh)}const p7=Object.freeze(Object.defineProperty({__proto__:null,name:d7,preprocess:g7},Symbol.toStringTag,{value:"Module"})),m7="3.2.6",_7={draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},y7={name:"Draco",id:"draco",module:"draco",shapes:["mesh"],version:m7,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:_7};function Y1(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;const a=t.POSITION?t.POSITION.value:[],c=a&&a.length;for(let f=0;f<c;f+=3){const p=a[f],m=a[f+1],v=a[f+2];e=p<e?p:e,n=m<n?m:n,i=v<i?v:i,r=p>r?p:r,s=m>s?m:s,o=v>o?v:o}return[[e,n,i],[r,s,o]]}function v7(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class la{constructor(e,n){T(this,"fields",void 0),T(this,"metadata",void 0),v7(Array.isArray(e)),E7(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(...e){const n=Object.create(null);for(const r of e)n[r]=!0;const i=this.fields.filter(r=>n[r.name]);return new la(i,this.metadata)}selectAt(...e){const n=e.map(i=>this.fields[i]).filter(Boolean);return new la(n,this.metadata)}assign(e){let n,i=this.metadata;if(e instanceof la){const o=e;n=o.fields,i=sw(sw(new Map,this.metadata),o.metadata)}else n=e;const r=Object.create(null);for(const o of this.fields)r[o.name]=o;for(const o of n)r[o.name]=o;const s=Object.values(r);return new la(s,i)}}function E7(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function sw(t,e){return new Map([...t||new Map,...e||new Map])}class rf{constructor(e,n,i=!1,r=new Map){T(this,"name",void 0),T(this,"type",void 0),T(this,"nullable",void 0),T(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=i,this.metadata=r}get typeId(){return this.type&&this.type.typeId}clone(){return new rf(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let Tt;(function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth"})(Tt||(Tt={}));let p3,m3,_3;class K1{static isNull(e){return e&&e.typeId===Tt.Null}static isInt(e){return e&&e.typeId===Tt.Int}static isFloat(e){return e&&e.typeId===Tt.Float}static isBinary(e){return e&&e.typeId===Tt.Binary}static isUtf8(e){return e&&e.typeId===Tt.Utf8}static isBool(e){return e&&e.typeId===Tt.Bool}static isDecimal(e){return e&&e.typeId===Tt.Decimal}static isDate(e){return e&&e.typeId===Tt.Date}static isTime(e){return e&&e.typeId===Tt.Time}static isTimestamp(e){return e&&e.typeId===Tt.Timestamp}static isInterval(e){return e&&e.typeId===Tt.Interval}static isList(e){return e&&e.typeId===Tt.List}static isStruct(e){return e&&e.typeId===Tt.Struct}static isUnion(e){return e&&e.typeId===Tt.Union}static isFixedSizeBinary(e){return e&&e.typeId===Tt.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===Tt.FixedSizeList}static isMap(e){return e&&e.typeId===Tt.Map}static isDictionary(e){return e&&e.typeId===Tt.Dictionary}get typeId(){return Tt.NONE}compareTo(e){return this===e}}p3=Symbol.toStringTag;class Ka extends K1{constructor(e,n){super(),T(this,"isSigned",void 0),T(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return Tt.Int}get[p3](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class w7 extends Ka{constructor(){super(!0,8)}}class T7 extends Ka{constructor(){super(!0,16)}}class C7 extends Ka{constructor(){super(!0,32)}}class b7 extends Ka{constructor(){super(!1,8)}}class S7 extends Ka{constructor(){super(!1,16)}}class x7 extends Ka{constructor(){super(!1,32)}}const y3={HALF:16,SINGLE:32,DOUBLE:64};m3=Symbol.toStringTag;class v3 extends K1{constructor(e){super(),T(this,"precision",void 0),this.precision=e}get typeId(){return Tt.Float}get[m3](){return"Float"}toString(){return"Float".concat(this.precision)}}class P7 extends v3{constructor(){super(y3.SINGLE)}}class M7 extends v3{constructor(){super(y3.DOUBLE)}}_3=Symbol.toStringTag;class I7 extends K1{constructor(e,n){super(),T(this,"listSize",void 0),T(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return Tt.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[_3](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function B7(t){switch(t.constructor){case Int8Array:return new w7;case Uint8Array:return new b7;case Int16Array:return new T7;case Uint16Array:return new S7;case Int32Array:return new C7;case Uint32Array:return new x7;case Float32Array:return new P7;case Float64Array:return new M7;default:throw new Error("array type not supported")}}function L7(t,e,n){const i=B7(e.value),r=n||R7(e);return new rf(t,new I7(e.size,new rf("value",i)),!1,r)}function R7(t){const e=new Map;return"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&e.set("normalized",t.normalized.toString()),e}function O7(t,e,n){const i=E3(e.metadata),r=[],s=F7(e.attributes);for(const o in t){const a=t[o],c=ow(o,a,s[o]);r.push(c)}if(n){const o=ow("indices",n);r.push(o)}return new la(r,i)}function F7(t){const e={};for(const n in t){const i=t[n];e[i.name||"undefined"]=i}return e}function ow(t,e,n){const i=n?E3(n.metadata):void 0;return L7(t,e,i)}function E3(t){const e=new Map;for(const n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}const aw={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},D7={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},k7=4;class N7{constructor(e){T(this,"draco",void 0),T(this,"decoder",void 0),T(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e,n={}){const i=new this.draco.DecoderBuffer;i.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);const r=this.decoder.GetEncodedGeometryType(i),s=r===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let o;switch(r){case this.draco.TRIANGULAR_MESH:o=this.decoder.DecodeBufferToMesh(i,s);break;case this.draco.POINT_CLOUD:o=this.decoder.DecodeBufferToPointCloud(i,s);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!o.ok()||!s.ptr){const v="DRACO decompression failed: ".concat(o.error_msg());throw new Error(v)}const a=this._getDracoLoaderData(s,r,n),c=this._getMeshData(s,a,n),f=Y1(c.attributes),p=O7(c.attributes,a,c.indices);return{loader:"draco",loaderData:a,header:{vertexCount:s.num_points(),boundingBox:f},...c,schema:p}}finally{this.draco.destroy(i),s&&this.draco.destroy(s)}}_getDracoLoaderData(e,n,i){const r=this._getTopLevelMetadata(e),s=this._getDracoAttributes(e,i);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:r,attributes:s}}_getDracoAttributes(e,n){const i={};for(let r=0;r<e.num_attributes();r++){const s=this.decoder.GetAttribute(e,r),o=this._getAttributeMetadata(e,r);i[s.unique_id()]={unique_id:s.unique_id(),attribute_type:s.attribute_type(),data_type:s.data_type(),num_components:s.num_components(),byte_offset:s.byte_offset(),byte_stride:s.byte_stride(),normalized:s.normalized(),attribute_index:r,metadata:o};const a=this._getQuantizationTransform(s,n);a&&(i[s.unique_id()].quantization_transform=a);const c=this._getOctahedronTransform(s,n);c&&(i[s.unique_id()].octahedron_transform=c)}return i}_getMeshData(e,n,i){const r=this._getMeshAttributes(n,e,i);if(!r.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(i.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:r,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:r,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:r}}_getMeshAttributes(e,n,i){const r={};for(const s of Object.values(e.attributes)){const o=this._deduceAttributeName(s,i);s.name=o;const{value:a,size:c}=this._getAttributeValues(n,s);r[o]={value:a,size:c,byteOffset:s.byte_offset,byteStride:s.byte_stride,normalized:s.normalized}}return r}_getTriangleListIndices(e){const i=e.num_faces()*3,r=i*k7,s=this.draco._malloc(r);try{return this.decoder.GetTrianglesUInt32Array(e,r,s),new Uint32Array(this.draco.HEAPF32.buffer,s,i).slice()}finally{this.draco._free(s)}}_getTriangleStripIndices(e){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),z7(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){const i=D7[n.data_type],r=n.num_components,o=e.num_points()*r,a=o*i.BYTES_PER_ELEMENT,c=U7(this.draco,i);let f;const p=this.draco._malloc(a);try{const m=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,m,c,a,p),f=new i(this.draco.HEAPF32.buffer,p,o).slice()}finally{this.draco._free(p)}return{value:f,size:r}}_deduceAttributeName(e,n){const i=e.unique_id;for(const[o,a]of Object.entries(n.extraAttributes||{}))if(a===i)return o;const r=e.attribute_type;for(const o in aw)if(this.draco[o]===r)return aw[o];const s=n.attributeNameEntry||"name";return e.metadata[s]?e.metadata[s].string:"CUSTOM_ATTRIBUTE_".concat(i)}_getTopLevelMetadata(e){const n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){const i=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(i)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const n={},i=this.metadataQuerier.NumEntries(e);for(let r=0;r<i;r++){const s=this.metadataQuerier.GetEntryName(e,r);n[s]=this._getDracoMetadataField(e,s)}return n}_getDracoMetadataField(e,n){const i=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,i);const r=G7(i);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:r}}finally{this.draco.destroy(i)}}_disableAttributeTransforms(e){const{quantizedAttributes:n=[],octahedronAttributes:i=[]}=e,r=[...n,...i];for(const s of r)this.decoder.SkipAttributeTransform(this.draco[s])}_getQuantizationTransform(e,n){const{quantizedAttributes:i=[]}=n,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits(),range:o.range(),min_values:new Float32Array([1,2,3]).map(a=>o.min_value(a))}}finally{this.draco.destroy(o)}}return null}_getOctahedronTransform(e,n){const{octahedronAttributes:i=[]}=n,r=e.attribute_type();if(i.map(o=>this.decoder[o]).includes(r)){const o=new this.draco.AttributeQuantizationTransform;try{if(o.InitFromAttribute(e))return{quantization_bits:o.quantization_bits()}}finally{this.draco.destroy(o)}}return null}}function U7(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function G7(t){const e=t.size(),n=new Int32Array(e);for(let i=0;i<e;i++)n[i]=t.GetValue(i);return n}function z7(t){const e=t.size(),n=new Int32Array(e);for(let i=0;i<e;i++)n[i]=t.GetValue(i);return n}const Z1="1.4.1",V7="https://www.gstatic.com/draco/versioned/decoders/".concat(Z1,"/draco_decoder.js"),H7="https://www.gstatic.com/draco/versioned/decoders/".concat(Z1,"/draco_wasm_wrapper.js"),j7="https://www.gstatic.com/draco/versioned/decoders/".concat(Z1,"/draco_decoder.wasm");let LA;async function W7(t){const e=t.modules||{};return e.draco3d?LA=LA||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):LA=LA||Q7(t),await LA}async function Q7(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await Zs(V7,"draco",t);break;case"wasm":default:[e,n]=await Promise.all([await Zs(H7,"draco",t),await Zs(j7,"draco",t)])}return e=e||globalThis.DracoDecoderModule,await X7(e,n)}function X7(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(i=>{t({...n,onModuleLoaded:r=>i({draco:r})})})}const w3={...y7,parse:J7};async function J7(t,e){const{draco:n}=await W7(e),i=new N7(n);try{return i.parseSync(t,e==null?void 0:e.draco)}finally{i.destroy()}}function Y7(t){const e={};for(const n in t){const i=t[n];if(n!=="indices"){const r=T3(i);e[n]=r}}return e}function T3(t){const{buffer:e,size:n,count:i}=K7(t);return{value:e,size:n,byteOffset:0,count:i,type:f3(n),componentType:d3(e)}}function K7(t){let e=t,n=1,i=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=Z7(e,Float32Array)),i=e.length/n),{buffer:e,size:n,count:i}}function Z7(t,e,n=!1){return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}const Ao="KHR_draco_mesh_compression",q7=Ao;function $7(t,e,n){const i=new yi(t);for(const r of C3(i))i.getObjectExtension(r,Ao)}async function eW(t,e,n){var i;if(!(e!=null&&(i=e.gltf)!==null&&i!==void 0&&i.decompressMeshes))return;const r=new yi(t),s=[];for(const o of C3(r))r.getObjectExtension(o,Ao)&&s.push(nW(r,o,e,n));await Promise.all(s),r.removeExtension(Ao)}function tW(t,e={}){const n=new yi(t);for(const i of n.json.meshes||[])iW(i),n.addRequiredExtension(Ao)}async function nW(t,e,n,i){const r=t.getObjectExtension(e,Ao);if(!r)return;const s=t.getTypedArrayForBufferView(r.bufferView),o=Hm(s.buffer,s.byteOffset),{parse:a}=i,c={...n};delete c["3d-tiles"];const f=await a(o,w3,c,i),p=Y7(f.attributes);for(const[m,v]of Object.entries(p))if(m in e.attributes){const w=e.attributes[m],C=t.getAccessor(w);C!=null&&C.min&&C!==null&&C!==void 0&&C.max&&(v.min=C.min,v.max=C.max)}e.attributes=p,f.indices&&(e.indices=T3(f.indices)),rW(e)}function iW(t,e,n=4,i,r){var s;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const o=i.DracoWriter.encodeSync({attributes:t}),a=r==null||(s=r.parseSync)===null||s===void 0?void 0:s.call(r,{attributes:t}),c=i._addFauxAttributes(a.attributes),f=i.addBufferView(o);return{primitives:[{attributes:c,mode:n,extensions:{[Ao]:{bufferView:f,attributes:c}}}]}}function rW(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*C3(t){for(const e of t.json.meshes||[])for(const n of e.primitives)yield n}const sW=Object.freeze(Object.defineProperty({__proto__:null,name:q7,preprocess:$7,decode:eW,encode:tW},Symbol.toStringTag,{value:"Module"})),Xs="KHR_lights_punctual",oW=Xs;async function aW(t){const e=new yi(t),{json:n}=e,i=e.getExtension(Xs);i&&(e.json.lights=i.lights,e.removeExtension(Xs));for(const r of n.nodes||[]){const s=e.getObjectExtension(r,Xs);s&&(r.light=s.light),e.removeObjectExtension(r,Xs)}}async function AW(t){const e=new yi(t),{json:n}=e;if(n.lights){const i=e.addExtension(Xs);qn(!i.lights),i.lights=n.lights,delete n.lights}if(e.json.lights){for(const i of e.json.lights){const r=i.node;e.addObjectExtension(r,Xs,i)}delete e.json.lights}}const lW=Object.freeze(Object.defineProperty({__proto__:null,name:oW,decode:aW,encode:AW},Symbol.toStringTag,{value:"Module"})),Hl="KHR_materials_unlit",cW=Hl;async function uW(t){const e=new yi(t),{json:n}=e;e.removeExtension(Hl);for(const i of n.materials||[])i.extensions&&i.extensions.KHR_materials_unlit&&(i.unlit=!0),e.removeObjectExtension(i,Hl)}function hW(t){const e=new yi(t),{json:n}=e;if(e.materials)for(const i of n.materials||[])i.unlit&&(delete i.unlit,e.addObjectExtension(i,Hl,{}),e.addExtension(Hl))}const fW=Object.freeze(Object.defineProperty({__proto__:null,name:cW,decode:uW,encode:hW},Symbol.toStringTag,{value:"Module"})),WA="KHR_techniques_webgl",dW=WA;async function gW(t){const e=new yi(t),{json:n}=e,i=e.getExtension(WA);if(i){const r=mW(i,e);for(const s of n.materials||[]){const o=e.getObjectExtension(s,WA);o&&(s.technique=Object.assign({},o,r[o.technique]),s.technique.values=_W(s.technique,e)),e.removeObjectExtension(s,WA)}e.removeExtension(WA)}}async function pW(t,e){}function mW(t,e){const{programs:n=[],shaders:i=[],techniques:r=[]}=t,s=new TextDecoder;return i.forEach(o=>{if(Number.isFinite(o.bufferView))o.code=s.decode(e.getTypedArrayForBufferView(o.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(o=>{o.fragmentShader=i[o.fragmentShader],o.vertexShader=i[o.vertexShader]}),r.forEach(o=>{o.program=n[o.program]}),r}function _W(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(i=>{t.uniforms[i].value&&!(i in n)&&(n[i]=t.uniforms[i].value)}),Object.keys(n).forEach(i=>{typeof n[i]=="object"&&n[i].index!==void 0&&(n[i].texture=e.getTexture(n[i].index))}),n}const yW=Object.freeze(Object.defineProperty({__proto__:null,name:dW,decode:gW,encode:pW},Symbol.toStringTag,{value:"Module"})),b3=[c7,f7,p7,sW,lW,fW,yW];function vW(t,e={},n){const i=b3.filter(s=>S3(s.name,e));for(const s of i){var r;(r=s.preprocess)===null||r===void 0||r.call(s,t,e,n)}}async function EW(t,e={},n){const i=b3.filter(s=>S3(s.name,e));for(const s of i){var r;await((r=s.decode)===null||r===void 0?void 0:r.call(s,t,e,n))}}function S3(t,e){var n;const i=(e==null||(n=e.gltf)===null||n===void 0?void 0:n.excludeExtensions)||{};return!(t in i&&!i[t])}const O0="KHR_binary_glTF";function wW(t){const e=new yi(t),{json:n}=e;for(const i of n.images||[]){const r=e.getObjectExtension(i,O0);r&&Object.assign(i,r),e.removeObjectExtension(i,O0)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(O0)}const Aw={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},TW={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class CW{constructor(){T(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),T(this,"json",void 0)}normalize(e,n){this.json=e.json;const i=e.json;switch(i.asset&&i.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(i.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(i),this._convertTopLevelObjectsToArrays(i),wW(e),this._convertObjectIdsToArrayIndices(i),this._updateObjects(i),this._updateMaterial(i)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const n in Aw)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){const i=e[n];if(!(!i||Array.isArray(i))){e[n]=[];for(const r in i){const s=i[r];s.id=s.id||r;const o=e[n].length;e[n].push(s),this.idToIndexMap[n][r]=o}}}_convertObjectIdsToArrayIndices(e){for(const n in Aw)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const n of e.textures)this._convertTextureIds(n);for(const n of e.meshes)this._convertMeshIds(n);for(const n of e.nodes)this._convertNodeIds(n);for(const n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const n of e.primitives){const{attributes:i,indices:r,material:s}=n;for(const o in i)i[o]=this._convertIdToIndex(i[o],"accessor");r&&(n.indices=this._convertIdToIndex(r,"accessor")),s&&(n.material=this._convertIdToIndex(s,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),e[n]=[]);for(const i of e[n])for(const r in i){const s=i[r],o=this._convertIdToIndex(s,r);i[r]=o}}_convertIdToIndex(e,n){const i=TW[n];if(i in this.idToIndexMap){const r=this.idToIndexMap[i][e];if(!Number.isFinite(r))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(e));return r}return e}_updateObjects(e){for(const n of this.json.buffers)delete n.type}_updateMaterial(e){for(const r of e.materials){var n,i;r.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const s=((n=r.values)===null||n===void 0?void 0:n.tex)||((i=r.values)===null||i===void 0?void 0:i.texture2d_0),o=e.textures.findIndex(a=>a.id===s);o!==-1&&(r.pbrMetallicRoughness.baseColorTexture={index:o})}}}function bW(t,e={}){return new CW().normalize(t,e)}const SW={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},xW={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Ai={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},PW={magFilter:Ai.TEXTURE_MAG_FILTER,minFilter:Ai.TEXTURE_MIN_FILTER,wrapS:Ai.TEXTURE_WRAP_S,wrapT:Ai.TEXTURE_WRAP_T},MW={[Ai.TEXTURE_MAG_FILTER]:Ai.LINEAR,[Ai.TEXTURE_MIN_FILTER]:Ai.NEAREST_MIPMAP_LINEAR,[Ai.TEXTURE_WRAP_S]:Ai.REPEAT,[Ai.TEXTURE_WRAP_T]:Ai.REPEAT};function IW(t){return xW[t]}function BW(t){return SW[t]}class LW{constructor(){T(this,"baseUri",""),T(this,"json",{}),T(this,"buffers",[]),T(this,"images",[])}postProcess(e,n={}){const{json:i,buffers:r=[],images:s=[],baseUri:o=""}=e;return qn(i),this.baseUri=o,this.json=i,this.buffers=r,this.images=s,this._resolveTree(this.json,n),this.json}_resolveTree(e,n={}){e.bufferViews&&(e.bufferViews=e.bufferViews.map((i,r)=>this._resolveBufferView(i,r))),e.images&&(e.images=e.images.map((i,r)=>this._resolveImage(i,r))),e.samplers&&(e.samplers=e.samplers.map((i,r)=>this._resolveSampler(i,r))),e.textures&&(e.textures=e.textures.map((i,r)=>this._resolveTexture(i,r))),e.accessors&&(e.accessors=e.accessors.map((i,r)=>this._resolveAccessor(i,r))),e.materials&&(e.materials=e.materials.map((i,r)=>this._resolveMaterial(i,r))),e.meshes&&(e.meshes=e.meshes.map((i,r)=>this._resolveMesh(i,r))),e.nodes&&(e.nodes=e.nodes.map((i,r)=>this._resolveNode(i,r))),e.skins&&(e.skins=e.skins.map((i,r)=>this._resolveSkin(i,r))),e.scenes&&(e.scenes=e.scenes.map((i,r)=>this._resolveScene(i,r))),e.scene!==void 0&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,n){if(typeof n=="object")return n;const i=this.json[e]&&this.json[e][n];return i||console.warn("glTF file error: Could not find ".concat(e,"[").concat(n,"]")),i}_resolveScene(e,n){return e.id=e.id||"scene-".concat(n),e.nodes=(e.nodes||[]).map(i=>this.getNode(i)),e}_resolveNode(e,n){return e.id=e.id||"node-".concat(n),e.children&&(e.children=e.children.map(i=>this.getNode(i))),e.mesh!==void 0?e.mesh=this.getMesh(e.mesh):e.meshes!==void 0&&e.meshes.length&&(e.mesh=e.meshes.reduce((i,r)=>{const s=this.getMesh(r);return i.id=s.id,i.primitives=i.primitives.concat(s.primitives),i},{primitives:[]})),e.camera!==void 0&&(e.camera=this.getCamera(e.camera)),e.skin!==void 0&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,n){return e.id=e.id||"skin-".concat(n),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,n){return e.id=e.id||"mesh-".concat(n),e.primitives&&(e.primitives=e.primitives.map(i=>{i={...i};const r=i.attributes;i.attributes={};for(const s in r)i.attributes[s]=this.getAccessor(r[s]);return i.indices!==void 0&&(i.indices=this.getAccessor(i.indices)),i.material!==void 0&&(i.material=this.getMaterial(i.material)),i})),e}_resolveMaterial(e,n){if(e.id=e.id||"material-".concat(n),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const i=e.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,n){if(e.id=e.id||"accessor-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=IW(e.componentType),e.components=BW(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const i=e.bufferView.buffer,{ArrayType:r,byteLength:s}=g3(e,e.bufferView),o=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+i.byteOffset;let a=i.arrayBuffer.slice(o,o+s);e.bufferView.byteStride&&(a=this._getValueFromInterleavedBuffer(i,o,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new r(a)}return e}_getValueFromInterleavedBuffer(e,n,i,r,s){const o=new Uint8Array(s*r);for(let a=0;a<s;a++){const c=n+a*i;o.set(new Uint8Array(e.arrayBuffer.slice(c,c+r)),a*r)}return o.buffer}_resolveTexture(e,n){return e.id=e.id||"texture-".concat(n),e.sampler="sampler"in e?this.getSampler(e.sampler):MW,e.source=this.getImage(e.source),e}_resolveSampler(e,n){e.id=e.id||"sampler-".concat(n),e.parameters={};for(const i in e){const r=this._enumSamplerParameter(i);r!==void 0&&(e.parameters[r]=e[i])}return e}_enumSamplerParameter(e){return PW[e]}_resolveImage(e,n){e.id=e.id||"image-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView));const i=this.images[n];return i&&(e.image=i),e}_resolveBufferView(e,n){const i=e.buffer,r={id:"bufferView-".concat(n),...e,buffer:this.buffers[i]},s=this.buffers[i].arrayBuffer;let o=this.buffers[i].byteOffset||0;return"byteOffset"in e&&(o+=e.byteOffset),r.data=new Uint8Array(s,o,e.byteLength),r}_resolveCamera(e,n){return e.id=e.id||"camera-".concat(n),e.perspective,e.orthographic,e}}function RW(t,e){return new LW().postProcess(t,e)}const lw=1735152710,q1=12,sf=8,OW=1313821514,FW=5130562,DW=0,kW=1,NW=0,Na=!0;function UW(t,e=0){return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function GW(t,e=0,n={}){const i=new DataView(t),{magic:r=lw}=n,s=i.getUint32(e,!1);return s===r||s===lw}function zW(t,e,n=0,i={}){const r=new DataView(e),s=UW(r,n+0),o=r.getUint32(n+4,Na),a=r.getUint32(n+8,Na);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:s,version:o,json:{},binChunks:[]}),n+=q1,t.version){case 1:return VW(t,r,n);case 2:return HW(t,r,n,i={});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}function VW(t,e,n){lt(t.header.byteLength>q1+sf);const i=e.getUint32(n+0,Na),r=e.getUint32(n+4,Na);return n+=sf,lt(r===NW),Up(t,e,n,i),n+=i,n+=Gp(t,e,n,t.header.byteLength),n}function HW(t,e,n,i){return lt(t.header.byteLength>q1+sf),jW(t,e,n,i),n+t.header.byteLength}function jW(t,e,n,i){for(;n+8<=t.header.byteLength;){const r=e.getUint32(n+0,Na),s=e.getUint32(n+4,Na);switch(n+=sf,s){case OW:Up(t,e,n,r);break;case FW:Gp(t,e,n,r);break;case DW:i.strict||Up(t,e,n,r);break;case kW:i.strict||Gp(t,e,n,r);break}n+=Zl(r,4)}return n}function Up(t,e,n,i){const r=new Uint8Array(e.buffer,n,i),o=new TextDecoder("utf8").decode(r);return t.json=JSON.parse(o),Zl(i,4)}function Gp(t,e,n,i){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:i,arrayBuffer:e.buffer}),Zl(i,4)}async function WW(t,e,n=0,i,r){var s,o,a,c;QW(t,e,n,i),bW(t,{normalize:i==null||(s=i.gltf)===null||s===void 0?void 0:s.normalize}),vW(t,i,r);const f=[];if(i!=null&&(o=i.gltf)!==null&&o!==void 0&&o.loadBuffers&&t.json.buffers&&await XW(t,i,r),i!=null&&(a=i.gltf)!==null&&a!==void 0&&a.loadImages){const m=JW(t,i,r);f.push(m)}const p=EW(t,i,r);return f.push(p),await Promise.all(f),i!=null&&(c=i.gltf)!==null&&c!==void 0&&c.postProcess?RW(t,i):t}function QW(t,e,n,i){if(i.uri&&(t.baseUri=i.uri),e instanceof ArrayBuffer&&!GW(e,n,i)&&(e=new TextDecoder().decode(e)),typeof e=="string")t.json=KL(e);else if(e instanceof ArrayBuffer){const o={};n=zW(o,e,n,i.glb),qn(o.type==="glTF","Invalid GLB magic string ".concat(o.type)),t._glb=o,t.json=o.json}else qn(!1,"GLTF: must be ArrayBuffer or string");const r=t.json.buffers||[];if(t.buffers=new Array(r.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:o}=t._glb;t.buffers[0]={arrayBuffer:o[0].arrayBuffer,byteOffset:o[0].byteOffset,byteLength:o[0].byteLength}}const s=t.json.images||[];t.images=new Array(s.length).fill({})}async function XW(t,e,n){const i=t.json.buffers||[];for(let o=0;o<i.length;++o){const a=i[o];if(a.uri){var r,s;const{fetch:c}=n;qn(c);const f=h3(a.uri,e),p=await(n==null||(r=n.fetch)===null||r===void 0?void 0:r.call(n,f)),m=await(p==null||(s=p.arrayBuffer)===null||s===void 0?void 0:s.call(p));t.buffers[o]={arrayBuffer:m,byteOffset:0,byteLength:m.byteLength},delete a.uri}else t.buffers[o]===null&&(t.buffers[o]={arrayBuffer:new ArrayBuffer(a.byteLength),byteOffset:0,byteLength:a.byteLength})}}async function JW(t,e,n){const i=YW(t),r=t.json.images||[],s=[];for(const o of i)s.push(KW(t,r[o],o,e,n));return await Promise.all(s)}function YW(t){const e=new Set,n=t.json.textures||[];for(const i of n)i.source!==void 0&&e.add(i.source);return Array.from(e).sort()}async function KW(t,e,n,i,r){const{fetch:s,parse:o}=r;let a;if(e.uri){const f=h3(e.uri,i);a=await(await s(f)).arrayBuffer()}if(Number.isFinite(e.bufferView)){const f=Hj(t.json,t.buffers,e.bufferView);a=Hm(f.buffer,f.byteOffset,f.byteLength)}qn(a,"glTF image has no data");let c=await o(a,[Ym,Vj],{mimeType:e.mimeType,basis:i.basis||{format:u3()}},r);c&&c[0]&&(c={compressed:!0,mipmaps:!1,width:c[0].width,height:c[0].height,data:c[0]}),t.images=t.images||[],t.images[n]=c}const jl={name:"glTF",id:"gltf",module:"gltf",version:bj,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:ZW,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function ZW(t,e={},n){e={...jl.options,...e},e.gltf={...jl.options.gltf,...e.gltf};const{byteOffset:i=0}=e;return await WW({},t,i,e,n)}async function qW(t){const e=[];return t.scenes.forEach(n=>{n.traverse(i=>{Object.values(i.model.getUniforms()).forEach(r=>{r.loaded===!1&&e.push(r)})})}),await $W(()=>e.some(n=>!n.loaded))}async function $W(t){for(;t();)await new Promise(e=>requestAnimationFrame(e))}const eQ=`#version 300 es

// Instance attributes
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;

// Uniforms
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;

// Attributes
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif

// Varying
out vec4 vColor;

// MODULE_PBR contains all the varying definitions needed
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif

// Main
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    // using instancePositions as world coordinates
    // when using globe mode, this branch does not re-orient the model to align with the surface of the earth
    // call project_normal before setting position to avoid rotation
    geometry.normal = project_normal(normal);
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    // set PBR data
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,tQ=`#version 300 es

// Uniforms
uniform float opacity;

// Varying
in vec4 vColor;

out vec4 fragmentColor;

// MODULE_PBR contains all the varying definitions needed
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,x3=[255,255,255,255],nQ={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?typeof t.scene=="object"?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:x3},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[jl]};class $1 extends Un{constructor(...e){super(...e),T(this,"state",void 0)}getShaders(){const e=[ar,Ar];return this.props._lighting==="pbr"&&e.push(m1),{vs:eQ,fs:tQ,modules:e}}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:x3,transition:!0},instanceModelMatrix:o3})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;n.scenegraph!==i.scenegraph?this._updateScenegraph():n._animations!==i._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:n}=this.context;let i=null;if(e.scenegraph instanceof va)i={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const a=e.scenegraph,c=Cj(n,a,this._getModelOptions());i={gltf:a,...c},qW(c).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(Re.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),i=e.scenegraph);const r={layer:this,gl:n},s=e.getScene(i,r),o=e.getAnimator(i,r);s instanceof va?(this._deleteScenegraph(),this._applyAllAttributes(s),this._applyAnimationsProp(s,o,e._animations),this.setState({scenegraph:s,animator:o})):s!==null&&Re.warn("invalid scenegraph:",s)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const n=this.getAttributeManager().getAttributes();e.traverse(i=>{this._setModelAttributes(i.model,n)})}}_applyAnimationsProp(e,n,i){if(!e||!n||!i)return;const r=n.getAnimations();Object.keys(i).sort().forEach(s=>{const o=i[s];if(s==="*")r.forEach(a=>{Object.assign(a,o)});else if(Number.isFinite(Number(s))){const a=Number(s);a>=0&&a<r.length?Object.assign(r[a],o):Re.warn("animation ".concat(s," not found"))()}else{const a=r.find(({name:c})=>c===s);a?Object.assign(a,o):Re.warn("animation ".concat(s," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof va&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let n=null;return e&&(typeof e=="function"?n=e({gl:this.context.gl,layer:this}):n=e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:n,modelOptions:{isInstanced:!0,transpileToGLSL100:!We(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(n=>{this._setModelAttributes(n.model,e)})}draw({moduleParameters:e=null,parameters:n={},context:i}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(i.timeline.getTime()),this.setNeedsRedraw());const{viewport:r}=this.context,{sizeScale:s,sizeMinPixels:o,sizeMaxPixels:a,opacity:c,coordinateSystem:f}=this.props,p=this.getNumInstances();this.state.scenegraph.traverse((m,{worldMatrix:v})=>{m.model.setInstanceCount(p),m.updateModuleSettings(e),m.draw({parameters:n,uniforms:{sizeScale:s,opacity:c,sizeMinPixels:o,sizeMaxPixels:a,composeModelMatrix:a3(r,f),sceneModelMatrix:v,u_Camera:m.model.getUniforms().project_uCameraPosition}})})}}T($1,"defaultProps",nQ);T($1,"layerName","ScenegraphLayer");const iQ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs

// Scale the model
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;

// Primitive attributes
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;

// Instance attributes
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;

// Outputs to fragment shader
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    // https://github.com/Esri/i3s-spec/blob/master/docs/1.7/geometryUVRegion.cmn.md
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    // set PBR data
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,rQ=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {

// NOTE(Tarek): This is necessary because
// headless.gl reports the extension as
// available but does not support it in
// the shader.
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function sQ(t){t.COLOR_0||t.colors||(t.colors={constant:!0,value:new Float32Array([1,1,1])})}const oQ={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class e_ extends Vl{getShaders(){const e=super.getShaders();return e.modules.push(m1),{...e,vs:iQ,fs:rQ}}initializeState(){const{featureIds:e}=this.props;super.initializeState();const n=this.getAttributeManager();e&&n.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);const{props:n,oldProps:i}=e;n.pbrMaterial!==i.pbrMaterial&&this.updatePbrMaterialUniforms(n.pbrMaterial)}draw(e){const{featureIds:n}=this.props;!this.state.model||(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:Boolean(n)}),super.draw(e))}getModel(e){const{id:n,pbrMaterial:i}=this.props,r=this.parseMaterial(i,e);this.setState({materialParser:r});const s=this.getShaders();return sQ(e.attributes),new Nn(this.context.gl,{...this.getShaders(),id:n,geometry:e,defines:{...s.defines,...r==null?void 0:r.defines,HAS_UV_REGIONS:e.attributes.uvRegions},parameters:r==null?void 0:r.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){const{model:n}=this.state;if(n){const{mesh:i}=this.props,r=this.parseMaterial(e,i);this.setState({materialParser:r}),n.setUniforms(r.uniforms)}}parseMaterial(e,n){var i;const r=Boolean(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return(i=this.state.materialParser)===null||i===void 0||i.delete(),new A3(this.context.gl,{attributes:{NORMAL:n.attributes.normals,TEXCOORD_0:n.attributes.texCoords},material:{unlit:r,...e},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){const n=this.props.featureIds,i=new Uint8ClampedArray(n.length*e.size),r=[];for(let s=0;s<n.length;s++)this.encodePickingColor(n[s],r),i[s*3]=r[0],i[s*3+1]=r[1],i[s*3+2]=r[2];e.value=i}finalizeState(e){var n;super.finalizeState(e),(n=this.state.materialParser)===null||n===void 0||n.delete(),this.setState({materialParser:null})}}T(e_,"layerName","MeshLayer");T(e_,"defaultProps",oQ);const aQ=6378137,AQ=6378137,lQ=6356752314245179e-9;function jf(t){return t}new K;function cQ(t,e=[],n=jf){return"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):"x"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function uQ(t,e=[]){return cQ(t,e,Ht._cartographicRadians?jf:kk)}function hQ(t,e,n=jf){return"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):"x"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function fQ(t,e){return hQ(t,e,Ht._cartographicRadians?jf:Nk)}const ko=new K,dQ=new K,gQ=new K;function pQ(t,e,n=[]){const{oneOverRadii:i,oneOverRadiiSquared:r,centerToleranceSquared:s}=e;ko.from(t);const o=ko.x,a=ko.y,c=ko.z,f=i.x,p=i.y,m=i.z,v=o*o*f*f,w=a*a*p*p,C=c*c*m*m,S=v+w+C,R=Math.sqrt(1/S);if(!Number.isFinite(R))return;const x=dQ;if(x.copy(t).scale(R),S<s)return x.to(n);const P=r.x,I=r.y,F=r.z,H=gQ;H.set(x.x*P*2,x.y*I*2,x.z*F*2);let Q=(1-R)*ko.len()/(.5*H.len()),q=0,ee,X,V,D;do{Q-=q,ee=1/(1+Q*P),X=1/(1+Q*I),V=1/(1+Q*F);const re=ee*ee,Ae=X*X,ge=V*V,Be=re*ee,Ye=Ae*X,Qe=ge*V;D=v*re+w*Ae+C*ge-1;const oe=v*Be*P+w*Ye*I+C*Qe*F,ve=-2*oe;q=D/ve}while(Math.abs(D)>Bl.EPSILON12);return ko.scale([ee,X,V]).to(n)}const cw=1e-14,mQ=new K,uw={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},F0={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},RA={east:new K,north:new K,up:new K,west:new K,south:new K,down:new K},_Q=new K,yQ=new K,vQ=new K;function hw(t,e,n,i,r,s){const o=uw[e]&&uw[e][n];Bi(o&&(!i||i===o));let a,c,f;const p=mQ.copy(r);if(_n(p.x,0,cw)&&_n(p.y,0,cw)){const v=Math.sign(p.z);a=_Q.fromArray(F0[e]),e!=="east"&&e!=="west"&&a.scale(v),c=yQ.fromArray(F0[n]),n!=="east"&&n!=="west"&&c.scale(v),f=vQ.fromArray(F0[i]),i!=="east"&&i!=="west"&&f.scale(v)}else{const{up:v,east:w,north:C}=RA;w.set(-p.y,p.x,0).normalize(),t.geodeticSurfaceNormal(p,v),C.copy(v).cross(w);const{down:S,west:R,south:x}=RA;S.copy(v).scale(-1),R.copy(w).scale(-1),x.copy(C).scale(-1),a=RA[e],c=RA[n],f=RA[i]}return s[0]=a.x,s[1]=a.y,s[2]=a.z,s[3]=0,s[4]=c.x,s[5]=c.y,s[6]=c.z,s[7]=0,s[8]=f.x,s[9]=f.y,s[10]=f.z,s[11]=0,s[12]=p.x,s[13]=p.y,s[14]=p.z,s[15]=1,s}const Mu=new K,fw=new K,EQ=new K,Si=new K,wQ=new K,Iu=new K;class rn{constructor(e=0,n=0,i=0){T(this,"radii",void 0),T(this,"radiiSquared",void 0),T(this,"radiiToTheFourth",void 0),T(this,"oneOverRadii",void 0),T(this,"oneOverRadiiSquared",void 0),T(this,"minimumRadius",void 0),T(this,"maximumRadius",void 0),T(this,"centerToleranceSquared",Bl.EPSILON1),T(this,"squaredXOverSquaredZ",void 0),Bi(e>=0),Bi(n>=0),Bi(i>=0),this.radii=new K(e,n,i),this.radiiSquared=new K(e*e,n*n,i*i),this.radiiToTheFourth=new K(e*e*e*e,n*n*n*n,i*i*i*i),this.oneOverRadii=new K(e===0?0:1/e,n===0?0:1/n,i===0?0:1/i),this.oneOverRadiiSquared=new K(e===0?0:1/(e*e),n===0?0:1/(n*n),i===0?0:1/(i*i)),this.minimumRadius=Math.min(e,n,i),this.maximumRadius=Math.max(e,n,i),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||Boolean(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,n=[0,0,0]){const i=fw,r=EQ,[,,s]=e;this.geodeticSurfaceNormalCartographic(e,i),r.copy(this.radiiSquared).scale(i);const o=Math.sqrt(i.dot(r));return r.scale(1/o),i.scale(s),r.add(i),r.to(n)}cartesianToCartographic(e,n=[0,0,0]){Iu.from(e);const i=this.scaleToGeodeticSurface(Iu,Si);if(!i)return;const r=this.geodeticSurfaceNormal(i,fw),s=wQ;s.copy(Iu).subtract(i);const o=Math.atan2(r.y,r.x),a=Math.asin(r.z),c=Math.sign(c1(s,Iu))*l1(s);return fQ([o,a,c],n)}eastNorthUpToFixedFrame(e,n=new De){return hw(this,"east","north","up",e,n)}localFrameToFixedFrame(e,n,i,r,s=new De){return hw(this,e,n,i,r,s)}geocentricSurfaceNormal(e,n=[0,0,0]){return Mu.from(e).normalize().to(n)}geodeticSurfaceNormalCartographic(e,n=[0,0,0]){const i=uQ(e),r=i[0],s=i[1],o=Math.cos(s);return Mu.set(o*Math.cos(r),o*Math.sin(r),Math.sin(s)).normalize(),Mu.to(n)}geodeticSurfaceNormal(e,n=[0,0,0]){return Mu.from(e).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(e,n){return pQ(e,this,n)}scaleToGeocentricSurface(e,n=[0,0,0]){Si.from(e);const i=Si.x,r=Si.y,s=Si.z,o=this.oneOverRadiiSquared,a=1/Math.sqrt(i*i*o.x+r*r*o.y+s*s*o.z);return Si.multiplyScalar(a).to(n)}transformPositionToScaledSpace(e,n=[0,0,0]){return Si.from(e).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(e,n=[0,0,0]){return Si.from(e).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(e,n=0,i=[0,0,0]){Bi(_n(this.radii.x,this.radii.y,Bl.EPSILON15)),Bi(this.radii.z>0),Si.from(e);const r=Si.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-n))return Si.set(0,0,r).to(i)}}T(rn,"WGS84",new rn(aQ,AQ,lQ));class TQ{constructor(e,n,i){T(this,"item",void 0),T(this,"previous",void 0),T(this,"next",void 0),this.item=e,this.previous=n,this.next=i}}class CQ{constructor(){T(this,"head",null),T(this,"tail",null),T(this,"_length",0)}get length(){return this._length}add(e){const n=new TQ(e,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}remove(e){!e||(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,n){e!==n&&(this.remove(n),this._insert(e,n))}_insert(e,n){const i=e.next;e.next=n,this.tail===e?this.tail=n:i.previous=n,n.next=i,n.previous=e,++this._length}}function D0(t){return t!=null}class bQ{constructor(){T(this,"_list",void 0),T(this,"_sentinel",void 0),T(this,"_trimTiles",void 0),this._list=new CQ,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const n=e._cacheNode;D0(n)&&this._list.splice(this._sentinel,n)}add(e,n,i){D0(n._cacheNode)||(n._cacheNode=this._list.add(n),i&&i(e,n))}unloadTile(e,n,i){const r=n._cacheNode;!D0(r)||(this._list.remove(r),n._cacheNode=void 0,i&&i(e,n))}unloadTiles(e,n){const i=this._trimTiles;this._trimTiles=!1;const r=this._list,s=e.maximumMemoryUsage*1024*1024,o=this._sentinel;let a=r.head;for(;a!==o&&(e.gpuMemoryUsageInBytes>s||i);){const c=a.item;a=a.next,this.unloadTile(e,c,n)}}trim(){this._trimTiles=!0}}function SQ(t,e){lt(t),lt(e);const{rtcCenter:n,gltfUpAxis:i}=e,{computedTransform:r,boundingVolume:{center:s}}=t;let o=new De(r);switch(n&&o.translate(n),i){case"Z":break;case"Y":const m=new De().rotateX(Math.PI/2);o=o.multiplyRight(m);break;case"X":const v=new De().rotateY(-Math.PI/2);o=o.multiplyRight(v);break}e.isQuantized&&o.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const a=new K(s);e.cartesianModelMatrix=o,e.cartesianOrigin=a;const c=rn.WGS84.cartesianToCartographic(a,new K),p=rn.WGS84.eastNorthUpToFixedFrame(a).invert();e.cartographicModelMatrix=p.multiplyRight(o),e.cartographicOrigin=c,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}const dw=new K,k0=new K,zp=new Zn([new hi,new hi,new hi,new hi,new hi,new hi]);function xQ(t,e){const{cameraDirection:n,cameraUp:i,height:r}=t,{metersPerUnit:s}=t.distanceScales,o=ch(t,t.center),a=rn.WGS84.eastNorthUpToFixedFrame(o),c=t.unprojectPosition(t.cameraPosition),f=rn.WGS84.cartographicToCartesian(c,new K),p=new K(a.transformAsVector(new K(n).scale(s))).normalize(),m=new K(a.transformAsVector(new K(i).scale(s))).normalize();MQ(t);const v=t.constructor,{longitude:w,latitude:C,width:S,bearing:R,zoom:x}=t,P=new v({longitude:w,latitude:C,height:r,width:S,bearing:R,zoom:x,pitch:0});return{camera:{position:f,direction:p,up:m},viewport:t,topDownViewport:P,height:r,cullingVolume:zp,frameNumber:e,sseDenominator:1.15}}function PQ(t,e,n){if(n===0||t.length<=n)return[t,[]];const i=[],{longitude:r,latitude:s}=e.viewport;for(const[f,p]of t.entries()){const[m,v]=p.header.mbs,w=Math.abs(r-m),C=Math.abs(s-v),S=Math.sqrt(C*C+w*w);i.push([f,S])}const o=i.sort((f,p)=>f[1]-p[1]),a=[];for(let f=0;f<n;f++)a.push(t[o[f][0]]);const c=[];for(let f=n;f<o.length;f++)c.push(t[o[f][0]]);return[a,c]}function MQ(t){const e=t.getFrustumPlanes(),n=gw(e.near,t.cameraPosition),i=ch(t,n),r=ch(t,t.cameraPosition,k0);let s=0;zp.planes[s++].fromPointNormal(i,dw.copy(i).subtract(r));for(const o in e){if(o==="near")continue;const a=e[o],c=gw(a,n,k0),f=ch(t,c,k0);zp.planes[s++].fromPointNormal(f,dw.copy(i).subtract(f))}}function gw(t,e,n=new K){const i=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-i).add(e),n}function ch(t,e,n=new K){const i=t.unprojectPosition(e);return rn.WGS84.cartographicToCartesian(i,n)}const IQ=6378137,BQ=6378137,Vp=6356752314245179e-9,pw=new K;function LQ(t,e){if(t instanceof dc){const{halfAxes:n}=t,i=OQ(n);return Math.log2(Vp/(i+e[2]))}else if(t instanceof fc){const{radius:n}=t;return Math.log2(Vp/(n+e[2]))}else if(t.width&&t.height){const{width:n,height:i}=t,r=Math.log2(IQ/n),s=Math.log2(BQ/i);return(r+s)/2}return 1}function P3(t,e,n){const i=rn.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],new K),r=Math.sqrt(Math.pow(i[0]-n[0],2)+Math.pow(i[1]-n[1],2)+Math.pow(i[2]-n[2],2));return Math.log2(Vp/(r+e[2]))}function RQ(t,e,n){const[i,r,s,o]=t;return P3({xmin:i,xmax:s,ymin:r,ymax:o,zmin:0,zmax:0},e,n)}function OQ(t){t.getColumn(0,pw);const e=t.getColumn(1),n=t.getColumn(2);return pw.add(e).add(n).len()}const Xn={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},Er={ADD:1,REPLACE:2},Ea={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},Ki={I3S:"I3S",TILES3D:"TILES3D"},Wf={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},FQ={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function M3(t){return t!=null}const DQ=new K,kQ=new K,NQ=new K;function N0(t,e,n){if(lt(t,"3D Tile: boundingVolume must be defined"),t.box)return UQ(t.box,e,n);if(t.region){const[i,r,s,o,a,c]=t.region,f=rn.WGS84.cartographicToCartesian([Ii(i),Ii(o),a],kQ),p=rn.WGS84.cartographicToCartesian([Ii(s),Ii(r),c],NQ),m=new K().addVectors(f,p).multiplyScalar(.5),v=new K().subVectors(f,p).len()/2;return mw([m[0],m[1],m[2],v],new De)}if(t.sphere)return mw(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function UQ(t,e,n){const i=new K(t[0],t[1],t[2]);e.transform(i,i);let r=[];if(t.length===10){const f=t.slice(3,6),p=new Il;p.fromArray(t,6);const m=new K([1,0,0]),v=new K([0,1,0]),w=new K([0,0,1]);m.transformByQuaternion(p),m.scale(f[0]),v.transformByQuaternion(p),v.scale(f[1]),w.transformByQuaternion(p),w.scale(f[2]),r=[...m.toArray(),...v.toArray(),...w.toArray()]}else r=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const s=e.transformAsVector(r.slice(0,3)),o=e.transformAsVector(r.slice(3,6)),a=e.transformAsVector(r.slice(6,9)),c=new Zt([s[0],s[1],s[2],o[0],o[1],o[2],a[0],a[1],a[2]]);return M3(n)?(n.center=i,n.halfAxes=c,n):new dc(i,c)}function mw(t,e,n){const i=new K(t[0],t[1],t[2]);e.transform(i,i);const r=e.getScale(DQ),s=Math.max(Math.max(r[0],r[1]),r[2]),o=t[3]*s;return M3(n)?(n.center=i,n.radius=o,n):new fc(i,o)}new K;new K;new De;new K;new K;new K;function GQ(t,e){const n=t*e;return 1-Math.exp(-(n*n))}function zQ(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,i=t.dynamicScreenSpaceErrorFactor;return GQ(e,n)*i}return 0}function VQ(t,e,n){const i=t.tileset,r=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,s=n?r:t.lodMetricValue;if(s===0)return 0;const o=Math.max(t._distanceToCamera,1e-7),{height:a,sseDenominator:c}=e,{viewDistanceScale:f}=i.options;let p=s*a*(f||1)/(o*c);return p-=zQ(i,o),p}const U0=new K,_w=new K,Jr=new K,yw=new K,HQ=new K,G0=new De,vw=new De;function jQ(t,e){if(t.lodMetricValue===0||isNaN(t.lodMetricValue))return"DIG";const n=2*I3(t,e);return n<2?"OUT":!t.header.children||n<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}function I3(t,e){const{topDownViewport:n}=e,i=t.header.mbs[1],r=t.header.mbs[0],s=t.header.mbs[2],o=t.header.mbs[3],a=[...t.boundingVolume.center],c=n.unprojectPosition(n.cameraPosition);rn.WGS84.cartographicToCartesian(c,U0),_w.copy(U0).subtract(a).normalize(),rn.WGS84.eastNorthUpToFixedFrame(a,G0),vw.copy(G0).invert(),Jr.copy(U0).transform(vw);const f=Math.sqrt(Jr[0]*Jr[0]+Jr[1]*Jr[1]),p=f*f/Jr[2];yw.copy([Jr[0],Jr[1],p]);const v=yw.transform(G0).subtract(a).normalize(),C=_w.cross(v).normalize().scale(o).add(a),S=rn.WGS84.cartesianToCartographic(C),R=n.project([r,i,s]),x=n.project(S);return HQ.copy(R).subtract(x).magnitude()}function WQ(t){return{assetGltfUpAxis:t.asset&&t.asset.gltfUpAxis||"Y"}}class Ew{constructor(e=0){T(this,"_map",new Map),T(this,"_array",void 0),T(this,"_length",void 0),this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return lt(e<this._array.length),this._array[e]}set(e,n){lt(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=n,this._map.set(n,e)}delete(e){const n=this._map.get(e);n>=0&&(this._array.splice(n,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const n=this.length++;this._array[n]=e,this._map.set(e,n)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){lt(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){lt(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const QQ={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class Qf{traversalFinished(e){return!0}constructor(e){T(this,"options",void 0),T(this,"root",void 0),T(this,"requestedTiles",void 0),T(this,"selectedTiles",void 0),T(this,"emptyTiles",void 0),T(this,"lastUpdate",new Date().getTime()),T(this,"updateDebounceTime",1e3),T(this,"_traversalStack",void 0),T(this,"_emptyTraversalStack",void 0),T(this,"_frameNumber",void 0),this.options={...QQ,...e},this._traversalStack=new Ew,this._emptyTraversalStack=new Ew,this._frameNumber=null,this.root=null,this.selectedTiles={},this.requestedTiles={},this.emptyTiles={}}traverse(e,n,i){this.root=e,this.options={...this.options,...i},this.reset(),this.updateTile(e,n),this._frameNumber=n.frameNumber,this.executeTraversal(e,n)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,n){const i=this._traversalStack;for(e._selectionDepth=1,i.push(e);i.length>0;){const s=i.pop();let o=!1;this.canTraverse(s,n)&&(this.updateChildTiles(s,n),o=this.updateAndPushChildren(s,n,i,s.hasRenderContent?s._selectionDepth+1:s._selectionDepth));const a=s.parent,c=Boolean(!a||a._shouldRefine),f=!o;s.hasRenderContent?s.refine===Er.ADD?(this.loadTile(s,n),this.selectTile(s,n)):s.refine===Er.REPLACE&&(this.loadTile(s,n),f&&this.selectTile(s,n)):(this.emptyTiles[s.id]=s,this.loadTile(s,n),f&&this.selectTile(s,n)),this.touchTile(s,n),s._shouldRefine=o&&c}const r=new Date().getTime();(this.traversalFinished(n)||r-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=r,this.options.onTraversalEnd(n))}updateChildTiles(e,n){const i=e.children;for(const r of i)this.updateTile(r,n);return!0}updateAndPushChildren(e,n,i,r){const{loadSiblings:s,skipLevelOfDetail:o}=this.options,a=e.children;a.sort(this.compareDistanceToCamera.bind(this));const c=e.refine===Er.REPLACE&&e.hasRenderContent&&!o;let f=!1,p=!0;for(const m of a)if(m._selectionDepth=r,m.isVisibleAndInRequestVolume?(i.find(m)&&i.delete(m),i.push(m),f=!0):(c||s)&&(this.loadTile(m,n),this.touchTile(m,n)),c){let v;if(m._inRequestVolume?m.hasRenderContent?v=m.contentAvailable:v=this.executeEmptyTraversal(m,n):v=!1,p=p&&v,!p)return!1}return f||(p=!1),p}updateTile(e,n){this.updateTileVisibility(e,n)}selectTile(e,n){this.shouldSelectTile(e)&&(e._selectedFrame=n.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,n){this.shouldLoadTile(e)&&(e._requestedFrame=n.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,n){e.tileset._cache.touch(e),e._touchedFrame=n.frameNumber}canTraverse(e,n,i=!1,r=!1){return e.hasChildren?e.hasTilesetContent?!e.contentExpired:!r&&!e.isVisibleAndInRequestVolume?!1:this.shouldRefine(e,n,i):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,n,i){let r=e._screenSpaceError;return i&&(r=e.getScreenSpaceError(n,!0)),r>this.options.maximumScreenSpaceError}updateTileVisibility(e,n){const i=[];if(this.options.viewportTraversersMap)for(const r in this.options.viewportTraversersMap)this.options.viewportTraversersMap[r]===n.viewport.id&&i.push(r);else i.push(n.viewport.id);e.updateVisibility(n,i)}compareDistanceToCamera(e,n){return e._distanceToCamera-n._distanceToCamera}anyChildrenVisible(e,n){let i=!1;for(const r of e.children)r.updateVisibility(n),i=i||r.isVisibleAndInRequestVolume;return i}executeEmptyTraversal(e,n){let i=!0;const r=this._emptyTraversalStack;for(r.push(e);r.length>0&&i;){const s=r.pop();if(this.updateTile(s,n),s.isVisibleAndInRequestVolume||this.loadTile(s,n),this.touchTile(s,n),!s.hasRenderContent&&this.canTraverse(s,n,!1,!0)){const a=s.children;for(const c of a)r.find(c)&&r.delete(c),r.push(c)}else s.contentAvailable||(i=!1)}return i}}const ww=new K;function XQ(t){return t!=null}class Hp{constructor(e,n,i,r=""){T(this,"tileset",void 0),T(this,"header",void 0),T(this,"id",void 0),T(this,"url",void 0),T(this,"parent",void 0),T(this,"refine",void 0),T(this,"type",void 0),T(this,"contentUrl",void 0),T(this,"lodMetricType",void 0),T(this,"lodMetricValue",void 0),T(this,"boundingVolume",void 0),T(this,"content",void 0),T(this,"contentState",void 0),T(this,"gpuMemoryUsageInBytes",void 0),T(this,"children",void 0),T(this,"depth",void 0),T(this,"viewportIds",void 0),T(this,"transform",void 0),T(this,"extensions",void 0),T(this,"userData",void 0),T(this,"computedTransform",void 0),T(this,"hasEmptyContent",void 0),T(this,"hasTilesetContent",void 0),T(this,"traverser",void 0),T(this,"_cacheNode",void 0),T(this,"_frameNumber",void 0),T(this,"_lodJudge",void 0),T(this,"_expireDate",void 0),T(this,"_expiredContent",void 0),T(this,"_shouldRefine",void 0),T(this,"_distanceToCamera",void 0),T(this,"_centerZDepth",void 0),T(this,"_screenSpaceError",void 0),T(this,"_visibilityPlaneMask",void 0),T(this,"_visible",void 0),T(this,"_inRequestVolume",void 0),T(this,"_stackLength",void 0),T(this,"_selectionDepth",void 0),T(this,"_touchedFrame",void 0),T(this,"_visitedFrame",void 0),T(this,"_selectedFrame",void 0),T(this,"_requestedFrame",void 0),T(this,"_priority",void 0),T(this,"_contentBoundingVolume",void 0),T(this,"_viewerRequestVolume",void 0),T(this,"_initialTransform",void 0),this.header=n,this.tileset=e,this.id=r||n.id,this.url=n.url,this.parent=i,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this.lodMetricType="geometricError",this.lodMetricValue=0,this.boundingVolume=null,this.content=null,this.contentState=Xn.UNLOADED,this.gpuMemoryUsageInBytes=0,this.children=[],this.hasEmptyContent=!1,this.hasTilesetContent=!1,this.depth=0,this.viewportIds=[],this.userData={},this.extensions=null,this._priority=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._screenSpaceError=0,this._cacheNode=null,this._frameNumber=null,this._cacheNode=null,this.traverser=new Qf({}),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._initialTransform=new De,this.transform=new De,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),this._lodJudge=null,this._expireDate=null,this._expiredContent=null,Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===Xn.READY||this.hasEmptyContent}get contentAvailable(){return Boolean(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===Xn.UNLOADED}get contentExpired(){return this.contentState===Xn.EXPIRED}get contentFailed(){return this.contentState===Xn.FAILED}getScreenSpaceError(e,n){switch(this.tileset.type){case Ki.I3S:return I3(this,e);case Ki.TILES3D:return VQ(this,e,n);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:n}=e.options,i=this.refine===Er.ADD||n;if(i&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===Xn.UNLOADED)return-1;const r=this.parent,o=r&&(!i||this._screenSpaceError===0||r.hasTilesetContent)?r._screenSpaceError:this._screenSpaceError,a=e.root?e.root._screenSpaceError:0;return Math.max(a-o,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=Xn.LOADING;const n=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!n)return this.contentState=Xn.UNLOADED,!1;try{const i=this.tileset.getTileUrl(this.contentUrl),r=this.tileset.loader,s={...this.tileset.loadOptions,[r.id]:{...this.tileset.loadOptions[r.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(r.id)}};return this.content=await Sr(i,r,s),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=Xn.READY,this._onContentLoaded(),!0}catch(i){throw this.contentState=Xn.FAILED,i}finally{n.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=Xn.UNLOADED,!0}updateVisibility(e,n){if(this._frameNumber===e.frameNumber)return;const i=this.parent,r=i?i._visibilityPlaneMask:Zn.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const s=i?i.computedTransform:this.tileset.modelMatrix;this._updateTransform(s)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,r),this._visible=this._visibilityPlaneMask!==Zn.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=n}visibility(e,n){const{cullingVolume:i}=e,{boundingVolume:r}=this;return i.computeVisibilityWithPlaneMask(r,n)}contentVisibility(){return!0}distanceToTile(e){const n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth({camera:e}){const n=this.boundingVolume;return ww.subVectors(n.center,e.position),e.direction.dot(ww)}insideViewerRequestVolume(e){const n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(XQ(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=Xn.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new De(e.transform):new De;const n=this.parent,i=this.tileset,r=n&&n.computedTransform?n.computedTransform.clone():i.modelMatrix.clone();this.computedTransform=new De(r).multiplyRight(this.transform);const s=n&&n._initialTransform?n._initialTransform.clone():new De;this._initialTransform=new De(s).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=Xn.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Zn.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||Er.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()&&(this.hasTilesetContent=!0)}_updateBoundingVolume(e){this.boundingVolume=N0(e.boundingVolume,this.computedTransform,this.boundingVolume);const n=e.content;!n||(n.boundingVolume&&(this._contentBoundingVolume=N0(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=N0(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(e=new De){const n=e.clone().multiplyRight(this.transform);n.equals(this.computedTransform)||(this.computedTransform=n,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case"i3s":return{...this.tileset.options.i3s,tile:this.header,tileset:this.tileset.tileset,isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return WQ(this.tileset.tileset)}}}class JQ extends Qf{compareDistanceToCamera(e,n){return n._distanceToCamera===0&&e._distanceToCamera===0?n._centerZDepth-e._centerZDepth:n._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,n){if(super.updateTileVisibility(e,n),!e.isVisibleAndInRequestVolume)return;const i=e.children.length>0;if(e.hasTilesetContent&&i){const o=e.children[0];this.updateTileVisibility(o,n),e._visible=o._visible;return}if(this.meetsScreenSpaceErrorEarly(e,n)){e._visible=!1;return}const r=e.refine===Er.REPLACE,s=e._optimChildrenWithinParent===FQ.USE_OPTIMIZATION;if(r&&s&&i&&!this.anyChildrenVisible(e,n)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,n){const{parent:i}=e;return!i||i.hasTilesetContent||i.refine!==Er.ADD?!1:!this.shouldRefine(e,n,!0)}}class YQ{constructor(){T(this,"frameNumberMap",new Map)}register(e,n){const i=this.frameNumberMap.get(e)||new Map,r=i.get(n)||0;i.set(n,r+1),this.frameNumberMap.set(e,i)}deregister(e,n){const i=this.frameNumberMap.get(e);if(!i)return;const r=i.get(n)||1;i.set(n,r-1)}isZero(e,n){var i;return(((i=this.frameNumberMap.get(e))===null||i===void 0?void 0:i.get(n))||0)===0}}const z0={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class KQ{constructor(){T(this,"_statusMap",void 0),T(this,"pendingTilesRegister",new YQ),this._statusMap={}}add(e,n,i,r){if(!this._statusMap[n]){const{frameNumber:s,viewport:{id:o}}=r;this._statusMap[n]={request:e,callback:i,key:n,frameState:r,status:z0.REQUESTED},this.pendingTilesRegister.register(o,s),e().then(a=>{this._statusMap[n].status=z0.COMPLETED;const{frameNumber:c,viewport:{id:f}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(f,c),this._statusMap[n].callback(a,r)}).catch(a=>{this._statusMap[n].status=z0.ERROR;const{frameNumber:c,viewport:{id:f}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(f,c),i(a)})}}update(e,n){if(this._statusMap[e]){const{frameNumber:i,viewport:{id:r}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(r,i);const{frameNumber:s,viewport:{id:o}}=n;this.pendingTilesRegister.register(o,s),this._statusMap[e].frameState=n}}find(e){return this._statusMap[e]}hasPendingTiles(e,n){return!this.pendingTilesRegister.isZero(e,n)}}class ZQ extends Qf{traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}constructor(e){super(e),T(this,"_tileManager",void 0),this._tileManager=new KQ}shouldRefine(e,n){return e._lodJudge=jQ(e,n),e._lodJudge==="DIG"}updateChildTiles(e,n){const i=e.header.children||[],r=e.children,s=e.tileset;for(const o of i){const a="".concat(o.id,"-").concat(n.viewport.id),c=r&&r.find(f=>f.id===a);if(c)c&&this.updateTile(c,n);else{let f=()=>this._loadTile(o.id,s);this._tileManager.find(a)?this._tileManager.update(a,n):(s.tileset.nodePages&&(f=()=>s.tileset.nodePagesTile.formTileFromNodePages(o.id)),this._tileManager.add(f,a,m=>this._onTileLoad(m,e,a),n))}}return!1}async _loadTile(e,n){const{loader:i}=n,r=n.getTileUrl("".concat(n.url,"/nodes/").concat(e)),s={...n.loadOptions,i3s:{...n.loadOptions.i3s,isTileHeader:!0,loadContent:!1}};return await Sr(r,i,s)}_onTileLoad(e,n,i){const r=new Hp(n.tileset,e,n,i);n.children.push(r);const s=this._tileManager.find(r.id).frameState;this.updateTile(r,s),this._frameNumber===s.frameNumber&&(this.traversalFinished(s)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(r,s)}}const qQ={description:"",ellipsoid:rn.WGS84,modelMatrix:new De,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},Bu="Tiles In Tileset(s)",V0="Tiles In Memory",Tw="Tiles In View",Cw="Tiles To Render",bw="Tiles Loaded",H0="Tiles Loading",Sw="Tiles Unloaded",xw="Failed Tile Loads",Pw="Points/Vertices",j0="Tile Memory Use";class $Q{constructor(e,n){T(this,"options",void 0),T(this,"loadOptions",void 0),T(this,"type",void 0),T(this,"tileset",void 0),T(this,"loader",void 0),T(this,"url",void 0),T(this,"basePath",void 0),T(this,"modelMatrix",void 0),T(this,"ellipsoid",void 0),T(this,"lodMetricType",void 0),T(this,"lodMetricValue",void 0),T(this,"refine",void 0),T(this,"root",void 0),T(this,"roots",void 0),T(this,"asset",void 0),T(this,"description",void 0),T(this,"properties",void 0),T(this,"extras",void 0),T(this,"attributions",void 0),T(this,"credits",void 0),T(this,"stats",void 0),T(this,"traverseCounter",void 0),T(this,"geometricError",void 0),T(this,"selectedTiles",void 0),T(this,"updatePromise",null),T(this,"tilesetInitializationPromise",void 0),T(this,"cartographicCenter",void 0),T(this,"cartesianCenter",void 0),T(this,"zoom",void 0),T(this,"boundingVolume",void 0),T(this,"gpuMemoryUsageInBytes",void 0),T(this,"dynamicScreenSpaceErrorComputedDensity",void 0),T(this,"_traverser",void 0),T(this,"_cache",void 0),T(this,"_requestScheduler",void 0),T(this,"_frameNumber",void 0),T(this,"_queryParamsString",void 0),T(this,"_queryParams",void 0),T(this,"_extensionsUsed",void 0),T(this,"_tiles",void 0),T(this,"_pendingCount",void 0),T(this,"lastUpdatedVieports",void 0),T(this,"_requestedTiles",void 0),T(this,"_emptyTiles",void 0),T(this,"frameStateData",void 0),T(this,"maximumMemoryUsage",void 0),lt(e),this.options={...qQ,...n},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||_b(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this.root=null,this.roots={},this.cartographicCenter=null,this.cartesianCenter=null,this.zoom=1,this.boundingVolume=null,this.traverseCounter=0,this.geometricError=0,this._traverser=this._initializeTraverser(),this._cache=new bQ,this._requestScheduler=new mb({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this._frameNumber=0,this._pendingCount=0,this._tiles={},this.selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this.frameStateData={},this.lastUpdatedVieports=null,this._queryParams={},this._queryParamsString="",this.maximumMemoryUsage=this.options.maximumMemoryUsage||32,this.gpuMemoryUsageInBytes=0,this.stats=new ql({id:this.url}),this._initializeStats(),this._extensionsUsed=void 0,this.dynamicScreenSpaceErrorComputedDensity=0,this.extras=null,this.asset={},this.credits={},this.description=this.options.description||"",this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return this._queryParamsString||(this._queryParamsString=eX(this._queryParams)),this._queryParamsString}setProps(e){this.options={...this.options,...e}}setOptions(e){this.options={...this.options,...e}}getTileUrl(e){return e.startsWith("data:")?e:"".concat(e).concat(this.queryParams)}hasExtension(e){return Boolean(this._extensionsUsed&&this._extensionsUsed.indexOf(e)>-1)}update(e=null){this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(e=null){return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(n=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),n(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const n=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;const i=[];for(const r of n){const s=r.id;this._needTraverse(s)?i.push(s):this.traverseCounter--}for(const r of n){const s=r.id;if(this.roots[s]||(this.roots[s]=this._initializeTileHeaders(this.tileset,null)),!i.includes(s))continue;const o=xQ(r,this._frameNumber);this._traverser.traverse(this.roots[s],o,this.options)}}_needTraverse(e){let n=e;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[e]),n===e}_onTraversalEnd(e){const n=e.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const i=this.frameStateData[n],r=Object.values(this._traverser.selectedTiles),[s,o]=PQ(r,e,this.options.maximumTilesSelected);i.selectedTiles=s;for(const a of o)a.unselect();i._requestedTiles=Object.values(this._traverser.requestedTiles),i._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const n=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,n){if(e.length!==n.length)return!0;const i=new Set(e.map(o=>o.id)),r=new Set(n.map(o=>o.id));let s=e.filter(o=>!r.has(o.id)).length>0;return s=s||n.filter(o=>!i.has(o.id)).length>0,s}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,n)=>e._unloadTile(n))}_updateStats(){let e=0,n=0;for(const i of this.selectedTiles)i.contentAvailable&&i.content&&(e++,i.content.pointCount?n+=i.content.pointCount:n+=i.content.vertexCount);this.stats.get(Tw).count=this.selectedTiles.length,this.stats.get(Cw).count=e,this.stats.get(Pw).count=n}async _initializeTileSet(e){this.type===Ki.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===Ki.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===Ki.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var e;const n=this.tileset.fullExtent;if(n){const{xmin:r,xmax:s,ymin:o,ymax:a,zmin:c,zmax:f}=n;this.cartographicCenter=new K(r+(s-r)/2,o+(a-o)/2,c+(f-c)/2),this.cartesianCenter=rn.WGS84.cartographicToCartesian(this.cartographicCenter,new K),this.zoom=P3(n,this.cartographicCenter,this.cartesianCenter);return}const i=(e=this.tileset.store)===null||e===void 0?void 0:e.extent;if(i){const[r,s,o,a]=i;this.cartographicCenter=new K(r+(o-r)/2,s+(a-s)/2,0),this.cartesianCenter=rn.WGS84.cartographicToCartesian(this.cartographicCenter,new K),this.zoom=RQ(i,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new K,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root;lt(e);const{center:n}=e.boundingVolume;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new K,this.zoom=1;return}this.cartographicCenter=rn.WGS84.cartesianToCartographic(n,new K),this.cartesianCenter=n,this.zoom=LQ(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(Bu),this.stats.get(H0),this.stats.get(V0),this.stats.get(Tw),this.stats.get(Cw),this.stats.get(bw),this.stats.get(Sw),this.stats.get(xw),this.stats.get(Pw,"memory"),this.stats.get(j0,"memory")}_initializeTileHeaders(e,n){const i=new Hp(this,e.root,n);if(n&&(n.children.push(i),i.depth=n.depth+1),this.type===Ki.TILES3D){const r=[];for(r.push(i);r.length>0;){const s=r.pop();this.stats.get(Bu).incrementCount();const o=s.header.children||[];for(const a of o){const c=new Hp(this,a,s);s.children.push(c),c.depth=s.depth+1,r.push(c)}}}return i}_initializeTraverser(){let e;switch(this.type){case Ki.TILES3D:e=JQ;break;case Ki.I3S:e=ZQ;break;default:e=Qf}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let n;try{this._onStartTileLoading(),n=await e.loadContent()}catch(i){this._onTileLoadError(e,i)}finally{this._onEndTileLoading(),this._onTileLoad(e,n)}}_onTileLoadError(e,n){this.stats.get(xw).incrementCount();const i=n.message||n.toString(),r=e.url;console.error("A 3D tile failed to load: ".concat(e.url," ").concat(i)),this.options.onTileError(e,i,r)}_onTileLoad(e,n){if(!!n){if(this.type===Ki.I3S){var i,r;const s=((i=this.tileset)===null||i===void 0||(r=i.nodePagesTile)===null||r===void 0?void 0:r.nodesInNodePages)||0;this.stats.get(Bu).reset(),this.stats.get(Bu).addCount(s)}e&&e.content&&SQ(e,e.content),this._addTileToCache(e),this.options.onTileLoad(e)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(H0).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(H0).decrementCount()}_addTileToCache(e){this._cache.add(this,e,n=>n._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(bw).incrementCount(),this.stats.get(V0).incrementCount(),this.gpuMemoryUsageInBytes+=e.content.byteLength||0,this.stats.get(j0).count=this.gpuMemoryUsageInBytes}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.content&&e.content.byteLength||0,this.stats.get(V0).decrementCount(),this.stats.get(Sw).incrementCount(),this.stats.get(j0).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const n=e.pop();for(const i of n.children)e.push(i);this._destroyTile(n)}this.root=null}_destroySubtree(e){const n=e,i=[];for(i.push(n);i.length>0;){e=i.pop();for(const r of e.children)i.push(r);e!==n&&this._destroyTile(e)}n.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed,this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}function eX(t){const e=[];for(const n of Object.keys(t))e.push("".concat(n,"=").concat(t[n]));switch(e.length){case 0:return"";case 1:return"?".concat(e[0]);default:return"?".concat(e.join("&"))}}const B3="3.2.6",OA={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function L3(t,e,n){lt(t instanceof ArrayBuffer);const i=new TextDecoder("utf8"),r=new Uint8Array(t,e,n);return i.decode(r)}function tX(t,e=0){const n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}const nX={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},zt={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},it={...nX,...zt},W0={[zt.DOUBLE]:Float64Array,[zt.FLOAT]:Float32Array,[zt.UNSIGNED_SHORT]:Uint16Array,[zt.UNSIGNED_INT]:Uint32Array,[zt.UNSIGNED_BYTE]:Uint8Array,[zt.BYTE]:Int8Array,[zt.SHORT]:Int16Array,[zt.INT]:Int32Array},iX={DOUBLE:zt.DOUBLE,FLOAT:zt.FLOAT,UNSIGNED_SHORT:zt.UNSIGNED_SHORT,UNSIGNED_INT:zt.UNSIGNED_INT,UNSIGNED_BYTE:zt.UNSIGNED_BYTE,BYTE:zt.BYTE,SHORT:zt.SHORT,INT:zt.INT},Q0="Failed to convert GL type";class er{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const n in W0)if(W0[n]===e)return n;throw new Error(Q0)}static fromName(e){const n=iX[e];if(!n)throw new Error(Q0);return n}static getArrayType(e){switch(e){case zt.UNSIGNED_SHORT_5_6_5:case zt.UNSIGNED_SHORT_4_4_4_4:case zt.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const n=W0[e];if(!n)throw new Error(Q0);return n}}static getByteSize(e){return er.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return Boolean(er.getArrayType(e))}static createTypedArray(e,n,i=0,r){r===void 0&&(r=(n.byteLength-i)/er.getByteSize(e));const s=er.getArrayType(e);return new s(n,i,r)}}function rX(t,e){if(!t)throw new Error("math.gl assertion failed. ".concat(e))}function sX(t,e=[0,0,0]){const n=t>>11&31,i=t>>5&63,r=t&31;return e[0]=n<<3,e[1]=i<<2,e[2]=r<<3,e}new A1;new K;new A1;new A1;function Mw(t,e=255){return kt(t,0,e)/e*2-1}function Iw(t){return t<0?-1:1}function oX(t,e,n,i){if(rX(i),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(i.x=Mw(t,n),i.y=Mw(e,n),i.z=1-(Math.abs(i.x)+Math.abs(i.y)),i.z<0){const r=i.x;i.x=(1-Math.abs(i.y))*Iw(r),i.y=(1-Math.abs(r))*Iw(i.y)}return i.normalize()}function aX(t,e,n){return oX(t,e,255,n)}class t_{constructor(e,n){T(this,"json",void 0),T(this,"buffer",void 0),T(this,"featuresLength",0),T(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=n}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return Boolean(this.json[e])}getGlobalProperty(e,n=it.UNSIGNED_INT,i=1){const r=this.json[e];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(e,n,i,1,r.byteOffset):r}getPropertyArray(e,n,i){const r=this.json[e];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(n=er.fromName(r.componentType)),this._getTypedArrayFromBinary(e,n,i,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(e,n,r)}getProperty(e,n,i,r,s){const o=this.json[e];if(!o)return o;const a=this.getPropertyArray(e,n,i);if(i===1)return a[r];for(let c=0;c<i;++c)s[c]=a[i*r+c];return s}_getTypedArrayFromBinary(e,n,i,r,s){const o=this._cachedTypedArrays;let a=o[e];return a||(a=er.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+s,r*i),o[e]=a),a}_getTypedArrayFromArray(e,n,i){const r=this._cachedTypedArrays;let s=r[e];return s||(s=er.createTypedArray(n,i),r[e]=s),s}}const AX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},lX={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},cX={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function uX(t,e,n,i){const{componentType:r}=t;lt(t.componentType);const s=typeof r=="string"?er.fromName(r):r,o=AX[t.type],a=lX[t.type],c=cX[t.type];return n+=t.byteOffset,{values:er.createTypedArray(s,e,n,o*i),type:s,size:o,unpacker:a,packer:c}}const $i=t=>t!==void 0;function hX(t,e,n){if(!e)return null;let i=t.getExtension("3DTILES_batch_table_hierarchy");const r=e.HIERARCHY;return r&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=r,i=r),i?fX(i,n):null}function fX(t,e){let n,i,r;const s=t.instancesLength,o=t.classes;let a=t.classIds,c=t.parentCounts,f=t.parentIds,p=s;$i(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,r=getBinaryAccessor(a),a=r.createArrayBufferView(e.buffer,e.byteOffset+a.byteOffset,s));let m;if($i(c))for($i(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,r=getBinaryAccessor(c),c=r.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,s)),m=new Uint16Array(s),p=0,n=0;n<s;++n)m[n]=p,p+=c[n];$i(f)&&$i(f.byteOffset)&&(f.componentType=defaultValue(f.componentType,GL.UNSIGNED_SHORT),f.type=AttributeType.SCALAR,r=getBinaryAccessor(f),f=r.createArrayBufferView(e.buffer,e.byteOffset+f.byteOffset,p));const v=o.length;for(n=0;n<v;++n){const R=o[n].length,x=o[n].instances,P=getBinaryProperties(R,x,e);o[n].instances=combine(P,x)}const w=new Array(v).fill(0),C=new Uint16Array(s);for(n=0;n<s;++n)i=a[n],C[n]=w[i],++w[i];const S={classes:o,classIds:a,classIndexes:C,parentCounts:c,parentIndexes:m,parentIds:f};return pX(S),S}function FA(t,e,n){if(!t)return;const i=t.parentCounts;return t.parentIds?n(t,e):i>0?dX(t,e,n):gX(t,e,n)}function dX(t,e,n){const i=t.classIds,r=t.parentCounts,s=t.parentIds,o=t.parentIndexes,a=i.length,c=scratchVisited;c.length=Math.max(c.length,a);const f=++marker,p=scratchStack;for(p.length=0,p.push(e);p.length>0;){if(e=p.pop(),c[e]===f)continue;c[e]=f;const m=n(t,e);if($i(m))return m;const v=r[e],w=o[e];for(let C=0;C<v;++C){const S=s[w+C];S!==e&&p.push(S)}}return null}function gX(t,e,n){let i=!0;for(;i;){const r=n(t,e);if($i(r))return r;const s=t.parentIds[e];i=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}function pX(t){const n=t.classIds.length;for(let i=0;i<n;++i)R3(t,i,stack)}function R3(t,e,n){const i=t.parentCounts,r=t.parentIds,s=t.parentIndexes,a=t.classIds.length;if(!$i(r))return;assert(e<a,"Parent index ".concat(e," exceeds the total number of instances: ").concat(a)),assert(n.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),n.push(e);const c=$i(i)?i[e]:1,f=$i(i)?s[e]:e;for(let p=0;p<c;++p){const m=r[f+p];m!==e&&R3(t,m,n)}n.pop(e)}function Bn(t){return t!=null}const Lu=(t,e)=>t,mX={HIERARCHY:!0,extensions:!0,extras:!0};class O3{constructor(e,n,i,r={}){var s;T(this,"json",void 0),T(this,"binary",void 0),T(this,"featureCount",void 0),T(this,"_extensions",void 0),T(this,"_properties",void 0),T(this,"_binaryProperties",void 0),T(this,"_hierarchy",void 0),lt(i>=0),this.json=e||{},this.binary=n,this.featureCount=i,this._extensions=((s=this.json)===null||s===void 0?void 0:s.extensions)||{},this._properties={};for(const o in this.json)mX[o]||(this._properties[o]=this.json[o]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=hX(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,n){if(this._checkBatchId(e),lt(typeof n=="string",n),this._hierarchy){const i=FA(this._hierarchy,e,(r,s)=>{const o=r.classIds[s];return r.classes[o].name===n});return Bn(i)}return!1}isExactClass(e,n){return lt(typeof n=="string",n),this.getExactClassName(e)===n}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const n=this._hierarchy.classIds[e];return this._hierarchy.classes[n].name}}hasProperty(e,n){return this._checkBatchId(e),lt(typeof n=="string",n),Bn(this._properties[n])||this._hasPropertyInHierarchy(e,n)}getPropertyNames(e,n){this._checkBatchId(e),n=Bn(n)?n:[],n.length=0;const i=Object.keys(this._properties);return n.push(...i),this._hierarchy&&this._getPropertyNamesInHierarchy(e,n),n}getProperty(e,n){if(this._checkBatchId(e),lt(typeof n=="string",n),this._binaryProperties){const r=this._binaryProperties[n];if(Bn(r))return this._getBinaryProperty(r,e)}const i=this._properties[n];if(Bn(i))return Lu(i[e]);if(this._hierarchy){const r=this._getHierarchyProperty(e,n);if(Bn(r))return r}}setProperty(e,n,i){const r=this.featureCount;if(this._checkBatchId(e),lt(typeof n=="string",n),this._binaryProperties){const o=this._binaryProperties[n];if(o){this._setBinaryProperty(o,e,i);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,n,i))return;let s=this._properties[n];Bn(s)||(this._properties[n]=new Array(r),s=this._properties[n]),s[e]=Lu(i)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,n){return e.unpack(e.typedArray,n)}_setBinaryProperty(e,n,i){e.pack(i,e.typedArray,n)}_initializeBinaryProperties(){let e=null;for(const n in this._properties){const i=this._properties[n],r=this._initializeBinaryProperty(n,i);r&&(e=e||{},e[n]=r)}return e}_initializeBinaryProperty(e,n){if("byteOffset"in n){const i=n;lt(this.binary,"Property ".concat(e," requires a batch table binary.")),lt(i.type,"Property ".concat(e," requires a type."));const r=uX(i,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null}_hasPropertyInHierarchy(e,n){if(!this._hierarchy)return!1;const i=FA(this._hierarchy,e,(r,s)=>{const o=r.classIds[s],a=r.classes[o].instances;return Bn(a[n])});return Bn(i)}_getPropertyNamesInHierarchy(e,n){FA(this._hierarchy,e,(i,r)=>{const s=i.classIds[r],o=i.classes[s].instances;for(const a in o)o.hasOwnProperty(a)&&n.indexOf(a)===-1&&n.push(a)})}_getHierarchyProperty(e,n){return FA(this._hierarchy,e,(i,r)=>{const s=i.classIds[r],o=i.classes[s],a=i.classIndexes[r],c=o.instances[n];return Bn(c)?Bn(c.typedArray)?this._getBinaryProperty(c,a):Lu(c[a]):null})}_setHierarchyProperty(e,n,i,r){const s=FA(this._hierarchy,n,(o,a)=>{const c=o.classIds[a],f=o.classes[c],p=o.classIndexes[a],m=f.instances[i];return Bn(m)?(lt(a===n,'Inherited property "'.concat(i,'" is read-only.')),Bn(m.typedArray)?this._setBinaryProperty(m,p,r):m[p]=Lu(r),!0):!1});return Bn(s)}}const X0=4;function Xf(t,e,n=0){const i=new DataView(e);if(t.magic=i.getUint32(n,!0),n+=X0,t.version=i.getUint32(n,!0),n+=X0,t.byteLength=i.getUint32(n,!0),n+=X0,t.version!==1)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}const No=4,Bw="b3dm tile in legacy format.";function n_(t,e,n){const i=new DataView(e);let r;t.header=t.header||{};let s=i.getUint32(n,!0);n+=No;let o=i.getUint32(n,!0);n+=No;let a=i.getUint32(n,!0);n+=No;let c=i.getUint32(n,!0);return n+=No,a>=570425344?(n-=No*2,r=s,a=o,c=0,s=0,o=0,console.warn(Bw)):c>=570425344&&(n-=No,r=a,a=s,c=o,s=0,o=0,console.warn(Bw)),t.header.featureTableJsonByteLength=s,t.header.featureTableBinaryByteLength=o,t.header.batchTableJsonByteLength=a,t.header.batchTableBinaryByteLength=c,t.header.batchLength=r,n}function i_(t,e,n,i){return n=_X(t,e,n),n=yX(t,e,n),n}function _X(t,e,n,i){const{featureTableJsonByteLength:r,featureTableBinaryByteLength:s,batchLength:o}=t.header;if(t.featureTableJson={BATCH_LENGTH:o||0},r>0){const a=L3(e,n,r);t.featureTableJson=JSON.parse(a)}return n+=r,t.featureTableBinary=new Uint8Array(e,n,s),n+=s,n}function yX(t,e,n,i){const{batchTableJsonByteLength:r,batchTableBinaryByteLength:s}=t.header;if(r>0){const o=L3(e,n,r);t.batchTableJson=JSON.parse(o),n+=r,s>0&&(t.batchTableBinary=new Uint8Array(e,n,s),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=s)}return n}function F3(t,e,n){if(!e&&(!t||!t.batchIds||!n))return null;const{batchIds:i,isRGB565:r,pointCount:s}=t;if(i&&n){const o=new Uint8ClampedArray(s*3);for(let a=0;a<s;a++){const c=i[a],p=n.getProperty(c,"dimensions").map(m=>m*255);o[a*3]=p[0],o[a*3+1]=p[1],o[a*3+2]=p[2]}return{type:it.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}if(r){const o=new Uint8ClampedArray(s*3);for(let a=0;a<s;a++){const c=sX(e[a]);o[a*3]=c[0],o[a*3+1]=c[1],o[a*3+2]=c[2]}return{type:it.UNSIGNED_BYTE,value:o,size:3,normalized:!0}}return e&&e.length===s*3?{type:it.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:it.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}const Lw=new K;function vX(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(t.pointsLength*3);for(let i=0;i<t.pointsLength;i++)aX(e[i*2],e[i*2+1],Lw),Lw.toArray(n,i*3);return{type:it.FLOAT,size:2,value:n}}return{type:it.FLOAT,size:2,value:e}}function EX(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,wX(t,e)):{type:it.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function wX(t,e){const n=new K,i=new Float32Array(t.pointCount*3);for(let r=0;r<t.pointCount;r++)n.set(e[r*3],e[r*3+1],e[r*3+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(i,r*3);return i}async function TX(t,e,n,i,r){n=Xf(t,e,n),n=n_(t,e,n),n=i_(t,e,n),CX(t);const{featureTable:s,batchTable:o}=bX(t);return await IX(t,s,o,i,r),SX(t,s,i),xX(t,s,o),PX(t,s),n}function CX(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function bX(t){const e=new t_(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",it.FLOAT,3);const i=MX(t,e);return{featureTable:e,batchTable:i}}function SX(t,e,n){if(!t.attributes.positions){if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",it.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const i=e.getPropertyArray("POSITION_QUANTIZED",it.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=(1<<16)-1,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",it.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",it.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=EX(t,i,n)}}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function xX(t,e,n){if(!t.attributes.colors){let i=null;e.hasProperty("RGBA")?(i=e.getPropertyArray("RGBA",it.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?i=e.getPropertyArray("RGB",it.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(i=e.getPropertyArray("RGB565",it.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=F3(t,i,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",it.UNSIGNED_BYTE,4))}function PX(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",it.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",it.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=vX(t,n)}}function MX(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",it.UNSIGNED_SHORT,1),t.batchIds)){const i=e.getGlobalProperty("BATCH_LENGTH");if(!i)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:r,batchTableBinary:s}=t;n=new O3(r,s,i)}return n}async function IX(t,e,n,i,r){let s,o,a;const c=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];c&&(a=c.properties);const f=e.getExtension("3DTILES_draco_point_compression");if(f){o=f.properties;const m=f.byteOffset,v=f.byteLength;if(!o||!Number.isFinite(m)||!v)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=t.featureTableBinary.slice(m,m+v),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA)}if(!s)return!0;const p={buffer:s,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await BX(t,p,i,r)}async function BX(t,e,n,i){const{parse:r}=i,s={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete s["3d-tiles"];const o=await r(e.buffer,w3,s),a=o.attributes.POSITION&&o.attributes.POSITION.value,c=o.attributes.COLOR_0&&o.attributes.COLOR_0.value,f=o.attributes.NORMAL&&o.attributes.NORMAL.value,p=o.attributes.BATCH_ID&&o.attributes.BATCH_ID.value,m=a&&o.attributes.POSITION.value.quantization,v=f&&o.attributes.NORMAL.value.quantization;if(m){const C=o.POSITION.data.quantization,S=C.range;t.quantizedVolumeScale=new K(S,S,S),t.quantizedVolumeOffset=new K(C.minValues),t.quantizedRange=(1<<C.quantizationBits)-1,t.isQuantizedDraco=!0}v&&(t.octEncodedRange=(1<<o.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const w={};if(e.batchTableProperties)for(const C of Object.keys(e.batchTableProperties))o.attributes[C]&&o.attributes[C].value&&(w[C.toLowerCase()]=o.attributes[C].value);t.attributes={positions:a,colors:F3(t,c,void 0),normals:f,batchIds:p,...w}}const jp={URI:0,EMBEDDED:1};function D3(t,e,n,i){t.rotateYtoZ=!0;const r=t.byteOffset+t.byteLength-n;if(r===0)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=i["3d-tiles"]&&i["3d-tiles"].assetGltfUpAxis?i["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=Hm(e,n,r),t.gltfByteOffset=0,t.gltfByteLength=r,n%4===0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}async function k3(t,e,n,i){const r=n["3d-tiles"]||{};if(LX(t,e),r.loadGLTF){const{parse:s,fetch:o}=i;t.gltfUrl&&(t.gltfArrayBuffer=await o(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await s(t.gltfArrayBuffer,jl,n,i),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}function LX(t,e,n){switch(e){case jp.URI:const i=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),s=new TextDecoder().decode(i);t.gltfUrl=s.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case jp.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function RX(t,e,n,i,r){var s;n=OX(t,e,n,i),await k3(t,jp.EMBEDDED,i,r);const o=t==null||(s=t.gltf)===null||s===void 0?void 0:s.extensions;return o&&o.CESIUM_RTC&&(t.rtcCenter=o.CESIUM_RTC.center),n}function OX(t,e,n,i,r){n=Xf(t,e,n),n=n_(t,e,n),n=i_(t,e,n),n=D3(t,e,n,i);const s=new t_(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=s.getGlobalProperty("RTC_CENTER",it.FLOAT,3),n}async function FX(t,e,n,i,r){return n=DX(t,e,n,i),await k3(t,t.gltfFormat,i,r),n}function DX(t,e,n,i,r){if(n=Xf(t,e,n),t.version!==1)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=n_(t,e,n);const s=new DataView(e);if(t.gltfFormat=s.getUint32(n,!0),n+=4,n=i_(t,e,n),n=D3(t,e,n,i),t.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new t_(t.featureTableJson,t.featureTableBinary),a=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",it.FLOAT,3);const c=new O3(t.batchTableJson,t.batchTableBinary,a);return kX(t,o,c,a),n}function kX(t,e,n,i){const s={instances:new Array(i),batchTable:t._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,o=new K;new K,new K,new K;const a=new Zt,c=new Il,f=new K,p={},m=new De,v=[],w=[],C=new K,S=new K;for(let R=0;R<i;R++){let x;if(e.hasProperty("POSITION"))x=e.getProperty("POSITION",it.FLOAT,3,R,o);else if(e.hasProperty("POSITION_QUANTIZED")){x=e.getProperty("POSITION_QUANTIZED",it.UNSIGNED_SHORT,3,R,o);const q=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",it.FLOAT,3,C);if(!q)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const ee=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",it.FLOAT,3,S);if(!ee)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const X=65535;for(let V=0;V<3;V++)x[V]=x[V]/X*ee[V]+q[V]}if(!x)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(o.copy(x),p.translation=o,t.normalUp=e.getProperty("NORMAL_UP",it.FLOAT,3,R,v),t.normalRight=e.getProperty("NORMAL_RIGHT",it.FLOAT,3,R,w),t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",it.UNSIGNED_SHORT,2,v),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",it.UNSIGNED_SHORT,2,w),t.octNormalUp)throw t.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");t.eastNorthUp?(rn.WGS84.eastNorthUpToFixedFrame(o,m),m.getRotationMatrix3(a)):a.identity()}c.fromMatrix3(a),p.rotation=c,f.set(1,1,1);const P=e.getProperty("SCALE",it.FLOAT,1,R);Number.isFinite(P)&&f.multiplyByScalar(P);const I=e.getProperty("SCALE_NON_UNIFORM",it.FLOAT,3,R,v);I&&f.scale(I),p.scale=f;let F=e.getProperty("BATCH_ID",it.UNSIGNED_SHORT,1,R);F===void 0&&(F=R);const H=new De().fromQuaternion(p.rotation);m.identity(),m.translate(p.translation),m.multiplyRight(H),m.scale(p.scale);const Q=m.clone();s[R]={modelMatrix:Q,batchId:F}}t.instances=s}async function NX(t,e,n,i,r,s){n=Xf(t,e,n);const o=new DataView(e);for(t.tilesLength=o.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const a={};t.tiles.push(a),n=await s(e,n,i,r,a)}return n}async function UX(t,e,n,i){t.rotateYtoZ=!0,t.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y";const{parse:r}=i;t.gltf=await r(e,jl,n,i)}async function N3(t,e=0,n,i,r={}){switch(r.byteOffset=e,r.type=tX(t,e),r.type){case OA.COMPOSITE:return await NX(r,t,e,n,i,N3);case OA.BATCHED_3D_MODEL:return await RX(r,t,e,n,i);case OA.GLTF:return await UX(r,t,n,i);case OA.INSTANCED_3D_MODEL:return await FX(r,t,e,n,i);case OA.POINT_CLOUD:return await TX(r,t,e,n,i);default:throw new Error("3DTileLoader: unknown type ".concat(r.type))}}const GX=1952609651,zX=1;async function VX(t){if(new Uint32Array(t.slice(0,4))[0]!==GX)throw new Error("Wrong subtree file magic number");if(new Uint32Array(t.slice(4,8))[0]!==zX)throw new Error("Wrong subtree file verson, must be 1");const i=Rw(t.slice(8,16)),r=new Uint8Array(t,24,i),o=new TextDecoder("utf8").decode(r),a=JSON.parse(o),c=Rw(t.slice(16,24));let f=new ArrayBuffer(0);return c&&(f=t.slice(24+i)),"bufferView"in a.tileAvailability&&(a.tileAvailability.explicitBitstream=await J0(a,"tileAvailability",f)),"bufferView"in a.contentAvailability&&(a.contentAvailability.explicitBitstream=await J0(a,"contentAvailability",f)),"bufferView"in a.childSubtreeAvailability&&(a.childSubtreeAvailability.explicitBitstream=await J0(a,"childSubtreeAvailability",f)),a}async function J0(t,e,n){const i=t[e].bufferView,r=t.bufferViews[i],s=t.buffers[r.buffer];if(s.uri){const a=await(await $g(s.uri)).arrayBuffer();return new Uint8Array(a,r.byteOffset,r.byteLength)}return new Uint8Array(n,r.byteOffset,r.byteLength)}function Rw(t){const e=new DataView(t),n=e.getUint32(0,!0),i=e.getUint32(4,!0);return n+2**32*i}const U3={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:B3,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:VX,options:{}},HX=4,jX=8,WX={QUADTREE:HX,OCTREE:jX};async function G3(t){const{options:e,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:i=0,globalData:r={level:0,mortonIndex:0,x:0,y:0,z:0}}=t;let{subtree:s,level:o=0}=t;const{subdivisionScheme:a,subtreeLevels:c,maximumLevel:f,contentUrlTemplate:p,subtreesUriTemplate:m,basePath:v}=e,w={children:[],lodMetricValue:0,contentUrl:""},C=WX[a],S=i&1,R=i>>1&1,x=i>>2&1,P=(C**o-1)/(C-1);let I=ks(n.mortonIndex,i),F=P+I,H=ks(n.x,S),Q=ks(n.y,R),q=ks(n.z,x),ee=!1;o+1>c&&(ee=Y0(s.childSubtreeAvailability,I));const X=ks(r.x,H),V=ks(r.y,Q),D=ks(r.z,q),re=o+r.level;if(ee){const Qe="".concat(v,"/").concat(m),oe=Wp(Qe,re,X,V,D);s=await Sr(oe,U3),r.mortonIndex=I,r.x=H,r.y=Q,r.z=q,r.level=o,I=0,F=0,H=0,Q=0,q=0,o=0}if(!Y0(s.tileAvailability,F)||o>f)return w;Y0(s.contentAvailability,F)&&(w.contentUrl=Wp(p,re,X,V,D));const Be=o+1,Ye={mortonIndex:I,x:H,y:Q,z:q};for(let Qe=0;Qe<C;Qe++){const oe=await G3({subtree:s,options:e,parentData:Ye,childIndex:Qe,level:Be,globalData:r});if(oe.contentUrl||oe.children.length){const ve=re+1,Le=QX(oe,ve,{childTileX:H,childTileY:Q,childTileZ:q},e);w.children.push(Le)}}return w}function Y0(t,e){return"constant"in t?Boolean(t.constant):t.explicitBitstream?YX(e,t.explicitBitstream):!1}function QX(t,e,n,i){const{basePath:r,refine:s,getRefine:o,lodMetricType:a,getTileType:c,rootLodMetricValue:f,rootBoundingVolume:p}=i,m=t.contentUrl&&t.contentUrl.replace("".concat(r,"/"),""),v=f/2**e,w=XX(e,p,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:m},id:t.contentUrl,refine:o(s),type:c(t),lodMetricType:a,lodMetricValue:v,boundingVolume:w}}function XX(t,e,n){if(e.region){const{childTileX:i,childTileY:r,childTileZ:s}=n,[o,a,c,f,p,m]=e.region,v=2**t,w=(c-o)/v,C=(f-a)/v,S=(m-p)/v,[R,x]=[o+w*i,o+w*(i+1)],[P,I]=[a+C*r,a+C*(r+1)],[F,H]=[p+S*s,p+S*(s+1)];return{region:[R,P,x,I,F,H]}}return console.warn("Unsupported bounding volume type: ",e),null}function ks(t,e){return parseInt(t.toString(2)+e.toString(2),2)}function Wp(t,e,n,i,r){const s=JX({level:e,x:n,y:i,z:r});return t.replace(/{level}|{x}|{y}|{z}/gi,o=>s[o])}function JX(t){const e={};for(const n in t)e["{".concat(n,"}")]=t[n];return e}function YX(t,e){const n=Math.floor(t/8),i=t%8;return(e[n]>>i&1)===1}function r_(t){if(!t.contentUrl)return Ea.EMPTY;const n=t.contentUrl.split(".").pop();switch(n){case"pnts":return Ea.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Ea.SCENEGRAPH;default:return n}}function s_(t){switch(t){case"REPLACE":case"replace":return Er.REPLACE;case"ADD":case"add":return Er.ADD;default:return t}}function Ow(t,e){if(!t)return null;if(t.content){const n=t.content.uri||t.content.url;t.contentUrl="".concat(e.basePath,"/").concat(n)}return t.id=t.contentUrl,t.lodMetricType=Wf.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=r_(t),t.refine=s_(t.refine),t}function KX(t){const e=t.basePath,n=Ow(t.root,t),i=[];for(i.push(n);i.length>0;){const s=(i.pop()||{}).children||[];for(const o of s)Ow(o,{basePath:e}),i.push(o)}return n}async function ZX(t){if(!t.root)return null;const e=t.basePath,n=t.root.extensions["3DTILES_implicit_tiling"],{subdivisionScheme:i,maximumLevel:r,subtreeLevels:s,subtrees:{uri:o}}=n,a=Wp(o,0,0,0,0),c="".concat(e,"/").concat(a),f=await Sr(c,U3),p="".concat(e,"/").concat(t.root.content.uri),m=t.root.refine,v=t.root.geometricError,w=t.root.boundingVolume,C={contentUrlTemplate:p,subtreesUriTemplate:o,subdivisionScheme:i,subtreeLevels:s,maximumLevel:r,refine:m,basePath:e,lodMetricType:Wf.GEOMETRIC_ERROR,rootLodMetricValue:v,rootBoundingVolume:w,getTileType:r_,getRefine:s_};return await qX(t.root,f,C)}async function qX(t,e,n){if(!t)return null;t.lodMetricType=Wf.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform;const{children:i,contentUrl:r}=await G3({subtree:e,options:n});return r&&(t.contentUrl=r,t.content={uri:r.replace("".concat(n.basePath,"/"),"")}),t.refine=s_(t.refine),t.type=r_(t),t.children=i,t.id=t.contentUrl,t}const Fw="3DTILES_implicit_tiling",z3={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:B3,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:nJ,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function $X(t){return _b(t.url)}async function eJ(t,e,n){const i={content:{featureIds:null}};return await N3(t,0,e,n,i.content),i.content}async function tJ(t,e,n){var i;const r=JSON.parse(new TextDecoder().decode(t));return r.loader=e.loader||z3,r.url=n.url,r.basePath=$X(r),r.root=iJ(r)?await ZX(r):KX(r),r.type=Ki.TILES3D,r.lodMetricType=Wf.GEOMETRIC_ERROR,r.lodMetricValue=((i=r.root)===null||i===void 0?void 0:i.lodMetricValue)||0,r}async function nJ(t,e,n){const i=e["3d-tiles"]||{};let r;return i.isTileset==="auto"?r=n.url&&n.url.indexOf(".json")!==-1:r=i.isTileset,r?t=await tJ(t,e,n):t=await eJ(t,e,n),t}function iJ(t){var e,n;return(t==null||(e=t.extensionsRequired)===null||e===void 0?void 0:e.includes(Fw))&&(t==null||(n=t.extensionsUsed)===null||n===void 0?void 0:n.includes(Fw))}const Dw=[0],rJ={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:null,loader:z3,onTilesetLoad:{type:"function",value:t=>{},compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:(t,e,n)=>{},compare:!1},_getMeshColor:{type:"function",value:t=>[255,255,255],compare:!1}};class V3 extends Rr{constructor(...e){super(...e),T(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&Re.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){const{tileset3d:e}=this.state;return e!==null&&e.isLoaded()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,oldProps:n,changeFlags:i}){if(e.data&&e.data!==n.data&&this._loadTileset(e.data),i.viewportChanged){const{activeViewports:r}=this.state;Object.keys(r).length&&(this._updateTileset(r),this.state.lastUpdatedViewports=r,this.state.activeViewports={})}if(i.propsChanged){const{layerMap:r}=this.state;for(const s in r)r[s].needsUpdate=!0}}activateViewport(e){const{activeViewports:n,lastUpdatedViewports:i}=this.state;this.internalState.viewport=e,n[e.id]=e;const r=i==null?void 0:i[e.id];(!r||!e.equals(r))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:e,sourceLayer:n}){const{layerMap:i}=this.state,r=n&&n.id;if(r){const s=r.substring(this.id.length+1),o=s.substring(s.indexOf("-")+1);e.object=i[o]&&i[o].tile}return e}filterSubLayer({layer:e,viewport:n}){const{tile:i}=e.props,{id:r}=n;return i.selected&&i.viewportIds.includes(r)}_updateAutoHighlight(e){e.sourceLayer&&e.sourceLayer.updateAutoHighlight(e)}async _loadTileset(e){const{loadOptions:n={}}=this.props;let i=this.props.loader||this.props.loaders;Array.isArray(i)&&(i=i[0]);const r={loadOptions:{...n}};if(i.preload){const a=await i.preload(e,n);a.headers&&(r.loadOptions.fetch={...r.loadOptions.fetch,headers:a.headers}),Object.assign(r,a)}const s=await Sr(e,i,r.loadOptions),o=new $Q(s,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...r});this.setState({tileset3d:o,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(o)}_onTileLoad(e){const{lastUpdatedViewports:n}=this.state;this.props.onTileLoad(e),this._updateTileset(n),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;const{tileset3d:n}=this.state,{timeline:i}=this.context,r=Object.keys(e).length;!i||!r||!n||n.selectTiles(Object.values(e)).then(s=>{this.state.frameNumber!==s&&this.setState({frameNumber:s})})}_getSubLayer(e,n){if(!e.content)return null;switch(e.type){case Ea.POINTCLOUD:return this._makePointCloudLayer(e,n);case Ea.SCENEGRAPH:return this._make3DModelLayer(e);case Ea.MESH:return this._makeSimpleMeshLayer(e,n);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}_makePointCloudLayer(e,n){const{attributes:i,pointCount:r,constantRGBA:s,cartographicOrigin:o,modelMatrix:a}=e.content,{positions:c,normals:f,colors:p}=i;if(!c)return null;const m=n&&n.props.data||{header:{vertexCount:r},attributes:{POSITION:c,NORMAL:f,COLOR_0:p}},{pointSize:v,getPointColor:w}=this.props,C=this.getSubLayerClass("pointcloud",B1);return new C({pointSize:v},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),tile:e,data:m,coordinateSystem:ze.METER_OFFSETS,coordinateOrigin:o,modelMatrix:a,getColor:s||w,_offset:0})}_make3DModelLayer(e){const{gltf:n,instances:i,cartographicOrigin:r,modelMatrix:s}=e.content,o=this.getSubLayerClass("scenegraph",$1);return new o({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),tile:e,data:i||Dw,scenegraph:n,coordinateSystem:ze.METER_OFFSETS,coordinateOrigin:r,modelMatrix:s,getTransformMatrix:a=>a.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,n){const i=e.content,{attributes:r,indices:s,modelMatrix:o,cartographicOrigin:a,coordinateSystem:c=ze.METER_OFFSETS,material:f,featureIds:p}=i,{_getMeshColor:m}=this.props,v=n&&n.props.mesh||new pi({drawMode:4,attributes:sJ(r),indices:s}),w=this.getSubLayerClass("mesh",e_);return new w(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),tile:e,mesh:v,data:Dw,getColor:m(e),pbrMaterial:f,modelMatrix:o,coordinateOrigin:a,coordinateSystem:c,featureIds:p,_offset:0})}renderLayers(){const{tileset3d:e,layerMap:n}=this.state;return e?e.tiles.map(i=>{const r=n[i.id]=n[i.id]||{tile:i};let{layer:s}=r;return i.selected&&(s?r.needsUpdate&&(s=this._getSubLayer(i,s),r.needsUpdate=!1):s=this._getSubLayer(i)),r.layer=s,s}).filter(Boolean):null}}T(V3,"defaultProps",rJ);T(V3,"layerName","Tile3DLayer");function sJ(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}const oJ=new Map([["centerX",Float64Array.BYTES_PER_ELEMENT],["centerY",Float64Array.BYTES_PER_ELEMENT],["centerZ",Float64Array.BYTES_PER_ELEMENT],["minHeight",Float32Array.BYTES_PER_ELEMENT],["maxHeight",Float32Array.BYTES_PER_ELEMENT],["boundingSphereCenterX",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterY",Float64Array.BYTES_PER_ELEMENT],["boundingSphereCenterZ",Float64Array.BYTES_PER_ELEMENT],["boundingSphereRadius",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointX",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointY",Float64Array.BYTES_PER_ELEMENT],["horizonOcclusionPointZ",Float64Array.BYTES_PER_ELEMENT]]);function K0(t){return t>>1^-(t&1)}function aJ(t){let e=0;const n={};for(const[i,r]of oJ){const s=r===8?t.getFloat64:t.getFloat32;n[i]=s.call(t,e,!0),e+=r}return{header:n,headerEndPosition:e}}function AJ(t,e){let n=e;const i=3,r=t.getUint32(n,!0),s=new Uint16Array(r*i);n+=Uint32Array.BYTES_PER_ELEMENT;const o=Uint16Array.BYTES_PER_ELEMENT,a=r*o,c=n,f=c+a,p=f+a;let m=0,v=0,w=0;for(let C=0;C<r;C++)m+=K0(t.getUint16(c+o*C,!0)),v+=K0(t.getUint16(f+o*C,!0)),w+=K0(t.getUint16(p+o*C,!0)),s[C]=m,s[C+r]=v,s[C+r*2]=w;return n+=a*3,{vertexData:s,vertexDataEndPosition:n}}function QA(t,e,n,i,r=!0){let s;if(i===2?s=new Uint16Array(t,e,n):s=new Uint32Array(t,e,n),!r)return s;let o=0;for(let a=0;a<s.length;++a){const c=s[a];s[a]=o-c,c===0&&++o}return s}function lJ(t,e,n){let i=n;const r=3,o=e.length/r>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT;i%o!==0&&(i+=o-i%o);const a=t.getUint32(i,!0);i+=Uint32Array.BYTES_PER_ELEMENT;const c=a*3,f=QA(t.buffer,i,c,o);return i+=c*o,{triangleIndicesEndPosition:i,triangleIndices:f}}function cJ(t,e,n){let i=n;const r=3,o=e.length/r>65536?Uint32Array.BYTES_PER_ELEMENT:Uint16Array.BYTES_PER_ELEMENT,a=t.getUint32(i,!0);i+=Uint32Array.BYTES_PER_ELEMENT;const c=QA(t.buffer,i,a,o,!1);i+=a*o;const f=t.getUint32(i,!0);i+=Uint32Array.BYTES_PER_ELEMENT;const p=QA(t.buffer,i,f,o,!1);i+=f*o;const m=t.getUint32(i,!0);i+=Uint32Array.BYTES_PER_ELEMENT;const v=QA(t.buffer,i,m,o,!1);i+=m*o;const w=t.getUint32(i,!0);i+=Uint32Array.BYTES_PER_ELEMENT;const C=QA(t.buffer,i,w,o,!1);return i+=w*o,{edgeIndicesEndPosition:i,westIndices:c,southIndices:p,eastIndices:v,northIndices:C}}function uJ(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function hJ(t){return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}function fJ(t,e){const n={};if(t.byteLength<=e)return{extensions:n,extensionsEndPosition:e};let i=e;for(;i<t.byteLength;){const r=t.getUint8(i,!0);i+=Uint8Array.BYTES_PER_ELEMENT;const s=t.getUint32(i,!0);i+=Uint32Array.BYTES_PER_ELEMENT;const o=new DataView(t.buffer,i,s);switch(r){case 1:{n.vertexNormals=uJ(o);break}case 2:{n.waterMask=hJ(o);break}}i+=s}return{extensions:n,extensionsEndPosition:i}}const ca={header:0,vertices:1,triangleIndices:2,edgeIndices:3,extensions:4},dJ={maxDecodingStep:ca.extensions};function gJ(t,e){const n=Object.assign({},dJ,e),i=new DataView(t),{header:r,headerEndPosition:s}=aJ(i);if(n.maxDecodingStep<ca.vertices)return{header:r};const{vertexData:o,vertexDataEndPosition:a}=AJ(i,s);if(n.maxDecodingStep<ca.triangleIndices)return{header:r,vertexData:o};const{triangleIndices:c,triangleIndicesEndPosition:f}=lJ(i,o,a);if(n.maxDecodingStep<ca.edgeIndices)return{header:r,vertexData:o,triangleIndices:c};const{westIndices:p,southIndices:m,eastIndices:v,northIndices:w,edgeIndicesEndPosition:C}=cJ(i,o,f);if(n.maxDecodingStep<ca.extensions)return{header:r,vertexData:o,triangleIndices:c,westIndices:p,northIndices:w,eastIndices:v,southIndices:m};const{extensions:S}=fJ(i,C);return{header:r,vertexData:o,triangleIndices:c,westIndices:p,northIndices:w,eastIndices:v,southIndices:m,extensions:S}}function H3(t,e,n,i){const r=i?mJ(i,t.POSITION.value):pJ(e),s=new t.POSITION.value.constructor(r.length*6),o=new t.TEXCOORD_0.value.constructor(r.length*4),a=new e.constructor(r.length*6);for(let f=0;f<r.length;f++){const p=r[f];_J({edge:p,edgeIndex:f,attributes:t,skirtHeight:n,newPosition:s,newTexcoord0:o,newTriangles:a})}t.POSITION.value=Xd(t.POSITION.value,s),t.TEXCOORD_0.value=Xd(t.TEXCOORD_0.value,o);const c=e instanceof Array?e.concat(a):Xd(e,a);return{attributes:t,triangles:c}}function pJ(t){const e=[];for(let o=0;o<t.length;o+=3)e.push([t[o],t[o+1]]),e.push([t[o+1],t[o+2]]),e.push([t[o+2],t[o]]);e.sort((o,a)=>Math.min(...o)-Math.min(...a)||Math.max(...o)-Math.max(...a));const n=[];let i=0;for(;i<e.length;){var r,s;e[i][0]===((r=e[i+1])===null||r===void 0?void 0:r[1])&&e[i][1]===((s=e[i+1])===null||s===void 0?void 0:s[0])?i+=2:(n.push(e[i]),i++)}return n}function mJ(t,e){t.westIndices.sort((i,r)=>e[3*i+1]-e[3*r+1]),t.eastIndices.sort((i,r)=>e[3*r+1]-e[3*i+1]),t.southIndices.sort((i,r)=>e[3*r]-e[3*i]),t.northIndices.sort((i,r)=>e[3*i]-e[3*r]);const n=[];for(const i in t){const r=t[i];for(let s=0;s<r.length-1;s++)n.push([r[s],r[s+1]])}return n}function _J({edge:t,edgeIndex:e,attributes:n,skirtHeight:i,newPosition:r,newTexcoord0:s,newTriangles:o}){const a=n.POSITION.value.length,c=e*2,f=e*2+1;r.set(n.POSITION.value.subarray(t[0]*3,t[0]*3+3),c*3),r[c*3+2]=r[c*3+2]-i,r.set(n.POSITION.value.subarray(t[1]*3,t[1]*3+3),f*3),r[f*3+2]=r[f*3+2]-i,s.set(n.TEXCOORD_0.value.subarray(t[0]*2,t[0]*2+2),c*2),s.set(n.TEXCOORD_0.value.subarray(t[1]*2,t[1]*2+2),f*2);const p=e*2*3;o[p]=t[0],o[p+1]=a/3+f,o[p+2]=t[1],o[p+3]=a/3+f,o[p+4]=t[0],o[p+5]=a/3+c}function yJ(t,e,n){const{minHeight:i,maxHeight:r}=e,[s,o,a,c]=n||[0,0,1,1],f=a-s,p=c-o,m=r-i,v=t.length/3,w=new Float32Array(v*3),C=new Float32Array(v*2);for(let S=0;S<v;S++){const R=t[S]/32767,x=t[S+v]/32767,P=t[S+v*2]/32767;w[3*S+0]=R*f+s,w[3*S+1]=x*p+o,w[3*S+2]=P*m+i,C[2*S+0]=R,C[2*S+1]=x}return{POSITION:{value:w,size:3},TEXCOORD_0:{value:C,size:2}}}function vJ(t,e){if(!t)return null;const{bounds:n}=e,{header:i,vertexData:r,triangleIndices:s,westIndices:o,northIndices:a,eastIndices:c,southIndices:f}=gJ(t,ca.triangleIndices);let p=s,m=yJ(r,i,n);const v=Y1(m);if(e.skirtHeight){const{attributes:w,triangles:C}=H3(m,p,e.skirtHeight,{westIndices:o,northIndices:a,eastIndices:c,southIndices:f});m=w,p=C}return{loaderData:{header:{}},header:{vertexCount:p.length,boundingBox:v},mode:4,indices:{value:p,size:1},attributes:m}}function kw(t,e){return vJ(t,e["quantized-mesh"])}class EJ{constructor(e=257){this.gridSize=e;const n=e-1;if(n&n-1)throw new Error(`Expected grid size to be 2^n+1, got ${e}.`);this.numTriangles=n*n*2-2,this.numParentTriangles=this.numTriangles-n*n,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let i=0;i<this.numTriangles;i++){let r=i+2,s=0,o=0,a=0,c=0,f=0,p=0;for(r&1?a=c=f=n:s=o=p=n;(r>>=1)>1;){const v=s+a>>1,w=o+c>>1;r&1?(a=s,c=o,s=f,o=p):(s=a,o=c,a=f,c=p),f=v,p=w}const m=i*4;this.coords[m+0]=s,this.coords[m+1]=o,this.coords[m+2]=a,this.coords[m+3]=c}}createTile(e){return new wJ(e,this)}}class wJ{constructor(e,n){const i=n.gridSize;if(e.length!==i*i)throw new Error(`Expected terrain data of length ${i*i} (${i} x ${i}), got ${e.length}.`);this.terrain=e,this.martini=n,this.errors=new Float32Array(e.length),this.update()}update(){const{numTriangles:e,numParentTriangles:n,coords:i,gridSize:r}=this.martini,{terrain:s,errors:o}=this;for(let a=e-1;a>=0;a--){const c=a*4,f=i[c+0],p=i[c+1],m=i[c+2],v=i[c+3],w=f+m>>1,C=p+v>>1,S=w+C-p,R=C+f-w,x=(s[p*r+f]+s[v*r+m])/2,P=C*r+w,I=Math.abs(x-s[P]);if(o[P]=Math.max(o[P],I),a<n){const F=(p+R>>1)*r+(f+S>>1),H=(v+R>>1)*r+(m+S>>1);o[P]=Math.max(o[P],o[F],o[H])}}}getMesh(e=0){const{gridSize:n,indices:i}=this.martini,{errors:r}=this;let s=0,o=0;const a=n-1;i.fill(0);function c(w,C,S,R,x,P){const I=w+S>>1,F=C+R>>1;Math.abs(w-x)+Math.abs(C-P)>1&&r[F*n+I]>e?(c(x,P,w,C,I,F),c(S,R,x,P,I,F)):(i[C*n+w]=i[C*n+w]||++s,i[R*n+S]=i[R*n+S]||++s,i[P*n+x]=i[P*n+x]||++s,o++)}c(0,0,a,a,a,0),c(a,a,0,0,0,a);const f=new Uint16Array(s*2),p=new Uint32Array(o*3);let m=0;function v(w,C,S,R,x,P){const I=w+S>>1,F=C+R>>1;if(Math.abs(w-x)+Math.abs(C-P)>1&&r[F*n+I]>e)v(x,P,w,C,I,F),v(S,R,x,P,I,F);else{const H=i[C*n+w]-1,Q=i[R*n+S]-1,q=i[P*n+x]-1;f[2*H]=w,f[2*H+1]=C,f[2*Q]=S,f[2*Q+1]=R,f[2*q]=x,f[2*q+1]=P,p[m++]=H,p[m++]=Q,p[m++]=q}}return v(0,0,a,a,a,0),v(a,a,0,0,0,a),{vertices:f,triangles:p}}}class TJ{constructor(e,n,i=n){this.data=e,this.width=n,this.height=i,this.coords=[],this.triangles=[],this._halfedges=[],this._candidates=[],this._queueIndices=[],this._queue=[],this._errors=[],this._rms=[],this._pending=[],this._pendingLen=0,this._rmsSum=0;const r=n-1,s=i-1,o=this._addPoint(0,0),a=this._addPoint(r,0),c=this._addPoint(0,s),f=this._addPoint(r,s),p=this._addTriangle(f,o,c,-1,-1,-1);this._addTriangle(o,f,a,p,-1,-1),this._flush()}run(e=1){for(;this.getMaxError()>e;)this.refine()}refine(){this._step(),this._flush()}getMaxError(){return this._errors[0]}getRMSD(){return this._rmsSum>0?Math.sqrt(this._rmsSum/(this.width*this.height)):0}heightAt(e,n){return this.data[this.width*n+e]}_flush(){const e=this.coords;for(let n=0;n<this._pendingLen;n++){const i=this._pending[n],r=2*this.triangles[i*3+0],s=2*this.triangles[i*3+1],o=2*this.triangles[i*3+2];this._findCandidate(e[r],e[r+1],e[s],e[s+1],e[o],e[o+1],i)}this._pendingLen=0}_findCandidate(e,n,i,r,s,o,a){const c=Math.min(e,i,s),f=Math.min(n,r,o),p=Math.max(e,i,s),m=Math.max(n,r,o);let v=Ns(i,r,s,o,c,f),w=Ns(s,o,e,n,c,f),C=Ns(e,n,i,r,c,f);const S=r-n,R=e-i,x=o-r,P=i-s,I=n-o,F=s-e,H=Ns(e,n,i,r,s,o),Q=this.heightAt(e,n)/H,q=this.heightAt(i,r)/H,ee=this.heightAt(s,o)/H;let X=0,V=0,D=0,re=0;for(let Ae=f;Ae<=m;Ae++){let ge=0;v<0&&x!==0&&(ge=Math.max(ge,Math.floor(-v/x))),w<0&&I!==0&&(ge=Math.max(ge,Math.floor(-w/I))),C<0&&S!==0&&(ge=Math.max(ge,Math.floor(-C/S)));let Be=v+x*ge,Ye=w+I*ge,Qe=C+S*ge,oe=!1;for(let ve=c+ge;ve<=p;ve++){if(Be>=0&&Ye>=0&&Qe>=0){oe=!0;const xe=Q*Be+q*Ye+ee*Qe,Le=Math.abs(xe-this.heightAt(ve,Ae));re+=Le*Le,Le>X&&(X=Le,V=ve,D=Ae)}else if(oe)break;Be+=x,Ye+=I,Qe+=S}v+=P,w+=F,C+=R}(V===e&&D===n||V===i&&D===r||V===s&&D===o)&&(X=0),this._candidates[2*a]=V,this._candidates[2*a+1]=D,this._rms[a]=re,this._queuePush(a,X,re)}_step(){const e=this._queuePop(),n=e*3+0,i=e*3+1,r=e*3+2,s=this.triangles[n],o=this.triangles[i],a=this.triangles[r],c=this.coords[2*s],f=this.coords[2*s+1],p=this.coords[2*o],m=this.coords[2*o+1],v=this.coords[2*a],w=this.coords[2*a+1],C=this._candidates[2*e],S=this._candidates[2*e+1],R=this._addPoint(C,S);if(Ns(c,f,p,m,C,S)===0)this._handleCollinear(R,n);else if(Ns(p,m,v,w,C,S)===0)this._handleCollinear(R,i);else if(Ns(v,w,c,f,C,S)===0)this._handleCollinear(R,r);else{const x=this._halfedges[n],P=this._halfedges[i],I=this._halfedges[r],F=this._addTriangle(s,o,R,x,-1,-1,n),H=this._addTriangle(o,a,R,P,-1,F+1),Q=this._addTriangle(a,s,R,I,F+2,H+1);this._legalize(F),this._legalize(H),this._legalize(Q)}}_addPoint(e,n){const i=this.coords.length>>1;return this.coords.push(e,n),i}_addTriangle(e,n,i,r,s,o,a=this.triangles.length){const c=a/3;return this.triangles[a+0]=e,this.triangles[a+1]=n,this.triangles[a+2]=i,this._halfedges[a+0]=r,this._halfedges[a+1]=s,this._halfedges[a+2]=o,r>=0&&(this._halfedges[r]=a+0),s>=0&&(this._halfedges[s]=a+1),o>=0&&(this._halfedges[o]=a+2),this._candidates[2*c+0]=0,this._candidates[2*c+1]=0,this._queueIndices[c]=-1,this._rms[c]=0,this._pending[this._pendingLen++]=c,a}_legalize(e){const n=this._halfedges[e];if(n<0)return;const i=e-e%3,r=n-n%3,s=i+(e+1)%3,o=i+(e+2)%3,a=r+(n+2)%3,c=r+(n+1)%3,f=this.triangles[o],p=this.triangles[e],m=this.triangles[s],v=this.triangles[a],w=this.coords;if(!CJ(w[2*f],w[2*f+1],w[2*p],w[2*p+1],w[2*m],w[2*m+1],w[2*v],w[2*v+1]))return;const C=this._halfedges[s],S=this._halfedges[o],R=this._halfedges[a],x=this._halfedges[c];this._queueRemove(i/3),this._queueRemove(r/3);const P=this._addTriangle(f,v,m,-1,R,C,i),I=this._addTriangle(v,f,p,P,S,x,r);this._legalize(P+1),this._legalize(I+2)}_handleCollinear(e,n){const i=n-n%3,r=i+(n+1)%3,s=i+(n+2)%3,o=this.triangles[s],a=this.triangles[n],c=this.triangles[r],f=this._halfedges[r],p=this._halfedges[s],m=this._halfedges[n];if(m<0){const Q=this._addTriangle(e,o,a,-1,p,-1,i),q=this._addTriangle(o,e,c,Q,-1,f);this._legalize(Q+1),this._legalize(q+2);return}const v=m-m%3,w=v+(m+2)%3,C=v+(m+1)%3,S=this.triangles[w],R=this._halfedges[w],x=this._halfedges[C];this._queueRemove(v/3);const P=this._addTriangle(o,a,e,p,-1,-1,i),I=this._addTriangle(a,S,e,x,-1,P+1,v),F=this._addTriangle(S,c,e,R,-1,I+1),H=this._addTriangle(c,o,e,f,P+2,F+1);this._legalize(P),this._legalize(I),this._legalize(F),this._legalize(H)}_queuePush(e,n,i){const r=this._queue.length;this._queueIndices[e]=r,this._queue.push(e),this._errors.push(n),this._rmsSum+=i,this._queueUp(r)}_queuePop(){const e=this._queue.length-1;return this._queueSwap(0,e),this._queueDown(0,e),this._queuePopBack()}_queuePopBack(){const e=this._queue.pop();return this._errors.pop(),this._rmsSum-=this._rms[e],this._queueIndices[e]=-1,e}_queueRemove(e){const n=this._queueIndices[e];if(n<0){const r=this._pending.indexOf(e);if(r!==-1)this._pending[r]=this._pending[--this._pendingLen];else throw new Error("Broken triangulation (something went wrong).");return}const i=this._queue.length-1;i!==n&&(this._queueSwap(n,i),this._queueDown(n,i)||this._queueUp(n)),this._queuePopBack()}_queueLess(e,n){return this._errors[e]>this._errors[n]}_queueSwap(e,n){const i=this._queue[e],r=this._queue[n];this._queue[e]=r,this._queue[n]=i,this._queueIndices[i]=n,this._queueIndices[r]=e;const s=this._errors[e];this._errors[e]=this._errors[n],this._errors[n]=s}_queueUp(e){let n=e;for(;;){const i=n-1>>1;if(i===n||!this._queueLess(n,i))break;this._queueSwap(i,n),n=i}}_queueDown(e,n){let i=e;for(;;){const r=2*i+1;if(r>=n||r<0)break;const s=r+1;let o=r;if(s<n&&this._queueLess(s,r)&&(o=s),!this._queueLess(o,i))break;this._queueSwap(i,o),i=o}return i>e}}function Ns(t,e,n,i,r,s){return(n-r)*(e-s)-(i-s)*(t-r)}function CJ(t,e,n,i,r,s,o,a){const c=t-o,f=e-a,p=n-o,m=i-a,v=r-o,w=s-a,C=c*c+f*f,S=p*p+m*m,R=v*v+w*w;return c*(m*R-S*w)-f*(p*R-S*v)+C*(p*w-m*v)<0}function Ru(t,e,n,i,r){const{rScaler:s,bScaler:o,gScaler:a,offset:c}=i,f=new Float32Array((e+1)*(n+1));for(let p=0,m=0;m<n;m++)for(let v=0;v<e;v++,p++){const w=p*4,C=t[w+0],S=t[w+1],R=t[w+2];f[p+m]=C*s+S*a+R*o+c}if(r==="martini"){for(let p=(e+1)*e,m=0;m<e;m++,p++)f[p]=f[p-e-1];for(let p=n,m=0;m<n+1;m++,p+=n+1)f[p]=f[p-1]}return f}function bJ(t,e,n,i,r){const s=n+1,o=t.length/2,a=new Float32Array(o*3),c=new Float32Array(o*2),[f,p,m,v]=r||[0,0,n,i],w=(m-f)/n,C=(v-p)/i;for(let S=0;S<o;S++){const R=t[S*2],x=t[S*2+1],P=x*s+R;a[3*S+0]=R*w+f,a[3*S+1]=-x*C+v,a[3*S+2]=e[P],c[2*S+0]=R/n,c[2*S+1]=x/i}return{POSITION:{value:a,size:3},TEXCOORD_0:{value:c,size:2}}}function SJ(t,e){if(t===null)return null;const{meshMaxError:n,bounds:i,elevationDecoder:r}=e,{data:s,width:o,height:a}=t;let c,f;switch(e.tesselator){case"martini":c=Ru(s,o,a,r,e.tesselator),f=Nw(n,o,c);break;case"delatin":c=Ru(s,o,a,r,e.tesselator),f=Uw(n,o,a,c);break;default:o===a&&!(a&o-1)?(c=Ru(s,o,a,r,"martini"),f=Nw(n,o,c)):(c=Ru(s,o,a,r,"delatin"),f=Uw(n,o,a,c));break}const{vertices:p}=f;let{triangles:m}=f,v=bJ(p,c,o,a,i);const w=Y1(v);if(e.skirtHeight){const{attributes:C,triangles:S}=H3(v,m,e.skirtHeight);v=C,m=S}return{loaderData:{header:{}},header:{vertexCount:m.length,boundingBox:w},mode:4,indices:{value:Uint32Array.from(m),size:1},attributes:v}}function Nw(t,e,n){const i=e+1,s=new EJ(i).createTile(n),{vertices:o,triangles:a}=s.getMesh(t);return{vertices:o,triangles:a}}function Uw(t,e,n,i){const r=new TJ(i,e+1,n+1);r.run(t);const{coords:s,triangles:o}=r;return{vertices:s,triangles:o}}async function xJ(t,e,n){const i={...e,mimeType:"application/x.image",image:{...e.image,type:"data"}},r=await n.parse(t,i);return SJ(r,e.terrain)}const j3="3.2.6",W3={name:"Terrain",id:"terrain",module:"terrain",version:j3,worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}},PJ={name:"Quantized Mesh",id:"quantized-mesh",module:"terrain",version:j3,worker:!0,extensions:["terrain"],mimeTypes:["application/vnd.quantized-mesh"],options:{"quantized-mesh":{bounds:[0,0,1,1],skirtHeight:null}}};({...W3});({...PJ});const Gw=[1],MJ={...gc.defaultProps,elevationData:kp,texture:{...kp,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:{type:"string",value:null},wireframe:!1,material:!0,loaders:[W3]};function zw(t){return Array.isArray(t)?t.join(";"):t||""}class Q3 extends Rr{constructor(...e){super(...e),T(this,"state",void 0)}updateState({props:e,oldProps:n}){const i=e.elevationData!==n.elevationData;if(i){const{elevationData:s}=e,o=s&&(Array.isArray(s)||s.includes("{x}")&&s.includes("{y}"));this.setState({isTiled:o})}const r=i||e.meshMaxError!==n.meshMaxError||e.elevationDecoder!==n.elevationDecoder||e.bounds!==n.bounds;if(!this.state.isTiled&&r){const s=this.loadTerrain(e);this.setState({terrain:s})}e.workerUrl&&Re.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:e,bounds:n,elevationDecoder:i,meshMaxError:r,signal:s}){var o;if(!e)return null;let a=this.getLoadOptions();a={...a,terrain:{skirtHeight:this.state.isTiled?r*2:0,...(o=a)===null||o===void 0?void 0:o.terrain,bounds:n,meshMaxError:r,elevationDecoder:i}};const{fetch:c}=this.props;return c(e,{propName:"elevationData",layer:this,loadOptions:a,signal:s})}getTiledTerrainData(e){const{elevationData:n,fetch:i,texture:r,elevationDecoder:s,meshMaxError:o}=this.props,{viewport:a}=this.context,c=ef(n,e),f=r&&ef(r,e),{signal:p}=e;let m=[0,0],v=[0,0];if(a.isGeospatial){const R=e.bbox;m=a.projectFlat([R.west,R.south]),v=a.projectFlat([R.east,R.north])}else{const R=e.bbox;m=[R.left,R.bottom],v=[R.right,R.top]}const w=[m[0],m[1],v[0],v[1]],C=this.loadTerrain({elevationData:c,bounds:w,elevationDecoder:s,meshMaxError:o,signal:p}),S=f?i(f,{propName:"texture",layer:this,loaders:[],signal:p}).catch(R=>null):Promise.resolve(null);return Promise.all([C,S])}renderSubLayers(e){const n=this.getSubLayerClass("mesh",Vl),{color:i,wireframe:r,material:s}=this.props,{data:o}=e;if(!o)return null;const[a,c]=o;return new n(e,{data:Gw,mesh:a,texture:c,_instanced:!1,coordinateSystem:ze.CARTESIAN,getPosition:f=>[0,0,0],getColor:i,wireframe:r,material:s})}onViewportLoad(e){if(!e)return;const{zRange:n}=this.state,i=e.map(o=>o.content).filter(Boolean).map(o=>o[0].header.boundingBox.map(c=>c[2]));if(i.length===0)return;const r=Math.min(...i.map(o=>o[0])),s=Math.max(...i.map(o=>o[1]));(!n||r<n[0]||s>n[1])&&this.setState({zRange:[r,s]})}renderLayers(){const{color:e,material:n,elevationData:i,texture:r,wireframe:s,meshMaxError:o,elevationDecoder:a,tileSize:c,maxZoom:f,minZoom:p,extent:m,maxRequests:v,onTileLoad:w,onTileUnload:C,onTileError:S,maxCacheSize:R,maxCacheByteSize:x,refinementStrategy:P}=this.props;if(this.state.isTiled)return new gc(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:zw(i),texture:zw(r),meshMaxError:o,elevationDecoder:a}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:c,maxZoom:f,minZoom:p,extent:m,maxRequests:v,onTileLoad:w,onTileUnload:C,onTileError:S,maxCacheSize:R,maxCacheByteSize:x,refinementStrategy:P});const I=this.getSubLayerClass("mesh",Vl);return new I(this.getSubLayerProps({id:"mesh"}),{data:Gw,mesh:this.state.terrain,texture:r,_instanced:!1,getPosition:F=>[0,0,0],getColor:e,material:n,wireframe:s})}}T(Q3,"defaultProps",MJ);T(Q3,"layerName","TerrainLayer");function IJ(t,e,n){const i=BJ(t),r=Object.keys(i).filter(s=>i[s]!==Array);return LJ(t,{propArrayTypes:i,...e},{numericPropKeys:n&&n.numericPropKeys||r,PositionDataType:n?n.PositionDataType:Float32Array})}function BJ(t){const e={};for(const n of t)if(n.properties)for(const i in n.properties){const r=n.properties[i];e[i]=NJ(r,e[i])}return e}function LJ(t,e,n){const{pointPositionsCount:i,pointFeaturesCount:r,linePositionsCount:s,linePathsCount:o,lineFeaturesCount:a,polygonPositionsCount:c,polygonObjectsCount:f,polygonRingsCount:p,polygonFeaturesCount:m,propArrayTypes:v,coordLength:w}=e,{numericPropKeys:C=[],PositionDataType:S=Float32Array}=n,R=t[0]&&"id"in t[0],x=t.length>65535?Uint32Array:Uint16Array,P={type:"Point",positions:new S(i*w),globalFeatureIds:new x(i),featureIds:r>65535?new Uint32Array(i):new Uint16Array(i),numericProps:{},properties:[],fields:[]},I={type:"LineString",pathIndices:s>65535?new Uint32Array(o+1):new Uint16Array(o+1),positions:new S(s*w),globalFeatureIds:new x(s),featureIds:a>65535?new Uint32Array(s):new Uint16Array(s),numericProps:{},properties:[],fields:[]},F={type:"Polygon",polygonIndices:c>65535?new Uint32Array(f+1):new Uint16Array(f+1),primitivePolygonIndices:c>65535?new Uint32Array(p+1):new Uint16Array(p+1),positions:new S(c*w),triangles:[],globalFeatureIds:new x(c),featureIds:m>65535?new Uint32Array(c):new Uint16Array(c),numericProps:{},properties:[],fields:[]};for(const Q of[P,I,F])for(const q of C){const ee=v[q];Q.numericProps[q]=new ee(Q.positions.length/w)}I.pathIndices[o]=s,F.polygonIndices[f]=c,F.primitivePolygonIndices[p]=c;const H={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const Q of t){const q=Q.geometry,ee=Q.properties||{};switch(q.type){case"Point":RJ(q,P,H,w,ee),P.properties.push(q0(ee,C)),R&&P.fields.push({id:Q.id}),H.pointFeature++;break;case"LineString":OJ(q,I,H,w,ee),I.properties.push(q0(ee,C)),R&&I.fields.push({id:Q.id}),H.lineFeature++;break;case"Polygon":FJ(q,F,H,w,ee),F.properties.push(q0(ee,C)),R&&F.fields.push({id:Q.id}),H.polygonFeature++;break;default:throw new Error("Invalid geometry type")}H.feature++}return kJ(P,I,F,w)}function RJ(t,e,n,i,r){e.positions.set(t.data,n.pointPosition*i);const s=t.data.length/i;o_(e,r,n.pointPosition,s),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+s),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+s),n.pointPosition+=s}function OJ(t,e,n,i,r){e.positions.set(t.data,n.linePosition*i);const s=t.data.length/i;o_(e,r,n.linePosition,s),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+s),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+s);for(let o=0,a=t.indices.length;o<a;++o){const c=t.indices[o],f=o===a-1?t.data.length:t.indices[o+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(f-c)/i}}function FJ(t,e,n,i,r){e.positions.set(t.data,n.polygonPosition*i);const s=t.data.length/i;o_(e,r,n.polygonPosition,s),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+s),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+s);for(let o=0,a=t.indices.length;o<a;++o){const c=n.polygonPosition;e.polygonIndices[n.polygonObject++]=c;const f=t.areas[o],p=t.indices[o],m=t.indices[o+1];for(let w=0,C=p.length;w<C;++w){const S=p[w],R=w===C-1?m===void 0?t.data.length:m[0]:p[w+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(R-S)/i}const v=n.polygonPosition;DJ(e,f,p,{startPosition:c,endPosition:v,coordLength:i})}}function DJ(t,e,n,{startPosition:i,endPosition:r,coordLength:s}){const o=i*s,a=r*s,c=t.positions.subarray(o,a),f=n[0],p=n.slice(1).map(v=>(v-f)/s),m=Mz(c,p,s,e);for(let v=0,w=m.length;v<w;++v)t.triangles.push(i+m[v])}function Z0(t,e){const n={};for(const i in t)n[i]={value:t[i],size:e};return n}function kJ(t,e,n,i){return{points:{...t,positions:{value:t.positions,size:i},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:Z0(t.numericProps,1)},lines:{...e,positions:{value:e.positions,size:i},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:Z0(e.numericProps,1)},polygons:{...n,positions:{value:n.positions,size:i},polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},triangles:{value:new Uint32Array(n.triangles),size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:Z0(n.numericProps,1)}}}function o_(t,e,n,i){for(const r in t.numericProps)if(r in e){const s=e[r];t.numericProps[r].fill(s,n,n+i)}}function q0(t,e){const n={};for(const i in t)e.includes(i)||(n[i]=t[i]);return n}function NJ(t,e){return e===Array||!Number.isFinite(t)?Array:e===Float64Array||Math.fround(t)!==t?Float64Array:Float32Array}function Vw(t,e){const n=e==null?void 0:e.globalFeatureId;return n!==void 0?UJ(t,n):GJ(t,e==null?void 0:e.type)}function UJ(t,e){const n=X3(t);for(const i of n){let r=0,s=i.featureIds.value[0];for(let o=0;o<i.featureIds.value.length;o++){const a=i.featureIds.value[o];if(a!==s){if(e===i.globalFeatureIds.value[r])return of(i,r,o);r=o,s=a}}if(e===i.globalFeatureIds.value[r])return of(i,r,i.featureIds.value.length)}throw new Error("featureId:".concat(e," not found"))}function GJ(t,e){const n=X3(t,e);return VJ(n)}function zJ(t,e,n){switch(t.type){case"Point":return QJ(t,e,n);case"LineString":return WJ(t,e,n);case"Polygon":return J3(t,e,n);default:const i=t;throw new Error("Unsupported geometry type: ".concat(i==null?void 0:i.type))}}function X3(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||XJ(t),[t];const i=[];return t.points&&(t.points.type="Point",i.push(t.points)),t.lines&&(t.lines.type="LineString",i.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",i.push(t.polygons)),i}function VJ(t){const e=[];for(const n of t){if(n.featureIds.value.length===0)continue;let i=0,r=n.featureIds.value[0];for(let s=0;s<n.featureIds.value.length;s++){const o=n.featureIds.value[s];o!==r&&(e.push(of(n,i,s)),i=s,r=o)}e.push(of(n,i,n.featureIds.value.length))}return e}function of(t,e,n){const i=zJ(t,e,n),r=jJ(t,e),s=HJ(t,e);return{type:"Feature",geometry:i,properties:r,...s}}function HJ(t,e=0,n){return t.fields&&t.fields[t.featureIds.value[e]]}function jJ(t,e=0,n){const i=Object.assign({},t.properties[t.featureIds.value[e]]);for(const r in t.numericProps)i[r]=t.numericProps[r].value[e];return i}function J3(t,e=-1/0,n=1/0){const{positions:i}=t,r=t.polygonIndices.value.filter(c=>c>=e&&c<=n),s=t.primitivePolygonIndices.value.filter(c=>c>=e&&c<=n);if(!(r.length>2)){const c=[];for(let f=0;f<s.length-1;f++){const p=s[f],m=s[f+1],v=af(i,p,m);c.push(v)}return{type:"Polygon",coordinates:c}}const a=[];for(let c=0;c<r.length-1;c++){const f=r[c],p=r[c+1],m=J3(t,f,p).coordinates;a.push(m)}return{type:"MultiPolygon",coordinates:a}}function WJ(t,e=-1/0,n=1/0){const{positions:i}=t,r=t.pathIndices.value.filter(a=>a>=e&&a<=n);if(!(r.length>2)){const a=af(i,r[0],r[1]);return{type:"LineString",coordinates:a}}const o=[];for(let a=0;a<r.length-1;a++){const c=af(i,r[a],r[a+1]);o.push(c)}return{type:"MultiLineString",coordinates:o}}function QJ(t,e,n){const{positions:i}=t,r=af(i,e,n);return r.length>1?{type:"MultiPoint",coordinates:r}:{type:"Point",coordinates:r[0]}}function af(t,e,n){e=e||0,n=n||t.value.length/t.size;const i=[];for(let r=e;r<n;r++){const s=Array();for(let o=r*t.size;o<(r+1)*t.size;o++)s.push(Number(t.value[o]));i.push(s)}return i}function XJ(t){return t.pathIndices?"LineString":t.polygonIndices?"Polygon":"Point"}var a_={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */a_.read=function(t,e,n,i,r){var s,o,a=r*8-i-1,c=(1<<a)-1,f=c>>1,p=-7,m=n?r-1:0,v=n?-1:1,w=t[e+m];for(m+=v,s=w&(1<<-p)-1,w>>=-p,p+=a;p>0;s=s*256+t[e+m],m+=v,p-=8);for(o=s&(1<<-p)-1,s>>=-p,p+=i;p>0;o=o*256+t[e+m],m+=v,p-=8);if(s===0)s=1-f;else{if(s===c)return o?NaN:(w?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-f}return(w?-1:1)*o*Math.pow(2,s-i)};a_.write=function(t,e,n,i,r,s){var o,a,c,f=s*8-r-1,p=(1<<f)-1,m=p>>1,v=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=i?0:s-1,C=i?1:-1,S=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=p):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+m>=1?e+=v/c:e+=v*Math.pow(2,1-m),e*c>=2&&(o++,c/=2),o+m>=p?(a=0,o=p):o+m>=1?(a=(e*c-1)*Math.pow(2,r),o=o+m):(a=e*Math.pow(2,m-1)*Math.pow(2,r),o=0));r>=8;t[n+w]=a&255,w+=C,a/=256,r-=8);for(o=o<<r|a,f+=r;f>0;t[n+w]=o&255,w+=C,o/=256,f-=8);t[n+w-C]|=S*128};var Y3=ot,Ou=a_;function ot(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}ot.Varint=0;ot.Fixed64=1;ot.Bytes=2;ot.Fixed32=5;var Qp=(1<<16)*(1<<16),Hw=1/Qp,JJ=12,K3=typeof TextDecoder>"u"?null:new TextDecoder("utf8");ot.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var i=this.readVarint(),r=i>>3,s=this.pos;this.type=i&7,t(r,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Fu(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Ww(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Fu(this.buf,this.pos)+Fu(this.buf,this.pos+4)*Qp;return this.pos+=8,t},readSFixed64:function(){var t=Fu(this.buf,this.pos)+Ww(this.buf,this.pos+4)*Qp;return this.pos+=8,t},readFloat:function(){var t=Ou.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Ou.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,n,i;return i=e[this.pos++],n=i&127,i<128||(i=e[this.pos++],n|=(i&127)<<7,i<128)||(i=e[this.pos++],n|=(i&127)<<14,i<128)||(i=e[this.pos++],n|=(i&127)<<21,i<128)?n:(i=e[this.pos],n|=(i&15)<<28,YJ(n,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=JJ&&K3?lY(this.buf,e,t):AY(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==ot.Bytes)return t.push(this.readVarint(e));var n=dr(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==ot.Bytes)return t.push(this.readSVarint());var e=dr(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==ot.Bytes)return t.push(this.readBoolean());var e=dr(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==ot.Bytes)return t.push(this.readFloat());var e=dr(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==ot.Bytes)return t.push(this.readDouble());var e=dr(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==ot.Bytes)return t.push(this.readFixed32());var e=dr(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==ot.Bytes)return t.push(this.readSFixed32());var e=dr(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==ot.Bytes)return t.push(this.readFixed64());var e=dr(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==ot.Bytes)return t.push(this.readSFixed64());var e=dr(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===ot.Varint)for(;this.buf[this.pos++]>127;);else if(e===ot.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ot.Fixed32)this.pos+=4;else if(e===ot.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Go(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Go(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Go(this.buf,t&-1,this.pos),Go(this.buf,Math.floor(t*Hw),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Go(this.buf,t&-1,this.pos),Go(this.buf,Math.floor(t*Hw),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){KJ(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=cY(this.buf,t,this.pos);var n=this.pos-e;n>=128&&jw(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Ou.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Ou.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var i=this.pos-n;i>=128&&jw(n,i,this),this.pos=n-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,n){this.writeTag(t,ot.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,$J,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,eY,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,iY,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,tY,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,nY,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,rY,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,sY,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,oY,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,aY,e)},writeBytesField:function(t,e){this.writeTag(t,ot.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,ot.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,ot.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,ot.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,ot.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,ot.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,ot.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,ot.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,ot.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,ot.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};function YJ(t,e,n){var i=n.buf,r,s;if(s=i[n.pos++],r=(s&112)>>4,s<128||(s=i[n.pos++],r|=(s&127)<<3,s<128)||(s=i[n.pos++],r|=(s&127)<<10,s<128)||(s=i[n.pos++],r|=(s&127)<<17,s<128)||(s=i[n.pos++],r|=(s&127)<<24,s<128)||(s=i[n.pos++],r|=(s&1)<<31,s<128))return Uo(t,r,e);throw new Error("Expected varint not more than 10 bytes")}function dr(t){return t.type===ot.Bytes?t.readVarint()+t.pos:t.pos+1}function Uo(t,e,n){return n?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function KJ(t,e){var n,i;if(t>=0?(n=t%4294967296|0,i=t/4294967296|0):(n=~(-t%4294967296),i=~(-t/4294967296),n^4294967295?n=n+1|0:(n=0,i=i+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),ZJ(n,i,e),qJ(i,e)}function ZJ(t,e,n){n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos]=t&127}function qJ(t,e){var n=(t&7)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function jw(t,e,n){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));n.realloc(i);for(var r=n.pos-1;r>=t;r--)n.buf[r+i]=n.buf[r]}function $J(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function eY(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function tY(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function nY(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function iY(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function rY(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function sY(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function oY(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function aY(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Fu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function Go(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function Ww(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function AY(t,e,n){for(var i="",r=e;r<n;){var s=t[r],o=null,a=s>239?4:s>223?3:s>191?2:1;if(r+a>n)break;var c,f,p;a===1?s<128&&(o=s):a===2?(c=t[r+1],(c&192)===128&&(o=(s&31)<<6|c&63,o<=127&&(o=null))):a===3?(c=t[r+1],f=t[r+2],(c&192)===128&&(f&192)===128&&(o=(s&15)<<12|(c&63)<<6|f&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(c=t[r+1],f=t[r+2],p=t[r+3],(c&192)===128&&(f&192)===128&&(p&192)===128&&(o=(s&15)<<18|(c&63)<<12|(f&63)<<6|p&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),r+=a}return i}function lY(t,e,n){return K3.decode(t.subarray(e,n))}function cY(t,e,n){for(var i=0,r,s;i<e.length;i++){if(r=e.charCodeAt(i),r>55295&&r<57344)if(s)if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,s=r;continue}else r=s-55296<<10|r-56320|65536,s=null;else{r>56319||i+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):s=r;continue}else s&&(t[n++]=239,t[n++]=191,t[n++]=189,s=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=r&63|128)}return n}function uY(t){const e=t.length;if(e<=1)return[t];const n=[];let i,r;for(let s=0;s<e;s++){const o=hY(t[s]);o!==0&&(r===void 0&&(r=o<0),r===o<0?(i&&n.push(i),i=[t[s]]):i&&i.push(t[s]))}return i&&n.push(i),n}function hY(t){let e=0;for(let n=0,i=t.length-1,r,s;n<t.length;i=n++)r=t[n],s=t[i],e+=(s[0]-r[0])*(r[1]+s[1]);return e}function fY(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?dY(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function dY(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}class A_{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(e,n,i,r,s){T(this,"properties",void 0),T(this,"extent",void 0),T(this,"type",void 0),T(this,"id",void 0),T(this,"_pbf",void 0),T(this,"_geometry",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),this.properties={},this.extent=i,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=r,this._values=s,e.readFields(fY,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let i=1,r=0,s=0,o=0;const a=[];let c;for(;e.pos<n;){if(r<=0){const f=e.readVarint();i=f&7,r=f>>3}if(r--,i===1||i===2)s+=e.readSVarint(),o+=e.readSVarint(),i===1&&(c&&a.push(c),c=[]),c&&c.push([s,o]);else if(i===7)c&&c.push(c[0].slice());else throw new Error("unknown command ".concat(i))}return c&&a.push(c),a}bbox(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let i=1,r=0,s=0,o=0,a=1/0,c=-1/0,f=1/0,p=-1/0;for(;e.pos<n;){if(r<=0){const m=e.readVarint();i=m&7,r=m>>3}if(r--,i===1||i===2)s+=e.readSVarint(),o+=e.readSVarint(),s<a&&(a=s),s>c&&(c=s),o<f&&(f=o),o>p&&(p=o);else if(i!==7)throw new Error("unknown command ".concat(i))}return[a,f,c,p]}_toGeoJSON(e){let n=this.loadGeometry(),i=A_.types[this.type],r,s;switch(this.type){case 1:const a=[];for(r=0;r<n.length;r++)a[r]=n[r][0];n=a,e(n,this);break;case 2:for(r=0;r<n.length;r++)e(n[r],this);break;case 3:for(n=uY(n),r=0;r<n.length;r++)for(s=0;s<n[r].length;s++)e(n[r][s],this);break}n.length===1?n=n[0]:i="Multi".concat(i);const o={type:"Feature",geometry:{type:i,coordinates:n},properties:this.properties};return this.id!==null&&(o.id=this.id),o}toGeoJSON(e){if(typeof e=="function")return this._toGeoJSON(e);const{x:n,y:i,z:r}=e,s=this.extent*Math.pow(2,r),o=this.extent*n,a=this.extent*i;function c(f){for(let p=0;p<f.length;p++){const m=f[p];m[0]=(m[0]+o)*360/s-180;const v=180-(m[1]+a)*360/s;m[1]=360/Math.PI*Math.atan(Math.exp(v*Math.PI/180))-90}}return this._toGeoJSON(c)}}class gY{constructor(e,n){T(this,"version",void 0),T(this,"name",void 0),T(this,"extent",void 0),T(this,"length",void 0),T(this,"_pbf",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(pY,this,n),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const n=this._pbf.readVarint()+this._pbf.pos;return new A_(this._pbf,n,this.extent,this._keys,this._values)}}function pY(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(mY(n)))}function mY(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const i=t.readVarint()>>3;e=i===1?t.readString():i===2?t.readFloat():i===3?t.readDouble():i===4?t.readVarint64():i===5?t.readVarint():i===6?t.readSVarint():i===7?t.readBoolean():null}return e}class _Y{constructor(e,n){T(this,"layers",void 0),this.layers=e.readFields(yY,{},n)}}function yY(t,e,n){if(t===3&&n){const i=new gY(n,n.readVarint()+n.pos);i.length&&e&&(e[i.name]=i)}}function vY(t){const e=t.indices.length,n="Polygon";if(e<=1)return{type:n,data:t.data,areas:[[Kh(t.data)]],indices:[t.indices]};const i=[],r=[];let s=[],o=[],a,c=0;for(let f,p=0,m;p<e;p++){m=t.indices[p]-c,f=t.indices[p+1]-c||t.data.length;const v=t.data.slice(m,f),w=Kh(v);if(w===0){const C=t.data.slice(0,m),S=t.data.slice(f);t.data=C.concat(S),c+=f-m;continue}a===void 0&&(a=w<0),a===w<0?(o.length&&(i.push(s),r.push(o)),o=[m],s=[w]):(s.push(w),o.push(m))}return s&&i.push(s),o.length&&r.push(o),{type:n,areas:i,indices:r,data:t.data}}function EY(t,e,n,i){for(let r=0,s=t.length;r<s;r+=2){t[r]=(t[r]+e)*360/i-180;const o=180-(t[r+1]+n)*360/i;t[r+1]=360/Math.PI*Math.atan(Math.exp(o*Math.PI/180))-90}}function wY(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?TY(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function TY(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const i=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[i]=r}}let Qw,Us,$0,Du,eg,tg,DA;class CY{constructor(e,n,i,r,s,o){T(this,"properties",void 0),T(this,"extent",void 0),T(this,"type",void 0),T(this,"id",void 0),T(this,"_pbf",void 0),T(this,"_geometry",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_geometryInfo",void 0),this.properties={},this.extent=i,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=r,this._values=s,this._geometryInfo=o,e.readFields(wY,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry,Qw=e.readVarint()+e.pos,Us=1,Du=0,eg=0,tg=0,DA=0;const n=[],i=[];for(;e.pos<Qw;)if(Du<=0&&($0=e.readVarint(),Us=$0&7,Du=$0>>3),Du--,Us===1||Us===2)eg+=e.readSVarint(),tg+=e.readSVarint(),Us===1&&n.push(DA),i.push(eg,tg),DA+=2;else if(Us===7){if(DA>0){const r=n[n.length-1];i.push(i[r],i[r+1]),DA+=2}}else throw new Error("unknown command ".concat(Us));return{data:i,indices:n}}_toBinaryCoordinates(e){const n=this.loadGeometry();let i;e(n.data,this);const r=2;switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=n.indices.length,i={type:"Point",...n};break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=n.indices.length,this._geometryInfo.linePositionsCount+=n.data.length/r,i={type:"LineString",...n};break;case 3:i=vY(n),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=i.indices.length;for(const o of i.indices)this._geometryInfo.polygonRingsCount+=o.length;this._geometryInfo.polygonPositionsCount+=i.data.length/r;break;default:throw new Error("Invalid geometry type: ".concat(this.type))}const s={type:"Feature",geometry:i,properties:this.properties};return this.id!==null&&(s.id=this.id),s}toBinaryCoordinates(e){if(typeof e=="function")return this._toBinaryCoordinates(e);const{x:n,y:i,z:r}=e,s=this.extent*Math.pow(2,r),o=this.extent*n,a=this.extent*i;return this._toBinaryCoordinates(c=>EY(c,o,a,s))}}class bY{constructor(e,n){T(this,"version",void 0),T(this,"name",void 0),T(this,"extent",void 0),T(this,"length",void 0),T(this,"_pbf",void 0),T(this,"_keys",void 0),T(this,"_values",void 0),T(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(SY,this,n),this.length=this._features.length}feature(e,n){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const i=this._pbf.readVarint()+this._pbf.pos;return new CY(this._pbf,i,this.extent,this._keys,this._values,n)}}function SY(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(xY(n)))}function xY(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const i=t.readVarint()>>3;e=i===1?t.readString():i===2?t.readFloat():i===3?t.readDouble():i===4?t.readVarint64():i===5?t.readVarint():i===6?t.readSVarint():i===7?t.readBoolean():null}return e}class PY{constructor(e,n){T(this,"layers",void 0),this.layers=e.readFields(MY,{},n)}}function MY(t,e,n){if(t===3&&n){const i=new bY(n,n.readVarint()+n.pos);i.length&&e&&(e[i.name]=i)}}function Xw(t,e){var n,i;const r=BY(e),s=(e==null||(n=e.gis)===null||n===void 0?void 0:n.format)||(e==null||(i=e.mvt)===null||i===void 0?void 0:i.shape);switch(s){case"columnar-table":return{shape:"columnar-table",data:ng(t,r)};case"geojson-row-table":return{shape:"geojson-row-table",data:Jw(t,r)};case"geojson":return Jw(t,r);case"binary-geometry":return ng(t,r);case"binary":return ng(t,r);default:throw new Error(s)}}function ng(t,e){const[n,i]=IY(t,e),r=IJ(n,i);return r.byteLength=t.byteLength,r}function IY(t,e){const n=[],i={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength<=0)return[n,i];const r=new PY(new Y3(t));return(e&&Array.isArray(e.layers)?e.layers:Object.keys(r.layers)).forEach(o=>{const a=r.layers[o];if(!!a)for(let c=0;c<a.length;c++){const f=a.feature(c,i),p=RY(f,e,o);n.push(p)}}),[n,i]}function Jw(t,e){if(t.byteLength<=0)return[];const n=[],i=new _Y(new Y3(t));return(Array.isArray(e.layers)?e.layers:Object.keys(i.layers)).forEach(s=>{const o=i.layers[s];if(!!o)for(let a=0;a<o.length;a++){const c=o.feature(a),f=LY(c,e,s);n.push(f)}}),n}function BY(t){var e;if(!(t!=null&&t.mvt))throw new Error("mvt options required");const n=((e=t.mvt)===null||e===void 0?void 0:e.coordinates)==="wgs84",{tileIndex:i}=t.mvt,r=i&&Number.isFinite(i.x)&&Number.isFinite(i.y)&&Number.isFinite(i.z);if(n&&!r)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return t.mvt}function LY(t,e,n){const i=t.toGeoJSON(e.coordinates==="wgs84"?e.tileIndex:OY);return e.layerProperty&&(i.properties[e.layerProperty]=n),i}function RY(t,e,n){const i=t.toBinaryCoordinates(e.coordinates==="wgs84"?e.tileIndex:FY);return e.layerProperty&&i.properties&&(i.properties[e.layerProperty]=n),i}function OY(t,e){const{extent:n}=e;for(let i=0;i<t.length;i++){const r=t[i];r[0]/=n,r[1]/=n}}function FY(t,e){const{extent:n}=e;for(let i=0,r=t.length;i<r;++i)t[i]/=n}const DY="3.2.6",kY={mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}},Z3={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:DY,extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:kY};({...Z3});const q3={clipBounds:[0,0,1,1]},$3=`
uniform vec4 clip_bounds;

bool clip_isInBounds(vec2 position) {
  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];
}
`,NY={name:"clip-vs",vs:$3},UY={"vs:#decl":`
varying float clip_isVisible;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));
`,"fs:#decl":`
varying float clip_isVisible;
`,"fs:DECKGL_FILTER_COLOR":`
  if (clip_isVisible < 0.5) discard;
`},GY={name:"clip-fs",fs:$3},zY={"vs:#decl":`
varying vec2 clip_commonPosition;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_commonPosition = geometry.position.xy;
`,"fs:#decl":`
varying vec2 clip_commonPosition;
`,"fs:DECKGL_FILTER_COLOR":`
  if (!clip_isInBounds(clip_commonPosition)) discard;
`};class l_ extends _x{getShaders(){let e="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(e=this.props.clipByInstance),this.state.clipByInstance=e,e?{modules:[NY],inject:UY}:{modules:[GY],inject:zY}}draw({uniforms:e}){const{clipBounds:n=q3.clipBounds}=this.props;if(this.state.clipByInstance)e.clip_bounds=n;else{const i=this.projectPosition([n[0],n[1],0]),r=this.projectPosition([n[2],n[3],0]);e.clip_bounds=[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[0],r[0]),Math.max(i[1],r[1])]}}}T(l_,"defaultProps",q3);T(l_,"extensionName","ClipExtension");const VY={Point:eP,MultiPoint:HY,LineString:tP,MultiLineString:jY,Polygon:nP,MultiPolygon:WY};function eP([t,e],[n,i],r){const s=ps(n[0],i[0],t),o=ps(n[1],i[1],e);return r.unprojectFlat([s,o])}function c_(t,e,n){return t.map(i=>eP(i,e,n))}function HY(t,e,n){return c_(t,e,n)}function tP(t,e,n){return c_(t,e,n)}function jY(t,e,n){return t.map(i=>tP(i,e,n))}function nP(t,e,n){return t.map(i=>c_(i,e,n))}function WY(t,e,n){return t.map(i=>nP(i,e,n))}function QY(t,e,n){const i=n.projectFlat([e.west,e.north]),r=n.projectFlat([e.east,e.south]),s=[i,r];return{...t,coordinates:VY[t.type](t.coordinates,s,n)}}const XY=["points","lines","polygons"];function JY(t,e,n,i){for(const r of XY){const s=t[r]&&YY(t[r],e,n,i);if(s>=0)return s}return-1}function YY(t,e,n,i){const r=t.featureIds.value;if(!r.length)return-1;let s=0,o=r[r.length-1]+1;if(i){const c=KY(t,i);if(c)s=c[0],o=c[1]+1;else return-1}let a=-1;if(e in t.numericProps){const c=t.numericProps[e].value.findIndex((f,p)=>f===n&&r[p]>=s&&r[p]<o);return c>=0?t.globalFeatureIds.value[c]:-1}else e?a=Yw(t.properties,c=>c[e]===n,s,o):t.fields&&(a=Yw(t.fields,c=>c.id===n,s,o));return a>=0?ZY(t,a):-1}function KY(t,e){if(!t.__layers){const n={},{properties:i}=t;for(let r=0;r<i.length;r++){const{layerName:s}=i[r];s&&(n[s]?n[s][1]=r:n[s]=[r,r])}t.__layers=n}return t.__layers[e]}function ZY(t,e){if(!t.__ids){const n=[],i=t.featureIds.value,r=t.globalFeatureIds.value;for(let s=0;s<i.length;s++)n[i[s]]=r[s];t.__ids=n}return t.__ids[e]}function Yw(t,e,n,i){for(let r=n;r<i;r++)if(e(t[r],r))return r;return-1}const ig=512,qY={...hc.defaultProps,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[Z3],binary:!0};class iP extends gc{initializeState(){super.initializeState();const e=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:e,data:null,tileJSON:null})}get isLoaded(){return this.state&&this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:e,oldProps:n,context:i,changeFlags:r}){var s;r.dataChanged&&this._updateTileData(),(s=this.state)!==null&&s!==void 0&&s.data&&(super.updateState({props:e,oldProps:n,context:i,changeFlags:r}),this._setWGS84PropertyForTiles());const{highlightColor:o}=e;o!==n.highlightColor&&Array.isArray(o)&&this.setState({highlightColor:o})}async _updateTileData(){let e=this.props.data,n=null;if(typeof e=="string"&&!gH(e)){const{onDataLoad:i,fetch:r}=this.props;this.setState({data:null,tileJSON:null});try{n=await r(e,{propName:"data",layer:this,loaders:[]})}catch(s){this.raiseError(s,"loading TileJSON"),e=null}i&&i(n,{propName:"data",layer:this})}else e.tilejson&&(n=e);n&&(e=n.tiles),this.setState({data:e,tileJSON:n})}_getTilesetOptions(){const e=super._getTilesetOptions(),n=this.state.tileJSON,{minZoom:i,maxZoom:r}=this.props;return n&&(Number.isFinite(n.minzoom)&&n.minzoom>i&&(e.minZoom=n.minzoom),Number.isFinite(n.maxzoom)&&(!Number.isFinite(r)||n.maxzoom<r)&&(e.maxZoom=n.maxzoom)),e}renderLayers(){var e;return(e=this.state)!==null&&e!==void 0&&e.data?super.renderLayers():null}getTileData(e){var n;const{data:i,binary:r}=this.state,{index:s,signal:o}=e,a=ef(i,e);if(!a)return Promise.reject("Invalid URL");let c=this.getLoadOptions();const{fetch:f}=this.props;return c={...c,mimeType:"application/x-protobuf",mvt:{...(n=c)===null||n===void 0?void 0:n.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:s},gis:r?{format:"binary"}:{}},f(a,{propName:"data",layer:this,loadOptions:c,signal:o})}renderSubLayers(e){const{x:n,y:i,z:r}=e.tile.index,s=Math.pow(2,r),o=ig/s,a=-o,c=ig*n/s,f=ig*(1-i/s),p=new De().scale([o,a,1]);e.autoHighlight=!1,this.context.viewport.resolution||(e.modelMatrix=p,e.coordinateOrigin=[c,f,0],e.coordinateSystem=ze.CARTESIAN,e.extensions=[...e.extensions||[],new l_]);const m=super.renderSubLayers(e);return this.state.binary&&!(m instanceof hc)&&Re.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),m}_updateAutoHighlight(e){const{uniqueIdProperty:n}=this.props,{hoveredFeatureId:i,hoveredFeatureLayerName:r}=this.state,s=e.object;let o,a;s&&(o=rg(s,n),a=Kw(s));let{highlightColor:c}=this.props;typeof c=="function"&&(c=c(e)),(i!==o||r!==a)&&this.setState({highlightColor:c,hoveredFeatureId:o,hoveredFeatureLayerName:a})}getPickingInfo(e){const n=super.getPickingInfo(e),i=Boolean(this.context.viewport.resolution);if(this.state.binary&&n.index!==-1){const{data:r}=e.sourceLayer.props;n.object=Vw(r,{globalFeatureId:n.index})}return n.object&&!i&&(n.object=qw(n.object,n.tile.bbox,this.context.viewport)),n}getSubLayerPropsByTile(e){return{highlightedObjectIndex:this.getHighlightedObjectIndex(e),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(e){const{hoveredFeatureId:n,hoveredFeatureLayerName:i,binary:r}=this.state,{uniqueIdProperty:s,highlightedFeatureId:o}=this.props,a=e.content,c=Zw(o);if(!(Zw(n)||c))return-1;const p=c?o:n;return Array.isArray(a)?a.findIndex(m=>{const v=rg(m,s)===p,w=c||Kw(m)===i;return v&&w}):a&&r?JY(a,s,p,c?"":i):-1}_pickObjects(e){const{deck:n,viewport:i}=this.context,r=i.width,s=i.height,o=i.x,a=i.y,c=[this.id];return n.pickObjects({x:o,y:a,width:r,height:s,layerIds:c,maxObjects:e})}getRenderedFeatures(e=null){const n=this._pickObjects(e),i=new Set,r=[];for(const s of n){const o=rg(s.object,this.props.uniqueIdProperty);o===void 0?r.push(s.object):i.has(o)||(i.add(o),r.push(s.object))}return r}_setWGS84PropertyForTiles(){const e="dataInWGS84";this.state.tileset.selectedTiles.forEach(i=>{i.hasOwnProperty(e)||Object.defineProperty(i,e,{get:()=>{if(!i.content)return null;if(this.state.binary&&Array.isArray(i.content)&&!i.content.length)return[];const{bbox:r}=i;if(i._contentWGS84===void 0&&pH(r)){const s=this.state.binary?Vw(i.content):i.content;i._contentWGS84=s.map(o=>qw(o,r,this.context.viewport))}return i._contentWGS84}})})}}T(iP,"layerName","MVTLayer");T(iP,"defaultProps",qY);function rg(t,e){if(t.properties&&e)return t.properties[e];if("id"in t)return t.id}function Kw(t){var e;return((e=t.properties)===null||e===void 0?void 0:e.layerName)||null}function Zw(t){return t!=null&&t!==""}function qw(t,e,n){const i={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(i.geometry,"coordinates",{get:()=>QY(t.geometry,e,n).coordinates}),i}const $w="0123456789bcdefghjkmnpqrstuvwxyz",rP={};for(let t=0;t<$w.length;t++)rP[$w.charAt(t)]=t;const $Y=-90,eK=90,tK=-180,nK=180;function iK(t){let e=!0,n=eK,i=$Y,r=nK,s=tK,o,a=0;for(let c=0,f=t.length;c<f;c++){const p=t[c].toLowerCase();a=rP[p];for(let m=4;m>=0;m--){const v=a>>m&1;e?(o=(r+s)/2,v===1?s=o:r=o):(o=(n+i)/2,v===1?i=o:n=o),e=!e}}return[i,s,n,r]}function rK(t){const[e,n,i,r]=iK(t);return[r,i,r,e,n,e,n,i,r,i]}const sK={getGeohash:{type:"accessor",value:t=>t.geohash}};class sP extends Ja{indexToBounds(){const{data:e,getGeohash:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(i,r)=>rK(n(i,r))}}}T(sP,"layerName","GeohashLayer");T(sP,"defaultProps",sK);const eT=[165921696e4,165928242e4],oK="pk.eyJ1IjoibWF5cTA0MjIiLCJhIjoiY2phamMwOHV4MjllajMzbnFyeTMwcmZvYiJ9.aFMw4Aws5zY9Y4NwYqFMlQ",aK=new WS({color:[255,255,255],intensity:1}),AK=new $6({color:[255,255,255],intensity:2,position:[-74.05,40.7,8e3]}),lK=new w1({ambientLight:aK,pointLight:AK}),cK={ambient:.1,diffuse:.6,shininess:32,specularColor:[60,64,70]},uK={buildingColor:[74,80,87],trailColor0:[253,128,93],trailColor1:[23,184,190],material:cK,effects:[lK]},hK={longitude:104.392,latitude:36.067,zoom:4,pitch:0,bearing:0},fK="mapbox://styles/mapbox/dark-v10";function dK({trailLength:t=180,initialViewState:e=hK,mapStyle:n=fK,theme:i=uK,loopLength:r=1e3,animationSpeed:s=1e5}){const[o,a]=Te.exports.useState(165921696e4),c=Te.exports.useRef(!0),f=Te.exports.useRef(0),p=()=>{c.current&&a(v=>{const w=v+s;return w>eT[1]?eT[0]:w}),f.current=window.requestAnimationFrame(p)};Te.exports.useEffect(()=>(f.current=window.requestAnimationFrame(p),()=>window.cancelAnimationFrame(f.current)),[f]);const m=[new W1({id:"trips",data:"trips.json",getPath:v=>v.waypoints.map(w=>w.coords),getTimestamps:v=>v.waypoints.map(w=>w.timestamp),getColor:[0,187,221],opacity:.8,widthMinPixels:2,rounded:!0,fadeTrail:!0,trailLength:1e7,currentTime:o,shadowEnabled:!1})];return sL(rL,{children:[Ks(wx,{layers:m,effects:i.effects,initialViewState:e,controller:!0,children:Ks(zm,{reuseMaps:!0,mapStyle:n,mapboxAccessToken:oK})}),Ks("div",{className:"time",onClick:()=>c.current=!c.current,children:new Date(o).toLocaleString()})]})}sg.createRoot(document.getElementById("root")).render(Ks(QM.StrictMode,{children:Ks(dK,{})}));export{MM as c};
